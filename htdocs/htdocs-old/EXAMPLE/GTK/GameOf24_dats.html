<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">//
</span><span class="comment">// Game-of-24 with a rough GUI
</span><span class="comment">//
</span><span class="comment">// Author: Hongwei Xi (hwxi AT cs DOT bu DOT edu)
</span><span class="comment">// Time: April, 2010
</span><span class="comment">//
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anon*)</span> <span class="keyword">=</span> "prelude/DATS/list.dats"</span>
<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anon*)</span> <span class="keyword">=</span> "prelude/DATS/list_vt.dats"</span>
<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anon*)</span> <span class="keyword">=</span> "prelude/DATS/reference.dats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">MATH <span class="keyword">=</span> "libc/SATS/math.sats"</span>
<span class="keyword">staload</span> <span class="staexp">RAND <span class="keyword">=</span> "libc/SATS/random.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"contrib/glib/SATS/glib.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"contrib/glib/SATS/glib-object.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"contrib/GTK/SATS/gdk.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"contrib/GTK/SATS/gtkclassdec.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"contrib/GTK/SATS/gtk.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">datatype</span> <span class="staexp"><a name="648"><span class="stacstdec">exp</span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> Num <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span>
  <span class="keyword">|</span> Add <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a><span class="keyword">)</span></span>
  <span class="keyword">|</span> Sub <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a><span class="keyword">)</span></span>
  <span class="keyword">|</span> Mul <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a><span class="keyword">)</span></span>
  <span class="keyword">|</span> Div <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a><span class="keyword">)</span></span>
<span class="comment">// end of [exp]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">extern</span>
<span class="keyword">fun</span> <a name="809"><span class="dyncstdec">eq_exp_exp <span class="keyword">(</span>x1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">,</span> x2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">)</span><span class="keyword">:&lt;&gt;</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14138"><span class="stacstuse">bool</span></a></span></span></a>
<span class="neuexp"><span class="keyword">overload</span> <span class="keyword">=</span> <span class="keyword">with</span> eq_exp_exp</span>

<span class="keyword">implement</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#809"><span class="dyncstimp">eq_exp_exp</span></a> <span class="keyword">(</span>x1<span class="keyword">,</span> x2<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>x1<span class="keyword">,</span> x2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>Num d1<span class="keyword">,</span> Num d2<span class="keyword">)</span> <span class="keyword">=&gt;</span>  <span class="keyword">(</span>d1 <span class="keyword">=</span> d2<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>Add <span class="keyword">(</span>x11<span class="keyword">,</span> x12<span class="keyword">)</span><span class="keyword">,</span> Add <span class="keyword">(</span>x21<span class="keyword">,</span> x22<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
      <span class="keyword">(</span>x11 <span class="keyword">=</span> x21 andalso x12 <span class="keyword">=</span> x22<span class="keyword">)</span> orelse <span class="keyword">(</span>x11 <span class="keyword">=</span> x22 andalso x12 <span class="keyword">=</span> x21<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>Sub <span class="keyword">(</span>x11<span class="keyword">,</span> x12<span class="keyword">)</span><span class="keyword">,</span> Sub <span class="keyword">(</span>x21<span class="keyword">,</span> x22<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>x11 <span class="keyword">=</span> x21<span class="keyword">)</span> andalso <span class="keyword">(</span>x12 <span class="keyword">=</span> x22<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>Mul <span class="keyword">(</span>x11<span class="keyword">,</span> x12<span class="keyword">)</span><span class="keyword">,</span> Mul <span class="keyword">(</span>x21<span class="keyword">,</span> x22<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
      <span class="keyword">(</span>x11 <span class="keyword">=</span> x21 andalso x12 <span class="keyword">=</span> x22<span class="keyword">)</span> orelse <span class="keyword">(</span>x11 <span class="keyword">=</span> x22 andalso x12 <span class="keyword">=</span> x21<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>Div <span class="keyword">(</span>x11<span class="keyword">,</span> x12<span class="keyword">)</span><span class="keyword">,</span> Div <span class="keyword">(</span>x21<span class="keyword">,</span> x22<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>x11 <span class="keyword">=</span> x21<span class="keyword">)</span> andalso <span class="keyword">(</span>x12 <span class="keyword">=</span> x22<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#4347"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [eq_exp_exp]
</span>
<span class="keyword">fun</span> explst_remdup
  <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">var</span> <span class="keyword">!</span>p_clo <span class="keyword">=</span> @lam <span class="keyword">(</span><span class="prfexp">pf<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#21611"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#21611"><span class="stacstuse">unit_v</span></a></span></a></span></span> <span class="keyword">|</span> x1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14138"><span class="stacstuse">bool</span></a></span> <span class="keyword">=&lt;</span><span class="staexp">clo</span><span class="keyword">&gt;</span> <span class="keyword">~</span><span class="keyword">(</span>x <span class="keyword">=</span> x1<span class="keyword">)</span>
      <span class="keyword">prval</span> <span class="prfexp">pf <span class="keyword">=</span> unit_v <span class="keyword">(</span><span class="keyword">)</span></span>
      <span class="keyword">val</span> xs <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2flist_2esats.html#8194"><span class="dyncstuse">list_filter_clo&lt;</span></a><span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">&gt;</span> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#21611"><span class="stacstuse">unit_v</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> xs<span class="keyword">,</span> <span class="keyword">!</span>p_clo<span class="keyword">)</span>
      <span class="keyword">prval</span> <span class="prfexp">unit_v <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> pf</span>
      <span class="keyword">val</span> xs <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2flist_2esats.html#2665"><span class="dyncstuse">list_of_list_vt</span></a> <span class="keyword">(</span>xs<span class="keyword">)</span>
    <span class="keyword">in</span>
      list_cons <span class="keyword">(</span>x<span class="keyword">,</span> explst_remdup xs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [explst_remdup]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> eval_exp
  <span class="keyword">(</span>e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> e <span class="keyword">of</span>
  <span class="keyword">|</span> Num <span class="keyword">(</span>a<span class="keyword">)</span> <span class="keyword">=&gt;</span> a
  <span class="keyword">|</span> Add <span class="keyword">(</span>e1<span class="keyword">,</span> e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> eval_exp e1 + eval_exp e2
  <span class="keyword">|</span> Sub <span class="keyword">(</span>e1<span class="keyword">,</span> e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> eval_exp e1 - eval_exp e2  
  <span class="keyword">|</span> Mul <span class="keyword">(</span>e1<span class="keyword">,</span> e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> eval_exp e1 * eval_exp e2
  <span class="keyword">|</span> Div <span class="keyword">(</span>e1<span class="keyword">,</span> e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> eval_exp e1 / eval_exp e2
<span class="comment">// end of [eval_exp]
</span>
<span class="keyword">fun</span> priority_mac <span class="keyword">(</span>e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15881"><span class="stacstuse">Nat</span></a></span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> e <span class="keyword">of</span>
  <span class="keyword">|</span> Num _ <span class="keyword">=&gt;</span> 0 <span class="keyword">|</span> Add _ <span class="keyword">=&gt;</span> 2 <span class="keyword">|</span> Sub _ <span class="keyword">=&gt;</span> 2 <span class="keyword">|</span> Mul _ <span class="keyword">=&gt;</span> 1 <span class="keyword">|</span> Div _ <span class="keyword">=&gt;</span> 1
<span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15881"><span class="stacstuse">Nat</span></a></span> <span class="comment">// end of [priority]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> g_print_exp <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>gs<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#1944"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#1944"><span class="stacstuse">GString_ptr</span></a></span></a> l</span><span class="keyword">,</span> e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> e <span class="keyword">of</span>
  <span class="keyword">|</span> Num r <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#4274"><span class="dyncstuse">g_string_append_printf</span></a> <span class="keyword">(</span>gs<span class="keyword">,</span> "%.0f"<span class="keyword">,</span> <span class="keyword">@(</span>r<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> Add <span class="keyword">(</span>e1<span class="keyword">,</span> e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> p1 <span class="keyword">=</span> priority_mac e1 <span class="keyword">and</span> p2 <span class="keyword">=</span> priority_mac e2
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp_ <span class="keyword">(</span>gs<span class="keyword">,</span> 2<span class="keyword">,</span> p1<span class="keyword">,</span> e1<span class="keyword">)</span>
      <span class="keyword">val</span> _ <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#3658"><span class="dyncstuse">g_string_append_c</span></a> <span class="keyword">(</span>gs<span class="keyword">,</span> <span class="keyword">(</span>gchar<span class="keyword">)</span>'+'<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp_ <span class="keyword">(</span>gs<span class="keyword">,</span> 2<span class="keyword">,</span> p2<span class="keyword">,</span> e2<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">// end of [Add]
</span>  <span class="keyword">|</span> Sub <span class="keyword">(</span>e1<span class="keyword">,</span> e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> p1 <span class="keyword">=</span> priority_mac e1 <span class="keyword">and</span> p2 <span class="keyword">=</span> priority_mac e2
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp_ <span class="keyword">(</span>gs<span class="keyword">,</span> 2<span class="keyword">,</span> p1<span class="keyword">,</span> e1<span class="keyword">)</span>
      <span class="keyword">val</span> _ <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#3658"><span class="dyncstuse">g_string_append_c</span></a> <span class="keyword">(</span>gs<span class="keyword">,</span> <span class="keyword">(</span>gchar<span class="keyword">)</span>'-'<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp_ <span class="keyword">(</span>gs<span class="keyword">,</span> 2<span class="keyword">,</span> p2<span class="keyword">,</span> e2<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">// end of [Sub]
</span>  <span class="keyword">|</span> Mul <span class="keyword">(</span>e1<span class="keyword">,</span> e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> p1 <span class="keyword">=</span> priority_mac e1 <span class="keyword">and</span> p2 <span class="keyword">=</span> priority_mac e2
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp_ <span class="keyword">(</span>gs<span class="keyword">,</span> 1<span class="keyword">,</span> p1<span class="keyword">,</span> e1<span class="keyword">)</span>
      <span class="keyword">val</span> _ <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#3658"><span class="dyncstuse">g_string_append_c</span></a> <span class="keyword">(</span>gs<span class="keyword">,</span> <span class="keyword">(</span>gchar<span class="keyword">)</span>'*'<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp_ <span class="keyword">(</span>gs<span class="keyword">,</span> 1<span class="keyword">,</span> p2<span class="keyword">,</span> e2<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">// end of [Mul]
</span>  <span class="keyword">|</span> Div <span class="keyword">(</span>e1<span class="keyword">,</span> e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> p1 <span class="keyword">=</span> priority_mac e1 <span class="keyword">and</span> p2 <span class="keyword">=</span> priority_mac e2
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp_ <span class="keyword">(</span>gs<span class="keyword">,</span> 1<span class="keyword">,</span> p1<span class="keyword">,</span> e1<span class="keyword">)</span>
      <span class="keyword">val</span> _ <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#3658"><span class="dyncstuse">g_string_append_c</span></a> <span class="keyword">(</span>gs<span class="keyword">,</span> <span class="keyword">(</span>gchar<span class="keyword">)</span>'/'<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp_ <span class="keyword">(</span>gs<span class="keyword">,</span> 1<span class="keyword">,</span> p2<span class="keyword">,</span> e2<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">// end of [Div]
</span><span class="keyword">end</span> <span class="comment">// end of [print_exp]
</span>
<span class="keyword">and</span> g_print_exp_ <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>gs<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#1944"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#1944"><span class="stacstuse">GString_ptr</span></a></span></a> l</span><span class="keyword">,</span> p0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15881"><span class="stacstuse">Nat</span></a></span><span class="keyword">,</span> p<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15881"><span class="stacstuse">Nat</span></a></span><span class="keyword">,</span> e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">if</span> p <span class="keyword">&lt;</span> p0 <span class="keyword">then</span> g_print_exp <span class="keyword">(</span>gs<span class="keyword">,</span> e<span class="keyword">)</span> <span class="keyword">else</span> <span class="keyword">let</span>
    <span class="keyword">val</span> _ <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#3658"><span class="dyncstuse">g_string_append_c</span></a> <span class="keyword">(</span>gs<span class="keyword">,</span> <span class="keyword">(</span>gchar<span class="keyword">)</span>'\('<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp <span class="keyword">(</span>gs<span class="keyword">,</span> e<span class="keyword">)</span>
    <span class="keyword">val</span> _ <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#3658"><span class="dyncstuse">g_string_append_c</span></a> <span class="keyword">(</span>gs<span class="keyword">,</span> <span class="keyword">(</span>gchar<span class="keyword">)</span>')'<span class="keyword">)</span>
  <span class="keyword">in</span>
    <span class="comment">// nothing
</span>  <span class="keyword">end</span> <span class="comment">// end of [if]
</span><span class="comment">// end of [print_exp_]
</span>
<span class="keyword">fun</span> print_exp <span class="keyword">(</span>e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> gs <span class="keyword">=</span> g_string_new <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp <span class="keyword">(</span>gs<span class="keyword">,</span> e<span class="keyword">)</span>
  <span class="keyword">val</span> ptr <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#2120"><span class="dyncstuse">g_string_get_str</span></a> <span class="keyword">(</span>gs<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> print <span class="keyword">(</span>string<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
    <span class="keyword">val</span> string <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#4032"><span class="dyncstuse">__cast</span></a> <span class="keyword">(</span>ptr<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span> <span class="keyword">extern</span> <span class="keyword">castfn</span> <a name="4032"><span class="dyncstdec">__cast <span class="keyword">(</span>x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14906"><span class="stacstuse">ptr</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15085"><span class="stacstuse">string</span></a></span></span></a> <span class="keyword">}</span>
  <span class="keyword">}</span> <span class="comment">// end of [val]
</span><span class="keyword">in</span>
  <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#6569"><span class="dyncstuse">g_string_free_true</span></a> <span class="keyword">(</span>gs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [print_exp]
</span>  
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">typedef</span> <span class="staexp"><a name="4165"><span class="stacstdec">explst <span class="keyword">(</span>n<span class="keyword">:</span>int<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20342"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="keyword">#define</span> <span class="neuexp">EPSILON 0.000001</span>
<span class="keyword">fn</span> iseq
  <span class="keyword">(</span>a1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span><span class="keyword">,</span> a2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14138"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> abs <span class="keyword">(</span>a1 - a2<span class="keyword">)</span> <span class="keyword">&lt;</span> EPSILON
<span class="comment">// end of [isZero]
</span>
<span class="keyword">fn</span> explst_add_exp_exp <span class="keyword">(</span>
    ans<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span><span class="keyword">,</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">,</span> x1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">,</span> x2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span> <span class="keyword">=</span> res <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">var</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span> <span class="keyword">=</span> res
  <span class="keyword">val</span> a1 <span class="keyword">=</span> eval_exp x1 <span class="keyword">and</span> a2 <span class="keyword">=</span> eval_exp x2
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> iseq <span class="keyword">(</span>a1 + a2<span class="keyword">,</span> ans<span class="keyword">)</span> <span class="keyword">then</span> res := list_cons <span class="keyword">(</span>Add <span class="keyword">(</span>x1<span class="keyword">,</span> x2<span class="keyword">)</span><span class="keyword">,</span> res<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> iseq <span class="keyword">(</span>a1 - a2<span class="keyword">,</span> ans<span class="keyword">)</span> <span class="keyword">then</span> res := list_cons <span class="keyword">(</span>Sub <span class="keyword">(</span>x1<span class="keyword">,</span> x2<span class="keyword">)</span><span class="keyword">,</span> res<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> iseq <span class="keyword">(</span>a2 - a1<span class="keyword">,</span> ans<span class="keyword">)</span> <span class="keyword">then</span> res := list_cons <span class="keyword">(</span>Sub <span class="keyword">(</span>x2<span class="keyword">,</span> x1<span class="keyword">)</span><span class="keyword">,</span> res<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> iseq <span class="keyword">(</span>a1 * a2<span class="keyword">,</span> ans<span class="keyword">)</span> <span class="keyword">then</span> res := list_cons <span class="keyword">(</span>Mul <span class="keyword">(</span>x1<span class="keyword">,</span> x2<span class="keyword">)</span><span class="keyword">,</span> res<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> iseq <span class="keyword">(</span>a1 / a2<span class="keyword">,</span> ans<span class="keyword">)</span> <span class="keyword">then</span> res := list_cons <span class="keyword">(</span>Div <span class="keyword">(</span>x1<span class="keyword">,</span> x2<span class="keyword">)</span><span class="keyword">,</span> res<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> iseq <span class="keyword">(</span>a2 / a1<span class="keyword">,</span> ans<span class="keyword">)</span> <span class="keyword">then</span> res := list_cons <span class="keyword">(</span>Div <span class="keyword">(</span>x2<span class="keyword">,</span> x1<span class="keyword">)</span><span class="keyword">,</span> res<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [explst_add_exp_exp]
</span>
<span class="keyword">macdef</span> <span class="neuexp">list_revapp <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2flist_2esats.html#19941"><span class="dyncstuse">list_reverse_append</span></span></a>

<span class="keyword">fun</span> play <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>int <span class="keyword">|</span> n <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#7223"><span class="stacstuse">&gt;=</span></a> 2<span class="keyword">}</span></span> <span class="keyword">(</span>
    ans<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span><span class="keyword">,</span> n<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14493"><span class="stacstuse">int</span></a> n</span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#4165"><span class="stacstuse">explst</span></a> n</span><span class="keyword">,</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span> <span class="keyword">=</span>
  <span class="keyword">if</span> n <span class="keyword">&gt;</span> 2 <span class="keyword">then</span> <span class="keyword">let</span>
    <span class="keyword">fun</span> aux <span class="staexp"><span class="keyword">{</span>n1<span class="keyword">,</span>n3<span class="keyword">,</span>n4<span class="keyword">:</span>nat <span class="keyword">|</span> n1<a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n3<a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n4 <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#7435"><span class="stacstuse">==</span></a> n<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n3<a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n4<span class="keyword">,</span>n4<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>
        xs1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#4165"><span class="stacstuse">explst</span></a> n1</span>
      <span class="keyword">,</span> x2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">,</span> xs2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#4165"><span class="stacstuse">explst</span></a> <span class="keyword">(</span>n3<a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n4<span class="keyword">)</span></span>
      <span class="keyword">,</span> xs3<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#4165"><span class="stacstuse">explst</span></a> n3</span><span class="keyword">,</span> xs4<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#4165"><span class="stacstuse">explst</span></a> n4</span>
      <span class="keyword">,</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span>
      <span class="keyword">)</span> <span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span> <span class="keyword">=</span>
      <span class="keyword">case+</span> xs4 <span class="keyword">of</span>
      <span class="keyword">|</span> list_cons <span class="keyword">(</span>x4<span class="keyword">,</span> xs4<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> ys <span class="keyword">=</span> list_revapp <span class="keyword">(</span>xs3<span class="keyword">,</span> xs4<span class="keyword">)</span>
          <span class="keyword">val</span> ys <span class="keyword">=</span> list_revapp <span class="keyword">(</span>xs1<span class="keyword">,</span> ys<span class="keyword">)</span>
          <span class="keyword">val</span> ys1 <span class="keyword">=</span> list_cons <span class="keyword">(</span>Add <span class="keyword">(</span>x2<span class="keyword">,</span> x4<span class="keyword">)</span><span class="keyword">,</span> ys<span class="keyword">)</span>
          <span class="keyword">val</span> res <span class="keyword">=</span> play <span class="keyword">(</span>ans<span class="keyword">,</span> n-1<span class="keyword">,</span> ys1<span class="keyword">,</span> res<span class="keyword">)</span>
          <span class="keyword">val</span> ys1 <span class="keyword">=</span> list_cons <span class="keyword">(</span>Sub <span class="keyword">(</span>x2<span class="keyword">,</span> x4<span class="keyword">)</span><span class="keyword">,</span> ys<span class="keyword">)</span>
          <span class="keyword">val</span> res <span class="keyword">=</span> play <span class="keyword">(</span>ans<span class="keyword">,</span> n-1<span class="keyword">,</span> ys1<span class="keyword">,</span> res<span class="keyword">)</span>
          <span class="keyword">val</span> ys1 <span class="keyword">=</span> list_cons <span class="keyword">(</span>Sub <span class="keyword">(</span>x4<span class="keyword">,</span> x2<span class="keyword">)</span><span class="keyword">,</span> ys<span class="keyword">)</span>
          <span class="keyword">val</span> res <span class="keyword">=</span> play <span class="keyword">(</span>ans<span class="keyword">,</span> n-1<span class="keyword">,</span> ys1<span class="keyword">,</span> res<span class="keyword">)</span>
          <span class="keyword">val</span> ys1 <span class="keyword">=</span> list_cons <span class="keyword">(</span>Mul <span class="keyword">(</span>x2<span class="keyword">,</span> x4<span class="keyword">)</span><span class="keyword">,</span> ys<span class="keyword">)</span>
          <span class="keyword">val</span> res <span class="keyword">=</span> play <span class="keyword">(</span>ans<span class="keyword">,</span> n-1<span class="keyword">,</span> ys1<span class="keyword">,</span> res<span class="keyword">)</span>
          <span class="keyword">val</span> ys1 <span class="keyword">=</span> list_cons <span class="keyword">(</span>Div <span class="keyword">(</span>x2<span class="keyword">,</span> x4<span class="keyword">)</span><span class="keyword">,</span> ys<span class="keyword">)</span>
          <span class="keyword">val</span> res <span class="keyword">=</span> play <span class="keyword">(</span>ans<span class="keyword">,</span> n-1<span class="keyword">,</span> ys1<span class="keyword">,</span> res<span class="keyword">)</span>
          <span class="keyword">val</span> ys1 <span class="keyword">=</span> list_cons <span class="keyword">(</span>Div <span class="keyword">(</span>x4<span class="keyword">,</span> x2<span class="keyword">)</span><span class="keyword">,</span> ys<span class="keyword">)</span>
          <span class="keyword">val</span> res <span class="keyword">=</span> play <span class="keyword">(</span>ans<span class="keyword">,</span> n-1<span class="keyword">,</span> ys1<span class="keyword">,</span> res<span class="keyword">)</span>
        <span class="keyword">in</span>
          aux <span class="keyword">(</span>xs1<span class="keyword">,</span> x2<span class="keyword">,</span> xs2<span class="keyword">,</span> list_cons <span class="keyword">(</span>x4<span class="keyword">,</span> xs3<span class="keyword">)</span><span class="keyword">,</span> xs4<span class="keyword">,</span> res<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>      <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> xs2 <span class="keyword">of</span>
        <span class="keyword">|</span> list_cons <span class="keyword">(</span>x21<span class="keyword">,</span> xs21<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
            <span class="keyword">val</span> xs1 <span class="keyword">=</span> list_cons <span class="keyword">(</span>x2<span class="keyword">,</span> xs1<span class="keyword">)</span> <span class="keyword">in</span> aux <span class="keyword">(</span>xs1<span class="keyword">,</span> x21<span class="keyword">,</span> xs21<span class="keyword">,</span> list_nil<span class="keyword">,</span> xs21<span class="keyword">,</span> res<span class="keyword">)</span>
          <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>        <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> res
        <span class="keyword">end</span> <span class="comment">// end of [list_nil]
</span>    <span class="keyword">val+</span> list_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> xs
  <span class="keyword">in</span>
    aux <span class="keyword">(</span>list_nil<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">,</span> list_nil<span class="keyword">,</span> xs<span class="keyword">,</span> res<span class="keyword">)</span>
  <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">let</span> <span class="comment">// n = 2
</span>    <span class="keyword">val+</span> list_cons <span class="keyword">(</span>x1<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> xs
    <span class="keyword">val+</span> list_cons <span class="keyword">(</span>x2<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> xs
  <span class="keyword">in</span>
    explst_add_exp_exp <span class="keyword">(</span>ans<span class="keyword">,</span> res<span class="keyword">,</span> x1<span class="keyword">,</span> x2<span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">(* end of [if] *)</span>
<span class="comment">// end of [play]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">macdef</span> <span class="neuexp">gs <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgbasics_2esats.html#9569"><span class="dyncstuse">gstring_of_string</span></span></a>

<span class="comment">(* ****** ****** *)</span>

<span class="neuexp"><span class="keyword">overload</span> gint <span class="keyword">with</span> gint_of_GtkResponseType</span>

<span class="keyword">fun</span> answering
  <span class="staexp"><span class="keyword">{</span>c<span class="keyword">:</span>cls <span class="keyword">|</span> c <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#8412"><span class="stacstuse">&lt;=</span></a> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#3563"><span class="stacstuse">GtkWindow</span></a><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>parent<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a></span></a> <span class="keyword">(</span>c<span class="keyword">,</span> l<span class="keyword">)</span></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> dialog <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkdialog_2esats.html#3866"><span class="dyncstuse">gtk_dialog_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwindow_2esats.html#2830"><span class="dyncstuse">gtk_window_set_transient_for</span></a> <span class="keyword">(</span>dialog<span class="keyword">,</span> parent<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_win</span> <span class="keyword">|</span> win<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkdialog_2esats.html#4329"><span class="dyncstuse">gtk_dialog_get_window</span></a> <span class="keyword">(</span>dialog<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"Game-of-24 Answer Dialog"
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwindow_2esats.html#2106"><span class="dyncstuse">gtk_window_set_title</span></a> <span class="keyword">(</span>dialog<span class="keyword">,</span> x<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf_win</span><span class="keyword">,</span> <span class="prfexp">win</span> <span class="keyword">|</span> dialog<span class="keyword">)</span></span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"_Close"
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_button</span> <span class="keyword">|</span> button<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkdialog_2esats.html#5179"><span class="dyncstuse">gtk_dialog_add_button</span></a> <span class="keyword">(</span>dialog<span class="keyword">,</span> x<span class="keyword">,</span> <span class="keyword">(</span>GtkResponseType<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf_button</span><span class="keyword">,</span> <span class="prfexp">button</span> <span class="keyword">|</span> dialog<span class="keyword">)</span></span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_vbox0</span> <span class="keyword">|</span> vbox0<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkdialog_2esats.html#4629"><span class="dyncstuse">gtk_dialog_get_vbox</span></a> <span class="keyword">(</span>dialog<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> hbox1 <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkhbox_2esats.html#1510"><span class="dyncstuse">gtk_hbox_new</span></a> <span class="keyword">(</span>GFALSE<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> hbox1<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> guint<span class="keyword">(</span>10<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons _ <span class="keyword">=&gt;</span> <span class="keyword">let</span>
<span class="comment">//
</span>        <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"Solution(s) found:"
        <span class="keyword">val</span> frame <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkframe_2esats.html#1510"><span class="dyncstuse">gtk_frame_new</span></a> <span class="keyword">(</span>x<span class="keyword">)</span>
        <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>hbox1<span class="keyword">,</span> frame<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GFALSE<span class="keyword">,</span> guint<span class="keyword">(</span>10<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">[</span><span class="staexp">l_box<span class="keyword">:</span>addr</span><span class="keyword">]</span> vbox2 <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkvbox_2esats.html#1510"><span class="dyncstuse">gtk_vbox_new</span></a> <span class="keyword">(</span>GTRUE<span class="keyword">,</span> gint<span class="keyword">(</span>2<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkcontainer_2esats.html#1510"><span class="dyncstuse">gtk_container_add</span></a> <span class="keyword">(</span>frame<span class="keyword">,</span> vbox2<span class="keyword">)</span>
<span class="comment">//
</span>        <span class="keyword">val</span> <span class="keyword">[</span><span class="staexp">l_str<span class="keyword">:</span>addr</span><span class="keyword">]</span> gs  <span class="keyword">=</span> g_string_new <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> loop <span class="keyword">(</span>vbox2<span class="keyword">,</span> gs<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
         <span class="keyword">fun</span> loop <span class="keyword">(</span>
             vbox2<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a></span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#4460"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#4460"><span class="stacstuse">GtkVBox</span></a></span></a><span class="keyword">,</span> l_box<span class="keyword">)</span></span><span class="keyword">,</span> gs<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#1944"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#1944"><span class="stacstuse">GString_ptr</span></a></span></a> l_str</span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#648"><span class="stacstuse">exp</span></a></span>
           <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
           <span class="keyword">|</span> list_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
               <span class="keyword">val</span> _ptr <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#6255"><span class="dyncstuse">g_string_truncate</span></a> <span class="keyword">(</span>gs<span class="keyword">,</span> gsize<span class="keyword">(</span>0<span class="keyword">)</span><span class="keyword">)</span>
               <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> g_print_exp <span class="keyword">(</span>gs <span class="keyword">,</span> x<span class="keyword">)</span>
               <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#4274"><span class="dyncstuse">g_string_append_printf</span></a> <span class="keyword">(</span>gs<span class="keyword">,</span> " = 24"<span class="keyword">,</span> <span class="keyword">@(</span><span class="keyword">)</span><span class="keyword">)</span>
               <span class="keyword">val</span> ptr <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#2120"><span class="dyncstuse">g_string_get_str</span></a> <span class="keyword">(</span>gs<span class="keyword">)</span>
               <span class="keyword">extern</span> <span class="keyword">castfn</span> <a name="8486"><span class="dyncstdec">__cast <span class="keyword">(</span>x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14906"><span class="stacstuse">ptr</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>l<span class="keyword">:</span>agz<span class="keyword">]</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2450"><span class="stacstuse">gstring</span></a> l <span class="keyword">-&lt;</span>lin<span class="keyword">,</span>prf<span class="keyword">&gt;</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a> <span class="keyword">|</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2450"><span class="stacstuse">gstring</span></a> l<span class="keyword">)</span></span></span></a>
               <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#8486"><span class="dyncstuse">__cast</span></a> <span class="keyword">(</span>ptr<span class="keyword">)</span>
               <span class="keyword">val</span> label_msg <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtklabel_2esats.html#1510"><span class="dyncstuse">gtk_label_new</span></a> <span class="keyword">(</span>x<span class="keyword">)</span>
               <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
              <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox2<span class="keyword">,</span> label_msg<span class="keyword">,</span> GFALSE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> guint<span class="keyword">(</span>0<span class="keyword">)</span><span class="keyword">)</span>
              <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>label_msg<span class="keyword">)</span>
            <span class="keyword">in</span>
              loop <span class="keyword">(</span>vbox2<span class="keyword">,</span> gs<span class="keyword">,</span> xs<span class="keyword">)</span>
            <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>          <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">}</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgstring_2esats.html#6569"><span class="dyncstuse">g_string_free_true</span></a> <span class="keyword">(</span>gs<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>vbox2<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>frame<span class="keyword">)</span>
      <span class="keyword">in</span>
        <span class="comment">// nothing
</span>      <span class="keyword">end</span> <span class="comment">// end of [if]
</span>    <span class="keyword">|</span> list_nil _ <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"No solution found!"
        <span class="keyword">val</span> label_ans <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtklabel_2esats.html#1510"><span class="dyncstuse">gtk_label_new</span></a> <span class="keyword">(</span>x<span class="keyword">)</span>
        <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>hbox1<span class="keyword">,</span> label_ans<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GFALSE<span class="keyword">,</span> guint<span class="keyword">(</span>10<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>label_ans<span class="keyword">)</span>
      <span class="keyword">in</span>
        <span class="comment">// nothing
</span>      <span class="keyword">end</span> <span class="comment">// end of [if]
</span>  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>hbox1<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf_vbox0</span><span class="keyword">,</span> <span class="prfexp">vbox0</span> <span class="keyword">|</span> dialog<span class="keyword">)</span></span>
  <span class="comment">// val () = gtk_widget_show (dialog) // this is automatically done
</span><span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">while</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#4303"><span class="dyncstuse">true</span></a><span class="keyword">)</span> <span class="keyword">let</span>
    <span class="keyword">val</span> response <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkdialog_2esats.html#5602"><span class="dyncstuse">gtk_dialog_run</span></a> <span class="keyword">(</span>dialog<span class="keyword">)</span>
    <span class="comment">// val () = (print "response = "; print ((int_of)response); print_newline ())
</span>  <span class="keyword">in</span>
    <span class="keyword">case+</span> 0 <span class="keyword">of</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> response <span class="keyword">=</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0 <span class="keyword">=&gt;</span> <span class="keyword">break</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> response <span class="keyword">=</span> <span class="keyword">(</span>gint<span class="keyword">)</span>GTK_RESPONSE_DELETE_EVENT <span class="keyword">=&gt;</span> <span class="keyword">break</span>
    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [val]
</span><span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#2382"><span class="dyncstuse">gtk_widget_destroy</span></a> <span class="keyword">(</span>dialog<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [answering]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> play24
  <span class="staexp"><span class="keyword">{</span>c<span class="keyword">:</span>cls <span class="keyword">|</span> c <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#8412"><span class="stacstuse">&lt;=</span></a> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#3563"><span class="stacstuse">GtkWindow</span></a><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span>
  <span class="keyword">(</span>parent<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a></span></a> <span class="keyword">(</span>c<span class="keyword">,</span> l<span class="keyword">)</span></span><span class="keyword">,</span> ns<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#21105"><span class="stacstuse">list_vt</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> xs <span class="keyword">=</span> loop <span class="keyword">(</span>ns<span class="keyword">,</span> list_nil<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
    <span class="keyword">fun</span> loop <span class="staexp"><span class="keyword">{</span>i<span class="keyword">,</span>j<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>i<span class="keyword">&gt;.</span></span>
      <span class="keyword">(</span>ns<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#21105"><span class="stacstuse">list_vt</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a><span class="keyword">,</span> i<span class="keyword">)</span></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#4165"><span class="stacstuse">explst</span></a> j</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#4165"><span class="stacstuse">explst</span></a> <span class="keyword">(</span>i<a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>j<span class="keyword">)</span></span> <span class="keyword">=</span>
      <span class="keyword">case+</span> ns <span class="keyword">of</span>
      <span class="keyword">|</span> <span class="keyword">~</span>list_vt_cons <span class="keyword">(</span>n<span class="keyword">,</span> ns<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> x <span class="keyword">=</span> Num <span class="keyword">(</span>double_of<span class="keyword">(</span>n<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">in</span> loop <span class="keyword">(</span>ns<span class="keyword">,</span> list_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [list_vt_cons]
</span>      <span class="keyword">|</span> <span class="keyword">~</span>list_vt_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> xs
    <span class="comment">// end of [loop]
</span>  <span class="keyword">}</span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> n <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2flist_2esats.html#17469"><span class="dyncstuse">list_length</span></a> <span class="keyword">(</span>xs<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> assert_errmsg <span class="keyword">(</span>n &gt;= 2<span class="keyword">,</span> <span class="keyword">#LOCATION</span><span class="keyword">)</span>
  <span class="keyword">val</span> ans <span class="keyword">=</span> 24.0
  <span class="keyword">val</span> res <span class="keyword">=</span> play <span class="keyword">(</span>ans<span class="keyword">,</span> n<span class="keyword">,</span> xs<span class="keyword">,</span> list_nil<span class="keyword">)</span>
  <span class="keyword">val</span> res <span class="keyword">=</span> explst_remdup <span class="keyword">(</span>res<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> answering <span class="keyword">(</span>parent<span class="keyword">,</span> res<span class="keyword">)</span>
<span class="comment">(*
  val () = loop (res) where {
    fun loop (xs: List exp): void =
      case+ xs of
      | list_cons (x, xs) =&gt; loop (xs) where {
          val () = (print_exp x; print " = "; print 24; print_newline ())
        } // end of [list_cons]
      | list_nil () =&gt; ()
    // end of [loop]
  } // end of [val]
*)</span>
<span class="keyword">in</span>
  <span class="comment">// nothing
</span><span class="keyword">end</span> <span class="comment">// end of [play24]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> suit_spinner_gen
  <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#10577"><span class="stacstuse">GtkSpinButton_ref1</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> adj <span class="keyword">=</span> gtk_adjustment_new
    <span class="keyword">(</span>1.0<span class="keyword">,</span> 1.0<span class="keyword">,</span> 13.0<span class="keyword">,</span> 1.0<span class="keyword">,</span> 0.0<span class="comment">(*ignored*)</span><span class="keyword">,</span> 0.0<span class="comment">(*ignored*)</span><span class="keyword">)</span>
  <span class="keyword">val</span> spinner <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkspinbutton_2esats.html#2364"><span class="dyncstuse">gtk_spin_button_new</span></a> <span class="keyword">(</span>adj<span class="keyword">,</span> <span class="keyword">(</span>gdouble<span class="keyword">)</span>0.0<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkspinbutton_2esats.html#4555"><span class="dyncstuse">gtk_spin_button_set_numeric</span></a> <span class="keyword">(</span>spinner<span class="keyword">,</span> GTRUE<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkspinbutton_2esats.html#4964"><span class="dyncstuse">gtk_spin_button_set_wrap</span></a> <span class="keyword">(</span>spinner<span class="keyword">,</span> GTRUE<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgobject_2esats.html#1980"><span class="dyncstuse">g_object_unref</span></a> <span class="keyword">(</span>adj<span class="keyword">)</span>
<span class="keyword">in</span>
  spinner
<span class="keyword">end</span> <span class="comment">// end of [suit_spinner_gen]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">viewtypedef</span>
<span class="staexp"><a name="11543"><span class="stacstdec">suitSpinnerLst <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#21155"><span class="stacstuse">List_vt</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#10577"><span class="stacstuse">GtkSpinButton_ref1</span></a><span class="keyword">)</span></span></a></span>

<span class="keyword">val</span> theSuitSpinnerLst <span class="keyword">=</span>
  <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2freference_2esats.html#2028"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#11543"><span class="stacstuse">suitSpinnerLst</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>list_vt_nil<span class="keyword">)</span>
<span class="comment">// end of [val]
</span>
<span class="keyword">fun</span> theSuitSpinnerLst_add
  <span class="keyword">(</span>x<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#10577"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#10577"><span class="stacstuse">GtkSpinButton_ref1</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">vbox pf_xs</span> <span class="keyword">|</span> p_xs<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2freference_2esats.html#3033"><span class="dyncstuse">ref_get_view_ptr</span></a> <span class="keyword">(</span>theSuitSpinnerLst<span class="keyword">)</span>
  <span class="keyword">val</span> x1 <span class="keyword">=</span> <span class="keyword">$effmask_ref</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgobject_2esats.html#1839"><span class="dyncstuse">g_object_ref</span></a> <span class="keyword">(</span>x<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">!</span>p_xs := list_vt_cons <span class="keyword">(</span>x1<span class="keyword">,</span> <span class="keyword">!</span>p_xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [theSuitSpinnerLst_add]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> inputapp <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">fun</span> loop <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#11543"><span class="stacstuse"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#11543"><span class="stacstuse">suitSpinnerLst</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> list_vt_cons <span class="keyword">(</span><span class="keyword">!</span>p_x<span class="keyword">,</span> <span class="keyword">!</span>p_xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">var</span> min<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2380"><span class="stacstuse">gdouble</span></a></span> <span class="keyword">and</span> max<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2380"><span class="stacstuse">gdouble</span></a></span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkspinbutton_2esats.html#2886"><span class="dyncstuse">gtk_spin_button_get_range</span></a> <span class="keyword">(</span><span class="keyword">!</span>p_x<span class="keyword">,</span> min<span class="keyword">,</span> max<span class="keyword">)</span>
        <span class="keyword">val</span> max <span class="keyword">=</span> double_of<span class="keyword">(</span>max<span class="keyword">)</span> <span class="keyword">and</span> min <span class="keyword">=</span> double_of<span class="keyword">(</span>min<span class="keyword">)</span>
        <span class="keyword">val</span> v <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2fmath_2esats.html#2103"><span class="dyncstuse">$MATH<span class="keyword">.</span>floor</span></a> <span class="keyword">(</span>min + <span class="keyword">(</span>max + 1 - min<span class="keyword">)</span> * <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2frandom_2esats.html#2104"><span class="dyncstuse">$RAND<span class="keyword">.</span>drand48</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">val</span> v <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkspinbutton_2esats.html#3741"><span class="dyncstuse">gtk_spin_button_set_value</span></a> <span class="keyword">(</span><span class="keyword">!</span>p_x<span class="keyword">,</span> <span class="keyword">(</span>gdouble<span class="keyword">)</span>v<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> loop <span class="keyword">(</span><span class="keyword">!</span>p_xs<span class="keyword">)</span>
        <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fold@ <span class="keyword">(</span>xs<span class="keyword">)</span></span>
      <span class="keyword">in</span>
        <span class="comment">// nothing
</span>      <span class="keyword">end</span> <span class="comment">// end of [list_vt_cons]
</span>    <span class="keyword">|</span> list_vt_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>fold@ xs<span class="keyword">)</span>
  <span class="comment">// end of [loop]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">$effmask_ref</span> <span class="keyword">(</span>loop <span class="keyword">(</span><span class="keyword">!</span>p_xs<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">vbox pf_xs</span> <span class="keyword">|</span> p_xs<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2freference_2esats.html#3033"><span class="dyncstuse">ref_get_view_ptr</span></a> <span class="keyword">(</span>theSuitSpinnerLst<span class="keyword">)</span>
  <span class="keyword">}</span>
<span class="keyword">}</span> <span class="comment">// end of [inputapp]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> evalapp
  <span class="staexp"><span class="keyword">{</span>c<span class="keyword">:</span>cls <span class="keyword">|</span> c <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#8412"><span class="stacstuse">&lt;=</span></a> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#3563"><span class="stacstuse">GtkWindow</span></a><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>parent<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a></span></a> <span class="keyword">(</span>c<span class="keyword">,</span> l<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> loop <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#11543"><span class="stacstuse"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#11543"><span class="stacstuse">suitSpinnerLst</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#21155"><span class="stacstuse">List_vt</span></a> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> list_vt_cons <span class="keyword">(</span><span class="keyword">!</span>p_x<span class="keyword">,</span> <span class="keyword">!</span>p_xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> v <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkspinbutton_2esats.html#3539"><span class="dyncstuse">gtk_spin_button_get_value_as_int</span></a> <span class="keyword">(</span><span class="keyword">!</span>p_x<span class="keyword">)</span>
        <span class="keyword">val</span> v <span class="keyword">=</span> int_of<span class="keyword">(</span>v<span class="keyword">)</span>
        <span class="keyword">val</span> vs <span class="keyword">=</span> loop <span class="keyword">(</span><span class="keyword">!</span>p_xs<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fold@ <span class="keyword">(</span>xs<span class="keyword">)</span>
      <span class="keyword">in</span>
        list_vt_cons <span class="keyword">(</span>v<span class="keyword">,</span> vs<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [list_vt_cons]
</span>    <span class="keyword">|</span> list_vt_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>fold@ xs<span class="keyword">;</span> list_vt_nil<span class="keyword">)</span>
  <span class="comment">// end of [loop]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">vbox pf_xs</span> <span class="keyword">|</span> p_xs<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2freference_2esats.html#3033"><span class="dyncstuse">ref_get_view_ptr</span></a> <span class="keyword">(</span>theSuitSpinnerLst<span class="keyword">)</span>
  <span class="keyword">val</span> vs <span class="keyword">=</span> <span class="keyword">$effmask_ref</span> <span class="keyword">(</span>loop <span class="keyword">(</span><span class="keyword">!</span>p_xs<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">$effmask_ref</span> <span class="keyword">(</span>play24 <span class="keyword">(</span>parent<span class="keyword">,</span> vs<span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="comment">// nothing
</span><span class="keyword">end</span> <span class="comment">// end of [evalapp]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">PRINTF <span class="keyword">=</span> "libc/SATS/printf.sats"</span>

<span class="keyword">fun</span> suit_spinnerlst_hbox_gen
  <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="keyword">(</span>n<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14493"><span class="stacstuse">int</span></a> n</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#6731"><span class="stacstuse">GtkHBox_ref1</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> hbox <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkhbox_2esats.html#1510"><span class="dyncstuse">gtk_hbox_new</span></a> <span class="keyword">(</span>GTRUE<span class="comment">(*homo*)</span><span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>10<span class="comment">(*spacing*)</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> loop <span class="keyword">(</span>hbox<span class="keyword">,</span> n<span class="keyword">,</span> 1<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
    <span class="keyword">fun</span> loop
      <span class="staexp"><span class="keyword">{</span>c<span class="keyword">:</span>cls <span class="keyword">|</span> c <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#8412"><span class="stacstuse">&lt;=</span></a> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#4253"><span class="stacstuse">GtkBox</span></a><span class="keyword">}</span></span>
      <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>
        box<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a></span></a> <span class="keyword">(</span>c<span class="keyword">,</span> l<span class="keyword">)</span></span><span class="keyword">,</span> n<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14493"><span class="stacstuse">int</span></a> n</span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span>
      <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
      <span class="keyword">if</span> n <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <span class="keyword">let</span>
        <span class="keyword">val</span> vbox <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkvbox_2esats.html#1510"><span class="dyncstuse">gtk_vbox_new</span></a> <span class="keyword">(</span>GFALSE<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>box<span class="keyword">,</span> vbox<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>20<span class="keyword">)</span>
        <span class="keyword">val</span> name <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgbasics_2esats.html#10385"><span class="dyncstuse">g_strdup_printf</span></a> <span class="keyword">(</span>"Card %d:"<span class="keyword">,</span> <span class="keyword">@(</span>i<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">val</span> label <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtklabel_2esats.html#1510"><span class="dyncstuse">gtk_label_new</span></a> <span class="keyword">(</span>name<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgmem_2esats.html#1963"><span class="dyncstuse">gstring_free</span></a> <span class="keyword">(</span>name<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox<span class="keyword">,</span> label<span class="keyword">,</span> GFALSE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>2<span class="keyword">)</span>
        <span class="keyword">val</span> spinner <span class="keyword">=</span> suit_spinner_gen <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> theSuitSpinnerLst_add <span class="keyword">(</span>spinner<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox<span class="keyword">,</span> spinner<span class="keyword">,</span> GFALSE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>2<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>label<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>spinner<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>vbox<span class="keyword">)</span>
      <span class="keyword">in</span>
        loop <span class="keyword">(</span>box<span class="keyword">,</span> n-1<span class="keyword">,</span> i+1<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [if]
</span>    <span class="comment">// end of [loop]
</span>  <span class="keyword">}</span> <span class="comment">// end of [val]
</span><span class="keyword">in</span>
  hbox
<span class="keyword">end</span> <span class="comment">// end of [suit_spinnerlst_hbox_gen]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> quitapp
  <span class="staexp"><span class="keyword">{</span>c<span class="keyword">:</span>cls <span class="keyword">|</span> c <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#8412"><span class="stacstuse">&lt;=</span></a> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#1995"><span class="stacstuse">GtkWidget</span></a><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>widget<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a></span></a> <span class="keyword">(</span>c<span class="keyword">,</span> l<span class="keyword">)</span></span><span class="keyword">,</span> event<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgdk_2fgdkevents_2esats.html#7291"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgdk_2fgdkevents_2esats.html#7291"><span class="stacstuse">GdkEvent</span></a></span></a></span><span class="keyword">,</span> _<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2414"><span class="stacstuse">gpointer</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2151"><span class="stacstuse">gboolean</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkmain_2esats.html#1611"><span class="dyncstuse">gtk_main_quit</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">in</span>
  GFALSE <span class="comment">// delivered!
</span><span class="keyword">end</span> <span class="comment">// end of [quitapp]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{^
extern
ats_void_type
mainats (ats_int_type argc, ats_ptr_type argv) ;
%}</span> <span class="comment">// end of [%{^]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">extern</span> <span class="keyword">fun</span> <a name="14942"><span class="dyncstdec">main1 <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span></span></a> <span class="keyword">=</span> "main1"

<span class="keyword">implement</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fGameOf24_2edats.html#14942"><span class="dyncstimp">main1</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2frandom_2esats.html#1793"><span class="dyncstuse">$RAND<span class="keyword">.</span>srand48_with_time</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> window <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwindow_2esats.html#1688"><span class="dyncstuse">gtk_window_new</span></a> <span class="keyword">(</span>GTK_WINDOW_TOPLEVEL<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_window</span> <span class="keyword">|</span> window_<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2770"><span class="dyncstuse">g_object_vref</span></a> <span class="keyword">(</span>window<span class="keyword">)</span>
  <span class="keyword">val</span> _sig <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1933"><span class="dyncstuse">g_signal_connect0</span></a>
    <span class="keyword">(</span>window_<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"destroy"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a><span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#2382"><span class="dyncstuse">gtk_widget_destroy</span></a><span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
  <span class="keyword">val</span> _sig <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#2245"><span class="dyncstuse">g_signal_connect1</span></a>
    <span class="keyword">(</span>window<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"delete_event"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a><span class="keyword">(</span>quitapp<span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"Game-of-24"
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwindow_2esats.html#2106"><span class="dyncstuse">gtk_window_set_title</span></a> <span class="keyword">(</span>window<span class="keyword">,</span> x<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
<span class="comment">//
</span>  <span class="keyword">val</span> vbox0 <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkvbox_2esats.html#1510"><span class="dyncstuse">gtk_vbox_new</span></a> <span class="keyword">(</span>GFALSE<span class="comment">(*homo*)</span><span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"Game-of-24"
  <span class="keyword">val</span> label_title <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtklabel_2esats.html#1510"><span class="dyncstuse">gtk_label_new</span></a> <span class="keyword">(</span>x<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> label_title<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>10<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>label_title<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> hsep <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkhseparator_2esats.html#1510"><span class="dyncstuse">gtk_hseparator_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> hsep<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>hsep<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> hbox_suits <span class="keyword">=</span> suit_spinnerlst_hbox_gen <span class="keyword">(</span>4<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> hbox_suits<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>10<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>hbox_suits<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> hsep <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkhseparator_2esats.html#1510"><span class="dyncstuse">gtk_hseparator_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> hsep<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>hsep<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> hbox <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkhbox_2esats.html#1510"><span class="dyncstuse">gtk_hbox_new</span></a> <span class="keyword">(</span>GFALSE<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> hbox<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>10<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span> <span class="comment">// adding the [input] button
</span>    <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"Random Input"
    <span class="keyword">val</span> button <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbutton_2esats.html#1606"><span class="dyncstuse">gtk_button_new_with_label</span></a> <span class="keyword">(</span>x<span class="keyword">)</span>
    <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
    <span class="keyword">val</span> _sid <span class="keyword">=</span> g_signal_connect
      <span class="keyword">(</span>button<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"clicked"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a><span class="keyword">(</span>inputapp<span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>hbox<span class="keyword">,</span> button<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>10<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>button<span class="keyword">)</span>
  <span class="keyword">}</span> <span class="comment">// end of [val]
</span><span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span> <span class="comment">// adding the [eval] button
</span>    <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"Eval"
    <span class="keyword">val</span> button <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbutton_2esats.html#1606"><span class="dyncstuse">gtk_button_new_with_label</span></a> <span class="keyword">(</span>x<span class="keyword">)</span>
    <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
    <span class="keyword">val</span> _sid <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#3618"><span class="dyncstuse">g_signal_connect_swapped1</span></a>
      <span class="keyword">(</span>button<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"clicked"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a><span class="keyword">(</span>evalapp<span class="keyword">)</span><span class="keyword">,</span> window<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>hbox<span class="keyword">,</span> button<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>10<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>button<span class="keyword">)</span>
  <span class="keyword">}</span> <span class="comment">// end of [val]
</span><span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>hbox<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> hsep <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkhseparator_2esats.html#1510"><span class="dyncstuse">gtk_hseparator_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> hsep<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>hsep<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> hbox <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkhbox_2esats.html#1510"><span class="dyncstuse">gtk_hbox_new</span></a> <span class="keyword">(</span>GFALSE<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"_Quit"
  <span class="keyword">val</span> button <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbutton_2esats.html#1762"><span class="dyncstuse">gtk_button_new_with_mnemonic</span></a> <span class="keyword">(</span>x<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
  <span class="keyword">val</span> _sid <span class="keyword">=</span> g_signal_connect_swapped
    <span class="keyword">(</span>button<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"clicked"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a><span class="keyword">(</span>quitapp<span class="keyword">)</span><span class="keyword">,</span> window<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>hbox<span class="keyword">,</span> button<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>10<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>button<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> hbox<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>10<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>hbox<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkcontainer_2esats.html#1510"><span class="dyncstuse">gtk_container_add</span></a> <span class="keyword">(</span>window<span class="keyword">,</span> vbox0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3291"><span class="dyncstuse">gtk_widget_show_unref</span></a> <span class="keyword">(</span>vbox0<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3061"><span class="dyncstuse">gtk_widget_show</span></a> <span class="keyword">(</span>window<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_window <span class="keyword">(</span>window<span class="keyword">)</span></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkmain_2esats.html#1510"><span class="dyncstuse">gtk_main</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [main1]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#6301"><span class="dyncstimp">main_dummy</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{$
ats_void_type
mainats (
  ats_int_type argc, ats_ptr_type argv
) {
  gtk_init ((int*)&amp;argc, (char***)&amp;argv) ; main1 () ; return ;
} // end of [mainats]
%}</span> <span class="comment">// end of [%{$]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [GameOf24.dats] *)</span>
</pre>
</body>
</html>
