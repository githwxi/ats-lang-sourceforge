<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">//
</span><span class="comment">//
</span><span class="comment">// Implementing Kolmogorov's translation on propositional logic
</span><span class="comment">//
</span><span class="comment">//
</span>
<span class="comment">// February 2005: It is completed by Sa Cui and Hongwei Xi
</span><span class="comment">// January 2007: It is ported to ATS/Geizella by Hongwei Xi
</span>
<span class="comment">// March 5th, 2008:
</span><span class="comment">// It is verified by ATS/Anairiats (without any changes being made).
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">// Infix operators
</span>
<span class="neuexp"><span class="keyword">infixl</span> land</span> <span class="comment">// left associative
</span><span class="neuexp"><span class="keyword">infixl</span> lor</span> <span class="comment">// left associative
</span><span class="neuexp"><span class="keyword">infixr</span> limp</span> <span class="comment">// right associative
</span>
<span class="comment">// Types for formulas 
</span>
<span class="keyword">datasort</span> <span class="staexp">form <span class="keyword">=</span>
  <span class="keyword">|</span> ltrue
  <span class="keyword">|</span> lfalse
  <span class="keyword">|</span> lnot <span class="keyword">of</span> form
  <span class="keyword">|</span> land <span class="keyword">of</span> <span class="keyword">(</span>form<span class="keyword">,</span> form<span class="keyword">)</span>
  <span class="keyword">|</span> lor <span class="keyword">of</span> <span class="keyword">(</span>form<span class="keyword">,</span> form<span class="keyword">)</span>
  <span class="keyword">|</span> limp <span class="keyword">of</span> <span class="keyword">(</span>form<span class="keyword">,</span> form<span class="keyword">)</span></span>

<span class="comment">// Types for contexts
</span>
<span class="keyword">datasort</span> <span class="staexp">forms <span class="keyword">=</span> nil <span class="keyword">|</span> :: <span class="keyword">of</span> <span class="keyword">(</span>form<span class="keyword">,</span> forms<span class="keyword">)</span></span>

<span class="comment">// [IN (A, G)] : The formula A is in the context G
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="706"><span class="stacstdec">IN <span class="keyword">(</span>form<span class="keyword">,</span> forms<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> INone <span class="staexp"><span class="keyword">(</span>A<span class="keyword">,</span> A :: G<span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> INshi <span class="staexp"><span class="keyword">(</span>A<span class="keyword">,</span> B :: G<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">IN <span class="keyword">(</span>A<span class="keyword">,</span> G<span class="keyword">)</span></span></span>

<span class="comment">// Double negation
</span>
<span class="keyword">stadef</span> <span class="staexp"><a name="850"><span class="stacstdec">dneg <span class="keyword">(</span>f<span class="keyword">:</span> form<span class="keyword">)</span><span class="keyword">:</span> form <span class="keyword">=</span> lnot <span class="keyword">(</span>lnot f<span class="keyword">)</span></span></a></span>

<span class="comment">// KOLM (A, A'): Kolmogrov's translation
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="939"><span class="stacstdec">KOLM <span class="keyword">(</span>form<span class="keyword">,</span> form<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> KOLMfalse <span class="staexp"><span class="keyword">(</span>lfalse<span class="keyword">,</span> dneg <span class="keyword">(</span>lfalse<span class="keyword">)</span><span class="keyword">,</span> 0<span class="keyword">)</span></span>

  <span class="keyword">|</span> KOLMtrue <span class="staexp"><span class="keyword">(</span>ltrue<span class="keyword">,</span> dneg <span class="keyword">(</span>ltrue<span class="keyword">)</span><span class="keyword">,</span> 0<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>A'<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      KOLMnot <span class="staexp"><span class="keyword">(</span>lnot A<span class="keyword">,</span> dneg <span class="keyword">(</span>lnot <span class="keyword">(</span>dneg A'<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">KOLM <span class="keyword">(</span>A<span class="keyword">,</span> dneg A'<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>A'<span class="keyword">,</span>B<span class="keyword">,</span>B'<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      KOLMand <span class="staexp"><span class="keyword">(</span>A land B<span class="keyword">,</span> dneg <span class="keyword">(</span><span class="keyword">(</span>dneg A'<span class="keyword">)</span> land <span class="keyword">(</span>dneg B'<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">,</span> n1+n2+1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span>KOLM <span class="keyword">(</span>A<span class="keyword">,</span> dneg A'<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> KOLM <span class="keyword">(</span>B<span class="keyword">,</span> dneg B'<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>A'<span class="keyword">,</span>B<span class="keyword">,</span>B'<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      KOLMor <span class="staexp"><span class="keyword">(</span>A lor B<span class="keyword">,</span> dneg <span class="keyword">(</span><span class="keyword">(</span>dneg A'<span class="keyword">)</span> lor <span class="keyword">(</span>dneg B'<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">,</span> n1+n2+1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span>KOLM <span class="keyword">(</span>A<span class="keyword">,</span> dneg A'<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> KOLM <span class="keyword">(</span>B<span class="keyword">,</span> dneg B'<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>A'<span class="keyword">,</span>B<span class="keyword">,</span>B'<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      KOLMimp <span class="staexp"><span class="keyword">(</span>A limp B<span class="keyword">,</span> dneg <span class="keyword">(</span><span class="keyword">(</span>dneg A'<span class="keyword">)</span> limp <span class="keyword">(</span>dneg B'<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">,</span> n1+n2+1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span>KOLM <span class="keyword">(</span>A<span class="keyword">,</span> dneg A'<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> KOLM <span class="keyword">(</span>B<span class="keyword">,</span> dneg B'<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="1627"><span class="stacstdec">KOLM0 <span class="keyword">(</span>A<span class="keyword">:</span>form<span class="keyword">,</span> A'<span class="keyword">:</span>form<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> KOLM <span class="keyword">(</span>A<span class="keyword">,</span> A'<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1687"><span class="stacstdec">FMEQ <span class="keyword">(</span>form<span class="keyword">,</span> form<span class="keyword">)</span></span></a></span> <span class="keyword">=</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> FMEQ <span class="staexp"><span class="keyword">(</span>A<span class="keyword">,</span> A<span class="keyword">)</span></span></span>

<span class="keyword">prfun</span> <span class="prfexp">fmeq <span class="staexp"><span class="keyword">{</span>A<span class="keyword">,</span>A'<span class="keyword">,</span>A''<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n1<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>pf1<span class="keyword">:</span> <span class="staexp">KOLM <span class="keyword">(</span>A<span class="keyword">,</span> A'<span class="keyword">,</span> n1<span class="keyword">)</span></span><span class="keyword">,</span> pf2<span class="keyword">:</span> <span class="staexp">KOLM <span class="keyword">(</span>A<span class="keyword">,</span> A''<span class="keyword">,</span> n2<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp">FMEQ <span class="keyword">(</span>A'<span class="keyword">,</span> A''<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> <span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>KOLMfalse <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> KOLMfalse <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> FMEQ

  <span class="keyword">|</span> <span class="keyword">(</span>KOLMtrue <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> KOLMtrue <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> FMEQ

  <span class="keyword">|</span> <span class="keyword">(</span>KOLMnot pf11<span class="keyword">,</span> KOLMnot pf21<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span> 
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>pf11<span class="keyword">,</span> pf21<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      FMEQ <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> <span class="keyword">(</span>KOLMand <span class="keyword">(</span>pf11<span class="keyword">,</span> pf12<span class="keyword">)</span><span class="keyword">,</span> KOLMand <span class="keyword">(</span>pf21<span class="keyword">,</span> pf22<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>pf11<span class="keyword">,</span> pf21<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>pf12<span class="keyword">,</span> pf22<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      FMEQ <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> <span class="keyword">(</span>KOLMor <span class="keyword">(</span>pf11<span class="keyword">,</span> pf12<span class="keyword">)</span><span class="keyword">,</span> KOLMor <span class="keyword">(</span>pf21<span class="keyword">,</span> pf22<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>pf11<span class="keyword">,</span> pf21<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>pf12<span class="keyword">,</span> pf22<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      FMEQ <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> <span class="keyword">(</span>KOLMimp <span class="keyword">(</span>pf11<span class="keyword">,</span> pf12<span class="keyword">)</span><span class="keyword">,</span> KOLMimp <span class="keyword">(</span>pf21<span class="keyword">,</span> pf22<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>pf11<span class="keyword">,</span> pf21<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>pf12<span class="keyword">,</span> pf22<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      FMEQ <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span></span> <span class="comment">// end of [fmeq]
</span>
<span class="comment">(*

prfun KOLMfun {A:form}: [A':form] KOLM (A, A') =
  scase A of
    | lfalse =&gt; dneg (A)
    | ltrue =&gt; dneg (A)
    | lnot A =&gt; ...
    | land of (form, form)
    | lor of (form, form)
    | limp of (form, form)

*)</span>

<span class="comment">// Existence of Kolmogorov's translation 
</span><span class="comment">// Given a formula A, there exists A', such that KOLM (A, A')
</span>
<span class="keyword">extern</span> <span class="keyword">prval</span> <a name="2920"><span class="dyncstdec"><span class="prfexp">KOLMfun <span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span><span class="keyword">[</span>A'<span class="keyword">:</span>form<span class="keyword">]</span> KOLM0 <span class="keyword">(</span>A<span class="keyword">,</span> dneg A'<span class="keyword">)</span></span></span></span></a>

<span class="comment">// Kolmogrov's translation on contexts
</span>  
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="3019"><span class="stacstdec">KOLMS <span class="keyword">(</span>forms<span class="keyword">,</span> forms<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> KOLMSnil <span class="staexp"><span class="keyword">(</span>nil<span class="keyword">,</span> nil<span class="keyword">,</span> 0<span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">,</span>G'<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>A'<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      KOLMScons <span class="staexp"><span class="keyword">(</span>A :: G<span class="keyword">,</span> dneg A' :: G'<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span>KOLM0 <span class="keyword">(</span>A<span class="keyword">,</span> dneg A'<span class="keyword">)</span><span class="keyword">,</span> KOLMS <span class="keyword">(</span>G<span class="keyword">,</span> G'<span class="keyword">,</span>n<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="3206"><span class="stacstdec">KOLMS0 <span class="keyword">(</span>G<span class="keyword">:</span>forms<span class="keyword">,</span> G'<span class="keyword">:</span>forms<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> KOLMS <span class="keyword">(</span>G<span class="keyword">,</span> G'<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>
  
<span class="comment">// Classical natural deduction 
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="3305"><span class="stacstdec">NK <span class="keyword">(</span>forms<span class="keyword">,</span> form<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      NKfalse <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NK <span class="keyword">(</span>G<span class="keyword">,</span> lfalse<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> NKtrue <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> ltrue<span class="keyword">,</span> 0<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> NKhyp <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> 0<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">IN <span class="keyword">(</span>A<span class="keyword">,</span> G<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span> 
      NKandi <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A land B<span class="keyword">,</span> n1+n2+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span>NK <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> NK <span class="keyword">(</span>G<span class="keyword">,</span> B<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NKandel <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NK<span class="keyword">(</span>G<span class="keyword">,</span> A land B<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NKander <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> B<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NK<span class="keyword">(</span>G<span class="keyword">,</span> A land B<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NKoril <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A lor B<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NK <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NKorir <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A lor B<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NK <span class="keyword">(</span>G<span class="keyword">,</span> B<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">,</span>C<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">,</span>n3<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      NKore <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> C<span class="keyword">,</span> n1+n2+n3+1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span>NK <span class="keyword">(</span>G<span class="keyword">,</span> A lor B<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> NK <span class="keyword">(</span>A :: G<span class="keyword">,</span> C<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">,</span> NK <span class="keyword">(</span>B :: G<span class="keyword">,</span> C<span class="keyword">,</span> n3<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      NKimpi <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A limp B<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NK <span class="keyword">(</span>A :: G<span class="keyword">,</span> B<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      NKimpe <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> B<span class="keyword">,</span> n1+n2+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span>NK <span class="keyword">(</span>G<span class="keyword">,</span> A limp B<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> NK <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NKnoti <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> lnot A<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NK <span class="keyword">(</span>A :: G<span class="keyword">,</span> lfalse<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span> 
      NKnote <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> lfalse<span class="keyword">,</span> n1+n2+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span>NK <span class="keyword">(</span>G<span class="keyword">,</span> lnot A<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> NK <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NKdneg <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NK <span class="keyword">(</span>G<span class="keyword">,</span> lnot <span class="keyword">(</span>lnot A<span class="keyword">)</span><span class="keyword">,</span> n<span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="4529"><span class="stacstdec">NK0 <span class="keyword">(</span>G<span class="keyword">:</span>forms<span class="keyword">,</span> A<span class="keyword">:</span>form<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> NK <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="comment">// Intuitionistic Natural Deduction
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="4621"><span class="stacstdec">NJ <span class="keyword">(</span>forms<span class="keyword">,</span> form<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NJfalse <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NJ <span class="keyword">(</span>G<span class="keyword">,</span> lfalse<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> NJtrue <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> ltrue<span class="keyword">,</span> 0<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> NJhyp <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> 0<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">IN <span class="keyword">(</span>A<span class="keyword">,</span> G<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span> 
      NJandi <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A land B<span class="keyword">,</span> n1+n2+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span>NJ <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> NJ <span class="keyword">(</span>G<span class="keyword">,</span> B<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NJandel <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NJ<span class="keyword">(</span>G<span class="keyword">,</span> A land B<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NJander <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> B<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NJ<span class="keyword">(</span>G<span class="keyword">,</span> A land B<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NJoril <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A lor B<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NJ <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NJorir <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A lor B<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NJ <span class="keyword">(</span>G<span class="keyword">,</span> B<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">,</span>C<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">,</span>n3<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      NJore <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> C<span class="keyword">,</span> n1+n2+n3+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span>NJ <span class="keyword">(</span>G<span class="keyword">,</span> A lor B<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> NJ <span class="keyword">(</span>A :: G<span class="keyword">,</span> C<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">,</span> NJ <span class="keyword">(</span>B :: G<span class="keyword">,</span> C<span class="keyword">,</span> n3<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NJimpi <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A limp B<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NJ <span class="keyword">(</span>A :: G<span class="keyword">,</span> B<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      NJimpe <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> B<span class="keyword">,</span> n1+n2+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span>NJ <span class="keyword">(</span>G<span class="keyword">,</span> A limp B<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> NJ <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>B<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> NJnoti <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> lnot A<span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">NJ <span class="keyword">(</span>A :: G<span class="keyword">,</span> lfalse<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>forms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      NJnote <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> lfalse<span class="keyword">,</span> n1+n2+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span>NJ <span class="keyword">(</span>G<span class="keyword">,</span> lnot A<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> NJ <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="5747"><span class="stacstdec">NJ0 <span class="keyword">(</span>G<span class="keyword">:</span>forms<span class="keyword">,</span> A<span class="keyword">:</span>form<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> NJ <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="comment">// Given a KOLMS (G, G', n) on contexts with a metric, and a prop IN (A, G),
</span><span class="comment">// there exists a formula A', such that KOLM (A, A') and IN (A', G').
</span>
<span class="keyword">prfun</span> <span class="prfexp">proposition10 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">,</span>G'<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>ks<span class="keyword">:</span> <span class="staexp">KOLMS <span class="keyword">(</span>G<span class="keyword">,</span> G'<span class="keyword">,</span>n<span class="keyword">)</span></span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp">IN <span class="keyword">(</span>A<span class="keyword">,</span> G<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>A'<span class="keyword">:</span>form<span class="keyword">]</span> <span class="keyword">(</span>KOLM0 <span class="keyword">(</span>A<span class="keyword">,</span> dneg A'<span class="keyword">)</span><span class="keyword">,</span> IN <span class="keyword">(</span>dneg A'<span class="keyword">,</span> G'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> i <span class="keyword">of</span>
  <span class="keyword">|</span> INone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span> 
      <span class="keyword">prval</span> <span class="prfexp">KOLMScons <span class="keyword">(</span>k<span class="keyword">,</span> ks<span class="keyword">)</span> <span class="keyword">=</span> ks</span> 
    <span class="keyword">in</span> 
      <span class="keyword">(</span>k<span class="keyword">,</span> INone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> 
    <span class="keyword">end</span>
  <span class="keyword">|</span> INshi i' <span class="keyword">=&gt;</span> <span class="keyword">let</span> 
      <span class="keyword">prval</span> <span class="prfexp">KOLMScons <span class="keyword">(</span>k<span class="keyword">,</span> ks<span class="keyword">)</span> <span class="keyword">=</span> ks</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k<span class="keyword">,</span> i'<span class="keyword">)</span> <span class="keyword">=</span> proposition10 <span class="keyword">(</span>ks<span class="keyword">,</span> i'<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>k<span class="keyword">,</span> INshi i'<span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span></span> <span class="comment">// end of [proposition10]
</span>
<span class="comment">// Double negation rule
</span>
<span class="keyword">prfn</span> <span class="prfexp">proposition20 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>G<span class="keyword">,</span> A limp <span class="keyword">(</span>lnot <span class="keyword">(</span>lnot A<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span>
  NJimpi <span class="keyword">(</span>NJnoti <span class="keyword">(</span>NJnote <span class="keyword">(</span>NJhyp INone<span class="keyword">,</span> NJhyp <span class="keyword">(</span>INshi INone<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>

<span class="keyword">prfn</span> <span class="prfexp">proposition21 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span>
  <span class="keyword">(</span>pf<span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>G<span class="keyword">,</span> lnot <span class="keyword">(</span>lnot A<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> NJimpe <span class="keyword">(</span>proposition20 <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> pf<span class="keyword">)</span></span>

<span class="comment">// Double false rule
</span>
<span class="keyword">prfn</span> <span class="prfexp">proposition30 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>G<span class="keyword">,</span> <span class="keyword">(</span>lnot <span class="keyword">(</span>lnot lfalse<span class="keyword">)</span><span class="keyword">)</span> limp lfalse<span class="keyword">)</span></span> <span class="keyword">=</span>
  NJimpi <span class="keyword">(</span>NJnote <span class="keyword">(</span><span class="keyword">(</span>NJhyp INone<span class="keyword">)</span><span class="keyword">,</span> NJnoti <span class="keyword">(</span>NJhyp INone<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>

<span class="keyword">prfn</span> <span class="prfexp">proposition31 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="keyword">(</span>pf<span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>G<span class="keyword">,</span> dneg lfalse<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>G<span class="keyword">,</span> lfalse<span class="keyword">)</span></span> <span class="keyword">=</span>
  NJimpe <span class="keyword">(</span>proposition30 <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> pf<span class="keyword">)</span></span>

<span class="comment">// not not not R
</span>
<span class="keyword">prfn</span> <span class="prfexp">proposition35 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>G<span class="keyword">,</span> <span class="keyword">(</span>lnot <span class="keyword">(</span>dneg A<span class="keyword">)</span><span class="keyword">)</span> limp <span class="keyword">(</span>lnot A<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">stadef</span> <span class="staexp"><a name="7029"><span class="stacstdec">G1<span class="keyword">:</span>forms <span class="keyword">=</span> lnot <span class="keyword">(</span>dneg A<span class="keyword">)</span> :: G</span></a></span>
  <span class="keyword">prval</span> <span class="prfexp">pf <span class="keyword">=</span> proposition21 <span class="keyword">(</span>NJhyp <span class="keyword">(</span>INone <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>
<span class="keyword">in</span>
  NJimpi <span class="keyword">(</span>NJnoti <span class="keyword">(</span>NJnote <span class="keyword">(</span>NJhyp <span class="keyword">(</span>INshi INone<span class="keyword">)</span><span class="keyword">,</span> pf<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">end</span></span> <span class="comment">// end of [proposition35]
</span>
<span class="keyword">prfn</span> <span class="prfexp">proposition36 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="keyword">(</span>pf<span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>G<span class="keyword">,</span> lnot <span class="keyword">(</span>dneg A<span class="keyword">)</span><span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>G<span class="keyword">,</span> lnot A<span class="keyword">)</span></span> <span class="keyword">=</span>
  NJimpe <span class="keyword">(</span>proposition35 <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> pf<span class="keyword">)</span></span>

<span class="comment">(***********************************************************************************)</span>

<span class="keyword">propdef</span> <span class="staexp"><a name="7415"><span class="stacstdec">SUP <span class="keyword">(</span>G2<span class="keyword">:</span>forms<span class="keyword">,</span> G1<span class="keyword">:</span>forms<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">{</span>A<span class="keyword">:</span> form<span class="keyword">}</span> IN <span class="keyword">(</span>A<span class="keyword">,</span> G1<span class="keyword">)</span> <span class="keyword">-&lt;</span>prf<span class="keyword">&gt;</span> IN <span class="keyword">(</span>A<span class="keyword">,</span> G2<span class="keyword">)</span></span></a></span>

<span class="comment">// Weakening
</span>
<span class="keyword">prfn</span> <span class="prfexp">proposition40 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span>
  <span class="keyword">(</span>f<span class="keyword">:</span> <span class="staexp">SUP <span class="keyword">(</span>G2<span class="keyword">,</span> G1<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp">SUP <span class="keyword">(</span>A :: G2<span class="keyword">,</span> G1<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">lam</span> i <span class="keyword">=&gt;</span> INshi <span class="keyword">(</span>f i<span class="keyword">)</span></span> 

<span class="comment">// Exchange
</span>
<span class="keyword">prfn</span> <span class="prfexp">proposition41 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A1<span class="keyword">,</span>A2<span class="keyword">:</span>form<span class="keyword">}</span></span>
  <span class="keyword">(</span>f<span class="keyword">:</span> <span class="staexp">SUP <span class="keyword">(</span>G2<span class="keyword">,</span> G1<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">SUP <span class="keyword">(</span>A1 :: A2 :: G2<span class="keyword">,</span> A2 :: A1 :: G1<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">lam</span> i <span class="keyword">=&gt;</span> <span class="keyword">case+</span> i <span class="keyword">of</span>
    <span class="keyword">|</span> INone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> INshi <span class="keyword">(</span>INone<span class="keyword">)</span>
    <span class="keyword">|</span> INshi <span class="keyword">(</span>INone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> INone
    <span class="keyword">|</span> INshi <span class="keyword">(</span>INshi i<span class="keyword">)</span> <span class="keyword">=&gt;</span> INshi <span class="keyword">(</span>INshi <span class="keyword">(</span>f i<span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">end</span></span> <span class="comment">// end of [proposition41]
</span>
<span class="comment">// Shift
</span>
<span class="keyword">prfn</span> <span class="prfexp">proposition42 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span>
  <span class="keyword">(</span>f<span class="keyword">:</span> <span class="staexp">SUP <span class="keyword">(</span>G2<span class="keyword">,</span> G1<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">SUP <span class="keyword">(</span>A :: G2<span class="keyword">,</span> A :: G1<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">lam</span> i <span class="keyword">=&gt;</span> <span class="keyword">case+</span> i <span class="keyword">of</span>
    <span class="keyword">|</span> INone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> INone
    <span class="keyword">|</span> INshi i <span class="keyword">=&gt;</span> INshi <span class="keyword">(</span>f i<span class="keyword">)</span>
<span class="keyword">end</span></span> <span class="comment">// end of [proposition42]
</span>
<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">proposition43 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span> 
  <span class="keyword">(</span>f<span class="keyword">:</span> <span class="staexp">SUP <span class="keyword">(</span>G2<span class="keyword">,</span> G1<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">(</span>pf<span class="keyword">:</span> <span class="staexp">NJ <span class="keyword">(</span>G1<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">NJ <span class="keyword">(</span>G2<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> pf <span class="keyword">of</span>
  <span class="keyword">|</span> NJhyp i <span class="keyword">=&gt;</span> NJhyp <span class="keyword">(</span>f i<span class="keyword">)</span>
  <span class="keyword">|</span> NJtrue <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> NJtrue
  <span class="keyword">|</span> NJfalse pf <span class="keyword">=&gt;</span> NJfalse <span class="keyword">(</span>proposition43 f pf<span class="keyword">)</span>
  <span class="keyword">|</span> NJandi <span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span> <span class="keyword">=&gt;</span> NJandi <span class="keyword">(</span>proposition43 f pf1<span class="keyword">,</span> proposition43 f pf2<span class="keyword">)</span>
  <span class="keyword">|</span> NJandel pf <span class="keyword">=&gt;</span> NJandel <span class="keyword">(</span>proposition43 f pf<span class="keyword">)</span>
  <span class="keyword">|</span> NJander pf <span class="keyword">=&gt;</span> NJander <span class="keyword">(</span>proposition43 f pf<span class="keyword">)</span>
  <span class="keyword">|</span> NJoril pf <span class="keyword">=&gt;</span> NJoril <span class="keyword">(</span>proposition43 f pf<span class="keyword">)</span>
  <span class="keyword">|</span> NJorir pf <span class="keyword">=&gt;</span> NJorir <span class="keyword">(</span>proposition43 f pf<span class="keyword">)</span>
  <span class="keyword">|</span> NJore <span class="keyword">(</span>pf<span class="keyword">,</span> pf1<span class="keyword">,</span> pf2<span class="keyword">)</span> <span class="keyword">=&gt;</span> NJore <span class="keyword">(</span>
      proposition43 f pf
    <span class="keyword">,</span> proposition43 <span class="keyword">(</span>proposition42 f<span class="keyword">)</span> pf1
    <span class="keyword">,</span> proposition43 <span class="keyword">(</span>proposition42 f<span class="keyword">)</span> pf2
    <span class="keyword">)</span> <span class="comment">// end of [NJore]
</span>  <span class="keyword">|</span> NJimpi pf <span class="keyword">=&gt;</span> NJimpi <span class="keyword">(</span>proposition43 <span class="keyword">(</span>proposition42 f<span class="keyword">)</span> pf<span class="keyword">)</span>
  <span class="keyword">|</span> NJimpe <span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span> <span class="keyword">=&gt;</span> NJimpe <span class="keyword">(</span>proposition43 f pf1<span class="keyword">,</span> proposition43 f pf2<span class="keyword">)</span>
  <span class="keyword">|</span> NJnoti pf <span class="keyword">=&gt;</span> NJnoti <span class="keyword">(</span>proposition43 <span class="keyword">(</span>proposition42 f<span class="keyword">)</span> pf<span class="keyword">)</span>
  <span class="keyword">|</span> NJnote <span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span> <span class="keyword">=&gt;</span> NJnote <span class="keyword">(</span>proposition43 f pf1<span class="keyword">,</span> proposition43 f pf2<span class="keyword">)</span> 
<span class="keyword">end</span></span> <span class="comment">// end of [proposition43]
</span>
<span class="comment">// Weakening rule
</span>
<span class="keyword">prfn</span> <span class="prfexp">proposition44 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">,</span>A'<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="keyword">(</span>pf<span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>A' :: G<span class="keyword">,</span> A<span class="keyword">)</span></span> <span class="keyword">=</span> 
  <span class="keyword">(</span>proposition43 <span class="keyword">(</span>proposition40 <span class="keyword">(</span><span class="keyword">lam</span> i <span class="keyword">=&gt;</span> i<span class="keyword">)</span><span class="keyword">)</span> pf<span class="keyword">)</span></span>

<span class="comment">// Exchanging rule
</span>
<span class="keyword">prfn</span> <span class="prfexp">proposition45 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A1<span class="keyword">,</span>A2<span class="keyword">,</span>A3<span class="keyword">:</span>form<span class="keyword">}</span></span>
  <span class="keyword">(</span>pf<span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>A1 :: A2 :: G<span class="keyword">,</span> A3<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp">NJ0 <span class="keyword">(</span>A2 :: A1 :: G<span class="keyword">,</span> A3<span class="keyword">)</span></span> <span class="keyword">=</span> 
  <span class="keyword">(</span>proposition43 <span class="keyword">(</span>proposition41 <span class="keyword">(</span><span class="keyword">lam</span> i <span class="keyword">=&gt;</span> i<span class="keyword">)</span><span class="keyword">)</span> pf<span class="keyword">)</span></span>

<span class="comment">(****************************************************************************************)</span>

<span class="comment">// Soundness:
</span><span class="comment">// whenever a formula A is provable in NK, its translation A' is provable in NJ
</span>
<span class="keyword">prfun</span> <span class="prfexp">trans <span class="staexp"><span class="keyword">{</span>G<span class="keyword">,</span>G'<span class="keyword">:</span>forms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>ks<span class="keyword">:</span> <span class="staexp">KOLMS0 <span class="keyword">(</span>G<span class="keyword">,</span> G'<span class="keyword">)</span></span><span class="keyword">,</span> kpf<span class="keyword">:</span> <span class="staexp">NK <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>A'<span class="keyword">:</span>form<span class="keyword">]</span> <span class="keyword">(</span>KOLM0 <span class="keyword">(</span>A<span class="keyword">,</span> dneg A'<span class="keyword">)</span><span class="keyword">,</span> NJ0 <span class="keyword">(</span>G'<span class="keyword">,</span> dneg A'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> kpf <span class="keyword">of</span>
  <span class="keyword">|</span> NKhyp i <span class="keyword">=&gt;</span> <span class="keyword">let</span> 
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=</span> proposition10 <span class="keyword">(</span>ks<span class="keyword">,</span> i<span class="keyword">)</span></span> 
    <span class="keyword">in</span> 
      <span class="keyword">(</span>k<span class="keyword">,</span> NJhyp i<span class="keyword">)</span> 
    <span class="keyword">end</span>

  <span class="keyword">|</span> NKtrue <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>KOLMtrue<span class="keyword">,</span> proposition21 NJtrue<span class="keyword">)</span>

  <span class="keyword">|</span> NKfalse kpf <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>KOLMfalse <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> jpf<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">k' <span class="keyword">=</span> KOLMfun <span class="staexp"><span class="keyword">{</span><span class="keyword">...</span><span class="keyword">}</span></span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>k'<span class="keyword">,</span> NJfalse <span class="keyword">(</span>proposition31 jpf<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> NKandi <span class="keyword">(</span>kpf1<span class="keyword">,</span> kpf2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k1<span class="keyword">,</span> jpf1<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k2<span class="keyword">,</span> jpf2<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf2<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>KOLMand <span class="keyword">(</span>k1<span class="keyword">,</span> k2<span class="keyword">)</span><span class="keyword">,</span> proposition21 <span class="keyword">(</span>NJandi <span class="keyword">(</span>jpf1<span class="keyword">,</span> jpf2<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> NKandel kpf <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>KOLMand <span class="keyword">(</span>k1<span class="keyword">,</span> k2<span class="keyword">)</span><span class="keyword">,</span> jpf<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf1 <span class="keyword">=</span> NJhyp <span class="keyword">(</span>INshi INone<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf2 <span class="keyword">=</span> NJandel <span class="keyword">(</span>NJhyp INone<span class="keyword">)</span></span> 
      <span class="keyword">prval</span> <span class="prfexp">pf3 <span class="keyword">=</span> NJnote <span class="keyword">(</span>pf2<span class="keyword">,</span> pf1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf4 <span class="keyword">=</span> NJnoti pf3</span> 
      <span class="keyword">prval</span> <span class="prfexp">pf5 <span class="keyword">=</span> NJnote <span class="keyword">(</span>proposition44 jpf<span class="keyword">,</span> pf4<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf6 <span class="keyword">=</span> NJnoti pf5</span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>k1<span class="keyword">,</span> pf6<span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> NKander kpf <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>KOLMand <span class="keyword">(</span>k1<span class="keyword">,</span> k2<span class="keyword">)</span><span class="keyword">,</span> jpf<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf1 <span class="keyword">=</span> NJhyp <span class="keyword">(</span>INshi INone<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf2 <span class="keyword">=</span> NJander <span class="keyword">(</span>NJhyp INone<span class="keyword">)</span></span> 
      <span class="keyword">prval</span> <span class="prfexp">pf3 <span class="keyword">=</span> NJnote <span class="keyword">(</span>pf2<span class="keyword">,</span> pf1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf4 <span class="keyword">=</span> NJnoti pf3</span> 
      <span class="keyword">prval</span> <span class="prfexp">pf5 <span class="keyword">=</span> NJnote <span class="keyword">(</span>proposition44 jpf<span class="keyword">,</span> pf4<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf6 <span class="keyword">=</span> NJnoti pf5</span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>k2<span class="keyword">,</span> pf6<span class="keyword">)</span>
    <span class="keyword">end</span> 

  <span class="keyword">|</span> NKoril kpf <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k1<span class="keyword">,</span> jpf<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">k2 <span class="keyword">=</span> KOLMfun <span class="staexp"><span class="keyword">{</span><span class="keyword">...</span><span class="keyword">}</span></span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>KOLMor <span class="keyword">(</span>k1<span class="keyword">,</span> k2<span class="keyword">)</span><span class="keyword">,</span> proposition21 <span class="keyword">(</span>NJoril jpf<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> NKorir kpf <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k2<span class="keyword">,</span> jpf<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">k1 <span class="keyword">=</span> KOLMfun <span class="staexp"><span class="keyword">{</span><span class="keyword">...</span><span class="keyword">}</span></span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>KOLMor <span class="keyword">(</span>k1<span class="keyword">,</span> k2<span class="keyword">)</span><span class="keyword">,</span> proposition21 <span class="keyword">(</span>NJorir jpf<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> NKore <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A1<span class="keyword">,</span>A2<span class="keyword">,</span>A3<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="keyword">(</span>kpf1<span class="keyword">,</span> kpf2<span class="keyword">,</span> kpf3<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">[</span><span class="staexp">A'<span class="keyword">:</span>form</span><span class="keyword">]</span> <span class="keyword">(</span>KOLMor <span class="keyword">(</span>k11<span class="keyword">,</span> k12<span class="keyword">)</span><span class="keyword">,</span> jpf1<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k2<span class="keyword">,</span> jpf2<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>KOLMScons <span class="keyword">(</span>k11<span class="keyword">,</span> ks<span class="keyword">)</span><span class="keyword">,</span> kpf2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k3<span class="keyword">,</span> jpf3<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>KOLMScons <span class="keyword">(</span>k12<span class="keyword">,</span> ks<span class="keyword">)</span><span class="keyword">,</span> kpf3<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>k2<span class="keyword">,</span> k3<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">[</span><span class="staexp">A3'<span class="keyword">:</span>form</span><span class="keyword">]</span> k4 <span class="keyword">=</span> KOLMfun <span class="staexp"><span class="keyword">{</span>A3<span class="keyword">}</span></span></span>
      <span class="keyword">prval</span> <span class="prfexp">jpf4 <span class="keyword">=</span> proposition45 <span class="keyword">(</span>proposition44 jpf2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">jpf4 <span class="keyword">=</span> proposition45 <span class="keyword">(</span>proposition44 jpf4<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">jpf5 <span class="keyword">=</span> proposition45 <span class="keyword">(</span>proposition44 jpf3<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">jpf5 <span class="keyword">=</span> proposition45 <span class="keyword">(</span>proposition44 jpf5<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>k2<span class="keyword">,</span> k4<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf1 <span class="keyword">=</span> NJore <span class="keyword">(</span>NJhyp <span class="keyword">(</span>INone <span class="staexp"><span class="keyword">{</span>lnot A3' :: G'<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A'<span class="keyword">}</span></span><span class="keyword">)</span><span class="keyword">,</span> jpf4<span class="keyword">,</span> jpf5<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf2 <span class="keyword">=</span> NJnote <span class="keyword">(</span>pf1<span class="keyword">,</span> NJhyp <span class="keyword">(</span>INshi INone<span class="keyword">)</span><span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf3 <span class="keyword">=</span> NJnoti pf2</span>
      <span class="keyword">prval</span> <span class="prfexp">pf4 <span class="keyword">=</span> NJnote <span class="keyword">(</span>proposition44 jpf1<span class="keyword">,</span> pf3<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf5 <span class="keyword">=</span> NJnoti pf4</span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>k4<span class="keyword">,</span> pf5<span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> NKnoti kpf <span class="keyword">=&gt;</span> <span class="keyword">let</span> <span class="comment">(* kpf: NK (A::G, lfalse) *)</span>
      <span class="keyword">prval</span> <span class="prfexp">k1 <span class="keyword">=</span> KOLMfun <span class="staexp"><span class="keyword">{</span><span class="keyword">...</span><span class="keyword">}</span></span></span> 
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>KOLMfalse <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> jpf<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>KOLMScons <span class="keyword">(</span>k1<span class="keyword">,</span> ks<span class="keyword">)</span><span class="keyword">,</span> kpf<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf1 <span class="keyword">=</span> proposition31 jpf</span>
      <span class="keyword">prval</span> <span class="prfexp">pf2 <span class="keyword">=</span> NJnoti pf1</span>
      <span class="keyword">prval</span> <span class="prfexp">pf3 <span class="keyword">=</span> proposition21 pf2</span>
    <span class="keyword">in</span>  
      <span class="keyword">(</span>KOLMnot k1<span class="keyword">,</span> pf3<span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> NKnote <span class="keyword">(</span>kpf1<span class="keyword">,</span> kpf2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>KOLMnot k1<span class="keyword">,</span> jpf1<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf1<span class="keyword">)</span></span> 
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k2<span class="keyword">,</span> jpf2<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>k1<span class="keyword">,</span> k2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">jpf1' <span class="keyword">=</span> <span class="keyword">(</span>proposition36<span class="keyword">)</span> jpf1</span> 
      <span class="keyword">prval</span> <span class="prfexp">pf1 <span class="keyword">=</span> NJnote <span class="keyword">(</span>jpf1'<span class="keyword">,</span> jpf2<span class="keyword">)</span></span> 
      <span class="keyword">prval</span> <span class="prfexp">pf2 <span class="keyword">=</span> proposition21 pf1</span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>KOLMfalse<span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> pf2<span class="keyword">)</span>
    <span class="keyword">end</span>   

  <span class="keyword">|</span> NKimpi kpf <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">k1 <span class="keyword">=</span> KOLMfun <span class="staexp"><span class="keyword">{</span><span class="keyword">...</span><span class="keyword">}</span></span></span> 
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k2<span class="keyword">,</span> jpf<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>KOLMScons <span class="keyword">(</span>k1<span class="keyword">,</span> ks<span class="keyword">)</span><span class="keyword">,</span> kpf<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>KOLMimp <span class="keyword">(</span>k1<span class="keyword">,</span> k2<span class="keyword">)</span><span class="keyword">,</span> proposition21 <span class="keyword">(</span>NJimpi jpf<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> NKimpe <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A1<span class="keyword">,</span>A2<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="keyword">(</span>kpf1<span class="keyword">,</span> kpf2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">[</span><span class="staexp">A'<span class="keyword">:</span>form</span><span class="keyword">]</span> <span class="keyword">(</span>KOLMimp <span class="keyword">(</span>k1<span class="keyword">,</span> k2<span class="keyword">)</span><span class="keyword">,</span> jpf1<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>k3<span class="keyword">,</span> jpf2<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>k1<span class="keyword">,</span> k3<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">[</span><span class="staexp">A2'<span class="keyword">:</span>form</span><span class="keyword">]</span> k4 <span class="keyword">=</span> KOLMfun <span class="staexp"><span class="keyword">{</span>A2<span class="keyword">}</span></span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf0 <span class="keyword">=</span> proposition44 <span class="keyword">(</span>proposition44 jpf2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">FMEQ <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fmeq <span class="keyword">(</span>k2<span class="keyword">,</span> k4<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf1 <span class="keyword">=</span> NJimpe <span class="keyword">(</span>NJhyp <span class="keyword">(</span>INone <span class="staexp"><span class="keyword">{</span>lnot A2' :: G'<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A'<span class="keyword">}</span></span><span class="keyword">)</span><span class="keyword">,</span> pf0<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf2 <span class="keyword">=</span> NJnote <span class="keyword">(</span>pf1<span class="keyword">,</span> NJhyp <span class="keyword">(</span>INshi INone<span class="keyword">)</span><span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf3 <span class="keyword">=</span> NJnoti pf2</span>
      <span class="keyword">prval</span> <span class="prfexp">pf4 <span class="keyword">=</span> NJnote <span class="keyword">(</span>proposition44 jpf1<span class="keyword">,</span> pf3<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf5 <span class="keyword">=</span> NJnoti pf4</span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>k2<span class="keyword">,</span> pf5<span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> NKdneg kpf <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>KOLMnot <span class="keyword">(</span>KOLMnot k<span class="keyword">)</span><span class="keyword">,</span> jpf<span class="keyword">)</span> <span class="keyword">=</span> trans <span class="keyword">(</span>ks<span class="keyword">,</span> kpf<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">pf <span class="keyword">=</span> proposition36 <span class="keyword">(</span>proposition36 <span class="keyword">(</span>proposition36 jpf<span class="keyword">)</span><span class="keyword">)</span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>k<span class="keyword">,</span> pf<span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span></span> <span class="comment">// end of [trans]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [KolmogorovTrans.dats] *)</span>
</pre>
</body>
</html>
