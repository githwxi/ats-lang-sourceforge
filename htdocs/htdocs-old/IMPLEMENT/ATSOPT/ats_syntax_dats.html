<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">(***********************************************************************)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(*                         Applied Type System                         *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(*                              Hongwei Xi                             *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(***********************************************************************)</span>

<span class="comment">(*
** ATS/Anairiats - Unleashing the Potential of Types!
**
** Copyright (C) 2002-2008 Hongwei Xi, Boston University
**
** All rights reserved
**
** ATS is free software;  you can  redistribute it and/or modify it under
** the terms of  the GNU GENERAL PUBLIC LICENSE (GPL) as published by the
** Free Software Foundation; either version 3, or (at  your  option)  any
** later version.
** 
** ATS is distributed in the hope that it will be useful, but WITHOUT ANY
** WARRANTY; without  even  the  implied  warranty  of MERCHANTABILITY or
** FITNESS FOR A PARTICULAR PURPOSE.  See the  GNU General Public License
** for more details.
** 
** You  should  have  received  a  copy of the GNU General Public License
** along  with  ATS;  see the  file COPYING.  If not, please write to the
** Free Software Foundation,  51 Franklin Street, Fifth Floor, Boston, MA
** 02110-1301, USA.
*)</span>

<span class="comment">(* ****** ****** *)</span>
<span class="comment">//
</span><span class="comment">// Author: Hongwei Xi (hwxi AT cs DOT bu DOT edu)
</span><span class="comment">// Time: July 2007
</span><span class="comment">//
</span><span class="comment">(* ****** ****** *)</span>

<span class="comment">(* ats_syntax: AST for source programs in ATS/Anairiats *)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">Err <span class="keyword">=</span> "ats_error.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Fil <span class="keyword">=</span> "ats_filename.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Fix <span class="keyword">=</span> "ats_fixity.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Glo <span class="keyword">=</span> "ats_global.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Lab <span class="keyword">=</span> "ats_label.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Lex <span class="keyword">=</span> "ats_lexer.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Loc <span class="keyword">=</span> "ats_location.sats"</span>
<span class="keyword">typedef</span> <span class="staexp"><a name="1832"><span class="stacstdec">loc_t <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#1710"><span class="stacstuse">$Loc<span class="keyword">.</span>location_t</span></a></span></a></span>
<span class="keyword">staload</span> <span class="staexp">Sym <span class="keyword">=</span> "ats_symbol.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"ats_syntax.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{^
#include "prelude/CATS/string.cats"
%}</span> <span class="comment">// end of [%{^]
</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">#define</span> <span class="neuexp">nil list_nil</span>
<span class="keyword">#define</span> <span class="neuexp">:: list_cons</span>
<span class="keyword">#define</span> <span class="neuexp">cons list_cons</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">val</span> combine <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#2006"><span class="dyncstuse">$Loc<span class="keyword">.</span>location_combine</span></a>

<span class="comment">(* ****** ****** *)</span>

<span class="neuexp"><span class="keyword">overload</span> <span class="keyword">=</span> <span class="keyword">with</span> $Sym<span class="keyword">.</span>eq_symbol_symbol</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> prerr_loc_error0
  <span class="keyword">(</span>loc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#2738"><span class="dyncstuse">$Loc<span class="keyword">.</span>prerr_location</span></a> loc<span class="keyword">;</span> prerr ": error(0)"<span class="keyword">)</span>
<span class="comment">// end of [prerr_loc_error0]
</span>
<span class="keyword">fn</span> prerr_interror <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> prerr "INTERNAL ERROR (ats_syntax)"

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2089"><span class="dyncstimp">abskind_prop</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> ABSKINDprop <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2137"><span class="dyncstimp">abskind_type</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> ABSKINDtype <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2185"><span class="dyncstimp">abskind_t0ype</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> ABSKINDt0ype <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2235"><span class="dyncstimp">abskind_view</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> ABSKINDview <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2283"><span class="dyncstimp">abskind_viewtype</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> ABSKINDviewtype <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2339"><span class="dyncstimp">abskind_viewt0ype</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> ABSKINDviewt0ype <span class="keyword">(</span><span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2558"><span class="dyncstimp">dcstkind_fun</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> DCSTKINDfun <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2607"><span class="dyncstimp">dcstkind_val</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> DCSTKINDval <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2656"><span class="dyncstimp">dcstkind_castfn</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> DCSTKINDcastfn <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2711"><span class="dyncstimp">dcstkind_praxi</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> DCSTKINDpraxi <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2764"><span class="dyncstimp">dcstkind_prfun</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> DCSTKINDprfun <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2817"><span class="dyncstimp">dcstkind_prval</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> DCSTKINDprval <span class="keyword">(</span><span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2871"><span class="dyncstimp">dcstkind_is_fun</span></a> <span class="keyword">(</span>dk<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> dk <span class="keyword">of</span>
  <span class="keyword">|</span> DCSTKINDfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2915"><span class="dyncstimp">dcstkind_is_castfn</span></a> <span class="keyword">(</span>dk<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> dk <span class="keyword">of</span>
  <span class="keyword">|</span> DCSTKINDcastfn <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#2962"><span class="dyncstimp">dcstkind_is_praxi</span></a> <span class="keyword">(</span>dk<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> dk <span class="keyword">of</span>
  <span class="keyword">|</span> DCSTKINDpraxi <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3008"><span class="dyncstimp">dcstkind_is_prfun</span></a> <span class="keyword">(</span>dk<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> dk <span class="keyword">of</span>
  <span class="keyword">|</span> DCSTKINDprfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3054"><span class="dyncstimp">dcstkind_is_prval</span></a> <span class="keyword">(</span>dk<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> dk <span class="keyword">of</span>
  <span class="keyword">|</span> DCSTKINDprval <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3100"><span class="dyncstimp">dcstkind_is_proof</span></a> <span class="keyword">(</span>dk<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> dk <span class="keyword">of</span>
  <span class="keyword">|</span> DCSTKINDpraxi <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> DCSTKINDprfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> DCSTKINDprval <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [dcstkind_is_proof]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3147"><span class="dyncstimp">fprint_dcstkind</span></a> <span class="keyword">(</span>out<span class="keyword">,</span> dk<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> dk <span class="keyword">of</span>
  <span class="keyword">|</span> DCSTKINDfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> fprint_string <span class="keyword">(</span>out<span class="keyword">,</span> "DCSTKINDfun"<span class="keyword">)</span>
  <span class="keyword">|</span> DCSTKINDval <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> fprint_string <span class="keyword">(</span>out<span class="keyword">,</span> "DCSTKINDval"<span class="keyword">)</span>
  <span class="keyword">|</span> DCSTKINDcastfn <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> fprint_string <span class="keyword">(</span>out<span class="keyword">,</span> "DCSTKINDcastfn"<span class="keyword">)</span>
  <span class="keyword">|</span> DCSTKINDpraxi <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> fprint_string <span class="keyword">(</span>out<span class="keyword">,</span> "DCSTKINDpraxi"<span class="keyword">)</span>
  <span class="keyword">|</span> DCSTKINDprfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> fprint_string <span class="keyword">(</span>out<span class="keyword">,</span> "DCSTKINDprfun"<span class="keyword">)</span>
  <span class="keyword">|</span> DCSTKINDprval <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> fprint_string <span class="keyword">(</span>out<span class="keyword">,</span> "DCSTKINDprval"<span class="keyword">)</span>
<span class="comment">// end of [fprint_dcstkind]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3333"><span class="dyncstimp">datakind_prop</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> DATAKINDprop <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3384"><span class="dyncstimp">datakind_type</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> DATAKINDtype <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3435"><span class="dyncstimp">datakind_view</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> DATAKINDview <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3486"><span class="dyncstimp">datakind_viewtype</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> DATAKINDviewtype <span class="keyword">(</span><span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3546"><span class="dyncstimp">datakind_is_proof</span></a> dk <span class="keyword">=</span> <span class="keyword">case+</span> dk <span class="keyword">of</span>
  <span class="keyword">|</span> DATAKINDprop <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> DATAKINDview <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [datakind_is_proof]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3794"><span class="dyncstimp">stadefkind_generic</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> STADEFKINDgeneric <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3857"><span class="dyncstimp">stadefkind_prop</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> STADEFKINDprop <span class="keyword">(</span>t<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3921"><span class="dyncstimp">stadefkind_type</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> STADEFKINDtype <span class="keyword">(</span>t<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#3985"><span class="dyncstimp">stadefkind_view</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> STADEFKINDview <span class="keyword">(</span>t<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#4049"><span class="dyncstimp">stadefkind_viewtype</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> STADEFKINDviewtype <span class="keyword">(</span>t<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#4896"><span class="dyncstimp">valkind_val</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> VALKINDval <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#4942"><span class="dyncstimp">valkind_valminus</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> VALKINDvalminus <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#4998"><span class="dyncstimp">valkind_valplus</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> VALKINDvalplus <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5052"><span class="dyncstimp">valkind_prval</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> VALKINDprval <span class="keyword">(</span><span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5103"><span class="dyncstimp">valkind_is_proof</span></a> vk <span class="keyword">=</span> <span class="keyword">case+</span> vk <span class="keyword">of</span>
  <span class="keyword">|</span> VALKINDprval <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [valkind_is_proof]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5277"><span class="dyncstimp">funkind_fn</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> FUNKINDfn <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5321"><span class="dyncstimp">funkind_fnstar</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> FUNKINDfnstar <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5373"><span class="dyncstimp">funkind_fun</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> FUNKINDfun <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5419"><span class="dyncstimp">funkind_castfn</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> FUNKINDcastfn <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5471"><span class="dyncstimp">funkind_prfn</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> FUNKINDprfn <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5519"><span class="dyncstimp">funkind_prfun</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> FUNKINDprfun <span class="keyword">(</span><span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5570"><span class="dyncstimp">funkind_is_proof</span></a> fk <span class="keyword">=</span> <span class="keyword">case+</span> fk <span class="keyword">of</span>
  <span class="keyword">|</span> FUNKINDfn <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> FUNKINDfnstar <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> FUNKINDfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> FUNKINDcastfn <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> FUNKINDprfn <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> FUNKINDprfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
<span class="comment">// end of [funkind_is_proof]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5621"><span class="dyncstimp">funkind_is_recursive</span></a> fk <span class="keyword">=</span> <span class="keyword">case+</span> fk <span class="keyword">of</span>
  <span class="keyword">|</span> FUNKINDfn <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> FUNKINDfnstar <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> FUNKINDfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> FUNKINDcastfn <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> FUNKINDprfn <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> FUNKINDprfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
<span class="comment">// end of [funkind_is_recursive]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5680"><span class="dyncstimp">funkind_is_tailrecur</span></a> fk <span class="keyword">=</span>
  <span class="keyword">case+</span> fk <span class="keyword">of</span> FUNKINDfnstar <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [funkind_is_tailrecur]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#6159"><span class="dyncstimp">lamkind_lam</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> LAMKINDlam <span class="keyword">(</span>t<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#6210"><span class="dyncstimp">lamkind_atlam</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> LAMKINDatlam <span class="keyword">(</span>t<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#6265"><span class="dyncstimp">lamkind_llam</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> LAMKINDllam <span class="keyword">(</span>t<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#6318"><span class="dyncstimp">lamkind_atllam</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> LAMKINDatllam <span class="keyword">(</span>t<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#6402"><span class="dyncstimp">fixkind_fix</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> LAMKINDfix <span class="keyword">(</span>t<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#6453"><span class="dyncstimp">fixkind_atfix</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> LAMKINDatfix <span class="keyword">(</span>t<span class="keyword">)</span>

<span class="keyword">fun</span> lamkind_loc_get
  <span class="keyword">(</span>knd<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5920"><span class="stacstuse">lamkind</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> knd <span class="keyword">of</span>
  <span class="keyword">|</span> LAMKINDlam tok <span class="keyword">=&gt;</span> tok<span class="keyword">.</span>t0kn_loc
  <span class="keyword">|</span> LAMKINDatlam tok <span class="keyword">=&gt;</span> tok<span class="keyword">.</span>t0kn_loc
  <span class="keyword">|</span> LAMKINDllam tok <span class="keyword">=&gt;</span> tok<span class="keyword">.</span>t0kn_loc
  <span class="keyword">|</span> LAMKINDatllam tok <span class="keyword">=&gt;</span> tok<span class="keyword">.</span>t0kn_loc
  <span class="keyword">|</span> LAMKINDfix tok <span class="keyword">=&gt;</span> tok<span class="keyword">.</span>t0kn_loc
  <span class="keyword">|</span> LAMKINDatfix tok <span class="keyword">=&gt;</span> tok<span class="keyword">.</span>t0kn_loc
  <span class="keyword">|</span> LAMKINDifix loc <span class="keyword">=&gt;</span> loc <span class="comment">// HX: implicit FIX
</span><span class="comment">// end of [lamkind_loc_get]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#6843"><span class="dyncstimp">srpifkindtok_if</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> SRPIFKINDTOK <span class="keyword">(</span>SRPIFKINDif <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> t<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#6907"><span class="dyncstimp">srpifkindtok_ifdef</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> SRPIFKINDTOK <span class="keyword">(</span>SRPIFKINDifdef <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> t<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#6977"><span class="dyncstimp">srpifkindtok_ifndef</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> SRPIFKINDTOK <span class="keyword">(</span>SRPIFKINDifndef <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> t<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#7308"><span class="dyncstimp">fprint_cstsp</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> cst<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> cst <span class="keyword">of</span>
  <span class="keyword">|</span> CSTSPfilename <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "#FILENAME"<span class="keyword">)</span>
  <span class="keyword">|</span> CSTSPlocation <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "#LOCATION"<span class="keyword">)</span>
<span class="comment">// end of [fprint_cstsp]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8458"><span class="dyncstimp">t0kn_make</span></a> <span class="keyword">(</span>loc<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">@{</span> t0kn_loc<span class="keyword">=</span> loc <span class="keyword">}</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#7997"><span class="dyncstimp">c0har_make</span></a> <span class="keyword">(</span>loc<span class="keyword">,</span> chr<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> c0har_loc<span class="keyword">=</span> loc<span class="keyword">,</span> c0har_val<span class="keyword">=</span> chr <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8054"><span class="dyncstimp">e0xtcode_make</span></a> <span class="keyword">(</span>loc<span class="keyword">,</span> int<span class="keyword">,</span> str<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> e0xtcode_loc<span class="keyword">=</span> loc<span class="keyword">,</span> e0xtcode_pos<span class="keyword">=</span> int<span class="keyword">,</span> e0xtcode_cod<span class="keyword">=</span> str <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8137"><span class="dyncstimp">f0loat_make</span></a> <span class="keyword">(</span>loc<span class="keyword">,</span> str<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> f0loat_loc<span class="keyword">=</span> loc<span class="keyword">,</span> f0loat_val<span class="keyword">=</span> str <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8199"><span class="dyncstimp">f0loatsp_make</span></a> <span class="keyword">(</span>loc<span class="keyword">,</span> str<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> f0loatsp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> f0loatsp_val<span class="keyword">=</span> str <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8267"><span class="dyncstimp">i0nt_make</span></a> <span class="keyword">(</span>loc<span class="keyword">,</span> str<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0nt_loc<span class="keyword">=</span> loc<span class="keyword">,</span> i0nt_val<span class="keyword">=</span> str <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8323"><span class="dyncstimp">i0ntsp_make</span></a> <span class="keyword">(</span>loc<span class="keyword">,</span> str<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0ntsp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> i0ntsp_val<span class="keyword">=</span> str <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8385"><span class="dyncstimp">s0tring_make</span></a> <span class="keyword">(</span>loc<span class="keyword">,</span> str<span class="keyword">,</span> len<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> s0tring_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0tring_val<span class="keyword">=</span> str<span class="keyword">,</span> s0tring_len<span class="keyword">=</span> len <span class="keyword">}</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8714"><span class="dyncstimp">fprint_i0de</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8837"><span class="dyncstimp">print_i0de</span></a> id <span class="keyword">=</span> print_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8714"><span class="dyncstuse">fprint_i0de</span></a><span class="keyword">,</span> id<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8868"><span class="dyncstimp">prerr_i0de</span></a> id <span class="keyword">=</span> prerr_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8714"><span class="dyncstuse">fprint_i0de</span></a><span class="keyword">,</span> id<span class="keyword">)</span>

<span class="comment">//
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8900"><span class="dyncstimp">fprint_i0delst</span></a> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">}</span></span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="keyword">fun</span> aux <span class="keyword">(</span>out<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse">FILE</span></a></span></a> m</span><span class="keyword">,</span> id0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8529"><span class="stacstuse">i0de</span></a></span><span class="keyword">,</span> ids<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8624"><span class="stacstuse">i0delst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> ids <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>id<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8714"><span class="dyncstuse">fprint_i0de</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id<span class="keyword">)</span><span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ", "<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8714"><span class="dyncstuse">fprint_i0de</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id0<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">case+</span> ids <span class="keyword">of</span> cons <span class="keyword">(</span>id<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>out<span class="keyword">,</span> id<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [fprint_i0delst]
</span>
<span class="comment">//
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9053"><span class="dyncstimp">i0de_make</span></a> <span class="keyword">(</span>loc<span class="keyword">,</span> str<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">(*
    val () = begin
      print "i0de_make: sym = "; print str; print_newline ()
    end // end of [val]
*)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  i0de_loc<span class="keyword">=</span> loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#4367"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_make_string</span></a> str
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [i0de_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9109"><span class="dyncstimp">i0de_make_ampersand</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#1770"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_AMPERSAND</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9173"><span class="dyncstimp">i0de_make_backslash</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#1853"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_BACKSLASH</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9237"><span class="dyncstimp">i0de_make_bang</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#1885"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_BANG</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9291"><span class="dyncstimp">i0de_make_eq</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#1968"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_EQ</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9341"><span class="dyncstimp">i0de_make_gt</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2045"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_GT</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9391"><span class="dyncstimp">i0de_make_gtlt</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2124"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_GTLT</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9445"><span class="dyncstimp">i0de_make_lt</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2184"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_LT</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9495"><span class="dyncstimp">i0de_make_minusgt</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2263"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_MINUSGT</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9555"><span class="dyncstimp">i0de_make_minusltgt</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2293"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_MINUSLTGT</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9619"><span class="dyncstimp">i0de_make_r0ead</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2717"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_R0EAD</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9675"><span class="dyncstimp">i0de_make_tilda</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2516"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_TILDA</span></a> <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9731"><span class="dyncstimp">i0de_make_t0ype</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3540"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_T0YPE</span></a> <span class="keyword">}</span>
<span class="comment">// end of [i0de_make_t0ype]
</span><span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9787"><span class="dyncstimp">i0de_make_viewt0ype</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3685"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_VIEWT0YPE</span></a> <span class="keyword">}</span>
<span class="comment">// end of [i0de_make_viewt0ype]
</span>
<span class="comment">//
</span><span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9975"><span class="dyncstimp">i0de_make_DO</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2638"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_DO</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10025"><span class="dyncstimp">i0de_make_IN</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2692"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_IN</span></a> <span class="keyword">}</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10075"><span class="dyncstimp">i0de_make_WHILE</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> i0de_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2926"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_WHILE</span></a> <span class="keyword">}</span>
<span class="comment">//
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9856"><span class="dyncstimp">i0de_make_lrbrackets</span></a> <span class="keyword">(</span>t_l<span class="keyword">,</span> t_r<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_l<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_r<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  i0de_loc<span class="keyword">=</span> loc<span class="keyword">,</span> i0de_sym<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2151"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_LRBRACKETS</span></a>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [i0de_make_lrbrackets]
</span>
<span class="comment">//
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10136"><span class="dyncstimp">i0delst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10180"><span class="dyncstimp">i0delst_sing</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10233"><span class="dyncstimp">i0delst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10300"><span class="dyncstimp">i0delstlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10353"><span class="dyncstimp">i0delstlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10561"><span class="dyncstimp">l0ab_ide</span></a> <span class="keyword">(</span>ide<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> lab <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flabel_2esats.html#1755"><span class="dyncstuse">$Lab<span class="keyword">.</span>label_make_sym</span></a> <span class="keyword">(</span>ide<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  l0ab_loc<span class="keyword">=</span> ide<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> l0ab_lab<span class="keyword">=</span> lab
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [l0ab_ide]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10605"><span class="dyncstimp">l0ab_int</span></a> <span class="keyword">(</span>int<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> lab <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flabel_2esats.html#1673"><span class="dyncstuse">$Lab<span class="keyword">.</span>label_make_int</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2finteger_2esats.html#2124"><span class="dyncstuse">int_of_string</span></a> int<span class="keyword">.</span>i0nt_val<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  l0ab_loc<span class="keyword">=</span> int<span class="keyword">.</span>i0nt_loc<span class="keyword">,</span> l0ab_lab<span class="keyword">=</span> lab
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [l0ab_int]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10671"><span class="dyncstimp">stai0de_make</span></a> <span class="keyword">(</span>ide<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> name <span class="keyword">=</span> "$" + <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#4322"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_name</span></a> <span class="keyword">(</span>ide<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9053"><span class="dyncstuse">i0de_make</span></a> <span class="keyword">(</span>ide<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> name<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [stai0de_make]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">// omitted precedence is assumed to equal 0
</span><span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10878"><span class="dyncstimp">p0rec_emp</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> P0RECint 0
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10963"><span class="dyncstimp">p0rec_int</span></a> <span class="keyword">(</span>i<span class="keyword">)</span> <span class="keyword">=</span> P0RECint <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2finteger_2esats.html#2124"><span class="dyncstuse">int_of_string</span></a> i<span class="keyword">.</span>i0nt_val<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10916"><span class="dyncstimp">p0rec_ide</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> P0RECide <span class="keyword">(</span>id<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11010"><span class="dyncstimp">p0rec_opr</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> opr<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> opr<span class="keyword">.</span>i0de_sym <span class="keyword">of</span>
  <span class="keyword">|</span> s <span class="keyword">when</span> s <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#1744"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_ADD</span></a> <span class="keyword">=&gt;</span> P0RECinc <span class="keyword">(</span>id<span class="keyword">,</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2finteger_2esats.html#2124"><span class="dyncstuse">int_of_string</span></a> i<span class="keyword">.</span>i0nt_val<span class="keyword">)</span>
  <span class="keyword">|</span> s <span class="keyword">when</span> s <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2490"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_SUB</span></a> <span class="keyword">=&gt;</span> P0RECdec <span class="keyword">(</span>id<span class="keyword">,</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2finteger_2esats.html#2124"><span class="dyncstuse">int_of_string</span></a> i<span class="keyword">.</span>i0nt_val<span class="keyword">)</span>
  <span class="keyword">|</span> s <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      prerr_loc_error0 <span class="keyword">(</span>opr<span class="keyword">.</span>i0de_loc<span class="keyword">)</span><span class="keyword">;</span>
      prerr ": the symbol ["<span class="keyword">;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5388"><span class="dyncstuse">$Sym<span class="keyword">.</span>prerr_symbol</span></a> s<span class="keyword">;</span>
      prerr "] must be either '+' or '-'."<span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#10750"><span class="stacstuse">p0rec</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [_]
</span><span class="comment">// end of [p0rec_opr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11651"><span class="dyncstimp">e0xplst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11695"><span class="dyncstimp">e0xplst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11762"><span class="dyncstimp">e0xpopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11808"><span class="dyncstimp">e0xpopt_some</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> Some <span class="keyword">(</span>x<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11883"><span class="dyncstimp">e0xp_app</span></a> <span class="keyword">(</span>e1<span class="keyword">,</span> e2<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>e1<span class="keyword">.</span>e0xp_loc<span class="keyword">,</span> e2<span class="keyword">.</span>e0xp_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> e0xp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> e0xp_node<span class="keyword">=</span> E0XPapp <span class="keyword">(</span>e1<span class="keyword">,</span> e2<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11940"><span class="dyncstimp">e0xp_char</span></a> c <span class="keyword">=</span>
  <span class="keyword">'{</span> e0xp_loc<span class="keyword">=</span> c<span class="keyword">.</span>c0har_loc<span class="keyword">,</span> e0xp_node<span class="keyword">=</span> E0XPchar c<span class="keyword">.</span>c0har_val <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11986"><span class="dyncstimp">e0xp_eval</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> e<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  e0xp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> e0xp_node<span class="keyword">=</span> E0XPeval e
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [e0xp_eval]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12059"><span class="dyncstimp">e0xp_float</span></a> f <span class="keyword">=</span>
  <span class="keyword">'{</span> e0xp_loc<span class="keyword">=</span> f<span class="keyword">.</span>f0loat_loc<span class="keyword">,</span> e0xp_node<span class="keyword">=</span> E0XPfloat f<span class="keyword">.</span>f0loat_val <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12107"><span class="dyncstimp">e0xp_ide</span></a> id <span class="keyword">=</span>
  <span class="keyword">'{</span> e0xp_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> e0xp_node<span class="keyword">=</span> E0XPide id<span class="keyword">.</span>i0de_sym <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12149"><span class="dyncstimp">e0xp_int</span></a> i <span class="keyword">=</span>
  <span class="keyword">'{</span> e0xp_loc<span class="keyword">=</span> i<span class="keyword">.</span>i0nt_loc<span class="keyword">,</span> e0xp_node<span class="keyword">=</span> E0XPint i<span class="keyword">.</span>i0nt_val <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12192"><span class="dyncstimp">e0xp_list</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  e0xp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> e0xp_node<span class="keyword">=</span> E0XPlist es
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [e0xp_list]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12269"><span class="dyncstimp">e0xp_string</span></a> s <span class="keyword">=</span> <span class="keyword">'{</span>
  e0xp_loc<span class="keyword">=</span> s<span class="keyword">.</span>s0tring_loc
<span class="keyword">,</span> e0xp_node<span class="keyword">=</span> E0XPstring <span class="keyword">(</span>s<span class="keyword">.</span>s0tring_val<span class="keyword">,</span> s<span class="keyword">.</span>s0tring_len<span class="keyword">)</span>
<span class="keyword">}</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12564"><span class="dyncstimp">fprint_s0rtq</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> q<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> q<span class="keyword">.</span>s0rtq_node <span class="keyword">of</span>
  <span class="keyword">|</span> S0RTQnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S0RTQstr fname <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '"'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> fname<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '"'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '.'<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S0RTQstr]
</span>  <span class="keyword">|</span> S0RTQsym id <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '.'<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S0RTQsym]
</span><span class="comment">// end of [fprint_s0rtq]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12690"><span class="dyncstimp">print_s0rtq</span></a> <span class="keyword">(</span>q<span class="keyword">)</span> <span class="keyword">=</span> print_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12564"><span class="dyncstuse">fprint_s0rtq</span></a><span class="keyword">,</span> q<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12723"><span class="dyncstimp">prerr_s0rtq</span></a> <span class="keyword">(</span>q<span class="keyword">)</span> <span class="keyword">=</span> prerr_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12564"><span class="dyncstuse">fprint_s0rtq</span></a><span class="keyword">,</span> q<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12757"><span class="dyncstimp">s0rtq_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rtq_loc<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#1761"><span class="dyncstuse">$Loc<span class="keyword">.</span>location_none</span></a><span class="keyword">,</span> s0rtq_node<span class="keyword">=</span> S0RTQnone <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12797"><span class="dyncstimp">s0rtq_str</span></a> <span class="keyword">(</span>s<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rtq_loc<span class="keyword">=</span> s<span class="keyword">.</span>s0tring_loc<span class="keyword">,</span> s0rtq_node<span class="keyword">=</span> S0RTQstr s<span class="keyword">.</span>s0tring_val
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12845"><span class="dyncstimp">s0rtq_sym</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rtq_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0rtq_node<span class="keyword">=</span> S0RTQsym id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13394"><span class="dyncstimp">fprint_s0rt</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> s0t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s0t<span class="keyword">.</span>s0rt_node <span class="keyword">of</span>
  <span class="keyword">|</span> S0RTapp <span class="keyword">(</span>s0t_fun<span class="keyword">,</span> s0t_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "S0RTapp("<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13394"><span class="dyncstuse">fprint_s0rt</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> s0t_fun<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ", "<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13394"><span class="dyncstuse">fprint_s0rt</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> s0t_arg<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ")"<span class="keyword">)</span><span class="keyword">;</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S0RTide id <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "S0RTid("<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ")"<span class="keyword">)</span><span class="keyword">;</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S0RTqid <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "S0RTqid("<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#12564"><span class="dyncstuse">fprint_s0rtq</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> q<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ")"<span class="keyword">)</span><span class="keyword">;</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S0RTlist s0ts <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "S0RTlist(...)"<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S0RTtup  s0ts <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "S0RTtup(...)"<span class="keyword">)</span>
    <span class="keyword">end</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13525"><span class="dyncstimp">s0rtlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13569"><span class="dyncstimp">s0rtlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13636"><span class="dyncstimp">s0rtopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13682"><span class="dyncstimp">s0rtopt_some</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> Some <span class="keyword">(</span>x<span class="keyword">)</span>

<span class="comment">//
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13757"><span class="dyncstimp">s0rt_prop</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rt_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3460"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_PROP</span></a>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13801"><span class="dyncstimp">s0rt_type</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rt_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3487"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_TYPE</span></a>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13845"><span class="dyncstimp">s0rt_t0ype</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rt_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3540"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_T0YPE</span></a>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13891"><span class="dyncstimp">s0rt_view</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rt_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3597"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_VIEW</span></a>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13935"><span class="dyncstimp">s0rt_viewtype</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rt_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3624"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_VIEWTYPE</span></a>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13987"><span class="dyncstimp">s0rt_viewt0ype</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rt_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3685"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_VIEWT0YPE</span></a>
<span class="keyword">}</span>

<span class="comment">//
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14046"><span class="dyncstimp">s0rt_app</span></a> <span class="keyword">(</span>s0t_fun<span class="keyword">,</span> s0t_arg<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
<span class="comment">(*
  print "s0rt_app:"; print_newline ();
  print "loc_fun = "; print s0t_fun.s0rt_loc; print_newline ();
  print "loc_arg = "; print s0t_arg.s0rt_loc; print_newline ();
*)</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>s0t_fun<span class="keyword">.</span>s0rt_loc<span class="keyword">,</span> s0t_arg<span class="keyword">.</span>s0rt_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> s0rt_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTapp <span class="keyword">(</span>s0t_fun<span class="keyword">,</span> s0t_arg<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>
<span class="keyword">end</span> <span class="comment">// end of [s0rt_app]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14103"><span class="dyncstimp">s0rt_ide</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rt_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14145"><span class="dyncstimp">s0rt_qid</span></a> <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>q<span class="keyword">.</span>s0rtq_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> s0rt_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTqid <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14198"><span class="dyncstimp">s0rt_list</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0ts<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
<span class="comment">(*
  print "s0rt_list:\n";
  print "t_beg.loc = "; print t_beg.t0kn_loc; print_newline ();
  print "t_end.loc = "; print t_end.t0kn_loc; print_newline ();
*)</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> s0rt_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTlist s0ts <span class="keyword">}</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14273"><span class="dyncstimp">s0rt_tup</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0ts<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> s0rt_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTtup s0ts <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14347"><span class="dyncstimp">s0rtpol_make</span></a> <span class="keyword">(</span>s0t<span class="keyword">,</span> pol<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0rtpol_loc<span class="keyword">=</span> s0t<span class="keyword">.</span>s0rt_loc<span class="keyword">,</span> s0rtpol_srt<span class="keyword">=</span> s0t<span class="keyword">,</span> s0rtpol_pol<span class="keyword">=</span> pol
<span class="keyword">}</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14535"><span class="dyncstimp">d0atsrtcon_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0atsrtcon_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> d0atsrtcon_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> d0atsrtcon_arg<span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0atsrtcon_make_none]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14610"><span class="dyncstimp">d0atsrtcon_make_some</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> s0t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0t<span class="keyword">.</span>s0rt_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0atsrtcon_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0atsrtcon_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> d0atsrtcon_arg<span class="keyword">=</span> Some s0t
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0atsrtcom_make_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14738"><span class="dyncstimp">d0atsrtconlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14800"><span class="dyncstimp">d0atsrtconlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15068"><span class="dyncstimp">d0atsrtdec_make</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>id<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8529"><span class="stacstuse">i0de</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14438"><span class="stacstuse">d0atsrtcon</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14701"><span class="stacstuse">d0atsrtconlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons<span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>id<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> x<span class="keyword">.</span>d0atsrtcon_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>id<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> id<span class="keyword">.</span>i0de_loc
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0atsrtdec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0atsrtdec_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> d0atsrtdec_con<span class="keyword">=</span> xs
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0atsrtdec_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15153"><span class="dyncstimp">d0atsrtdeclst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15215"><span class="dyncstimp">d0atsrtdeclst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15518"><span class="dyncstimp">fprint_funclo</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> fc<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> fc <span class="keyword">of</span>
  <span class="keyword">|</span> FUNCLOclo <span class="keyword">(</span>knd<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fprintf_2esats.html#2234"><span class="dyncstuse">fprintf1_exn</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "clo(%i)"<span class="keyword">,</span> <span class="keyword">@(</span>knd<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> FUNCLOfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "fun"<span class="keyword">)</span>
<span class="comment">// end of [fprint_funclo]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15647"><span class="dyncstimp">print_funclo</span></a> <span class="keyword">(</span>fc<span class="keyword">)</span> <span class="keyword">=</span> print_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15518"><span class="dyncstuse">fprint_funclo</span></a><span class="keyword">,</span> fc<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15682"><span class="dyncstimp">prerr_funclo</span></a> <span class="keyword">(</span>fc<span class="keyword">)</span> <span class="keyword">=</span> prerr_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15518"><span class="dyncstuse">fprint_funclo</span></a><span class="keyword">,</span> fc<span class="keyword">)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15718"><span class="dyncstimp">eq_funclo_funclo</span></a> <span class="keyword">(</span>fc1<span class="keyword">,</span> fc2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>fc1<span class="keyword">,</span> fc2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>FUNCLOclo <span class="keyword">(</span>knd1<span class="keyword">)</span><span class="keyword">,</span> FUNCLOclo <span class="keyword">(</span>knd2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>knd1 <span class="keyword">=</span> knd2<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>FUNCLOfun <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> FUNCLOfun <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [eq_funclo_funclo]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16254"><span class="dyncstimp">e0fftag_cst</span></a> <span class="keyword">(</span>i<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> name <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#4322"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_name</span></a> <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  e0fftag_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> e0fftag_node<span class="keyword">=</span> E0FFTAGcst <span class="keyword">(</span>i<span class="keyword">,</span> name<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [e0fftag_cst]
</span>
<span class="keyword">local</span>

<span class="keyword">fn</span> name_is_prf <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> name <span class="keyword">=</span> "prf"

<span class="comment">//
</span>
<span class="keyword">fn</span> name_is_lin0 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> 
  <span class="keyword">if</span> name <span class="keyword">=</span> "lin" <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> name <span class="keyword">=</span> "lin0"
<span class="keyword">fn</span> name_is_lin1 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> name <span class="keyword">=</span> "lin1"

<span class="comment">//
</span>
<span class="keyword">fn</span> name_is_fun0 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> 
  <span class="keyword">if</span> name <span class="keyword">=</span> "fun" <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> name <span class="keyword">=</span> "fun0"
<span class="keyword">fn</span> name_is_fun1 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> name <span class="keyword">=</span> "fun1"

<span class="keyword">fn</span> name_is_linfun0 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> 
  <span class="keyword">if</span> name <span class="keyword">=</span> "linfun" <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> name <span class="keyword">=</span> "linfun0"
<span class="keyword">fn</span> name_is_linfun1 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> name <span class="keyword">=</span> "linfun1"

<span class="comment">//
</span>
<span class="keyword">fn</span> name_is_clo0 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span>
  <span class="keyword">if</span> name <span class="keyword">=</span> "clo" <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> name <span class="keyword">=</span> "clo0"
<span class="keyword">fn</span> name_is_clo1 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> name <span class="keyword">=</span> "clo1"

<span class="keyword">fn</span> name_is_linclo0 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span>
  <span class="keyword">if</span> name <span class="keyword">=</span> "linclo" <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> name <span class="keyword">=</span> "linclo0"
<span class="keyword">fn</span> name_is_linclo1 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> name <span class="keyword">=</span> "linclo1"

<span class="comment">//
</span>
<span class="keyword">fn</span> name_is_cloptr0 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> 
  <span class="keyword">if</span> name <span class="keyword">=</span> "cloptr" <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> name <span class="keyword">=</span> "cloptr0"
<span class="keyword">fn</span> name_is_cloptr1 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> name <span class="keyword">=</span> "cloptr1"

<span class="keyword">fn</span> name_is_lincloptr0 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> 
  <span class="keyword">if</span> name <span class="keyword">=</span> "lincloptr" <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> name <span class="keyword">=</span> "lincloptr0"
<span class="keyword">fn</span> name_is_lincloptr1 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> name <span class="keyword">=</span> "lincloptr1"

<span class="comment">//
</span>
<span class="keyword">fn</span> name_is_cloref0 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> 
  <span class="keyword">if</span> name <span class="keyword">=</span> "cloref" <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> name <span class="keyword">=</span> "cloref0"
<span class="keyword">fn</span> name_is_cloref1 <span class="keyword">(</span>name<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> name <span class="keyword">=</span> "cloref1"

<span class="comment">//
</span>
<span class="keyword">#define</span> <span class="neuexp">CLO 0</span>
<span class="keyword">#define</span> <span class="neuexp">CLOPTR  1</span>
<span class="keyword">#define</span> <span class="neuexp">CLOREF ~1</span>

<span class="keyword">in</span> <span class="comment">// in of [local]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16313"><span class="dyncstimp">e0fftag_var</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> name <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#4322"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_name</span></a> <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
  <span class="keyword">val</span> node <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> name <span class="keyword">of</span>
<span class="comment">//
</span>    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_prf name <span class="keyword">=&gt;</span> E0FFTAGprf
<span class="comment">//
</span>    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_clo0 name <span class="keyword">=&gt;</span> E0FFTAGclo <span class="keyword">(</span>~1<span class="comment">(*u*)</span><span class="keyword">,</span> CLO<span class="keyword">,</span> 0<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_clo1 name <span class="keyword">=&gt;</span> E0FFTAGclo <span class="keyword">(</span>~1<span class="comment">(*u*)</span><span class="keyword">,</span> CLO<span class="keyword">,</span> 1<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_linclo0 name <span class="keyword">=&gt;</span> E0FFTAGclo <span class="keyword">(</span>1<span class="comment">(*l*)</span><span class="keyword">,</span> CLO<span class="keyword">,</span> 0<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_linclo1 name <span class="keyword">=&gt;</span> E0FFTAGclo <span class="keyword">(</span>1<span class="comment">(*l*)</span><span class="keyword">,</span> CLO<span class="keyword">,</span> 1<span class="keyword">)</span>
<span class="comment">//
</span>    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_cloptr0 name <span class="keyword">=&gt;</span> E0FFTAGclo <span class="keyword">(</span>~1<span class="comment">(*u*)</span><span class="keyword">,</span> CLOPTR<span class="keyword">,</span> 0<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_cloptr1 name <span class="keyword">=&gt;</span> E0FFTAGclo <span class="keyword">(</span>~1<span class="comment">(*u*)</span><span class="keyword">,</span> CLOPTR<span class="keyword">,</span> 1<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_lincloptr0 name <span class="keyword">=&gt;</span> E0FFTAGclo <span class="keyword">(</span>1<span class="comment">(*l*)</span><span class="keyword">,</span> CLOPTR<span class="keyword">,</span> 0<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_lincloptr1 name <span class="keyword">=&gt;</span> E0FFTAGclo <span class="keyword">(</span>1<span class="comment">(*l*)</span><span class="keyword">,</span> CLOPTR<span class="keyword">,</span> 1<span class="keyword">)</span>
<span class="comment">//
</span>    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_cloref0 name <span class="keyword">=&gt;</span> E0FFTAGclo <span class="keyword">(</span>0<span class="comment">(*n*)</span><span class="keyword">,</span> CLOREF<span class="keyword">,</span> 0<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_cloref1 name <span class="keyword">=&gt;</span> E0FFTAGclo <span class="keyword">(</span>0<span class="comment">(*n*)</span><span class="keyword">,</span> CLOREF<span class="keyword">,</span> 1<span class="keyword">)</span>
<span class="comment">//
</span>    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_fun0 name <span class="keyword">=&gt;</span> E0FFTAGfun <span class="keyword">(</span>~1<span class="comment">(*u*)</span><span class="keyword">,</span> 0<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_fun1 name <span class="keyword">=&gt;</span> E0FFTAGfun <span class="keyword">(</span>~1<span class="comment">(*u*)</span><span class="keyword">,</span> 1<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_linfun0 name <span class="keyword">=&gt;</span> E0FFTAGfun <span class="keyword">(</span>1<span class="comment">(*l*)</span><span class="keyword">,</span> 0<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_linfun1 name <span class="keyword">=&gt;</span> E0FFTAGfun <span class="keyword">(</span>1<span class="comment">(*l*)</span><span class="keyword">,</span> 1<span class="keyword">)</span>
<span class="comment">//
</span>    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_lin0 name <span class="keyword">=&gt;</span> E0FFTAGlin 0
    <span class="keyword">|</span> _ <span class="keyword">when</span> name_is_lin1 name <span class="keyword">=&gt;</span> E0FFTAGlin 1
<span class="comment">//
</span>    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> E0FFTAGvar id
   <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15833"><span class="stacstuse">e0fftag_node</span></a></span> <span class="comment">// end of [val]
</span><span class="comment">//
</span><span class="keyword">in</span> <span class="keyword">'{</span>
  e0fftag_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> e0fftag_node<span class="keyword">=</span> node
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [e0fftag_var]
</span>
<span class="keyword">end</span> <span class="comment">// end of [local]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16364"><span class="dyncstimp">e0fftag_var_fun</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  e0fftag_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> e0fftag_node<span class="keyword">=</span> E0FFTAGfun <span class="keyword">(</span>~1<span class="comment">(*u*)</span><span class="keyword">,</span> 0<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [e0fftag_var_fun]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16427"><span class="dyncstimp">e0fftag_int</span></a> <span class="keyword">(</span>i<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  e0fftag_loc<span class="keyword">=</span> i<span class="keyword">.</span>i0nt_loc<span class="keyword">,</span> e0fftag_node<span class="keyword">=</span> E0FFTAGcst <span class="keyword">(</span>0<span class="keyword">,</span> i<span class="keyword">.</span>i0nt_val<span class="keyword">)</span>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16514"><span class="dyncstimp">e0fftaglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16567"><span class="dyncstimp">e0fftaglst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16694"><span class="dyncstimp">e0fftaglstopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16760"><span class="dyncstimp">e0fftaglstopt_some</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> Some <span class="keyword">(</span>x<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* static qualifiers *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17278"><span class="dyncstimp">s0taq_make</span></a> 
  <span class="keyword">(</span>loc<span class="keyword">,</span> node<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span> s0taq_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0taq_node<span class="keyword">=</span> node <span class="keyword">}</span>
<span class="comment">// end of [s0taq]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17081"><span class="dyncstimp">fprint_s0taq</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> q<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> q<span class="keyword">.</span>s0taq_node <span class="keyword">of</span>
  <span class="keyword">|</span> S0TAQnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S0TAQfildot fil <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '$'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '"'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> fil<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '"'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '.'<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S0TAQsymcolon id <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id<span class="keyword">)</span><span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ':'<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S0TAQsymcolon]
</span>  <span class="keyword">|</span> S0TAQsymdot id <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id<span class="keyword">)</span><span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '.'<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S0TAQsymdot]
</span><span class="comment">// end of [fprint_s0taq]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17207"><span class="dyncstimp">print_s0taq</span></a> <span class="keyword">(</span>q<span class="keyword">)</span> <span class="keyword">=</span> print_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17081"><span class="dyncstuse">fprint_s0taq</span></a><span class="keyword">,</span> q<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17240"><span class="dyncstimp">prerr_s0taq</span></a> <span class="keyword">(</span>q<span class="keyword">)</span> <span class="keyword">=</span> prerr_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17081"><span class="dyncstuse">fprint_s0taq</span></a><span class="keyword">,</span> q<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17331"><span class="dyncstimp">s0taq_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0taq_loc<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#1761"><span class="dyncstuse">$Loc<span class="keyword">.</span>location_none</span></a><span class="keyword">,</span> s0taq_node<span class="keyword">=</span> S0TAQnone <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [s0taq_node]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17371"><span class="dyncstimp">s0taq_fildot</span></a> <span class="keyword">(</span>fname<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0taq_loc<span class="keyword">=</span> fname<span class="keyword">.</span>s0tring_loc<span class="keyword">,</span> s0taq_node<span class="keyword">=</span> S0TAQfildot <span class="keyword">(</span>fname<span class="keyword">.</span>s0tring_val<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [s0taq_fildot]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17428"><span class="dyncstimp">s0taq_symcolon</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0taq_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0taq_node<span class="keyword">=</span> S0TAQsymcolon <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [s0taq_symcolon]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17484"><span class="dyncstimp">s0taq_symdot</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0taq_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0taq_node<span class="keyword">=</span> S0TAQsymdot <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [s0taq_symdot]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* dynamic qualifiers *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17933"><span class="dyncstimp">fprint_d0ynq</span></a>
  <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> q<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> q<span class="keyword">.</span>d0ynq_node <span class="keyword">of</span>
  <span class="keyword">|</span> D0YNQfildot fil <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '$'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '"'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> fil<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '"'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '.'<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> D0YNQfildot_symcolon <span class="keyword">(</span>fil<span class="keyword">,</span> id_colon<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '$'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '"'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> fil<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '"'<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id_colon<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ':'<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> D0YNQsymcolon id_colon <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id_colon<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ':'<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> D0YNQsymdot id_dot <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id_dot<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '.'<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> D0YNQsymdot_symcolon <span class="keyword">(</span>id_dot<span class="keyword">,</span> id_colon<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id_dot<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5186"><span class="dyncstuse">$Sym<span class="keyword">.</span>fprint_symbol</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> id_colon<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ':'<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> D0YNQnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [fprint_d0ynq]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18058"><span class="dyncstimp">print_d0ynq</span></a> <span class="keyword">(</span>q<span class="keyword">)</span> <span class="keyword">=</span> print_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17933"><span class="dyncstuse">fprint_d0ynq</span></a><span class="keyword">,</span> q<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18123"><span class="dyncstimp">prerr_d0ynq</span></a> <span class="keyword">(</span>q<span class="keyword">)</span> <span class="keyword">=</span> prerr_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17933"><span class="dyncstuse">fprint_d0ynq</span></a><span class="keyword">,</span> q<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18193"><span class="dyncstimp">d0ynq_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0ynq_loc<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#1761"><span class="dyncstuse">$Loc<span class="keyword">.</span>location_none</span></a><span class="keyword">,</span> d0ynq_node<span class="keyword">=</span> D0YNQnone <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18233"><span class="dyncstimp">d0ynq_fildot</span></a> <span class="keyword">(</span>fname<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0ynq_loc<span class="keyword">=</span> fname<span class="keyword">.</span>s0tring_loc<span class="keyword">,</span> d0ynq_node<span class="keyword">=</span> D0YNQfildot <span class="keyword">(</span>fname<span class="keyword">.</span>s0tring_val<span class="keyword">)</span>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18290"><span class="dyncstimp">d0ynq_fildot_symcolon</span></a> <span class="keyword">(</span>fname<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>

<span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>fname<span class="keyword">.</span>s0tring_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span>

<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ynq_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> d0ynq_node<span class="keyword">=</span> D0YNQfildot_symcolon <span class="keyword">(</span>fname<span class="keyword">.</span>s0tring_val<span class="keyword">,</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ynq_fildot_symcolon]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18377"><span class="dyncstimp">d0ynq_symcolon</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> d0ynq_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> d0ynq_node<span class="keyword">=</span> D0YNQsymcolon <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span> <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18433"><span class="dyncstimp">d0ynq_symdot</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> d0ynq_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> d0ynq_node<span class="keyword">=</span> D0YNQsymdot <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span> <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18485"><span class="dyncstimp">d0ynq_symdot_symcolon</span></a> <span class="keyword">(</span>id_dot<span class="keyword">,</span> id_colon<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>

<span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id_dot<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> id_colon<span class="keyword">.</span>i0de_loc<span class="keyword">)</span>

<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ynq_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> d0ynq_node<span class="keyword">=</span> D0YNQsymdot_symcolon <span class="keyword">(</span>id_dot<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> id_colon<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ynq_symdot_symcolon]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* static qualified identifiers *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18830"><span class="dyncstimp">sqi0de_make_some</span></a> <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>q<span class="keyword">.</span>s0taq_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  sqi0de_loc<span class="keyword">=</span> loc<span class="keyword">,</span> sqi0de_qua<span class="keyword">=</span> q<span class="keyword">,</span> sqi0de_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [sqi0de_make_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18769"><span class="dyncstimp">sqi0de_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> q <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#17331"><span class="dyncstuse">s0taq_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">in</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18830"><span class="dyncstuse">sqi0de_make_some</span></a> <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">end</span>

<span class="comment">(* dynamic qualified identifiers *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#19121"><span class="dyncstimp">dqi0de_make_some</span></a> <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>q<span class="keyword">.</span>d0ynq_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span> <span class="keyword">in</span> <span class="keyword">'{</span>
  dqi0de_loc<span class="keyword">=</span> loc<span class="keyword">,</span> dqi0de_qua<span class="keyword">=</span> q<span class="keyword">,</span> dqi0de_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [dqi0de_make_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#19060"><span class="dyncstimp">dqi0de_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">let</span> <span class="keyword">val</span> q <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18193"><span class="dyncstuse">d0ynq_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">in</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#19121"><span class="dyncstuse">dqi0de_make_some</span></a> <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">end</span>
<span class="keyword">end</span> <span class="comment">// end of [dqi0de_make_none]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#19393"><span class="dyncstimp">arrqi0de_make_some</span></a>
  <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  arrqi0de_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc
<span class="keyword">,</span> arrqi0de_qua<span class="keyword">=</span> q<span class="keyword">,</span> arrqi0de_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span> <span class="comment">// end of [arrqi0de_make_some]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#19324"><span class="dyncstimp">arrqi0de_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> q <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18193"><span class="dyncstuse">d0ynq_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">in</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#19393"><span class="dyncstuse">arrqi0de_make_some</span></a> <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">end</span>
<span class="comment">// end of [arrqi0de_make_none]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#19705"><span class="dyncstimp">tmpqi0de_make_some</span></a> <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>q<span class="keyword">.</span>d0ynq_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span> <span class="keyword">in</span> <span class="keyword">'{</span>
  tmpqi0de_loc<span class="keyword">=</span> loc<span class="keyword">,</span> tmpqi0de_qua<span class="keyword">=</span> q<span class="keyword">,</span> tmpqi0de_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [tmpqi0de_make_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#19604"><span class="dyncstimp">tmpqi0de_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> q <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18193"><span class="dyncstuse">d0ynq_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">in</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#19705"><span class="dyncstuse">tmpqi0de_make_some</span></a> <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">end</span>
<span class="comment">// end of [tmpqi0de_make_none]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#19996"><span class="dyncstimp">d0atarg_srt</span></a> <span class="keyword">(</span>s0tp<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> d0atarg_loc<span class="keyword">=</span> s0tp<span class="keyword">.</span>s0rtpol_loc<span class="keyword">,</span> d0atarg_node<span class="keyword">=</span> D0ATARGsrt s0tp <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20050"><span class="dyncstimp">d0atarg_id_srt</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> s0tp<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0tp<span class="keyword">.</span>s0rtpol_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> d0atarg_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0atarg_node<span class="keyword">=</span> D0ATARGidsrt <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> s0tp<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20197"><span class="dyncstimp">d0atarglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20250"><span class="dyncstimp">d0atarglst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20334"><span class="dyncstimp">d0atarglstopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20400"><span class="dyncstimp">d0atarglstopt_some</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> Some <span class="keyword">(</span>x<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20580"><span class="dyncstimp">s0arg_make</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> osrt<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> osrt <span class="keyword">of</span>
    <span class="keyword">|</span> Some srt <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> srt<span class="keyword">.</span>s0rt_loc<span class="keyword">)</span>
    <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> id<span class="keyword">.</span>i0de_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0arg_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0arg_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> s0arg_srt<span class="keyword">=</span> osrt
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0arg_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20640"><span class="dyncstimp">s0arg_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0arg_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0arg_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> s0arg_srt<span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20730"><span class="dyncstimp">s0arglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20777"><span class="dyncstimp">s0arglst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20951"><span class="dyncstimp">s0arglstlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#21007"><span class="dyncstimp">s0arglstlst_cons</span></a> <span class="keyword">(</span>xs<span class="keyword">,</span> xss<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>xs<span class="keyword">,</span> xss<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#21095"><span class="dyncstimp">s0arglstlst_cons_ide</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> xss<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> x <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20640"><span class="dyncstuse">s0arg_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">in</span> cons <span class="keyword">(</span>cons <span class="keyword">(</span>x<span class="keyword">,</span> nil<span class="keyword">)</span><span class="keyword">,</span> xss<span class="keyword">)</span> <span class="keyword">end</span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* static patterns *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#21377"><span class="dyncstimp">sp0at_con</span></a> <span class="keyword">(</span>qid<span class="keyword">,</span> xs<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>qid<span class="keyword">.</span>sqi0de_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  sp0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> sp0at_node<span class="keyword">=</span> SP0Tcon <span class="keyword">(</span>qid<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0pat_con]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">// for handling template ids
</span><span class="keyword">fn</span> gtlt_t1mps0expseqseq_cons_loc <span class="keyword">(</span>
    loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> s0es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23880"><span class="stacstuse">s0explst</span></a></span><span class="keyword">,</span> ts0ess<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23657"><span class="stacstuse">t1mps0explstlst</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23657"><span class="stacstuse">t1mps0explstlst</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux
    <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> s0e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23795"><span class="stacstuse">s0exp</span></a></span><span class="keyword">,</span> s0es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23880"><span class="stacstuse">s0explst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> s0es <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>s0e<span class="keyword">,</span> s0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>loc0<span class="keyword">,</span> s0e<span class="keyword">,</span> s0es<span class="keyword">)</span>
    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>loc0<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux]
</span>  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> s0es <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>s0e<span class="keyword">,</span> s0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>loc0<span class="keyword">,</span> s0e<span class="keyword">,</span> s0es<span class="keyword">)</span>
    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> loc0
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="comment">// end of [val]
</span><span class="keyword">in</span>
  T1MPS0EXPLSTLSTcons <span class="keyword">(</span>loc<span class="keyword">,</span> s0es<span class="keyword">,</span> ts0ess<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [gtlt_t1mps0expseqseq_cons_loc]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27491"><span class="dyncstimp">gtlt_t1mps0expseqseq_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> T1MPS0EXPLSTLSTnil <span class="keyword">(</span><span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27572"><span class="dyncstimp">gtlt_t1mps0expseqseq_cons_tok</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> s0es<span class="keyword">,</span> ts0ess<span class="keyword">)</span> <span class="keyword">=</span>
  gtlt_t1mps0expseqseq_cons_loc <span class="keyword">(</span>t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0es<span class="keyword">,</span> ts0ess<span class="keyword">)</span>
<span class="comment">// end of [gtltt1mps0expseqseq_cons_tok]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* static expressions *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#24367"><span class="dyncstimp">s0exp_ann</span></a> <span class="keyword">(</span>s0e<span class="keyword">,</span> s0t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">,</span> s0t<span class="keyword">.</span>s0rt_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eann <span class="keyword">(</span>s0e<span class="keyword">,</span> s0t<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_ann]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#24423"><span class="dyncstimp">s0exp_app</span></a> <span class="keyword">(</span>s0e_fun<span class="keyword">,</span> s0e_arg<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>s0e_fun<span class="keyword">.</span>s0exp_loc<span class="keyword">,</span> s0e_arg<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eapp <span class="keyword">(</span>s0e_fun<span class="keyword">,</span> s0e_arg<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_app]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#24486"><span class="dyncstimp">s0exp_char</span></a> <span class="keyword">(</span>c<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> c<span class="keyword">.</span>c0har_loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Echar <span class="keyword">(</span>c<span class="keyword">.</span>c0har_val<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [s0exp_char]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#24535"><span class="dyncstimp">s0exp_exi</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> knd<span class="keyword">,</span> s0quas<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eexi <span class="keyword">(</span>knd<span class="comment">(*funres*)</span><span class="keyword">,</span> s0quas<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_exi]
</span>
<span class="comment">(*
** HX-2010-12-05: for handling $extype with arguments
*)</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#24649"><span class="dyncstimp">s0expext_nam</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> name<span class="keyword">)</span> <span class="keyword">=</span> S0EXT <span class="keyword">(</span>t<span class="keyword">,</span> name<span class="keyword">,</span> nil<span class="keyword">)</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#24720"><span class="dyncstimp">s0expext_app</span></a> <span class="keyword">(</span>s0ext<span class="keyword">,</span> s0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val+</span> S0EXT <span class="keyword">(</span>t<span class="keyword">,</span> name<span class="keyword">,</span> s0es<span class="keyword">)</span> <span class="keyword">=</span> s0ext <span class="keyword">in</span> S0EXT <span class="keyword">(</span>t<span class="keyword">,</span> name<span class="keyword">,</span> cons <span class="keyword">(</span>s0e<span class="keyword">,</span> s0es<span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s0expext_app]
</span><span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#24797"><span class="dyncstimp">s0exp_extern</span></a> <span class="keyword">(</span>s0ext<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val+</span> S0EXT <span class="keyword">(</span>t<span class="keyword">,</span> name<span class="keyword">,</span> s0es<span class="keyword">)</span> <span class="keyword">=</span> s0ext
  <span class="keyword">val</span> loc <span class="keyword">=</span> name<span class="keyword">.</span>s0tring_loc
  <span class="keyword">val</span> loc <span class="keyword">=</span> loop <span class="keyword">(</span>loc<span class="keyword">,</span> s0es<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
    <span class="keyword">fun</span> loop <span class="keyword">(</span>loc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> s0es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23880"><span class="stacstuse">s0explst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
      <span class="keyword">case+</span> s0es <span class="keyword">of</span>
      <span class="keyword">|</span> cons <span class="keyword">(</span>s0e<span class="keyword">,</span> s0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> loop <span class="keyword">(</span>s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">,</span> s0es<span class="keyword">)</span>
      <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> loc
    <span class="comment">// end of [loop]
</span>  <span class="keyword">}</span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eextype <span class="keyword">(</span>name<span class="keyword">.</span>s0tring_val<span class="keyword">,</span> s0es<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_extern]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#25012"><span class="dyncstimp">s0exp_ide</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span>  <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eide id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span> <span class="comment">// end of [s0exp_ide]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#25058"><span class="dyncstimp">s0exp_int</span></a> <span class="keyword">(</span>i<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> i<span class="keyword">.</span>i0nt_loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eint i<span class="keyword">.</span>i0nt_val
<span class="keyword">}</span> <span class="comment">// end of [s0exp_int]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#25171"><span class="dyncstimp">s0exp_intsp_err</span></a> <span class="keyword">(</span>i<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> prerr_loc_error0 <span class="keyword">(</span>i<span class="keyword">.</span>i0nt_loc<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> prerr ": the specified integer ["
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> prerr <span class="keyword">(</span>i<span class="keyword">.</span>i0nt_val<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> prerr "] is not allowed in statics."
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23795"><span class="stacstuse">s0exp</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s0exp_intsp_err]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#24857"><span class="dyncstimp">s0exp_imp</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> efs<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eimp efs
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_imp]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#24958"><span class="dyncstimp">s0exp_imp_emp</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eimp <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16514"><span class="dyncstuse">e0fftaglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [s0exp_imp_emp]
</span>
<span class="keyword">fn</span> s0exp_lam <span class="keyword">(</span> <span class="comment">// lam-expression construction
</span>    loc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> arg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20703"><span class="stacstuse">s0arglst</span></a></span><span class="keyword">,</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13232"><span class="stacstuse">s0rtopt</span></a></span><span class="keyword">,</span> body<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23795"><span class="stacstuse">s0exp</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23795"><span class="stacstuse">s0exp</span></a></span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc <span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Elam <span class="keyword">(</span>arg<span class="keyword">,</span> res<span class="keyword">,</span> body<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [s0exp_lam]
</span> 
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#25229"><span class="dyncstimp">s0exp_lams</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> args<span class="keyword">,</span> res<span class="keyword">,</span> body<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> body<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
  <span class="keyword">fun</span> aux
    <span class="keyword">(</span>arg0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20703"><span class="stacstuse">s0arglst</span></a></span><span class="keyword">,</span> args<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20918"><span class="stacstuse">s0arglstlst</span></a></span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloptr1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23795"><span class="stacstuse">s0exp</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> args <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>arg<span class="keyword">,</span> args<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        s0exp_lam <span class="keyword">(</span>loc<span class="keyword">,</span> arg0<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13636"><span class="dyncstuse">s0rtopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> aux <span class="keyword">(</span>arg<span class="keyword">,</span> args<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s0exp_lam <span class="keyword">(</span>loc<span class="keyword">,</span> arg0<span class="keyword">,</span> res<span class="keyword">,</span> body<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">case+</span> args <span class="keyword">of</span>
  <span class="keyword">|</span> cons <span class="keyword">(</span>arg<span class="keyword">,</span> args<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>arg<span class="keyword">,</span> args<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> body
<span class="keyword">end</span> <span class="comment">// end of [s0exp_lams]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#25345"><span class="dyncstimp">s0exp_list</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
  <span class="keyword">'{</span> s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Elist <span class="keyword">(</span>s0es<span class="keyword">)</span> <span class="keyword">}</span>
<span class="keyword">end</span> <span class="comment">// end of [s0exp_list]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#25425"><span class="dyncstimp">s0exp_list2</span></a>
  <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0es1<span class="keyword">,</span> s0es2<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
  <span class="keyword">'{</span> s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Elist2 <span class="keyword">(</span>s0es1<span class="keyword">,</span> s0es2<span class="keyword">)</span> <span class="keyword">}</span>
<span class="keyword">end</span> <span class="comment">// end of [s0exp_list2]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(*
// HX-2010-12-04: inadequate design
implement s0exp_named (ide, s0e) = let
  val loc = combine (ide.i0de_loc, s0e.s0exp_loc)
in '{
  s0exp_loc= loc, s0exp_node= S0Enamed (ide.i0de_sym, s0e)
} end // end of [s0exp_named]
*)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#25675"><span class="dyncstimp">s0exp_opide</span></a> <span class="keyword">(</span>t_op<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_op<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eopide id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_opide]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#25738"><span class="dyncstimp">s0exp_qid</span></a> <span class="keyword">(</span>s0q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>s0q<span class="keyword">.</span>s0taq_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eqid<span class="keyword">(</span>s0q<span class="keyword">,</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_qid]
</span>
<span class="comment">(*
// HX-2010-11-01: simplification
implement
s0exp_struct (t_struct, ls0es, t_end) = let
  val loc = combine (t_struct.t0kn_loc, t_end.t0kn_loc)
in '{
  s0exp_loc= loc, s0exp_node= S0Estruct ls0es
} end // end of [s0exp_struct]
*)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#25927"><span class="dyncstimp">s0exp_tyarr</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> elt<span class="keyword">,</span> ind<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> ind<span class="keyword">.</span>s0arrind_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Etyarr <span class="keyword">(</span>elt<span class="keyword">,</span> ind<span class="keyword">.</span>s0arrind_ind<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_tyarr]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26010"><span class="dyncstimp">s0exp_tyrec</span></a>
  <span class="keyword">(</span>flat<span class="keyword">,</span> t_beg<span class="keyword">,</span> ls0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Etyrec <span class="keyword">(</span>flat<span class="keyword">,</span> ls0es<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_tyrec]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26108"><span class="dyncstimp">s0exp_tyrec_ext</span></a>
  <span class="keyword">(</span>t_beg<span class="keyword">,</span> name<span class="comment">(*s0tring*)</span><span class="keyword">,</span> ls0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Etyrec_ext <span class="keyword">(</span>name<span class="keyword">.</span>s0tring_val<span class="keyword">,</span> ls0es<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_tyrec_ext]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26236"><span class="dyncstimp">s0exp_tytup</span></a>
  <span class="keyword">(</span>flat<span class="keyword">,</span> t_beg<span class="keyword">,</span> s0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Etytup <span class="keyword">(</span>flat<span class="keyword">,</span> s0es<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_tytup]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26330"><span class="dyncstimp">s0exp_tytup2</span></a>
  <span class="keyword">(</span>flat<span class="keyword">,</span> t_beg<span class="keyword">,</span> s0es1<span class="keyword">,</span> s0es2<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Etytup2 <span class="keyword">(</span>flat<span class="keyword">,</span> s0es1<span class="keyword">,</span> s0es2<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_tytup2]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26442"><span class="dyncstimp">s0exp_uni</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0quas<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>  <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Euni <span class="keyword">(</span>s0quas<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_uni]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26522"><span class="dyncstimp">s0exp_union</span></a>
  <span class="keyword">(</span>t_union<span class="keyword">,</span> ind<span class="keyword">,</span> ls0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_union<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0exp_node<span class="keyword">=</span> S0Eunion <span class="keyword">(</span>ind<span class="keyword">,</span> ls0es<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0exp_union]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26645"><span class="dyncstimp">s0explst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26692"><span class="dyncstimp">s0explst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26764"><span class="dyncstimp">s0expopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26813"><span class="dyncstimp">s0expopt_some</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> Some <span class="keyword">(</span>x<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26871"><span class="dyncstimp">s0explstlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26927"><span class="dyncstimp">s0explstlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27016"><span class="dyncstimp">s0explstopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27074"><span class="dyncstimp">s0explstopt_some</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> Some <span class="keyword">(</span>x<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27148"><span class="dyncstimp">labs0explst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> LABS0EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27204"><span class="dyncstimp">labs0explst_cons</span></a> <span class="keyword">(</span>l<span class="keyword">,</span> s0e<span class="keyword">,</span> ls0es<span class="keyword">)</span> <span class="keyword">=</span> LABS0EXPLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> s0e<span class="keyword">,</span> ls0es<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27302"><span class="dyncstimp">s0arrind_make_sing</span></a> <span class="keyword">(</span>s0es<span class="keyword">,</span> t_rbracket<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0arrind_loc<span class="keyword">=</span> t_rbracket<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0arrind_ind<span class="keyword">=</span> cons <span class="keyword">(</span>s0es<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [s0arrind_make_sing]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27394"><span class="dyncstimp">s0arrind_make_cons</span></a> <span class="keyword">(</span>s0es<span class="keyword">,</span> ind<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0arrind_loc<span class="keyword">=</span> ind<span class="keyword">.</span>s0arrind_loc<span class="keyword">,</span> s0arrind_ind<span class="keyword">=</span> cons <span class="keyword">(</span>s0es<span class="keyword">,</span> ind<span class="keyword">.</span>s0arrind_ind<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [s0arrind_make_cons]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27709"><span class="dyncstimp">s0rtext_srt</span></a> <span class="keyword">(</span>s0t<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> s0rtext_loc<span class="keyword">=</span> s0t<span class="keyword">.</span>s0rt_loc<span class="keyword">,</span> s0rtext_node<span class="keyword">=</span> S0TEsrt s0t <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27760"><span class="dyncstimp">s0rtext_sub</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> id<span class="keyword">,</span> s0te<span class="keyword">,</span> s0e<span class="keyword">,</span> s0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> s0rtext_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0rtext_node<span class="keyword">=</span> S0TEsub <span class="keyword">(</span>id<span class="keyword">,</span> s0te<span class="keyword">,</span> s0e<span class="keyword">,</span> s0es<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27891"><span class="dyncstimp">s0qua_prop</span></a> <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0qua_loc<span class="keyword">=</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">,</span> s0qua_node<span class="keyword">=</span> S0QUAprop s0e
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27939"><span class="dyncstimp">s0qua_vars</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> ids<span class="keyword">,</span> s0te<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0te<span class="keyword">.</span>s0rtext_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> s0qua_loc<span class="keyword">=</span> loc<span class="keyword">,</span> s0qua_node<span class="keyword">=</span> S0QUAvars <span class="keyword">(</span>id<span class="keyword">,</span> ids<span class="keyword">,</span> s0te<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#28019"><span class="dyncstimp">s0qualst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#28066"><span class="dyncstimp">s0qualst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#28138"><span class="dyncstimp">s0qualstlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#28194"><span class="dyncstimp">s0qualstlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#28283"><span class="dyncstimp">s0qualstopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#28341"><span class="dyncstimp">s0qualstopt_some</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> Some <span class="keyword">(</span>x<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#28576"><span class="dyncstimp">impqi0de_make_none</span></a> <span class="keyword">(</span>qid<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  impqi0de_loc<span class="keyword">=</span> qid<span class="keyword">.</span>dqi0de_loc
<span class="keyword">,</span> impqi0de_qua<span class="keyword">=</span> qid<span class="keyword">.</span>dqi0de_qua
<span class="keyword">,</span> impqi0de_sym<span class="keyword">=</span> qid<span class="keyword">.</span>dqi0de_sym
<span class="keyword">,</span> impqi0de_arg<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#27491"><span class="dyncstuse">gtlt_t1mps0expseqseq_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [impqi0de_make_none]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#28680"><span class="dyncstimp">impqi0de_make_some</span></a> <span class="keyword">(</span>qid<span class="keyword">,</span> arg<span class="keyword">,</span> args<span class="keyword">,</span> t_gt<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc_qid <span class="keyword">=</span> qid<span class="keyword">.</span>tmpqi0de_loc
  <span class="keyword">val</span> loc_qid_end <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#1952"><span class="dyncstuse">$Loc<span class="keyword">.</span>location_end_make</span></a> loc_qid
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>loc_qid<span class="keyword">,</span> t_gt<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="keyword">val</span> args <span class="keyword">=</span> gtlt_t1mps0expseqseq_cons_loc <span class="keyword">(</span>loc_qid_end<span class="keyword">,</span> arg<span class="keyword">,</span> args<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  impqi0de_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> impqi0de_qua<span class="keyword">=</span> qid<span class="keyword">.</span>tmpqi0de_qua
<span class="keyword">,</span> impqi0de_sym<span class="keyword">=</span> qid<span class="keyword">.</span>tmpqi0de_sym
<span class="keyword">,</span> impqi0de_arg<span class="keyword">=</span> args
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [impqid0de_make_some]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#43016"><span class="dyncstimp">i0nvarg_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  i0nvarg_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc
<span class="keyword">,</span> i0nvarg_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> i0nvarg_typ<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26764"><span class="dyncstuse">s0expopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#43079"><span class="dyncstimp">i0nvarg_make_some</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> s0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  i0nvarg_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> i0nvarg_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> i0nvarg_typ<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26813"><span class="dyncstuse">s0expopt_some</span></a> s0e 
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [i0nvarg_make_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#43153"><span class="dyncstimp">i0nvarglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#43206"><span class="dyncstimp">i0nvarglst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#43405"><span class="dyncstimp">i0nvresstate_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> qua <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#28283"><span class="dyncstuse">s0qualstopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">and</span> arg <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#43153"><span class="dyncstuse">i0nvarglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  i0nvresstate_qua<span class="keyword">=</span> qua<span class="keyword">,</span> i0nvresstate_arg<span class="keyword">=</span> arg
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [i0nvresstate_none]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#43466"><span class="dyncstimp">i0nvresstate_some</span></a> <span class="keyword">(</span>qua<span class="keyword">,</span> arg<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  i0nvresstate_qua<span class="keyword">=</span> qua<span class="keyword">,</span> i0nvresstate_arg<span class="keyword">=</span> arg
<span class="keyword">}</span> <span class="comment">// end of [i0nvresstate_some]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#43760"><span class="dyncstimp">loopi0nv_make</span></a> <span class="keyword">(</span>qua<span class="keyword">,</span> met<span class="keyword">,</span> arg<span class="keyword">,</span> res<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  loopi0nv_qua<span class="keyword">=</span> qua
<span class="keyword">,</span> loopi0nv_met<span class="keyword">=</span> met
<span class="keyword">,</span> loopi0nv_arg<span class="keyword">=</span> arg
<span class="keyword">,</span> loopi0nv_res<span class="keyword">=</span> res
<span class="keyword">}</span> <span class="comment">// end of [loopi0nv_make]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#39122"><span class="dyncstimp">witht0ype_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> WITHT0YPEnone <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#39174"><span class="dyncstimp">witht0ype_prop</span></a> <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=</span> WITHT0YPEprop <span class="keyword">(</span>s0e<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#39234"><span class="dyncstimp">witht0ype_type</span></a> <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=</span> WITHT0YPEtype <span class="keyword">(</span>s0e<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#39294"><span class="dyncstimp">witht0ype_view</span></a> <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=</span> WITHT0YPEview <span class="keyword">(</span>s0e<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#39354"><span class="dyncstimp">witht0ype_viewtype</span></a> <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=</span> WITHT0YPEviewtype <span class="keyword">(</span>s0e<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29238"><span class="dyncstimp">s0rtdef_make</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> def<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">(*
  val () = print "s0rtdef_make:\n"
  val () = begin
    print "def.loc = "; print def.s0rtext_loc; print_newline ()
  end // end of [val]
*)</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> def<span class="keyword">.</span>s0rtext_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0rtdef_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> s0rtdef_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> s0rtdef_def<span class="keyword">=</span> def
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0rtdef_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29335"><span class="dyncstimp">s0rtdeflst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29388"><span class="dyncstimp">s0rtdeflst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29632"><span class="dyncstimp">s0tacon_make_none_none</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0tacon_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc
<span class="keyword">,</span> s0tacon_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> s0tacon_arg<span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">,</span> s0tacon_def<span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29708"><span class="dyncstimp">s0tacon_make_some_none</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> arg<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0tacon_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc
<span class="keyword">,</span> s0tacon_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> s0tacon_arg<span class="keyword">=</span> Some arg
<span class="keyword">,</span> s0tacon_def<span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29801"><span class="dyncstimp">s0tacon_make_none_some</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> def<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> def<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span> <span class="keyword">in</span> <span class="keyword">'{</span>
  s0tacon_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> s0tacon_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> s0tacon_arg<span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">,</span> s0tacon_def<span class="keyword">=</span> Some def
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0tacon_make_none_some]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29889"><span class="dyncstimp">s0tacon_make_some_some</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> arg<span class="keyword">,</span> def<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> def<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span> <span class="keyword">in</span> <span class="keyword">'{</span>
  s0tacon_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> s0tacon_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> s0tacon_arg<span class="keyword">=</span> Some arg
<span class="keyword">,</span> s0tacon_def<span class="keyword">=</span> Some def
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0tacon_make_some_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30029"><span class="dyncstimp">s0taconlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30082"><span class="dyncstimp">s0taconlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30301"><span class="dyncstimp">s0tacst_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> s0t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0t<span class="keyword">.</span>s0rt_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0tacst_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> s0tacst_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> s0tacst_arg<span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">,</span> s0tacst_res<span class="keyword">=</span> s0t
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0tacst_make_none]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30378"><span class="dyncstimp">s0tacst_make_some</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> arg<span class="keyword">,</span> s0t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0t<span class="keyword">.</span>s0rt_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0tacst_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> s0tacst_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> s0tacst_arg<span class="keyword">=</span> Some arg
<span class="keyword">,</span> s0tacst_res<span class="keyword">=</span> s0t
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0tacst_make_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30507"><span class="dyncstimp">s0tacstlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30560"><span class="dyncstimp">s0tacstlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30750"><span class="dyncstimp">s0tavar_make</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> s0t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0t<span class="keyword">.</span>s0rt_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  s0tavar_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> s0tavar_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> s0tavar_srt<span class="keyword">=</span> s0t
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [s0tavar_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30852"><span class="dyncstimp">s0tavarlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30905"><span class="dyncstimp">s0tavarlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31235"><span class="dyncstimp">s0expdef_make</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> arg<span class="keyword">,</span> res<span class="keyword">,</span> def<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>

<span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> def<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>

<span class="keyword">in</span> <span class="keyword">'{</span>
  s0expdef_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> s0expdef_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> s0expdef_loc_id<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc
<span class="keyword">,</span> s0expdef_arg<span class="keyword">=</span> arg
<span class="keyword">,</span> s0expdef_res<span class="keyword">=</span> res
<span class="keyword">,</span> s0expdef_def<span class="keyword">=</span> def
<span class="keyword">}</span> <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31341"><span class="dyncstimp">s0expdeflst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31397"><span class="dyncstimp">s0expdeflst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31672"><span class="dyncstimp">s0aspdec_make</span></a> <span class="keyword">(</span>qid<span class="keyword">,</span> arg<span class="keyword">,</span> res<span class="keyword">,</span> def<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>

<span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>qid<span class="keyword">.</span>sqi0de_loc<span class="keyword">,</span> def<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>

<span class="keyword">in</span> <span class="keyword">'{</span>
  s0aspdec_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> s0aspdec_qid<span class="keyword">=</span> qid
<span class="keyword">,</span> s0aspdec_arg<span class="keyword">=</span> arg
<span class="keyword">,</span> s0aspdec_res<span class="keyword">=</span> res
<span class="keyword">,</span> s0aspdec_def<span class="keyword">=</span> def
<span class="keyword">}</span> <span class="keyword">end</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31963"><span class="dyncstimp">d0atcon_make</span></a> <span class="keyword">(</span>qua<span class="keyword">,</span> id<span class="keyword">,</span> ind<span class="keyword">,</span> arg<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> arg <span class="keyword">of</span>
    <span class="keyword">|</span> Some s0e <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> ind <span class="keyword">of</span>
      <span class="keyword">|</span> Some s0e <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> loc
      <span class="keyword">end</span> <span class="comment">// end of [None]
</span>  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0atcon_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> d0atcon_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> d0atcon_qua<span class="keyword">=</span> qua
<span class="keyword">,</span> d0atcon_arg<span class="keyword">=</span> arg
<span class="keyword">,</span> d0atcon_ind<span class="keyword">=</span> ind
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0atcon_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32104"><span class="dyncstimp">d0atconlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32157"><span class="dyncstimp">d0atconlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">fun</span> d0atdec_make <span class="keyword">(</span>
    id<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8529"><span class="stacstuse">i0de</span></a></span>
  <span class="keyword">,</span> hdloc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
  <span class="keyword">,</span> arg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#20158"><span class="stacstuse">d0atarglstopt</span></a></span>
  <span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32074"><span class="stacstuse">d0atconlst</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32245"><span class="stacstuse">d0atdec</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>

  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>id<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8529"><span class="stacstuse">i0de</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31806"><span class="stacstuse">d0atcon</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32074"><span class="stacstuse">d0atconlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>id<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> x<span class="keyword">.</span>d0atcon_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>
  <span class="keyword">val</span> fil <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ffilename_2esats.html#3958"><span class="dyncstuse">$Fil<span class="keyword">.</span>the_filename_get</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>id<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> id<span class="keyword">.</span>i0de_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0atdec_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> d0atdec_headloc<span class="keyword">=</span> hdloc
<span class="keyword">,</span> d0atdec_fil<span class="keyword">=</span> fil
<span class="keyword">,</span> d0atdec_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> d0atdec_arg<span class="keyword">=</span> arg
<span class="keyword">,</span> d0atdec_con<span class="keyword">=</span> xs
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0atdec_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32433"><span class="dyncstimp">d0atdec_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span>
  d0atdec_make <span class="keyword">(</span>id<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> None <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32516"><span class="dyncstimp">d0atdec_make_some</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> arg<span class="keyword">,</span> tok<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc_id <span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">;</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>loc_id<span class="keyword">,</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
  d0atdec_make <span class="keyword">(</span>id<span class="keyword">,</span> loc<span class="keyword">,</span> Some arg<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [d0atdec_make_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32662"><span class="dyncstimp">d0atdeclst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32715"><span class="dyncstimp">d0atdeclst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> list_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32983"><span class="dyncstimp">e0xndec_make</span></a> <span class="keyword">(</span>qua<span class="keyword">,</span> id<span class="keyword">,</span> arg<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> arg <span class="keyword">of</span>
    <span class="keyword">|</span> Some s0e <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> id<span class="keyword">.</span>i0de_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
  <span class="keyword">val</span> fil <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ffilename_2esats.html#3958"><span class="dyncstuse">$Fil<span class="keyword">.</span>the_filename_get</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  e0xndec_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> e0xndec_fil<span class="keyword">=</span> fil
<span class="keyword">,</span> e0xndec_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> e0xndec_qua<span class="keyword">=</span> qua
<span class="keyword">,</span> e0xndec_arg<span class="keyword">=</span> arg
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [e0xndec_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#33110"><span class="dyncstimp">e0xndeclst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#33163"><span class="dyncstimp">e0xndeclst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> list_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35238"><span class="dyncstimp">p0arg_make_none</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> p0arg_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> p0arg_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> p0arg_ann<span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35295"><span class="dyncstimp">p0arg_make_some</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> s0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  p0arg_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0arg_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> p0arg_ann<span class="keyword">=</span> Some s0e
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [p0arg_make_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35394"><span class="dyncstimp">p0arglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35441"><span class="dyncstimp">p0arglst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> list_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35751"><span class="dyncstimp">d0arg_var</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> arg <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35441"><span class="dyncstuse">p0arglst_cons</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35238"><span class="dyncstuse">p0arg_make_none</span></a> id<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35394"><span class="dyncstuse">p0arglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> d0arg_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> d0arg_node<span class="keyword">=</span> D0ARGdyn arg <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35798"><span class="dyncstimp">d0arg_dyn</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> arg<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> d0arg_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0arg_node<span class="keyword">=</span> D0ARGdyn arg <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35876"><span class="dyncstimp">d0arg_dyn2</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> arg1<span class="keyword">,</span> arg2<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> d0arg_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0arg_node<span class="keyword">=</span> D0ARGdyn2 <span class="keyword">(</span>arg1<span class="keyword">,</span> arg2<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#35973"><span class="dyncstimp">d0arg_sta</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> arg<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> d0arg_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0arg_node<span class="keyword">=</span> D0ARGsta arg <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36082"><span class="dyncstimp">d0arglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36129"><span class="dyncstimp">d0arglst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36285"><span class="dyncstimp">m0acarg_one</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> M0ACARGone <span class="keyword">(</span>x<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36336"><span class="dyncstimp">m0acarg_lst</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> xs<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> M0ACARGlst <span class="keyword">(</span>xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36457"><span class="dyncstimp">m0acarglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36510"><span class="dyncstimp">m0acarglst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36752"><span class="dyncstimp">dcstextdef_is_mac</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> x <span class="keyword">of</span> DCSTEXTDEFsome_mac _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [dcstextdef_is_mac]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36820"><span class="dyncstimp">extnamopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#18767"><span class="dyncstuse">stropt_none</span></a>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36869"><span class="dyncstimp">extnamopt_some</span></a> <span class="keyword">(</span>ext<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">(*
  val () = begin
    print "extnamopt_some: ext = "; print ext.s0tring_val; print_newline ()
  end
*)</span>
<span class="keyword">in</span>
  <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#18824"><span class="dyncstuse">stropt_some</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#4982"><span class="dyncstuse">string1_of_string</span></a> ext<span class="keyword">.</span>s0tring_val<span class="keyword">)</span>
<span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#37172"><span class="dyncstimp">d0cstdec_make</span></a>
  <span class="keyword">(</span>id<span class="keyword">,</span> arg<span class="keyword">,</span> eff<span class="keyword">,</span> res<span class="keyword">,</span> extdef<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> fil <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ffilename_2esats.html#3958"><span class="dyncstuse">$Fil<span class="keyword">.</span>the_filename_get</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> res<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0cstdec_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> d0cstdec_fil<span class="keyword">=</span> fil
<span class="keyword">,</span> d0cstdec_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> d0cstdec_arg<span class="keyword">=</span> arg
<span class="keyword">,</span> d0cstdec_eff<span class="keyword">=</span> eff
<span class="keyword">,</span> d0cstdec_res<span class="keyword">=</span> res
<span class="keyword">,</span> d0cstdec_extdef<span class="keyword">=</span> extdef
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0cstdec_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#37331"><span class="dyncstimp">d0cstdeclst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#37387"><span class="dyncstimp">d0cstdeclst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#38265"><span class="dyncstimp">s0vararg_one</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> S0VARARGone <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#38313"><span class="dyncstimp">s0vararg_all</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> S0VARARGall <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#38361"><span class="dyncstimp">s0vararg_seq</span></a> <span class="keyword">(</span>s0es<span class="keyword">)</span> <span class="keyword">=</span> S0VARARGseq s0es

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(*
** HX: dynamic patterns
*)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40347"><span class="dyncstimp">p0at_ann</span></a> <span class="keyword">(</span>p0t<span class="keyword">,</span> s0e<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>p0t<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tann <span class="keyword">(</span>p0t<span class="keyword">,</span> s0e<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">fn</span> p0at_app <span class="keyword">(</span>p0t_fun<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40202"><span class="stacstuse">p0at</span></a></span><span class="keyword">,</span> p0t_arg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40202"><span class="stacstuse">p0at</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40202"><span class="stacstuse">p0at</span></a></span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>p0t_fun<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> p0t_arg<span class="keyword">.</span>p0at_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tapp <span class="keyword">(</span>p0t_fun<span class="keyword">,</span> p0t_arg<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40399"><span class="dyncstimp">p0at_apps</span></a> <span class="keyword">(</span>p0t_fun<span class="keyword">,</span> p0ts_arg<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> p0ts_arg <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>p0t_arg<span class="keyword">,</span> p0ts_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      <span class="keyword">let</span> <span class="keyword">val</span> p0t_fun <span class="keyword">=</span> p0at_app <span class="keyword">(</span>p0t_fun<span class="keyword">,</span> p0t_arg<span class="keyword">)</span> <span class="keyword">in</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40399"><span class="dyncstuse">p0at_apps</span></a> <span class="keyword">(</span>p0t_fun<span class="keyword">,</span> p0ts_arg<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> p0t_fun

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40461"><span class="dyncstimp">p0at_as</span></a> <span class="keyword">(</span>id<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8529"><span class="stacstuse">i0de</span></a></span><span class="keyword">,</span> p0t<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40202"><span class="stacstuse">p0at</span></a></span><span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> p0t<span class="keyword">.</span>p0at_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tas<span class="keyword">(</span>id<span class="keyword">,</span> p0t<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40511"><span class="dyncstimp">p0at_char</span></a> <span class="keyword">(</span>c<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  p0at_loc<span class="keyword">=</span> c<span class="keyword">.</span>c0har_loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tchar c<span class="keyword">.</span>c0har_val
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40557"><span class="dyncstimp">p0at_exist</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> qua<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Texist qua <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40636"><span class="dyncstimp">p0at_float</span></a> <span class="keyword">(</span>f<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  p0at_loc<span class="keyword">=</span> f<span class="keyword">.</span>f0loat_loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tfloat f<span class="keyword">.</span>f0loat_val
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40685"><span class="dyncstimp">p0at_free</span></a> <span class="keyword">(</span>t_tilda<span class="keyword">,</span> p0t<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_tilda<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> p0t<span class="keyword">.</span>p0at_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tfree p0t <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40745"><span class="dyncstimp">p0at_ide</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  p0at_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tide id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40788"><span class="dyncstimp">p0at_int</span></a> <span class="keyword">(</span>int<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  p0at_loc<span class="keyword">=</span> int<span class="keyword">.</span>i0nt_loc
<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tint <span class="keyword">(</span>int<span class="keyword">.</span>i0nt_val<span class="keyword">)</span>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40831"><span class="dyncstimp">p0at_list</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> p0ts<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tlist <span class="keyword">(</span>p0ts<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40904"><span class="dyncstimp">p0at_list2</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> p0ts1<span class="keyword">,</span> p0ts2<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tlist2 <span class="keyword">(</span>p0ts1<span class="keyword">,</span> p0ts2<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#40996"><span class="dyncstimp">p0at_lst</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> p0ts<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tlst <span class="keyword">(</span>p0ts<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41068"><span class="dyncstimp">p0at_opide</span></a> <span class="keyword">(</span>t_op<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_op<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Topide id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [p0at_opide]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41128"><span class="dyncstimp">p0at_qid</span></a> <span class="keyword">(</span>d0q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>d0q<span class="keyword">.</span>d0ynq_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tqid<span class="keyword">(</span>d0q<span class="keyword">,</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41182"><span class="dyncstimp">p0at_rec</span></a> <span class="keyword">(</span>flat<span class="keyword">,</span> t_beg<span class="keyword">,</span> lp0ts<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Trec <span class="keyword">(</span>flat<span class="keyword">,</span> lp0ts<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41270"><span class="dyncstimp">p0at_ref</span></a> <span class="keyword">(</span>t_bang<span class="keyword">,</span> ide<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_bang<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> ide<span class="keyword">.</span>i0de_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tref ide <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41326"><span class="dyncstimp">p0at_refas</span></a> <span class="keyword">(</span>t_bang<span class="keyword">,</span> ide<span class="keyword">,</span> p0t<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_bang<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> p0t<span class="keyword">.</span>p0at_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Trefas <span class="keyword">(</span>ide<span class="keyword">,</span> p0t<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41396"><span class="dyncstimp">p0at_string</span></a> <span class="keyword">(</span>s<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  p0at_loc<span class="keyword">=</span> s<span class="keyword">.</span>s0tring_loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tstring s<span class="keyword">.</span>s0tring_val
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41448"><span class="dyncstimp">p0at_svararg</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> arg<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Tsvararg arg <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41531"><span class="dyncstimp">p0at_tup</span></a> <span class="keyword">(</span>flat<span class="keyword">,</span> t_beg<span class="keyword">,</span> p0ts<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Ttup <span class="keyword">(</span>flat<span class="keyword">,</span> p0ts<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41615"><span class="dyncstimp">p0at_tup2</span></a> <span class="keyword">(</span>flat<span class="keyword">,</span> t_beg<span class="keyword">,</span> p0ts1<span class="keyword">,</span> p0ts2<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> p0at_loc<span class="keyword">=</span> loc<span class="keyword">,</span> p0at_node<span class="keyword">=</span> P0Ttup2 <span class="keyword">(</span>flat<span class="keyword">,</span> p0ts1<span class="keyword">,</span> p0ts2<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="comment">//
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41718"><span class="dyncstimp">p0atlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41762"><span class="dyncstimp">p0atlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41829"><span class="dyncstimp">p0atopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41875"><span class="dyncstimp">p0atopt_some</span></a> <span class="keyword">(</span>p0t<span class="keyword">)</span> <span class="keyword">=</span> Some p0t

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41929"><span class="dyncstimp">labp0atlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> LABP0ATLSTnil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41982"><span class="dyncstimp">labp0atlst_dot</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> LABP0ATLSTdot <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#42035"><span class="dyncstimp">labp0atlst_cons</span></a> <span class="keyword">(</span>l<span class="keyword">,</span> x<span class="keyword">,</span> lxs<span class="keyword">)</span> <span class="keyword">=</span> LABP0ATLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> x<span class="keyword">,</span> lxs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#42353"><span class="dyncstimp">f0arg_sta1</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0qs<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> f0arg_loc<span class="keyword">=</span> loc<span class="keyword">,</span> f0arg_node<span class="keyword">=</span> F0ARGsta1 s0qs <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#42432"><span class="dyncstimp">f0arg_sta2</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0as<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> f0arg_loc<span class="keyword">=</span> loc<span class="keyword">,</span> f0arg_node<span class="keyword">=</span> F0ARGsta2 s0as <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#42512"><span class="dyncstimp">f0arg_dyn</span></a> <span class="keyword">(</span>p0t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  f0arg_loc<span class="keyword">=</span> p0t<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> f0arg_node<span class="keyword">=</span> F0ARGdyn p0t
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#42558"><span class="dyncstimp">f0arg_met_none</span></a> <span class="keyword">(</span>t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  f0arg_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> f0arg_node<span class="keyword">=</span> F0ARGmet <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26645"><span class="dyncstuse">s0explst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#42613"><span class="dyncstimp">f0arg_met_some</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> 
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> f0arg_loc<span class="keyword">=</span> loc<span class="keyword">,</span> f0arg_node<span class="keyword">=</span> F0ARGmet s0es <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#42734"><span class="dyncstimp">f0arglst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#42781"><span class="dyncstimp">f0arglst_cons</span></a><span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#38608"><span class="dyncstimp">s0exparg_one</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> S0EXPARGone <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#38656"><span class="dyncstimp">s0exparg_all</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> S0EXPARGall <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#38704"><span class="dyncstimp">s0exparg_seq</span></a> <span class="keyword">(</span>s0es<span class="keyword">)</span> <span class="keyword">=</span> S0EXPARGseq s0es

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#38866"><span class="dyncstimp">s0elop_make</span></a> <span class="keyword">(</span>knd<span class="keyword">,</span> t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  s0elop_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0elop_knd<span class="keyword">=</span> knd
<span class="keyword">}</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53240"><span class="dyncstimp">d0exp_ann</span></a> <span class="keyword">(</span>d0e<span class="keyword">,</span> s0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine
    <span class="keyword">(</span>d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eann <span class="keyword">(</span>d0e<span class="keyword">,</span> s0e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_ann]
</span>
<span class="keyword">fn</span> d0exp_app <span class="keyword">(</span>
  d0e_fun<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50540"><span class="stacstuse">d0exp</span></a></span><span class="keyword">,</span> d0e_arg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50540"><span class="stacstuse">d0exp</span></a></span>
<span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50540"><span class="stacstuse">d0exp</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine
    <span class="keyword">(</span>d0e_fun<span class="keyword">.</span>d0exp_loc<span class="keyword">,</span> d0e_arg<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eapp <span class="keyword">(</span>d0e_fun<span class="keyword">,</span> d0e_arg<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_app]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53298"><span class="dyncstimp">d0exp_apps</span></a>
  <span class="keyword">(</span>d0e_fun<span class="keyword">,</span> d0es_arg<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> d0es_arg <span class="keyword">of</span>
  <span class="keyword">|</span> cons <span class="keyword">(</span>d0e_arg<span class="keyword">,</span> d0es_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> d0e_fun <span class="keyword">=</span> d0exp_app <span class="keyword">(</span>d0e_fun<span class="keyword">,</span> d0e_arg<span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53298"><span class="dyncstuse">d0exp_apps</span></a> <span class="keyword">(</span>d0e_fun<span class="keyword">,</span> d0es_arg<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> d0e_fun <span class="comment">// end of [nil]
</span><span class="comment">// end of [d0exp_apps]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53412"><span class="dyncstimp">d0exp_arrinit</span></a> <span class="keyword">(</span>
  t_beg<span class="keyword">,</span> s0e_elt<span class="keyword">,</span> od0e_asz<span class="keyword">,</span> d0es_elt<span class="keyword">,</span> t_end
<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="comment">// checking the syntax for array assignmnet
</span>    <span class="keyword">case+</span> od0e_asz <span class="keyword">of</span>
    <span class="keyword">|</span> Some _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d0es_elt <span class="keyword">of</span>
      <span class="comment">// if the array size if given, the rules for using [d0es_elt] is
</span>      <span class="comment">// given as follows:
</span>      <span class="comment">// 1. if [d0es_elt] is empty, then the array is uninitialized;
</span>      <span class="comment">// 2. if [d0es_elt] contains only one element, then the array is
</span>      <span class="comment">//    initialized with this element.
</span>      <span class="comment">// 3. if [d0es_elt] contains two or more elements, it is illegal
</span>      <span class="keyword">|</span> list_cons <span class="keyword">(</span>_<span class="keyword">,</span> list_cons <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          prerr_loc_error0 <span class="keyword">(</span>loc<span class="keyword">)</span><span class="keyword">;</span>
          prerr ": the syntax for array initialization is incorrect."<span class="keyword">;</span>
          <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [list_cons (_, list_cons)]
</span>      <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// [d0es_elt] contains at most one element
</span>      <span class="keyword">end</span> <span class="comment">// end of [Some]
</span>    <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [val]
</span><span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Earrinit <span class="keyword">(</span>s0e_elt<span class="keyword">,</span> od0e_asz<span class="keyword">,</span> d0es_elt<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_arrinit]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53545"><span class="dyncstimp">d0exp_arrinit_none</span></a>
  <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0e_elt<span class="keyword">,</span> d0es_elt<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53412"><span class="dyncstuse">d0exp_arrinit</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0e_elt<span class="keyword">,</span> None <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> d0es_elt<span class="keyword">,</span> t_end<span class="keyword">)</span>
<span class="comment">// end of [d0exp_arrinit_none]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53671"><span class="dyncstimp">d0exp_arrinit_some</span></a>
  <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0e_elt<span class="keyword">,</span> d0e_asz<span class="keyword">,</span> d0es_elt<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53412"><span class="dyncstuse">d0exp_arrinit</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0e_elt<span class="keyword">,</span> Some d0e_asz<span class="keyword">,</span> d0es_elt<span class="keyword">,</span> t_end<span class="keyword">)</span>
<span class="comment">// end of [d0exp_arrinit_some]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53830"><span class="dyncstimp">d0exp_arrsize</span></a> <span class="keyword">(</span>
  t_beg<span class="keyword">,</span> os0e<span class="keyword">,</span> t_lp<span class="keyword">,</span> d0es<span class="keyword">,</span> t_rp
<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_rp<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="keyword">val</span> d0e_elts <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> d0es <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d0e<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> d0e
    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56490"><span class="dyncstuse">d0exp_list</span></a> <span class="keyword">(</span>t_lp<span class="keyword">,</span> d0es<span class="keyword">,</span> t_rp<span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50540"><span class="stacstuse">d0exp</span></a></span> <span class="comment">// end of [val]
</span><span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Earrsize <span class="keyword">(</span>os0e<span class="keyword">,</span> d0e_elts<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_arrsize]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53970"><span class="dyncstimp">d0exp_arrsub</span></a> <span class="keyword">(</span>qid<span class="keyword">,</span> ind<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc_ind <span class="keyword">=</span> ind<span class="keyword">.</span>d0arrind_loc
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>qid<span class="keyword">.</span>arrqi0de_loc<span class="keyword">,</span> loc_ind<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Earrsub <span class="keyword">(</span>qid<span class="keyword">,</span> loc_ind<span class="keyword">,</span> ind<span class="keyword">.</span>d0arrind_ind<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_arrsub]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#54091"><span class="dyncstimp">d0exp_char</span></a> <span class="keyword">(</span>c<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> c<span class="keyword">.</span>c0har_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Echar c<span class="keyword">.</span>c0har_val
<span class="keyword">}</span> <span class="comment">// end of [d0exp_char]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#54140"><span class="dyncstimp">d0exp_caseof</span></a> <span class="keyword">(</span>hd<span class="keyword">,</span> d0e<span class="keyword">,</span> t_of<span class="keyword">,</span> c0ls<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc <span class="keyword">(</span>
    t_case<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#1896"><span class="stacstuse">t0kn</span></a></span><span class="keyword">,</span> c0l<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51583"><span class="stacstuse">c0lau</span></a></span><span class="keyword">,</span> c0ls<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51719"><span class="stacstuse">c0laulst</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> c0ls <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>c0l<span class="keyword">,</span> c0ls<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>t_case<span class="keyword">,</span> c0l<span class="keyword">,</span> c0ls<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>t_case<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> c0l<span class="keyword">.</span>c0lau_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>  <span class="keyword">val</span> t_case <span class="keyword">=</span> hd<span class="keyword">.</span>casehead_tok<span class="keyword">;</span> <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">case+</span> c0ls <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>c0l<span class="keyword">,</span> c0ls<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>t_case<span class="keyword">,</span> c0l<span class="keyword">,</span> c0ls<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>t_case<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_of<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="comment">// end of [val]
</span><span class="keyword">in</span>
  <span class="keyword">'{</span> d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Ecaseof <span class="keyword">(</span>hd<span class="keyword">,</span> d0e<span class="keyword">,</span> c0ls<span class="keyword">)</span> <span class="keyword">}</span>
<span class="keyword">end</span> <span class="comment">// end of [d0exp_caseof]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#54241"><span class="dyncstimp">d0exp_crypt</span></a> <span class="keyword">(</span>knd<span class="comment">(*de/en*)</span><span class="keyword">,</span> t_crypt<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> t_crypt<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Ecrypt knd
<span class="keyword">}</span> <span class="comment">// end of [d0exp_crypt]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#54307"><span class="dyncstimp">d0exp_decseq</span></a>
  <span class="keyword">(</span>t_lbrace<span class="keyword">,</span> d0cs<span class="keyword">,</span> t_rbrace<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>
    t_lbrace<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_rbrace<span class="keyword">.</span>t0kn_loc
  <span class="keyword">)</span> <span class="comment">// end of [val]
</span><span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Edecseq <span class="keyword">(</span>d0cs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_decseq]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#54402"><span class="dyncstimp">d0exp_delay</span></a> <span class="keyword">(</span>lin<span class="keyword">,</span> t_delay<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> t_delay<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Edelay <span class="keyword">(</span>lin<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_delay]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#54494"><span class="dyncstimp">d0exp_dynload</span></a> <span class="keyword">(</span>t_delay<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> t_delay<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Edynload <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_dynload]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#54875"><span class="dyncstimp">d0exp_empty</span></a> <span class="keyword">(</span>loc<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eempty <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_empty]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#54926"><span class="dyncstimp">d0exp_exist</span></a>
  <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0a<span class="keyword">,</span> t_bar<span class="keyword">,</span> d0e<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="keyword">val</span> qualoc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_bar<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eexist <span class="keyword">(</span>qualoc<span class="keyword">,</span> s0a<span class="keyword">,</span> d0e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_exist]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55042"><span class="dyncstimp">d0exp_extval</span></a>
  <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0e<span class="keyword">,</span> s0tr<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="keyword">val</span> code <span class="keyword">=</span> s0tr<span class="keyword">.</span>s0tring_val
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eextval <span class="keyword">(</span>s0e<span class="keyword">,</span> code<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_extval]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55144"><span class="dyncstimp">d0exp_fix</span></a>
  <span class="keyword">(</span>knd<span class="keyword">,</span> id<span class="keyword">,</span> arg<span class="keyword">,</span> res<span class="keyword">,</span> eff<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc_knd <span class="keyword">=</span> lamkind_loc_get <span class="keyword">(</span>knd<span class="keyword">)</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>loc_knd<span class="keyword">,</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Efix <span class="keyword">(</span>knd<span class="keyword">,</span> id<span class="keyword">,</span> arg<span class="keyword">,</span> res<span class="keyword">,</span> eff<span class="keyword">,</span> d0e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_fix]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55297"><span class="dyncstimp">d0exp_float</span></a> <span class="keyword">(</span>f<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> f<span class="keyword">.</span>f0loat_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Efloat <span class="keyword">(</span>f<span class="keyword">.</span>f0loat_val<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_float]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55348"><span class="dyncstimp">d0exp_floatsp</span></a> <span class="keyword">(</span>f<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> f<span class="keyword">.</span>f0loatsp_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Efloatsp <span class="keyword">(</span>f<span class="keyword">.</span>f0loatsp_val<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_floatsp]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55427"><span class="dyncstimp">d0exp_foldat</span></a> <span class="keyword">(</span>t_foldat<span class="keyword">,</span> d0es<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>d0e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50540"><span class="stacstuse">d0exp</span></a></span><span class="keyword">,</span> d0es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50625"><span class="stacstuse">d0explst</span></a></span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloptr1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> d0es <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d0e<span class="keyword">,</span> d0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>d0e<span class="keyword">,</span> d0es<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>t_foldat<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">case+</span> d0es <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d0e<span class="keyword">,</span> d0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>d0e<span class="keyword">,</span> d0es<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> t_foldat<span class="keyword">.</span>t0kn_loc
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Efoldat d0es
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_foldat]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55526"><span class="dyncstimp">d0exp_for_itp</span></a> <span class="keyword">(</span>hd<span class="keyword">,</span> itp<span class="keyword">,</span> body<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> t_loop <span class="keyword">=</span> hd<span class="keyword">.</span>loophead_tok
  <span class="keyword">val</span> loc_inv <span class="keyword">=</span> t_loop<span class="keyword">.</span>t0kn_loc
  <span class="keyword">val</span> loc <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#2006"><span class="dyncstuse">$Loc<span class="keyword">.</span>location_combine</span></a> <span class="keyword">(</span>loc_inv<span class="keyword">,</span> body<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="comment">(*
  val () = begin
    $Loc.print_location loc; print ": d0exp_for_itp"; print_newline ()
  end // end of [val]
*)</span>
  <span class="keyword">val</span> inv <span class="keyword">=</span> hd<span class="keyword">.</span>loophead_inv
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Efor <span class="keyword">(</span>inv<span class="keyword">,</span> loc_inv<span class="keyword">,</span> itp<span class="keyword">.</span>0<span class="keyword">,</span> itp<span class="keyword">.</span>1<span class="keyword">,</span> itp<span class="keyword">.</span>2<span class="keyword">,</span> body<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d2exp_for_itp]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55621"><span class="dyncstimp">d0exp_freeat</span></a> <span class="keyword">(</span>t_freeat<span class="keyword">,</span> d0es<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>d0e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50540"><span class="stacstuse">d0exp</span></a></span><span class="keyword">,</span> d0es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50625"><span class="stacstuse">d0explst</span></a></span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloptr1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> d0es <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d0e<span class="keyword">,</span> d0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>d0e<span class="keyword">,</span> d0es<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>t_freeat<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">case+</span> d0es <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d0e<span class="keyword">,</span> d0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>d0e<span class="keyword">,</span> d0es<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> t_freeat<span class="keyword">.</span>t0kn_loc
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Efreeat d0es
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_freeat]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55741"><span class="dyncstimp">d0exp_ide</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> sym_id <span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">in</span>
  <span class="keyword">if</span> sym_id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#2430"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_QMARK</span></a> <span class="keyword">then</span> <span class="keyword">begin</span>
    <span class="keyword">'{</span> d0exp_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Etop <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span>
    <span class="keyword">'{</span> d0exp_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eide sym_id <span class="keyword">}</span>
  <span class="keyword">end</span> <span class="comment">// end of [if]
</span><span class="keyword">end</span> <span class="comment">(* end of [d0exp_ide] *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55788"><span class="dyncstimp">d0exp_idext</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eidext <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_i0dext]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55865"><span class="dyncstimp">d0exp_if_none</span></a>
  <span class="keyword">(</span>hd<span class="keyword">,</span> d0e_cond<span class="keyword">,</span> d0e_then<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> t_if <span class="keyword">=</span> hd<span class="keyword">.</span>ifhead_tok
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_if<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0e_then<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eif <span class="keyword">(</span>hd<span class="keyword">,</span> d0e_cond<span class="keyword">,</span> d0e_then<span class="keyword">,</span> None <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_if_none]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#55959"><span class="dyncstimp">d0exp_if_some</span></a> <span class="keyword">(</span>
  hd<span class="keyword">,</span> d0e_cond<span class="keyword">,</span> d0e_then<span class="keyword">,</span> d0e_else
<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> t_if <span class="keyword">=</span> hd<span class="keyword">.</span>ifhead_tok
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_if<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0e_else<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eif <span class="keyword">(</span>hd<span class="keyword">,</span> d0e_cond<span class="keyword">,</span> d0e_then<span class="keyword">,</span> Some d0e_else<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_if_some]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56093"><span class="dyncstimp">d0exp_int</span></a> <span class="keyword">(</span>i<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> i<span class="keyword">.</span>i0nt_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eint <span class="keyword">(</span>i<span class="keyword">.</span>i0nt_val<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_int]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56138"><span class="dyncstimp">d0exp_intsp</span></a> <span class="keyword">(</span>i<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> i<span class="keyword">.</span>i0ntsp_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eintsp <span class="keyword">(</span>i<span class="keyword">.</span>i0ntsp_val<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_intsp]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56211"><span class="dyncstimp">d0exp_lam</span></a>
  <span class="keyword">(</span>knd<span class="keyword">,</span> arg<span class="keyword">,</span> res<span class="keyword">,</span> eff<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc_knd <span class="keyword">=</span> lamkind_loc_get <span class="keyword">(</span>knd<span class="keyword">)</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>loc_knd<span class="keyword">,</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Elam <span class="keyword">(</span>knd<span class="keyword">,</span> arg<span class="keyword">,</span> res<span class="keyword">,</span> eff<span class="keyword">,</span> d0e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_lam]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56351"><span class="dyncstimp">d0exp_let_seq</span></a>
  <span class="keyword">(</span>t_beg<span class="keyword">,</span> d0cs<span class="keyword">,</span> t_in<span class="keyword">,</span> d0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="keyword">val</span> d0e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58231"><span class="dyncstuse">d0exp_seq</span></a> <span class="keyword">(</span>t_in<span class="keyword">,</span> d0es<span class="keyword">,</span> t_end<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Elet <span class="keyword">(</span>d0cs<span class="keyword">,</span> d0e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_let_seq]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56490"><span class="dyncstimp">d0exp_list</span></a>
  <span class="keyword">(</span>t_beg<span class="keyword">,</span> d0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Elist d0es
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_list]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56576"><span class="dyncstimp">d0exp_list2</span></a>
  <span class="keyword">(</span>t_beg<span class="keyword">,</span> d0es1<span class="keyword">,</span> d0es2<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Elist2 <span class="keyword">(</span>d0es1<span class="keyword">,</span> d0es2<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_list2]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56703"><span class="dyncstimp">d0exp_loopexn</span></a> <span class="keyword">(</span>i<span class="keyword">,</span> t<span class="keyword">)</span> <span class="keyword">=</span> 
  <span class="keyword">'{</span> d0exp_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eloopexn i <span class="keyword">}</span>
<span class="comment">// end of [d0exp_loopexn]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56786"><span class="dyncstimp">d0exp_lst</span></a> <span class="keyword">(</span>
  lin<span class="keyword">,</span> t_beg<span class="keyword">,</span> os0e<span class="keyword">,</span> t_lp<span class="keyword">,</span> d0es<span class="keyword">,</span> t_rp
<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_rp<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="keyword">val</span> d0e_elts <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> d0es <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d0e<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> d0e
    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56490"><span class="dyncstuse">d0exp_list</span></a> <span class="keyword">(</span>t_lp<span class="keyword">,</span> d0es<span class="keyword">,</span> t_rp<span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50540"><span class="stacstuse">d0exp</span></a></span> <span class="comment">// end of [val]
</span><span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Elst <span class="keyword">(</span>lin<span class="keyword">,</span> os0e<span class="keyword">,</span> d0e_elts<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_lst]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56909"><span class="dyncstimp">d0exp_lst_quote</span></a> <span class="keyword">(</span>
  t_beg<span class="keyword">,</span> d0es_elt<span class="keyword">,</span> t_end
<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> d0e_elts <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#56490"><span class="dyncstuse">d0exp_list</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> d0es_elt<span class="keyword">,</span> t_end<span class="keyword">)</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> d0e_elts<span class="keyword">.</span>d0exp_loc
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Elst <span class="keyword">(</span>0<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26764"><span class="dyncstuse">s0expopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> d0e_elts<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_lst_quote]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">local</span>

<span class="keyword">fun</span> d0exp_macsyn
  <span class="keyword">(</span>loc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> knd<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5771"><span class="stacstuse">macsynkind</span></a></span><span class="keyword">,</span> d0e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50540"><span class="stacstuse">d0exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50540"><span class="stacstuse">d0exp</span></a></span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Emacsyn <span class="keyword">(</span>knd<span class="keyword">,</span> d0e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_macsyn]
</span>
<span class="keyword">in</span> <span class="comment">// in of [local]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#57026"><span class="dyncstimp">d0exp_macsyn_cross</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> d0e<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span>
  d0exp_macsyn <span class="keyword">(</span>loc<span class="keyword">,</span> MACSYNKINDcross<span class="keyword">,</span> d0e<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [d0exp_macsyn_cross]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#57150"><span class="dyncstimp">d0exp_macsyn_decode</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> d0e<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span>
  d0exp_macsyn <span class="keyword">(</span>loc<span class="keyword">,</span> MACSYNKINDdecode<span class="keyword">,</span> d0e<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [d0exp_macsyn_decode]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#57277"><span class="dyncstimp">d0exp_macsyn_encode_seq</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> d0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> d0e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58231"><span class="dyncstuse">d0exp_seq</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> d0es<span class="keyword">,</span> t_end<span class="keyword">)</span>
<span class="keyword">in</span>
  d0exp_macsyn <span class="keyword">(</span>d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">,</span> MACSYNKINDencode<span class="keyword">,</span> d0e<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [d0exp_macsyn_encode_seq]
</span>
<span class="keyword">end</span> <span class="comment">// end of [local]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#57621"><span class="dyncstimp">d0exp_opide</span></a> <span class="keyword">(</span>t_op<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_op<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eopide id<span class="keyword">.</span>i0de_sym
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_opide]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#57688"><span class="dyncstimp">d0exp_ptrof</span></a> <span class="keyword">(</span>t_amp<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">'{</span> d0exp_loc<span class="keyword">=</span> t_amp<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eptrof <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">}</span>
<span class="comment">// end of [d0exp_ptrof]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#57746"><span class="dyncstimp">d0exp_qid</span></a> <span class="keyword">(</span>d0q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc_q <span class="keyword">=</span> d0q<span class="keyword">.</span>d0ynq_loc <span class="keyword">and</span> loc_id <span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>loc_q<span class="keyword">,</span> loc_id<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eqid<span class="keyword">(</span>d0q<span class="keyword">,</span> id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_qid]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#57809"><span class="dyncstimp">d0exp_raise</span></a> <span class="keyword">(</span>t_raise<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_raise<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eraise <span class="keyword">(</span>d0e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_raise]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#57881"><span class="dyncstimp">d0exp_rec</span></a>
  <span class="keyword">(</span>flat<span class="keyword">,</span> t_beg<span class="keyword">,</span> ld0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Erec <span class="keyword">(</span>flat<span class="keyword">,</span> ld0es<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_rec]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#57983"><span class="dyncstimp">d0exp_scaseof</span></a> <span class="keyword">(</span>hd<span class="keyword">,</span> s0e<span class="keyword">,</span> t_of<span class="keyword">,</span> sc0ls<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc <span class="keyword">(</span>t_case<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#1896"><span class="stacstuse">t0kn</span></a></span><span class="keyword">,</span> sc0l<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51752"><span class="stacstuse">sc0lau</span></a></span><span class="keyword">,</span> sc0ls<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51857"><span class="stacstuse">sc0laulst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> sc0ls <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>sc0l<span class="keyword">,</span> sc0ls<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>t_case<span class="keyword">,</span> sc0l<span class="keyword">,</span> sc0ls<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>t_case<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> sc0l<span class="keyword">.</span>sc0lau_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>  <span class="keyword">val</span> t_case <span class="keyword">=</span> hd<span class="keyword">.</span>casehead_tok
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">case+</span> sc0ls <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>sc0l<span class="keyword">,</span> sc0ls<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>t_case<span class="keyword">,</span> sc0l<span class="keyword">,</span> sc0ls<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>t_case<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_of<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="comment">// end of [val]
</span><span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Escaseof <span class="keyword">(</span>hd<span class="keyword">,</span> s0e<span class="keyword">,</span> sc0ls<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_case]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58092"><span class="dyncstimp">d0exp_sel_lab</span></a> <span class="keyword">(</span>sel<span class="keyword">,</span> lab<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>sel<span class="keyword">.</span>s0elop_loc<span class="keyword">,</span> lab<span class="keyword">.</span>l0ab_loc<span class="keyword">)</span> <span class="keyword">in</span>
    <span class="keyword">'{</span> d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Esel_lab <span class="keyword">(</span>sel<span class="keyword">.</span>s0elop_knd<span class="keyword">,</span> lab<span class="keyword">.</span>l0ab_lab<span class="keyword">)</span> <span class="keyword">}</span>
  <span class="keyword">end</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58156"><span class="dyncstimp">d0exp_sel_ind</span></a> <span class="keyword">(</span>sel<span class="keyword">,</span> ind<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>sel<span class="keyword">.</span>s0elop_loc<span class="keyword">,</span> ind<span class="keyword">.</span>d0arrind_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Esel_ind <span class="keyword">(</span>sel<span class="keyword">.</span>s0elop_knd<span class="keyword">,</span> ind<span class="keyword">.</span>d0arrind_ind<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_sel_ind]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58231"><span class="dyncstimp">d0exp_seq</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> d0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">case+</span> d0es <span class="keyword">of</span>
  <span class="keyword">|</span> cons _ <span class="keyword">=&gt;</span> <span class="keyword">'{</span> d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eseq d0es <span class="keyword">}</span>
  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#54875"><span class="dyncstuse">d0exp_empty</span></a> <span class="keyword">(</span>loc<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [d0exp_seq]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58316"><span class="dyncstimp">d0exp_sexparg</span></a> <span class="keyword">(</span>t_beg<span class="keyword">,</span> s0a<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Esexparg s0a
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_sexparg]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58407"><span class="dyncstimp">d0exp_sif</span></a> <span class="keyword">(</span>hd<span class="keyword">,</span> s0e_cond<span class="keyword">,</span> d0e_then<span class="keyword">,</span> d0e_else<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> t_sif <span class="keyword">=</span> hd<span class="keyword">.</span>ifhead_tok
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_sif<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0e_else<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Esif <span class="keyword">(</span>hd<span class="keyword">,</span> s0e_cond<span class="keyword">,</span> d0e_then<span class="keyword">,</span> d0e_else<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_sif]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58515"><span class="dyncstimp">d0exp_string</span></a> <span class="keyword">(</span>s<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> s<span class="keyword">.</span>s0tring_loc
<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Estring <span class="keyword">(</span>s<span class="keyword">.</span>s0tring_val<span class="keyword">,</span> s<span class="keyword">.</span>s0tring_len<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_string]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58661"><span class="dyncstimp">d0exp_tmpid</span></a> <span class="keyword">(</span>qid<span class="keyword">,</span> arg<span class="keyword">,</span> args<span class="keyword">,</span> t_gt<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc_qid <span class="keyword">=</span> qid<span class="keyword">.</span>tmpqi0de_loc
  <span class="keyword">val</span> loc_qid_end <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#1952"><span class="dyncstuse">$Loc<span class="keyword">.</span>location_end_make</span></a> loc_qid
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>loc_qid<span class="keyword">,</span> t_gt<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="keyword">val</span> args <span class="keyword">=</span> gtlt_t1mps0expseqseq_cons_loc <span class="keyword">(</span>loc_qid_end<span class="keyword">,</span> arg<span class="keyword">,</span> args<span class="keyword">)</span> 
<span class="keyword">in</span>
  <span class="keyword">'{</span> d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Etmpid <span class="keyword">(</span>qid<span class="keyword">,</span> args<span class="keyword">)</span> <span class="keyword">}</span>
<span class="keyword">end</span> <span class="comment">// end of [d0exp_tmpid]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58771"><span class="dyncstimp">d0exp_trywith_seq</span></a> <span class="keyword">(</span>hd<span class="keyword">,</span> d0es<span class="keyword">,</span> t_with<span class="keyword">,</span> c0ls<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>t_try<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#1896"><span class="stacstuse">t0kn</span></a></span><span class="keyword">,</span> c0l<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51583"><span class="stacstuse">c0lau</span></a></span><span class="keyword">,</span> c0ls<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51719"><span class="stacstuse">c0laulst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> c0ls <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>c0l<span class="keyword">,</span> c0ls<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>t_try<span class="keyword">,</span> c0l<span class="keyword">,</span> c0ls<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>t_try<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> c0l<span class="keyword">.</span>c0lau_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>  <span class="keyword">val</span> t_try <span class="keyword">=</span> hd<span class="keyword">.</span>tryhead_tok
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">case+</span> c0ls <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>c0l<span class="keyword">,</span> c0ls<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>t_try<span class="keyword">,</span> c0l<span class="keyword">,</span> c0ls<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>t_try<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_with<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
  <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> d0e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58231"><span class="dyncstuse">d0exp_seq</span></a> <span class="keyword">(</span>t_try<span class="keyword">,</span> d0es<span class="keyword">,</span> t_with<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Etrywith <span class="keyword">(</span>hd<span class="keyword">,</span> d0e<span class="keyword">,</span> c0ls<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_trywith]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58887"><span class="dyncstimp">d0exp_tup</span></a>
  <span class="keyword">(</span>flat<span class="keyword">,</span> t_beg<span class="keyword">,</span> d0es<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Etup <span class="keyword">(</span>flat<span class="keyword">,</span> d0es<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_tup]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58979"><span class="dyncstimp">d0exp_tup2</span></a>
  <span class="keyword">(</span>flat<span class="keyword">,</span> t_beg<span class="keyword">,</span> d0es1<span class="keyword">,</span> d0es2<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_beg<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Etup2 <span class="keyword">(</span>flat<span class="keyword">,</span> d0es1<span class="keyword">,</span> d0es2<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_tup2]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59093"><span class="dyncstimp">d0exp_viewat</span></a> <span class="keyword">(</span>t_viewat<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> t_viewat<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Eviewat <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0exp_viewat]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59152"><span class="dyncstimp">d0exp_where</span></a> <span class="keyword">(</span>d0e<span class="keyword">,</span> d0cs<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Ewhere <span class="keyword">(</span>d0e<span class="keyword">,</span> d0cs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_where]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59235"><span class="dyncstimp">d0exp_while</span></a> <span class="keyword">(</span>hd<span class="keyword">,</span> test<span class="keyword">,</span> body<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> t_loop <span class="keyword">=</span> hd<span class="keyword">.</span>loophead_tok
  <span class="keyword">val</span> loc_inv <span class="keyword">=</span> t_loop<span class="keyword">.</span>t0kn_loc
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>loc_inv<span class="keyword">,</span> body<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
  <span class="keyword">val</span> inv <span class="keyword">=</span> hd<span class="keyword">.</span>loophead_inv
<span class="keyword">in</span> <span class="keyword">'{</span> 
  d0exp_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Ewhile <span class="keyword">(</span>inv<span class="keyword">,</span> loc_inv<span class="keyword">,</span> test<span class="keyword">,</span> body<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0exp_while]
</span>
<span class="comment">// ------ ------
</span>
<span class="comment">(*
** for special constants
*)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59339"><span class="dyncstimp">d0exp_FILENAME</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Ecstsp CSTSPfilename
<span class="keyword">}</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59396"><span class="dyncstimp">d0exp_LOCATION</span></a> <span class="keyword">(</span>tok<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0exp_loc<span class="keyword">=</span> tok<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0exp_node<span class="keyword">=</span> D0Ecstsp CSTSPlocation
<span class="keyword">}</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59475"><span class="dyncstimp">d0explst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59522"><span class="dyncstimp">d0explst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59593"><span class="dyncstimp">d0explst_sing</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59909"><span class="dyncstimp">d0expopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59958"><span class="dyncstimp">d0expopt_some</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> Some <span class="keyword">(</span>x<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59758"><span class="dyncstimp">labd0explst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> LABD0EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59814"><span class="dyncstimp">labd0explst_cons</span></a> <span class="keyword">(</span>l<span class="keyword">,</span> x<span class="keyword">,</span> lxs<span class="keyword">)</span> <span class="keyword">=</span> LABD0EXPLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> x<span class="keyword">,</span> lxs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60016"><span class="dyncstimp">d0explstopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60074"><span class="dyncstimp">d0explstopt_some</span></a> <span class="keyword">(</span>xs<span class="keyword">)</span> <span class="keyword">=</span> Some <span class="keyword">(</span>xs<span class="keyword">)</span>

<span class="comment">// ------ ------
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60149"><span class="dyncstimp">d0arrind_make_sing</span></a> <span class="keyword">(</span>d0es<span class="keyword">,</span> t_rbracket<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0arrind_loc<span class="keyword">=</span> t_rbracket<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0arrind_ind<span class="keyword">=</span> cons <span class="keyword">(</span>d0es<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0arrind_make_sing]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60242"><span class="dyncstimp">d0arrind_make_cons</span></a> <span class="keyword">(</span>d0es<span class="keyword">,</span> ind<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0arrind_loc<span class="keyword">=</span> ind<span class="keyword">.</span>d0arrind_loc<span class="keyword">,</span> d0arrind_ind<span class="keyword">=</span> cons <span class="keyword">(</span>d0es<span class="keyword">,</span> ind<span class="keyword">.</span>d0arrind_ind<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0arrind_make_cons]
</span>
<span class="comment">// ------ ------
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60337"><span class="dyncstimp">initestpost_make</span></a>
  <span class="keyword">(</span>t1<span class="keyword">,</span> d0es_ini<span class="keyword">,</span> t2<span class="keyword">,</span> d0es_test<span class="keyword">,</span> t3<span class="keyword">,</span> d0es_post<span class="keyword">,</span> t4<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> d0e_ini <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58231"><span class="dyncstuse">d0exp_seq</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> d0es_ini<span class="keyword">,</span> t2<span class="keyword">)</span>
  <span class="keyword">val</span> d0e_test <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58231"><span class="dyncstuse">d0exp_seq</span></a> <span class="keyword">(</span>t2<span class="keyword">,</span> d0es_test<span class="keyword">,</span> t3<span class="keyword">)</span>
  <span class="keyword">val</span> d0e_post <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#58231"><span class="dyncstuse">d0exp_seq</span></a> <span class="keyword">(</span>t3<span class="keyword">,</span> d0es_post<span class="keyword">,</span> t4<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">'(</span>d0e_ini<span class="keyword">,</span> d0e_test<span class="keyword">,</span> d0e_post<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [initestpost_make]
</span>
<span class="comment">// ------ ------
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60510"><span class="dyncstimp">m0atch_make_none</span></a> <span class="keyword">(</span>d0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  m0atch_loc<span class="keyword">=</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">,</span> m0atch_exp<span class="keyword">=</span> d0e<span class="keyword">,</span> m0atch_pat<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41829"><span class="dyncstuse">p0atopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [m0atch_make_none]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60573"><span class="dyncstimp">m0atch_make_some</span></a> <span class="keyword">(</span>d0e<span class="keyword">,</span> p0t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">,</span> p0t<span class="keyword">.</span>p0at_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  m0atch_loc<span class="keyword">=</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">,</span> m0atch_exp<span class="keyword">=</span> d0e<span class="keyword">,</span> m0atch_pat<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#41875"><span class="dyncstuse">p0atopt_some</span></a> p0t
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [m0atch_make_some]
</span>
<span class="comment">// ------ ------
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60647"><span class="dyncstimp">m0atchlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60697"><span class="dyncstimp">m0atchlst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">// ------ ------
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60777"><span class="dyncstimp">guap0at_make_none</span></a> <span class="keyword">(</span>p0t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  guap0at_loc<span class="keyword">=</span> p0t<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> guap0at_pat<span class="keyword">=</span> p0t<span class="keyword">,</span> guap0at_gua<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60647"><span class="dyncstuse">m0atchlst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [guap0at_make_none]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60845"><span class="dyncstimp">guap0at_make_some</span></a> <span class="keyword">(</span>p0t<span class="keyword">,</span> m0ats<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> aux1 <span class="keyword">(</span>p0t<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> m0ats<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
    <span class="keyword">fun</span> aux1 <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> m0ats<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51003"><span class="stacstuse">m0atchlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
      <span class="keyword">case+</span> m0ats <span class="keyword">of</span>
      <span class="keyword">|</span> list_cons <span class="keyword">(</span>m0at<span class="keyword">,</span> m0ats<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2 <span class="keyword">(</span>loc0<span class="keyword">,</span> m0at<span class="keyword">,</span> m0ats<span class="keyword">)</span>
      <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> loc0
    <span class="keyword">and</span> aux2
      <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> m0at<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50924"><span class="stacstuse">m0atch</span></a></span><span class="keyword">,</span> m0ats<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51003"><span class="stacstuse">m0atchlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
      <span class="keyword">case+</span> m0ats <span class="keyword">of</span>
      <span class="keyword">|</span> list_cons <span class="keyword">(</span>m0at<span class="keyword">,</span> m0ats<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2 <span class="keyword">(</span>loc0<span class="keyword">,</span> m0at<span class="keyword">,</span> m0ats<span class="keyword">)</span>
      <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>loc0<span class="keyword">,</span> m0at<span class="keyword">.</span>m0atch_loc<span class="keyword">)</span>
  <span class="keyword">}</span> <span class="comment">// end of [where]
</span><span class="keyword">in</span> <span class="keyword">'{</span>
  guap0at_loc<span class="keyword">=</span> p0t<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> guap0at_pat<span class="keyword">=</span> p0t<span class="keyword">,</span> guap0at_gua<span class="keyword">=</span> m0ats
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [guap0at_make_some]
</span>
<span class="comment">// ------ ------
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#60935"><span class="dyncstimp">ifhead_make</span></a>
  <span class="keyword">(</span>t_if<span class="keyword">,</span> inv<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span> ifhead_tok<span class="keyword">=</span> t_if<span class="keyword">,</span> ifhead_inv<span class="keyword">=</span> inv <span class="keyword">}</span>
<span class="comment">// end of [ifhead_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61010"><span class="dyncstimp">casehead_make</span></a> <span class="keyword">(</span>k<span class="keyword">,</span> t_case<span class="keyword">,</span> inv<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  casehead_tok<span class="keyword">=</span> t_case<span class="keyword">,</span> casehead_knd<span class="keyword">=</span> k<span class="keyword">,</span> casehead_inv<span class="keyword">=</span> inv
<span class="keyword">}</span> <span class="comment">// end of [casehead_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61101"><span class="dyncstimp">loophead_make_none</span></a> <span class="keyword">(</span>t_loop<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  loophead_tok<span class="keyword">=</span> t_loop<span class="keyword">,</span> loophead_inv<span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [loophead_make_none]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61174"><span class="dyncstimp">loophead_make_some</span></a> <span class="keyword">(</span>t_loop<span class="keyword">,</span> inv<span class="keyword">,</span> t_eqgt<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_loop<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_eqgt<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  loophead_tok<span class="keyword">=</span> t_loop<span class="keyword">,</span> loophead_inv<span class="keyword">=</span> Some inv
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [loophead_make_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61277"><span class="dyncstimp">tryhead_make</span></a> <span class="keyword">(</span>t_try<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  tryhead_tok<span class="keyword">=</span> t_try<span class="keyword">,</span> tryhead_inv<span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#43405"><span class="dyncstuse">i0nvresstate_none</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [tryhead_make]
</span>
<span class="comment">// ------ ------
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61356"><span class="dyncstimp">c0lau_make</span></a> <span class="keyword">(</span>gp0t<span class="keyword">,</span> seq<span class="keyword">,</span> neg<span class="keyword">,</span> body<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>gp0t<span class="keyword">.</span>guap0at_loc<span class="keyword">,</span> body<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  c0lau_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> c0lau_pat<span class="keyword">=</span> gp0t
<span class="keyword">,</span> c0lau_seq<span class="keyword">=</span> seq
<span class="keyword">,</span> c0lau_neg<span class="keyword">=</span> neg
<span class="keyword">,</span> c0lau_body<span class="keyword">=</span> body
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [c0lau_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61451"><span class="dyncstimp">c0laulst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61498"><span class="dyncstimp">c0laulst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">// ------ ------
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61572"><span class="dyncstimp">sc0lau_make</span></a> <span class="keyword">(</span>sp0t<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>sp0t<span class="keyword">.</span>sp0at_loc<span class="keyword">,</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  sc0lau_loc<span class="keyword">=</span> loc<span class="keyword">,</span> sc0lau_pat<span class="keyword">=</span> sp0t<span class="keyword">,</span> sc0lau_body<span class="keyword">=</span> d0e
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [sc0lau_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61641"><span class="dyncstimp">sc0laulst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61691"><span class="dyncstimp">sc0laulst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61791"><span class="dyncstimp">v0aldec_make</span></a> <span class="keyword">(</span>p0t<span class="keyword">,</span> def<span class="keyword">,</span> ann<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> ann <span class="keyword">of</span>
    <span class="keyword">|</span> WITHT0YPEnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
      combine <span class="keyword">(</span>p0t<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> def<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> WITHT0YPEprop <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      combine <span class="keyword">(</span>p0t<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> WITHT0YPEtype <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      combine <span class="keyword">(</span>p0t<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> WITHT0YPEview <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      combine <span class="keyword">(</span>p0t<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> WITHT0YPEviewtype <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      combine <span class="keyword">(</span>p0t<span class="keyword">.</span>p0at_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  v0aldec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> v0aldec_pat<span class="keyword">=</span> p0t<span class="keyword">,</span> v0aldec_def<span class="keyword">=</span> def<span class="keyword">,</span> v0aldec_ann<span class="keyword">=</span> ann
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [v0aldec_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61879"><span class="dyncstimp">v0aldeclst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#61932"><span class="dyncstimp">v0aldeclst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> f0undec_make <span class="keyword">(</span>
    id<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8529"><span class="stacstuse">i0de</span></a></span>
  <span class="keyword">,</span> arg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#42707"><span class="stacstuse">f0arglst</span></a></span>
  <span class="keyword">,</span> eff<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16655"><span class="stacstuse">e0fftaglstopt</span></a></span>
  <span class="keyword">,</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23912"><span class="stacstuse">s0expopt</span></a></span>
  <span class="keyword">,</span> def<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50540"><span class="stacstuse">d0exp</span></a></span>
  <span class="keyword">,</span> ann<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#38953"><span class="stacstuse">witht0ype</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52104"><span class="stacstuse">f0undec</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>

  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">case+</span> ann <span class="keyword">of</span>
    <span class="keyword">|</span> WITHT0YPEnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
      combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> def<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> WITHT0YPEprop <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> WITHT0YPEtype <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> WITHT0YPEview <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> WITHT0YPEviewtype <span class="keyword">(</span>s0e<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  f0undec_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> f0undec_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> f0undec_sym_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc
<span class="keyword">,</span> f0undec_arg<span class="keyword">=</span> arg
<span class="keyword">,</span> f0undec_eff<span class="keyword">=</span> eff
<span class="keyword">,</span> f0undec_res<span class="keyword">=</span> res
<span class="keyword">,</span> f0undec_def<span class="keyword">=</span> def
<span class="keyword">,</span> f0undec_ann<span class="keyword">=</span> ann
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [f0undec_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62037"><span class="dyncstimp">f0undec_make_none</span></a>
  <span class="keyword">(</span>id<span class="keyword">,</span> arg<span class="keyword">,</span> def<span class="keyword">,</span> ann<span class="keyword">)</span> <span class="keyword">=</span> f0undec_make <span class="keyword">(</span>
  id<span class="keyword">,</span> arg<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#16694"><span class="dyncstuse">e0fftaglstopt_none</span></a><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26764"><span class="dyncstuse">s0expopt_none</span></a><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> def<span class="keyword">,</span> ann
<span class="keyword">)</span> <span class="comment">// end of [f0undec_make_none]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62149"><span class="dyncstimp">f0undec_make_some</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> arg<span class="keyword">,</span> eff<span class="keyword">,</span> res<span class="keyword">,</span> def<span class="keyword">,</span> ann<span class="keyword">)</span> <span class="keyword">=</span>
  f0undec_make <span class="keyword">(</span>id<span class="keyword">,</span> arg<span class="keyword">,</span> eff<span class="keyword">,</span> Some res<span class="keyword">,</span> def<span class="keyword">,</span> ann<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62308"><span class="dyncstimp">f0undeclst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62361"><span class="dyncstimp">f0undeclst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62466"><span class="dyncstimp">v0arwth_none</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62512"><span class="dyncstimp">v0arwth_some</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> Some <span class="keyword">(</span>id<span class="keyword">)</span>

<span class="keyword">fn</span> v0ardec_make <span class="keyword">(</span>
    loc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
  <span class="keyword">,</span> knd<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
  <span class="keyword">,</span> id<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8529"><span class="stacstuse">i0de</span></a></span>
  <span class="keyword">,</span> typ<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#23912"><span class="stacstuse">s0expopt</span></a></span>
  <span class="keyword">,</span> wth<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8687"><span class="stacstuse">i0deopt</span></a></span>
  <span class="keyword">,</span> ini<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#50657"><span class="stacstuse">d0expopt</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52386"><span class="stacstuse">v0ardec</span></a></span> <span class="keyword">=</span> <span class="keyword">'{</span>
  v0ardec_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> v0ardec_knd<span class="keyword">=</span> knd
<span class="keyword">,</span> v0ardec_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> v0ardec_sym_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc
<span class="keyword">,</span> v0ardec_typ<span class="keyword">=</span> typ
<span class="keyword">,</span> v0ardec_wth<span class="keyword">=</span> wth
<span class="keyword">,</span> v0ardec_ini<span class="keyword">=</span> ini
<span class="keyword">}</span> <span class="comment">// end of [v0ardec_make]
</span> 
<span class="keyword">implement</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62682"><span class="dyncstimp">v0ardec_make_some_none</span></a> <span class="keyword">(</span>stadyn<span class="keyword">,</span> id<span class="keyword">,</span> s0e<span class="keyword">,</span> wth<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span>
  v0ardec_make <span class="keyword">(</span>
    loc<span class="keyword">,</span> stadyn<span class="keyword">,</span> id<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26813"><span class="dyncstuse">s0expopt_some</span></a> s0e<span class="keyword">,</span> wth<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59909"><span class="dyncstuse">d0expopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">)</span> <span class="comment">// end of [v0ardec_make]
</span><span class="keyword">end</span> <span class="comment">// end of [v0ardec_make_some_none]
</span>
<span class="keyword">implement</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62567"><span class="dyncstimp">v0ardec_make_none_some</span></a> <span class="keyword">(</span>stadyn<span class="keyword">,</span> id<span class="keyword">,</span> wth<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span>
  v0ardec_make <span class="keyword">(</span>
    loc<span class="keyword">,</span> stadyn<span class="keyword">,</span> id<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26764"><span class="dyncstuse">s0expopt_none</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> wth<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59958"><span class="dyncstuse">d0expopt_some</span></a> d0e
  <span class="keyword">)</span> <span class="comment">// end of [v0ardec_make]
</span><span class="keyword">end</span> <span class="comment">// end of [v0ardec_make_none_some]
</span>
<span class="keyword">implement</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62797"><span class="dyncstimp">v0ardec_make_some_some</span></a> <span class="keyword">(</span>stadyn<span class="keyword">,</span> id<span class="keyword">,</span> s0e<span class="keyword">,</span> wth<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span>
  v0ardec_make <span class="keyword">(</span>
    loc<span class="keyword">,</span> stadyn<span class="keyword">,</span> id<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#26813"><span class="dyncstuse">s0expopt_some</span></a> s0e<span class="keyword">,</span> wth<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#59958"><span class="dyncstuse">d0expopt_some</span></a> d0e
  <span class="keyword">)</span> <span class="comment">// end of [v0ardec_make]
</span><span class="keyword">end</span> <span class="comment">// end of [v0ardec_make_some_some]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62924"><span class="dyncstimp">v0ardeclst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#62977"><span class="dyncstimp">v0ardeclst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63082"><span class="dyncstimp">m0acdef_make</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> arg<span class="keyword">,</span> def<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> def<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  m0acdef_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> m0acdef_sym<span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
<span class="keyword">,</span> m0acdef_arg<span class="keyword">=</span> arg
<span class="keyword">,</span> m0acdef_def<span class="keyword">=</span> def
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [m0acdef_make]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63170"><span class="dyncstimp">m0acdeflst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63223"><span class="dyncstimp">m0acdeflst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63328"><span class="dyncstimp">i0mpdec_make</span></a> <span class="keyword">(</span>qid<span class="keyword">,</span> arg<span class="keyword">,</span> res<span class="keyword">,</span> def<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>qid<span class="keyword">.</span>impqi0de_loc<span class="keyword">,</span> def<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  i0mpdec_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> i0mpdec_qid<span class="keyword">=</span> qid
<span class="keyword">,</span> i0mpdec_arg<span class="keyword">=</span> arg
<span class="keyword">,</span> i0mpdec_res<span class="keyword">=</span> res
<span class="keyword">,</span> i0mpdec_def<span class="keyword">=</span> def
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [i0mpdec_make]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* declarations *)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">local</span>

<span class="keyword">fun</span> aux1_loc
  <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> id<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8529"><span class="stacstuse">i0de</span></a></span><span class="keyword">,</span> ids<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8624"><span class="stacstuse">i0delst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> ids <span class="keyword">of</span>
  <span class="keyword">|</span> cons <span class="keyword">(</span>id<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux1_loc <span class="keyword">(</span>loc0<span class="keyword">,</span> id<span class="keyword">,</span> ids<span class="keyword">)</span>
  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>loc0<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span>
<span class="comment">// end of [aux1_loc]
</span>
<span class="keyword">fun</span> aux2_loc <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> ids<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8624"><span class="stacstuse">i0delst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> ids <span class="keyword">of</span>
  <span class="keyword">|</span> cons <span class="keyword">(</span>id<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux1_loc <span class="keyword">(</span>loc0<span class="keyword">,</span> id<span class="keyword">,</span> ids<span class="keyword">)</span>
  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> loc0
<span class="comment">// end of [aux2_loc]
</span>
<span class="keyword">in</span> <span class="comment">// in of [local]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63611"><span class="dyncstimp">d0ec_infix</span></a> <span class="keyword">(</span>t_infix<span class="keyword">,</span> p<span class="keyword">,</span> i<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> aux2_loc <span class="keyword">(</span>t_infix<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> ids<span class="keyword">)</span>
  <span class="keyword">val</span> assoc <span class="keyword">=</span> <span class="keyword">case+</span> i <span class="keyword">of</span> 
    <span class="keyword">|</span> ~1 <span class="keyword">=&gt;</span> $Fix<span class="keyword">.</span>ASSOClft
    <span class="keyword">|</span>  1 <span class="keyword">=&gt;</span> $Fix<span class="keyword">.</span>ASSOCrgt
    <span class="keyword">|</span>  _ <span class="comment">(*0*)</span> <span class="keyword">=&gt;</span> $Fix<span class="keyword">.</span>ASSOCnon
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc
<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cfixity<span class="keyword">(</span>F0XTYinf <span class="keyword">(</span>p<span class="keyword">,</span> assoc<span class="keyword">)</span><span class="keyword">,</span> ids<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_infix]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63690"><span class="dyncstimp">d0ec_prefix</span></a> <span class="keyword">(</span>t_prefix<span class="keyword">,</span> p<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> aux2_loc <span class="keyword">(</span>t_prefix<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> ids<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cfixity<span class="keyword">(</span>F0XTYpre p<span class="keyword">,</span> ids<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_prefix]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63762"><span class="dyncstimp">d0ec_postfix</span></a> <span class="keyword">(</span>t_postfix<span class="keyword">,</span> p<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> aux2_loc <span class="keyword">(</span>t_postfix<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> ids<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cfixity<span class="keyword">(</span>F0XTYpos p<span class="keyword">,</span> ids<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_postfix]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63836"><span class="dyncstimp">d0ec_nonfix</span></a> <span class="keyword">(</span>t_nonfix<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> aux2_loc <span class="keyword">(</span>t_nonfix<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> ids<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> t_nonfix<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cnonfix ids
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_nonfix]
</span>
<span class="keyword">end</span> <span class="comment">// end of [local]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63899"><span class="dyncstimp">d0ec_include</span></a> <span class="keyword">(</span>stadyn<span class="keyword">,</span> s<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> s<span class="keyword">.</span>s0tring_loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cinclude <span class="keyword">(</span>stadyn<span class="keyword">,</span> s<span class="keyword">.</span>s0tring_val<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0ec_include]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63969"><span class="dyncstimp">d0ec_symintr</span></a> <span class="keyword">(</span>t_symintr<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> t_symintr<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Csymintr ids
<span class="keyword">}</span> <span class="comment">// end of [d0ec_symintr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64034"><span class="dyncstimp">d0ec_e0xpundef</span></a> <span class="keyword">(</span>id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Ce0xpundef <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0ec_e0xpundef]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64089"><span class="dyncstimp">d0ec_e0xpdef</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> oe<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> oe <span class="keyword">of</span>
    <span class="keyword">|</span> Some e <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> e<span class="keyword">.</span>e0xp_loc<span class="keyword">)</span>
    <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> id<span class="keyword">.</span>i0de_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="comment">// end of [val]
</span><span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Ce0xpdef <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> oe<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_e0xpdef]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64155"><span class="dyncstimp">d0ec_e0xpact_assert</span></a> <span class="keyword">(</span>e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> e<span class="keyword">.</span>e0xp_loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Ce0xpact <span class="keyword">(</span>E0XPACTassert<span class="keyword">,</span> e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0ec_e0xpact_assert]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64219"><span class="dyncstimp">d0ec_e0xpact_error</span></a> <span class="keyword">(</span>e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> e<span class="keyword">.</span>e0xp_loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Ce0xpact <span class="keyword">(</span>E0XPACTerror<span class="keyword">,</span> e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0ec_e0xpact_error]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64281"><span class="dyncstimp">d0ec_e0xpact_print</span></a> <span class="keyword">(</span>e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> e<span class="keyword">.</span>e0xp_loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Ce0xpact <span class="keyword">(</span>E0XPACTprint<span class="keyword">,</span> e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0ec_e0xpact_print]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64435"><span class="dyncstimp">d0ec_srtdefs</span></a> <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29098"><span class="stacstuse">s0rtdef</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29098"><span class="stacstuse">s0rtdef</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29207"><span class="stacstuse">s0rtdeflst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>s0rtdef_loc<span class="keyword">,</span> x<span class="keyword">.</span>s0rtdef_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>s0rtdef_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Csrtdefs <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_srtdefs]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64344"><span class="dyncstimp">d0ec_datsrts</span></a> <span class="keyword">(</span>para<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14924"><span class="stacstuse">d0atsrtdec</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#14924"><span class="stacstuse">d0atsrtdec</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15031"><span class="stacstuse">d0atsrtdeclst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>d0atsrtdec_loc<span class="keyword">,</span> x<span class="keyword">.</span>d0atsrtdec_loc<span class="keyword">)</span>

  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>d0atsrtdec_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cdatsrts<span class="keyword">(</span>para<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_datsrts]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64505"><span class="dyncstimp">d0ec_stacons</span></a> <span class="keyword">(</span>k<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29497"><span class="stacstuse">s0tacon</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29497"><span class="stacstuse">s0tacon</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#29999"><span class="stacstuse">s0taconlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>s0tacon_loc<span class="keyword">,</span> x<span class="keyword">.</span>s0tacon_loc<span class="keyword">)</span>

  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>s0tacon_loc
<span class="keyword">in</span>
  <span class="keyword">'{</span> d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cstacons <span class="keyword">(</span>k<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">}</span>
<span class="keyword">end</span> <span class="comment">// end of [d0ec_stacons]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64589"><span class="dyncstimp">d0ec_stacsts</span></a> <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30170"><span class="stacstuse">s0tacst</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30170"><span class="stacstuse">s0tacst</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30477"><span class="stacstuse">s0tacstlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>s0tacst_loc<span class="keyword">,</span> x<span class="keyword">.</span>s0tacst_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>s0tacst_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>

<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cstacsts <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_stacsts]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64659"><span class="dyncstimp">d0ec_stavars</span></a> <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30648"><span class="stacstuse">s0tavar</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30648"><span class="stacstuse">s0tavar</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#30822"><span class="stacstuse">s0tavarlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>s0tavar_loc<span class="keyword">,</span> x<span class="keyword">.</span>s0tavar_loc<span class="keyword">)</span>

  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>s0tavar_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>

<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cstavars <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_stavars]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> d0ec_sexpdefs_main
  <span class="keyword">(</span>srt<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13232"><span class="stacstuse">s0rtopt</span></a></span><span class="keyword">,</span> x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31014"><span class="stacstuse">s0expdef</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31202"><span class="stacstuse">s0expdeflst</span></a></span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31014"><span class="stacstuse">s0expdef</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31014"><span class="stacstuse">s0expdef</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31202"><span class="stacstuse">s0expdeflst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>s0expdef_loc<span class="keyword">,</span> x<span class="keyword">.</span>s0expdef_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>s0expdef_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Csexpdefs <span class="keyword">(</span>srt<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_sexpdefs_main]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64729"><span class="dyncstimp">d0ec_sexpdefs</span></a> <span class="keyword">(</span>k<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> os0t <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> k <span class="keyword">of</span>
    <span class="keyword">|</span> STADEFKINDgeneric <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> None <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">|</span> STADEFKINDprop t <span class="keyword">=&gt;</span> Some <span class="keyword">'{</span>
        s0rt_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3460"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_PROP</span></a>
      <span class="keyword">}</span>
    <span class="keyword">|</span> STADEFKINDtype t <span class="keyword">=&gt;</span> Some <span class="keyword">'{</span>
        s0rt_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3540"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_T0YPE</span></a>
      <span class="keyword">}</span>
    <span class="keyword">|</span> STADEFKINDview t <span class="keyword">=&gt;</span> Some <span class="keyword">'{</span>
        s0rt_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3597"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_VIEW</span></a>
      <span class="keyword">}</span>
    <span class="keyword">|</span> STADEFKINDviewtype t <span class="keyword">=&gt;</span> Some <span class="keyword">'{</span>
        s0rt_loc<span class="keyword">=</span> t<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> s0rt_node<span class="keyword">=</span> S0RTide <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3685"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_VIEWT0YPE</span></a>
      <span class="keyword">}</span>
  <span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#13232"><span class="stacstuse">s0rtopt</span></a></span> <span class="comment">// end of [case]
</span><span class="keyword">in</span>
  d0ec_sexpdefs_main <span class="keyword">(</span>os0t<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [d0ec_sexpdefs]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64820"><span class="dyncstimp">d0ec_saspdec</span></a> <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> x<span class="keyword">.</span>s0aspdec_loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Csaspdec <span class="keyword">(</span>x<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0ec_saspdec]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64875"><span class="dyncstimp">d0ec_dcstdecs</span></a> <span class="keyword">(</span>k<span class="keyword">,</span> arg<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36956"><span class="stacstuse">d0cstdec</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36956"><span class="stacstuse">d0cstdec</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#37298"><span class="stacstuse">d0cstdeclst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>d0cstdec_loc<span class="keyword">,</span> x<span class="keyword">.</span>d0cstdec_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>d0cstdec_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cdcstdecs <span class="keyword">(</span>k<span class="keyword">,</span> arg<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_dcstdecs]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#64984"><span class="dyncstimp">d0ec_datdecs</span></a> <span class="keyword">(</span>dk<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">,</span> ys<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux1_loc
    <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32245"><span class="stacstuse">d0atdec</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32245"><span class="stacstuse">d0atdec</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32632"><span class="stacstuse">d0atdeclst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux1_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>d0atdec_loc<span class="keyword">,</span> x<span class="keyword">.</span>d0atdec_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux1_loc]
</span>  <span class="keyword">fun</span> aux2_loc
    <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32245"><span class="stacstuse">d0atdec</span></a></span><span class="keyword">,</span> y<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31014"><span class="stacstuse">s0expdef</span></a></span><span class="keyword">,</span> ys<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#31202"><span class="stacstuse">s0expdeflst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> ys <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>y<span class="keyword">,</span> ys<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2_loc <span class="keyword">(</span>x0<span class="keyword">,</span> y<span class="keyword">,</span> ys<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>d0atdec_loc<span class="keyword">,</span> y<span class="keyword">.</span>s0expdef_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux2_loc]
</span>  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> ys <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>y<span class="keyword">,</span> ys<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2_loc <span class="keyword">(</span>x0<span class="keyword">,</span> y<span class="keyword">,</span> ys<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
      <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux1_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
      <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>d0atdec_loc
      <span class="keyword">end</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cdatdecs <span class="keyword">(</span>dk<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">,</span> ys<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_datdecs]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#65096"><span class="dyncstimp">d0ec_exndecs</span></a> <span class="keyword">(</span>t_exception<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#32824"><span class="stacstuse">e0xndec</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#33079"><span class="stacstuse">e0xndeclst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>loc0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>loc0<span class="keyword">,</span> x<span class="keyword">.</span>e0xndec_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>  <span class="keyword">val</span> loc <span class="keyword">=</span> aux_loc <span class="keyword">(</span>t_exception<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cexndecs <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_exndecs]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#65354"><span class="dyncstimp">d0ec_classdec_none</span></a> <span class="keyword">(</span>t_class<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_class<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cclassdec <span class="keyword">(</span>id<span class="keyword">,</span> None<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_classdec_none]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#65428"><span class="dyncstimp">d0ec_classdec_some</span></a> <span class="keyword">(</span>t_class<span class="keyword">,</span> id<span class="keyword">,</span> sup<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_class<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> sup<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cclassdec <span class="keyword">(</span>id<span class="keyword">,</span> Some sup<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_classdec_some]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#65567"><span class="dyncstimp">d0ec_overload</span></a>
  <span class="keyword">(</span>t_overload<span class="keyword">,</span> id<span class="keyword">,</span> qid<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_overload<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> qid<span class="keyword">.</span>dqi0de_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Coverload <span class="keyword">(</span>id<span class="keyword">,</span> qid<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_overload]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#65671"><span class="dyncstimp">d0ec_overload_lrbrackets</span></a>
  <span class="keyword">(</span>t_overload<span class="keyword">,</span> t_l<span class="keyword">,</span> t_r<span class="keyword">,</span> qid<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#9856"><span class="dyncstuse">i0de_make_lrbrackets</span></a> <span class="keyword">(</span>t_l<span class="keyword">,</span> t_r<span class="keyword">)</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_overload<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> qid<span class="keyword">.</span>dqi0de_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Coverload <span class="keyword">(</span>id<span class="keyword">,</span> qid<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_overload_lrbrackets]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66751"><span class="dyncstimp">d0ec_dynload</span></a> <span class="keyword">(</span>s<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> s<span class="keyword">.</span>s0tring_loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cdynload <span class="keyword">(</span>s<span class="keyword">.</span>s0tring_val<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [d0ec_dynload]
</span>
<span class="comment">//
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66808"><span class="dyncstimp">d0ec_staload_none</span></a> <span class="keyword">(</span>s<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> name <span class="keyword">=</span> s<span class="keyword">.</span>s0tring_val <span class="comment">// filename
</span><span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> s<span class="keyword">.</span>s0tring_loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cstaload <span class="keyword">(</span>None<span class="keyword">,</span> name<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_staload_none]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66874"><span class="dyncstimp">d0ec_staload_some</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> s<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> name <span class="keyword">=</span> s<span class="keyword">.</span>s0tring_val <span class="comment">// filename
</span>  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>id<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> s<span class="keyword">.</span>s0tring_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cstaload <span class="keyword">(</span>Some id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> name<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_staload_some]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#65841"><span class="dyncstimp">d0ec_extype</span></a> <span class="keyword">(</span>name<span class="keyword">,</span> s0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>name<span class="keyword">.</span>s0tring_loc<span class="keyword">,</span> s0e<span class="keyword">.</span>s0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cextype <span class="keyword">(</span>name<span class="keyword">.</span>s0tring_val<span class="keyword">,</span> s0e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d2ec_extype]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#65908"><span class="dyncstimp">d0ec_extval</span></a> <span class="keyword">(</span>name<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>name<span class="keyword">.</span>s0tring_loc<span class="keyword">,</span> d0e<span class="keyword">.</span>d0exp_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cextval <span class="keyword">(</span>name<span class="keyword">.</span>s0tring_val<span class="keyword">,</span> d0e<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d2ec_extval]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#65975"><span class="dyncstimp">d0ec_extcode_dyn</span></a> <span class="keyword">(</span>code<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> pos <span class="keyword">=</span> code<span class="keyword">.</span>e0xtcode_pos
  <span class="keyword">val</span> loc <span class="keyword">=</span> code<span class="keyword">.</span>e0xtcode_loc
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span>
    <span class="keyword">if</span> <span class="keyword">(</span>pos <span class="keyword">&lt;</span> 0<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">begin</span>
      prerr_loc_error0 <span class="keyword">(</span>loc<span class="keyword">)</span><span class="keyword">;</span>
      prerr ": the sequence \"%{#\" is only for"<span class="keyword">;</span>
      prerr " including external code in a static file"<span class="keyword">;</span>
      prerr "; please use either \"%{\", \"%{^\", or \"%{$\" instead."<span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">val</span> cod <span class="keyword">=</span> code<span class="keyword">.</span>e0xtcode_cod
<span class="keyword">in</span> <span class="keyword">'{</span> <span class="comment">// external code
</span>  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cextcode <span class="keyword">(</span>pos<span class="keyword">,</span> cod<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_extcode_dyn]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66040"><span class="dyncstimp">d0ec_extcode_sta</span></a> <span class="keyword">(</span>code<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> pos <span class="keyword">=</span> code<span class="keyword">.</span>e0xtcode_pos
  <span class="keyword">val</span> loc <span class="keyword">=</span> code<span class="keyword">.</span>e0xtcode_loc
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span>
    <span class="keyword">if</span> <span class="keyword">(</span>pos &gt;= 0<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">begin</span>
      prerr_loc_error0 <span class="keyword">(</span>loc<span class="keyword">)</span><span class="keyword">;</span>
      prerr ": the sequence \"%{#\" should be used for"<span class="keyword">;</span>
      prerr " including external code in a static file."<span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">val</span> cod <span class="keyword">=</span> code<span class="keyword">.</span>e0xtcode_cod
<span class="keyword">in</span> <span class="keyword">'{</span> <span class="comment">// external code
</span>  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cextcode <span class="keyword">(</span>pos<span class="keyword">,</span> cod<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_extcode_sta]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">local</span>

<span class="keyword">fun</span> aux1_loc
  <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51913"><span class="stacstuse">v0aldec</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52046"><span class="stacstuse">v0aldeclst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> xs <span class="keyword">of</span>
  <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>v0aldec_loc
<span class="comment">// end [aux1_loc]
</span>
<span class="keyword">and</span> aux2_loc
  <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51913"><span class="stacstuse">v0aldec</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#51913"><span class="stacstuse">v0aldec</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52046"><span class="stacstuse">v0aldeclst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> xs <span class="keyword">of</span>
  <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>v0aldec_loc<span class="keyword">,</span> x<span class="keyword">.</span>v0aldec_loc<span class="keyword">)</span>
<span class="comment">// end [aux2_loc]
</span>
<span class="keyword">in</span> <span class="comment">// in of [local]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66106"><span class="dyncstimp">d0ec_valdecs</span></a> <span class="keyword">(</span>k<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> aux1_loc <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cvaldecs <span class="keyword">(</span>k<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_valdecs]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66190"><span class="dyncstimp">d0ec_valdecs_par</span></a> <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> aux1_loc <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cvaldecs_par <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_valdecs_par]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66270"><span class="dyncstimp">d0ec_valdecs_rec</span></a> <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> aux1_loc <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cvaldecs_rec <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_valdecs_rec]
</span>
<span class="keyword">end</span> <span class="comment">// end of [local]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66350"><span class="dyncstimp">d0ec_fundecs</span></a> <span class="keyword">(</span>k<span class="keyword">,</span> arg<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52104"><span class="stacstuse">f0undec</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52104"><span class="stacstuse">f0undec</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52334"><span class="stacstuse">f0undeclst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>f0undec_loc<span class="keyword">,</span> x<span class="keyword">.</span>f0undec_loc<span class="keyword">)</span>
  <span class="comment">// end of [aux_loc]
</span>  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>f0undec_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cfundecs <span class="keyword">(</span>k<span class="keyword">,</span> arg<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_fundecs]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66454"><span class="dyncstimp">d0ec_vardecs</span></a> <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52386"><span class="stacstuse">v0ardec</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52386"><span class="stacstuse">v0ardec</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52603"><span class="stacstuse">v0ardeclst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>v0ardec_loc<span class="keyword">,</span> x<span class="keyword">.</span>v0ardec_loc<span class="keyword">)</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>v0ardec_loc
<span class="keyword">in</span>
  <span class="keyword">'{</span> d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cvardecs <span class="keyword">(</span>x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">}</span> 
<span class="keyword">end</span> <span class="comment">// end of [d0ec_vardecs]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66526"><span class="dyncstimp">d0ec_macdefs</span></a> <span class="keyword">(</span>knd<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="comment">// knd: 0/1/2 =&gt; short/long/long rec
</span>
  <span class="keyword">fun</span> aux_loc
    <span class="keyword">(</span>x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52655"><span class="stacstuse">m0acdef</span></a></span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52655"><span class="stacstuse">m0acdef</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#52784"><span class="stacstuse">m0acdeflst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> combine <span class="keyword">(</span>x0<span class="keyword">.</span>m0acdef_loc<span class="keyword">,</span> x<span class="keyword">.</span>m0acdef_loc<span class="keyword">)</span>

  <span class="keyword">val</span> loc <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_loc <span class="keyword">(</span>x0<span class="keyword">,</span> x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> x0<span class="keyword">.</span>m0acdef_loc
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2edats.html#1832"><span class="stacstuse">loc_t</span></a></span>

  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> knd <span class="keyword">&lt;</span> 0 <span class="keyword">then</span> <span class="keyword">begin</span> <span class="comment">// error checking
</span>    prerr_loc_error0 <span class="keyword">(</span>loc<span class="keyword">)</span><span class="keyword">;</span>
    prerr ": only a macro in long form can be recursively defined"<span class="keyword">;</span>
    prerr ", which is introduced via [macrodef] instead of [macdef]."<span class="keyword">;</span>
    <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [val]
</span><span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cmacdefs <span class="keyword">(</span>knd<span class="keyword">,</span> x0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_macdefs]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">// [d0ecarg: s0arglstlst]
</span><span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66639"><span class="dyncstimp">d0ec_impdec</span></a> <span class="keyword">(</span>t_implement<span class="keyword">,</span> i0mparg<span class="keyword">,</span> i0mpdec<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_implement<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> i0mpdec<span class="keyword">.</span>i0mpdec_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cimpdec <span class="keyword">(</span>i0mparg<span class="keyword">,</span> i0mpdec<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_impdec]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#66951"><span class="dyncstimp">d0ec_local</span></a>
  <span class="keyword">(</span>t_local<span class="keyword">,</span> d0cs1<span class="keyword">,</span> d0cs2<span class="keyword">,</span> t_end<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_local<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> t_end<span class="keyword">.</span>t0kn_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Clocal <span class="keyword">(</span>d0cs1<span class="keyword">,</span> d0cs2<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_local]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#67057"><span class="dyncstimp">d0ec_guadec</span></a> <span class="keyword">(</span>kndtok<span class="keyword">,</span> gd0c<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> SRPIFKINDTOK <span class="keyword">(</span>knd<span class="keyword">,</span> t_srpif<span class="keyword">)</span> <span class="keyword">=</span> kndtok
  <span class="keyword">val</span> loc <span class="keyword">=</span> combine <span class="keyword">(</span>t_srpif<span class="keyword">.</span>t0kn_loc<span class="keyword">,</span> gd0c<span class="keyword">.</span>guad0ec_loc<span class="keyword">)</span>
<span class="keyword">in</span> <span class="keyword">'{</span>
  d0ec_loc<span class="keyword">=</span> loc<span class="keyword">,</span> d0ec_node<span class="keyword">=</span> D0Cguadec <span class="keyword">(</span>knd<span class="keyword">,</span> gd0c<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [d0ec_guadec]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#67153"><span class="dyncstimp">d0eclst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#67197"><span class="dyncstimp">d0eclst_cons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#67264"><span class="dyncstimp">d0ecllst_nil</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> D0CLLSTnil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#67311"><span class="dyncstimp">d0ecllst_cons</span></a> <span class="keyword">(</span>xs<span class="keyword">,</span> x<span class="keyword">)</span> <span class="keyword">=</span> D0CLLSTcons <span class="keyword">(</span>xs<span class="keyword">,</span> x<span class="keyword">)</span>

<span class="keyword">fun</span> d0ecllst_revapp
  <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#63504"><span class="stacstuse">d0ecllst</span></a></span><span class="keyword">,</span> ys<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53091"><span class="stacstuse">d0eclst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#53091"><span class="stacstuse">d0eclst</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">~</span>D0CLLSTcons <span class="keyword">(</span>xs<span class="keyword">,</span> x<span class="keyword">)</span> <span class="keyword">=&gt;</span> d0ecllst_revapp <span class="keyword">(</span>xs<span class="keyword">,</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> ys<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">~</span>D0CLLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> ys
<span class="comment">// end of [d0eclst_revapp]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#67382"><span class="dyncstimp">d0ecllst_reverse</span></a> <span class="keyword">(</span>xs<span class="keyword">)</span> <span class="keyword">=</span> d0ecllst_revapp <span class="keyword">(</span>xs<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#67470"><span class="dyncstimp">guad0ec_one</span></a>
  <span class="keyword">(</span>gua<span class="keyword">,</span> d0cs_then<span class="keyword">,</span> t_endif<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  guad0ec_loc<span class="keyword">=</span> t_endif<span class="keyword">.</span>t0kn_loc
<span class="keyword">,</span> guad0ec_node<span class="keyword">=</span> GD0Cone <span class="keyword">(</span>gua<span class="keyword">,</span> d0cs_then<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [guad0ec_one]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#67563"><span class="dyncstimp">guad0ec_two</span></a>
  <span class="keyword">(</span>gua<span class="keyword">,</span> d0cs_then<span class="keyword">,</span> d0cs_else<span class="keyword">,</span> t_endif<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">'{</span>
  guad0ec_loc<span class="keyword">=</span> t_endif<span class="keyword">.</span>t0kn_loc
<span class="keyword">,</span> guad0ec_node<span class="keyword">=</span> GD0Ctwo <span class="keyword">(</span>gua<span class="keyword">,</span> d0cs_then<span class="keyword">,</span> d0cs_else<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [guad0ec_two]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#67705"><span class="dyncstimp">guad0ec_cons</span></a> <span class="keyword">(</span>gua<span class="keyword">,</span> d0cs<span class="keyword">,</span> kndtok<span class="keyword">,</span> rst<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> SRPIFKINDTOK <span class="keyword">(</span>knd<span class="keyword">,</span> _<span class="comment">(*tok*)</span><span class="keyword">)</span> <span class="keyword">=</span> kndtok
<span class="keyword">in</span> <span class="keyword">'{</span>
  guad0ec_loc<span class="keyword">=</span> rst<span class="keyword">.</span>guad0ec_loc
<span class="keyword">,</span> guad0ec_node<span class="keyword">=</span> GD0Ccons <span class="keyword">(</span>gua<span class="keyword">,</span> d0cs<span class="keyword">,</span> knd<span class="keyword">,</span> rst<span class="keyword">.</span>guad0ec_node<span class="keyword">)</span>
<span class="keyword">}</span> <span class="keyword">end</span> <span class="comment">// end of [guad0ec_cons]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [ats_syntax.dats] *)</span>
</pre>
</body>
</html>
