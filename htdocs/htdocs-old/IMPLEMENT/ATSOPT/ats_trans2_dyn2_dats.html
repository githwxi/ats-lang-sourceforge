<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">(***********************************************************************)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(*                         Applied Type System                         *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(*                              Hongwei Xi                             *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(***********************************************************************)</span>

<span class="comment">(*
** ATS/Anairiats - Unleashing the Potential of Types!
**
** Copyright (C) 2002-2008 Hongwei Xi, Boston University
**
** All rights reserved
**
** ATS is free software;  you can  redistribute it and/or modify it under
** the terms of  the GNU GENERAL PUBLIC LICENSE (GPL) as published by the
** Free Software Foundation; either version 3, or (at  your  option)  any
** later version.
** 
** ATS is distributed in the hope that it will be useful, but WITHOUT ANY
** WARRANTY; without  even  the  implied  warranty  of MERCHANTABILITY or
** FITNESS FOR A PARTICULAR PURPOSE.  See the  GNU General Public License
** for more details.
** 
** You  should  have  received  a  copy of the GNU General Public License
** along  with  ATS;  see the  file COPYING.  If not, please write to the
** Free Software Foundation,  51 Franklin Street, Fifth Floor, Boston, MA
** 02110-1301, USA.
*)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">// Author: Hongwei Xi (hwxi AT cs DOT bu DOT edu)
</span><span class="comment">// Time: November 2007
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">Deb <span class="keyword">=</span> "ats_debug.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Err <span class="keyword">=</span> "ats_error.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Lst <span class="keyword">=</span> "ats_list.sats"</span>
<span class="keyword">staload</span> <span class="staexp">NS <span class="keyword">=</span> "ats_namespace.sats"</span>
<span class="keyword">staload</span> <span class="staexp">PM <span class="keyword">=</span> "ats_posmark.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Sym <span class="keyword">=</span> "ats_symbol.sats"</span>

<span class="keyword">staload</span> <span class="staexp">SymEnv <span class="keyword">=</span> "ats_symenv.sats"</span>
<span class="keyword">stadef</span> <span class="staexp"><a name="1751"><span class="stacstdec">symmap_t <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymenv_2esats.html#1613"><span class="stacstuse">$SymEnv<span class="keyword">.</span>symmap_t</span></a></span></a></span> 
<span class="keyword">typedef</span> <span class="staexp"><a name="1788"><span class="stacstdec">symmapref <span class="keyword">(</span>itm<span class="keyword">:</span>t@ype<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymenv_2esats.html#1657"><span class="stacstuse">$SymEnv<span class="keyword">.</span>symmapref</span></a> <span class="keyword">(</span>itm<span class="keyword">)</span></span></a></span>

<span class="keyword">staload</span> <span class="staexp">Syn <span class="keyword">=</span> "ats_syntax.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"ats_staexp1.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"ats_dynexp1.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"ats_staexp2.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"ats_dynexp2.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"ats_stadyncst2.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"ats_trans2_env.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"ats_trans2.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"ats_reference.sats"</span>
<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anonymous*)</span> <span class="keyword">=</span> "ats_reference.dats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anonymous*)</span> <span class="keyword">=</span> "ats_map_lin.dats"</span>
<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anonymous*)</span> <span class="keyword">=</span> "ats_symenv.dats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">#define</span> <span class="neuexp">THISFILENAME "ats_trans2_dyn2.dats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">#define</span> <span class="neuexp">nil list_nil</span>
<span class="keyword">#define</span> <span class="neuexp">cons list_cons</span>
<span class="keyword">#define</span> <span class="neuexp">:: list_cons</span>

<span class="comment">(* ****** ****** *)</span>

<span class="neuexp"><span class="keyword">overload</span> prerr <span class="keyword">with</span> $Syn<span class="keyword">.</span>prerr_d0ynq</span>
<span class="neuexp"><span class="keyword">overload</span> prerr <span class="keyword">with</span> $Sym<span class="keyword">.</span>prerr_symbol</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> prerr_loc_error2 <span class="keyword">(</span>loc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1783"><span class="stacstuse">loc_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#2738"><span class="dyncstuse">$Loc<span class="keyword">.</span>prerr_location</span></a> loc<span class="keyword">;</span> prerr ": error(2)"<span class="keyword">)</span>
<span class="comment">// end of [prerr_loc_error2]
</span>
<span class="keyword">fn</span> prerr_interror <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> prerr "INTERNAL ERROR (ats_trans2_dyn2)"

<span class="keyword">fn</span> prerr_loc_interror <span class="keyword">(</span>loc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1783"><span class="stacstuse">loc_t</span></a></span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#2738"><span class="dyncstuse">$Loc<span class="keyword">.</span>prerr_location</span></a> loc<span class="keyword">;</span> prerr ": INTERNAL ERROR (ats_trans2_dyn2)"
<span class="keyword">end</span> <span class="comment">// end of [prerr_loc_interror]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> dyncstimploc_posmark
  <span class="keyword">(</span>loc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1783"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> d2c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2635"><span class="stacstuse">d2cst_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc_d2c <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#4333"><span class="dyncstuse">d2cst_loc_get</span></a> <span class="keyword">(</span>d2c<span class="keyword">)</span>
  <span class="keyword">val</span> loc_begoff <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#2273"><span class="dyncstuse">$Loc<span class="keyword">.</span>location_begpos_toff</span></a> loc
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fposmark_2esats.html#2805"><span class="dyncstuse">$PM<span class="keyword">.</span>posmark_insert_dyncstimp_beg</span></a> <span class="keyword">(</span>loc_begoff<span class="keyword">,</span> loc_d2c<span class="keyword">)</span>
  <span class="keyword">val</span> loc_endoff <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#2322"><span class="dyncstuse">$Loc<span class="keyword">.</span>location_endpos_toff</span></a> loc
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fposmark_2esats.html#2867"><span class="dyncstuse">$PM<span class="keyword">.</span>posmark_insert_dyncstimp_end</span></a> <span class="keyword">(</span>loc_endoff<span class="keyword">,</span> loc_d2c<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="comment">// empty
</span><span class="keyword">end</span> <span class="comment">// end of [dyncstimploc_posmark]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> symintr_tr <span class="keyword">(</span>ids<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#1935"><span class="stacstuse">i0delst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>ids<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#1935"><span class="stacstuse">i0delst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> ids <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>id<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux ids <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3987"><span class="dyncstuse">the_d2expenv_add</span></a> <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> D2ITEMsymdef nil<span class="keyword">)</span>
      <span class="keyword">}</span> <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// end of [list_nil]
</span>  <span class="comment">// end of [aux]
</span><span class="keyword">in</span>
  aux ids
<span class="keyword">end</span> <span class="comment">// end of [symintr_tr]
</span>
<span class="keyword">fn</span> symelim_tr <span class="keyword">(</span>ids<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#1935"><span class="stacstuse">i0delst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>ids<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#1935"><span class="stacstuse">i0delst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> ids <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>id<span class="keyword">,</span> ids<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux ids <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3987"><span class="dyncstuse">the_d2expenv_add</span></a> <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> D2ITEMsymdef nil<span class="keyword">)</span>
      <span class="keyword">}</span> <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// end of [list_nil]
</span>  <span class="comment">// end of [aux]
</span><span class="keyword">in</span>
  aux ids
<span class="keyword">end</span> <span class="comment">// end of [symelim_tr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> c1lassdec_tr
  <span class="keyword">(</span>id<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#2039"><span class="stacstuse">i0de</span></a></span><span class="keyword">,</span> sup<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#8980"><span class="stacstuse">s1expopt</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> s2c <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#13375"><span class="dyncstuse">s2cst_make</span></a> <span class="keyword">(</span>
      id<span class="keyword">.</span>i0de_sym <span class="comment">// sym
</span>    <span class="keyword">,</span> id<span class="keyword">.</span>i0de_loc <span class="comment">// location
</span>    <span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10160"><span class="dyncstuse">s2rt_cls</span></a> <span class="comment">// srt
</span>    <span class="keyword">,</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// isabs
</span>    <span class="keyword">,</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a> <span class="comment">// iscon
</span>    <span class="keyword">,</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a> <span class="comment">// isrec
</span>    <span class="keyword">,</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a> <span class="comment">// isasp
</span>    <span class="keyword">,</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// islst
</span>    <span class="keyword">,</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// argvar
</span>    <span class="keyword">,</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// def
</span>  <span class="keyword">)</span> <span class="comment">// end of [s2cst_make]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2344"><span class="dyncstuse">the_s2expenv_add_scst</span></a> s2c
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> sup <span class="keyword">of</span>
    <span class="keyword">|</span> Some s1e <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#2495"><span class="dyncstuse">s1exp_tr_dn_cls</span></a> <span class="keyword">(</span>s1e<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#14960"><span class="dyncstuse">s2cst_supcls_add</span></a> <span class="keyword">(</span>s2c<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">in</span>
        <span class="comment">// nothing
</span>      <span class="keyword">end</span> <span class="comment">// end of [Some]
</span>    <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [val]
</span><span class="keyword">}</span> <span class="comment">// end of [c1lassdec_tr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4932"><span class="dyncstimp">overload_def_tr</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> def<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> ans <span class="keyword">=</span> ans <span class="keyword">where</span> <span class="keyword">{</span>
    <span class="keyword">val</span> id_sym <span class="keyword">=</span> id<span class="keyword">.</span>i0de_sym
    <span class="keyword">val</span> ans <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4888"><span class="dyncstuse">the_d2expenv_current_find</span></a> id_sym
    <span class="keyword">val</span> ans <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> ans <span class="keyword">of</span>
      <span class="keyword">|</span> Some_vt _ <span class="keyword">=&gt;</span> <span class="keyword">(</span>fold@ ans<span class="keyword">;</span> ans<span class="keyword">)</span>
      <span class="keyword">|</span> <span class="keyword">~</span>None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4944"><span class="dyncstuse">the_d2expenv_pervasive_find</span></a> id_sym
    <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3707"><span class="stacstuse">d2itemopt_vt</span></a></span>
  <span class="keyword">}</span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> d2is <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> ans <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">~</span>Some_vt d2i <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d2i <span class="keyword">of</span>
      <span class="keyword">|</span> D2ITEMsymdef d2is <span class="keyword">=&gt;</span> d2is <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          prerr_loc_error2 id<span class="keyword">.</span>i0de_loc<span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: overload_def_tr"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
          prerr ": the identifier ["<span class="keyword">;</span>
          prerr id<span class="keyword">.</span>i0de_sym<span class="keyword">;</span>
          prerr "] should refer to a symbol but it does not."<span class="keyword">;</span>
          <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3671"><span class="stacstuse">d2itemlst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>          
        <span class="keyword">end</span> <span class="comment">// end of [_]
</span>      <span class="keyword">end</span> <span class="comment">(* end of [Some_vt] *)</span>
    <span class="keyword">|</span> <span class="keyword">~</span>None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        prerr_loc_error2 id<span class="keyword">.</span>i0de_loc<span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: overload_def_tr"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
        prerr ": the identifier ["<span class="keyword">;</span>
        prerr id<span class="keyword">.</span>i0de_sym<span class="keyword">;</span>
        prerr "] is unrecognized."<span class="keyword">;</span>
        <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3671"><span class="stacstuse">d2itemlst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [None_vt]
</span>  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3671"><span class="stacstuse">d2itemlst</span></a></span>
<span class="comment">(*
  val () = begin
    print "overload_def_tr: def := "; print_d2item def; print_newline ();
    print "overload_def_tr: d2is := "; print_d2itemlst d2is; print_newline ();
  end // end of [val]
*)</span>
  <span class="keyword">val</span> d2is_new <span class="keyword">=</span> D2ITEMsymdef <span class="keyword">(</span>def :: d2is<span class="keyword">)</span> 
<span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3987"><span class="dyncstuse">the_d2expenv_add</span></a> <span class="keyword">(</span>id<span class="keyword">.</span>i0de_sym<span class="keyword">,</span> d2is_new<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">(* end of [overload_def_tr] *)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> overload_tr
  <span class="keyword">(</span>id<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8529"><span class="stacstuse">$Syn<span class="keyword">.</span>i0de</span></a></span><span class="keyword">,</span> qid<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18964"><span class="stacstuse">$Syn<span class="keyword">.</span>dqi0de</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3423"><span class="stacstuse">d2item</span></a></span> <span class="keyword">=</span> def <span class="keyword">where</span> <span class="keyword">{</span>
<span class="comment">(*
  val () = begin
    print "overload_tr: id = ";
    $Sym.print_symbol id.i0de_sym;
    print_newline ();
    print "overload_tr: qid = ";
    $Syn.print_d0ynq qid.dqi0de_qua;
    $Sym.print_symbol qid.dqi0de_sym;
    print_newline ();
  end // end of [val]
*)</span>
  <span class="keyword">val</span> ans <span class="keyword">=</span> 
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4524"><span class="dyncstuse">the_d2expenv_find_qua</span></a> <span class="keyword">(</span>qid<span class="keyword">.</span>dqi0de_qua<span class="keyword">,</span> qid<span class="keyword">.</span>dqi0de_sym<span class="keyword">)</span>
  <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> def <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> ans <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">~</span>Some_vt d2i <span class="keyword">=&gt;</span> d2i <span class="keyword">|</span> <span class="keyword">~</span>None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        prerr_loc_error2 qid<span class="keyword">.</span>dqi0de_loc<span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: overload_tr"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
        prerr ": the dynamic identifier ["<span class="keyword">;</span>
        prerr qid<span class="keyword">.</span>dqi0de_qua<span class="keyword">;</span> prerr qid<span class="keyword">.</span>dqi0de_sym<span class="keyword">;</span>
        prerr "] is unrecognized."<span class="keyword">;</span>
        <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3423"><span class="stacstuse">d2item</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [None_vt]
</span>  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3423"><span class="stacstuse">d2item</span></a></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4932"><span class="dyncstuse">overload_def_tr</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> def<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [overload_tr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> witht1ype_tr
  <span class="keyword">(</span>w1t<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#13609"><span class="stacstuse">witht1ype</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9427"><span class="stacstuse">s2expopt</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> w1t <span class="keyword">of</span>
  <span class="keyword">|</span> WITHT1YPEnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> None <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> WITHT1YPEprop s1e <span class="keyword">=&gt;</span> Some <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#2314"><span class="dyncstuse">s1exp_tr_dn</span></a> <span class="keyword">(</span>s1e<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10270"><span class="dyncstuse">s2rt_prop</span></a><span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> WITHT1YPEtype s1e <span class="keyword">=&gt;</span> Some <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#2314"><span class="dyncstuse">s1exp_tr_dn</span></a> <span class="keyword">(</span>s1e<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10312"><span class="dyncstuse">s2rt_t0ype</span></a><span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> WITHT1YPEview s1e <span class="keyword">=&gt;</span> Some <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#2314"><span class="dyncstuse">s1exp_tr_dn</span></a> <span class="keyword">(</span>s1e<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10334"><span class="dyncstuse">s2rt_view</span></a><span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> WITHT1YPEviewtype s1e <span class="keyword">=&gt;</span> Some <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#2314"><span class="dyncstuse">s1exp_tr_dn</span></a> <span class="keyword">(</span>s1e<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10380"><span class="dyncstuse">s2rt_viewt0ype</span></a><span class="keyword">)</span><span class="keyword">)</span>
<span class="comment">// end of [witht1ype_tr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> v1aldec_tr <span class="keyword">(</span>d1c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#16535"><span class="stacstuse">v1aldec</span></a></span><span class="keyword">,</span> p2t<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12329"><span class="stacstuse">p2at</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#22737"><span class="stacstuse">v2aldec</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> d1c<span class="keyword">.</span>v1aldec_loc
  <span class="keyword">val</span> def <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4666"><span class="dyncstuse">d1exp_tr</span></a> <span class="keyword">(</span>d1c<span class="keyword">.</span>v1aldec_def<span class="keyword">)</span>
  <span class="keyword">val</span> ann <span class="keyword">=</span> witht1ype_tr <span class="keyword">(</span>d1c<span class="keyword">.</span>v1aldec_ann<span class="keyword">)</span>
<span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33312"><span class="dyncstuse">v2aldec_make</span></a> <span class="keyword">(</span>loc<span class="keyword">,</span> p2t<span class="keyword">,</span> def<span class="keyword">,</span> ann<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [v1aldec_tr]
</span>
<span class="keyword">fn</span> v1aldeclst_tr <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span>
  <span class="keyword">(</span>isrec<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span><span class="keyword">,</span> d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#16535"><span class="stacstuse">v1aldec</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#22863"><span class="stacstuse">v2aldeclst</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux1 <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="keyword">(</span>d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#16535"><span class="stacstuse">v1aldec</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12329"><span class="stacstuse">p2at</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> d1cs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d1c<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> cons <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4303"><span class="dyncstuse">p1at_tr</span></a> d1c<span class="keyword">.</span>v1aldec_pat<span class="keyword">,</span> aux1 d1cs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">fun</span> aux2 <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span>
    <span class="keyword">(</span>d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#16535"><span class="stacstuse">v1aldec</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> p2ts<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12329"><span class="stacstuse">p2at</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#22863"><span class="stacstuse">v2aldeclst</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> d1cs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d1c<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val+</span> cons <span class="keyword">(</span>p2t<span class="keyword">,</span> p2ts<span class="keyword">)</span> <span class="keyword">=</span> p2ts
      <span class="keyword">in</span>
        cons <span class="keyword">(</span>v1aldec_tr <span class="keyword">(</span>d1c<span class="keyword">,</span> p2t<span class="keyword">)</span><span class="keyword">,</span> aux2 <span class="keyword">(</span>d1cs<span class="keyword">,</span> p2ts<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> p2ts<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12329"><span class="stacstuse">p2at</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span> aux1 d1cs
  <span class="keyword">val</span> s2vs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3282"><span class="dyncstuse">s2varlst_of_s2varlstord</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12677"><span class="dyncstuse">p2atlst_svs_union</span></a> p2ts<span class="keyword">)</span>
  <span class="keyword">val</span> d2vs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3339"><span class="dyncstuse">d2varlst_of_d2varlstord</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12727"><span class="dyncstuse">p2atlst_dvs_union</span></a> p2ts<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">if</span> isrec <span class="keyword">then</span> <span class="keyword">let</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4339"><span class="dyncstuse">the_d2expenv_add_dvarlst</span></a> d2vs
    <span class="keyword">val</span> d2cs <span class="keyword">=</span> aux2 <span class="keyword">(</span>d1cs<span class="keyword">,</span> p2ts<span class="keyword">)</span>
  <span class="keyword">in</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2438"><span class="dyncstuse">the_s2expenv_add_svarlst</span></a> s2vs<span class="keyword">;</span> d2cs
  <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">let</span>
    <span class="keyword">val</span> d2cs <span class="keyword">=</span> aux2 <span class="keyword">(</span>d1cs<span class="keyword">,</span> p2ts<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4339"><span class="dyncstuse">the_d2expenv_add_dvarlst</span></a> d2vs
  <span class="keyword">in</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2438"><span class="dyncstuse">the_s2expenv_add_svarlst</span></a> s2vs<span class="keyword">;</span> d2cs
  <span class="keyword">end</span> <span class="comment">// end of [if]
</span><span class="keyword">end</span> <span class="comment">(* end of [v1aldeclst_tr] *)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> f1undec_tr <span class="keyword">(</span>
    level<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
  <span class="keyword">,</span> decarg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse">s2qualst</span></a></span>
  <span class="keyword">,</span> d2v<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2719"><span class="stacstuse">d2var_t</span></a></span>
  <span class="keyword">,</span> d1c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#16714"><span class="stacstuse">f1undec</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#22915"><span class="stacstuse">f2undec</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#6988"><span class="dyncstuse">d2var_lev_set</span></a> <span class="keyword">(</span>d2v<span class="keyword">,</span> level<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#7195"><span class="dyncstuse">d2var_decarg_set</span></a> <span class="keyword">(</span>d2v<span class="keyword">,</span> decarg<span class="keyword">)</span>
  <span class="keyword">val</span> def <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4666"><span class="dyncstuse">d1exp_tr</span></a> <span class="keyword">(</span>d1c<span class="keyword">.</span>f1undec_def<span class="keyword">)</span>
<span class="comment">(*
  val () = begin
    print "f1undec_tr: d2v = "; print d2v; print_newline ()
    print "f1undec_tr: def = "; print def; print_newline ()
  end // end of [val]
*)</span>
  <span class="keyword">val</span> ann <span class="keyword">=</span> witht1ype_tr <span class="keyword">(</span>d1c<span class="keyword">.</span>f1undec_ann<span class="keyword">)</span>
<span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33413"><span class="dyncstuse">f2undec_make</span></a> <span class="keyword">(</span>d1c<span class="keyword">.</span>f1undec_loc<span class="keyword">,</span> d2v<span class="keyword">,</span> def<span class="keyword">,</span> ann<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [f1undec_tr]
</span>
<span class="keyword">fn</span> f1undeclst_tr <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="keyword">(</span>
    fk<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5152"><span class="stacstuse">$Syn<span class="keyword">.</span>funkind</span></a></span>
  <span class="keyword">,</span> level<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
  <span class="keyword">,</span> decarg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse">s2qualst</span></a></span>
  <span class="keyword">,</span> d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#16714"><span class="stacstuse">f1undec</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23044"><span class="stacstuse">f2undeclst</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> isprf <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5570"><span class="dyncstuse">$Syn<span class="keyword">.</span>funkind_is_proof</span></a> fk
  <span class="keyword">val</span> isrec <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#5621"><span class="dyncstuse">$Syn<span class="keyword">.</span>funkind_is_recursive</span></a> fk
  <span class="keyword">val</span> d2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2719"><span class="stacstuse">d2var_t</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span> aux1 <span class="keyword">(</span>isprf<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
    <span class="keyword">fun</span> aux1 <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span>
      <span class="keyword">(</span>isprf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span><span class="keyword">,</span> d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#16714"><span class="stacstuse">f1undec</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span>
      <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2719"><span class="stacstuse">d2var_t</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d1cs <span class="keyword">of</span>
      <span class="keyword">|</span> cons <span class="keyword">(</span>d1c<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> d2v <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#6454"><span class="dyncstuse">d2var_make</span></a> <span class="keyword">(</span>d1c<span class="keyword">.</span>f1undec_sym_loc<span class="keyword">,</span> d1c<span class="keyword">.</span>f1undec_sym<span class="keyword">)</span>
          <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#6817"><span class="dyncstuse">d2var_isfix_set</span></a> <span class="keyword">(</span>d2v<span class="keyword">,</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a><span class="keyword">)</span>
          <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#6904"><span class="dyncstuse">d2var_isprf_set</span></a> <span class="keyword">(</span>d2v<span class="keyword">,</span> isprf<span class="keyword">)</span>
        <span class="keyword">in</span>
          cons <span class="keyword">(</span>d2v<span class="keyword">,</span> aux1 <span class="keyword">(</span>isprf<span class="keyword">,</span> d1cs<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [aux1]
</span>  <span class="keyword">}</span> <span class="comment">// end of [where]
</span>  <span class="keyword">fun</span> aux2 <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="keyword">(</span>
      level<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
    <span class="keyword">,</span> decarg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse">s2qualst</span></a></span>
    <span class="keyword">,</span> d2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2719"><span class="stacstuse">d2var_t</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span>
    <span class="keyword">,</span> d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#16714"><span class="stacstuse">f1undec</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span>
    <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#22915"><span class="stacstuse">f2undec</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> d2vs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d2v<span class="keyword">,</span> d2vs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val+</span> cons <span class="keyword">(</span>d1c<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=</span> d1cs
        <span class="keyword">val</span> d2c <span class="keyword">=</span> f1undec_tr <span class="keyword">(</span>level<span class="keyword">,</span> decarg<span class="keyword">,</span> d2v<span class="keyword">,</span> d1c<span class="keyword">)</span>
        <span class="keyword">val</span> d2cs <span class="keyword">=</span> aux2 <span class="keyword">(</span>level<span class="keyword">,</span> decarg<span class="keyword">,</span> d2vs<span class="keyword">,</span> d1cs<span class="keyword">)</span>
      <span class="keyword">in</span>
        cons <span class="keyword">(</span>d2c<span class="keyword">,</span> d2cs<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> isrec <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4339"><span class="dyncstuse">the_d2expenv_add_dvarlst</span></a> <span class="keyword">(</span>d2vs<span class="keyword">)</span> <span class="keyword">else</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> d2cs <span class="keyword">=</span> aux2 <span class="keyword">(</span>level<span class="keyword">,</span> decarg<span class="keyword">,</span> d2vs<span class="keyword">,</span> d1cs<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> isrec <span class="keyword">then</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">else</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4339"><span class="dyncstuse">the_d2expenv_add_dvarlst</span></a> <span class="keyword">(</span>d2vs<span class="keyword">)</span>
<span class="keyword">in</span>
  d2cs
<span class="keyword">end</span> <span class="comment">// end of [f1undeclst_tr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> v1ardec_tr <span class="keyword">(</span>d1c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#16919"><span class="stacstuse">v1ardec</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23096"><span class="stacstuse">v2ardec</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> knd <span class="keyword">=</span> d1c<span class="keyword">.</span>v1ardec_knd
<span class="comment">(*
  // top-level stack allocation is now supported!!!
  val () = if knd &gt; 0 then (*BANG*)
    if d2var_current_level_get () = 0 then begin
      prerr_loc_error2 (d1c.v1ardec_loc);
      prerr ": stack allocation is not supported at the top level.";
      prerr_newline ();
      $Err.abort {void} ()
    end // end of [if]
  // end of [val]
*)</span>
  <span class="keyword">val</span> sym <span class="keyword">=</span> d1c<span class="keyword">.</span>v1ardec_sym
  <span class="keyword">val</span> loc_sym <span class="keyword">=</span> d1c<span class="keyword">.</span>v1ardec_sym_loc
  <span class="keyword">val</span> d2v_ptr <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#6454"><span class="dyncstuse">d2var_make</span></a> <span class="keyword">(</span>loc_sym<span class="keyword">,</span> sym<span class="keyword">)</span>
  <span class="comment">// [s2v_ptr] is introduced as a static variable of the
</span>  <span class="keyword">val</span> s2v_ptr <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#16646"><span class="dyncstuse">s2var_make_id_srt</span></a> <span class="keyword">(</span>sym<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10097"><span class="dyncstuse">s2rt_addr</span></a><span class="keyword">)</span> <span class="comment">// same name
</span>  <span class="keyword">val</span> os2e_ptr <span class="keyword">=</span> Some <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32074"><span class="dyncstuse">s2exp_var</span></a> s2v_ptr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#7290"><span class="dyncstuse">d2var_addr_set</span></a> <span class="keyword">(</span>d2v_ptr<span class="keyword">,</span> os2e_ptr<span class="keyword">)</span>
  <span class="keyword">val</span> typ <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> d1c<span class="keyword">.</span>v1ardec_typ <span class="keyword">of</span>
    <span class="keyword">|</span> Some s1e <span class="keyword">=&gt;</span> Some <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#2831"><span class="dyncstuse">s1exp_tr_dn_impredicative</span></a> s1e<span class="keyword">)</span>
    <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> None <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9427"><span class="stacstuse">s2expopt</span></a></span>
  <span class="keyword">val</span> wth <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> d1c<span class="keyword">.</span>v1ardec_wth <span class="keyword">of</span>
    <span class="keyword">|</span> Some <span class="keyword">(</span>i0de<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> d2v <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#6454"><span class="dyncstuse">d2var_make</span></a> <span class="keyword">(</span>i0de<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> i0de<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
      <span class="keyword">in</span>
        D2VAROPTsome d2v
      <span class="keyword">end</span> <span class="comment">// end of [Some]
</span>    <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> D2VAROPTnone <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3161"><span class="stacstuse">d2varopt</span></a></span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> ini <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4738"><span class="dyncstuse">d1expopt_tr</span></a> d1c<span class="keyword">.</span>v1ardec_ini
<span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33538"><span class="dyncstuse">v2ardec_make</span></a> <span class="keyword">(</span>d1c<span class="keyword">.</span>v1ardec_loc<span class="keyword">,</span> knd<span class="keyword">,</span> d2v_ptr<span class="keyword">,</span> s2v_ptr<span class="keyword">,</span> typ<span class="keyword">,</span> wth<span class="keyword">,</span> ini<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [v1ardec_tr]
</span>
<span class="keyword">fn</span> v1ardeclst_tr
  <span class="keyword">(</span>d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#17136"><span class="stacstuse">v1ardeclst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23372"><span class="stacstuse">v2ardeclst</span></a></span> <span class="keyword">=</span> d2cs <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">fun</span> aux1 <span class="keyword">(</span>
      d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#17136"><span class="stacstuse">v1ardeclst</span></a></span>
    <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23372"><span class="stacstuse">v2ardeclst</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> d1cs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d1c<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>v1ardec_tr d1c<span class="keyword">,</span> aux1 d1cs<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux1]
</span>  <span class="keyword">val</span> d2cs <span class="keyword">=</span> aux1 d1cs
  <span class="keyword">fun</span> aux2 <span class="keyword">(</span>
      d2cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23372"><span class="stacstuse">v2ardeclst</span></a></span>
    <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> d2cs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d2c<span class="keyword">,</span> d2cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2 d2cs <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2391"><span class="dyncstuse">the_s2expenv_add_svar</span></a> <span class="keyword">(</span>d2c<span class="keyword">.</span>v2ardec_svar<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4292"><span class="dyncstuse">the_d2expenv_add_dvar</span></a> <span class="keyword">(</span>d2c<span class="keyword">.</span>v2ardec_dvar<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> d2c<span class="keyword">.</span>v2ardec_wth <span class="keyword">of</span>
          <span class="keyword">|</span> D2VAROPTsome d2v <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4292"><span class="dyncstuse">the_d2expenv_add_dvar</span></a> d2v
          <span class="keyword">|</span> D2VAROPTnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="comment">// end of [val]
</span>      <span class="keyword">}</span> <span class="comment">// end of [cons]
</span>    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux2]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux2 d2cs
<span class="keyword">}</span> <span class="comment">// end of [v2ardeclst_tr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> s1arglst_bind_svarlst <span class="keyword">(</span>
    loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1783"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> s1as<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#5768"><span class="stacstuse">s1arglst</span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span><span class="keyword">,</span> sub<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse">stasub_t</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="keyword">(</span>
      s1as<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#5689"><span class="stacstuse">s1arg</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span>
    <span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span>
    <span class="keyword">,</span> sub<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse">stasub_t</span></a></span></a></span>
    <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">case+</span> s1as <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>s1a<span class="keyword">,</span> s1as<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val+</span> cons <span class="keyword">(</span>s2v<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=</span> s2vs
        <span class="keyword">val</span> s2v_new <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#1976"><span class="dyncstuse">s1arg_var_tr_srt</span></a> <span class="keyword">(</span>s1a<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#16824"><span class="dyncstuse">s2var_srt_get</span></a> s2v<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span>
          <span class="keyword">~</span><span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#16824"><span class="dyncstuse">s2var_srt_get</span></a> s2v &lt;= <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#16824"><span class="dyncstuse">s2var_srt_get</span></a> s2v_new<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">begin</span>
          prerr_loc_error2 s1a<span class="keyword">.</span>s1arg_loc<span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a>
            <span class="keyword">(</span>": %s: s1arglst_bind_svarlst"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
          prerr ": the ascribed sort for the static variable ["<span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5388"><span class="dyncstuse">$Sym<span class="keyword">.</span>prerr_symbol</span></a> s1a<span class="keyword">.</span>s1arg_sym<span class="keyword">;</span>
          prerr "] is incorrect."<span class="keyword">;</span>
          <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [if]
</span>        <span class="keyword">val</span> s2e_new <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32074"><span class="dyncstuse">s2exp_var</span></a> <span class="keyword">(</span>s2v_new<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> sub := <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33428"><span class="dyncstuse">stasub_add</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2v<span class="keyword">,</span> s2e_new<span class="keyword">)</span>
      <span class="keyword">in</span>
        cons <span class="keyword">(</span>s2v_new<span class="keyword">,</span> aux <span class="keyword">(</span>s1as<span class="keyword">,</span> s2vs<span class="keyword">,</span> sub<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux]
</span>  <span class="keyword">val</span> ns1as <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2308"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_length</span></a> s1as <span class="keyword">and</span> ns2vs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2308"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_length</span></a> s2vs
<span class="keyword">in</span>
  <span class="keyword">if</span> ns1as &lt;&gt; ns2vs <span class="keyword">then</span> <span class="keyword">begin</span>
    prerr_loc_error2 loc0<span class="keyword">;</span>
    <span class="keyword">if</span> ns1as <span class="keyword">&lt;</span> ns2vs <span class="keyword">then</span> prerr ": more static arguments should be given."<span class="keyword">;</span>
    <span class="keyword">if</span> ns1as <span class="keyword">&gt;</span> ns2vs <span class="keyword">then</span> prerr ": less static arguments should be given."<span class="keyword">;</span>
    <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span>
    aux <span class="keyword">(</span>s1as<span class="keyword">,</span> s2vs<span class="keyword">,</span> sub<span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [if]
</span><span class="keyword">end</span> <span class="comment">(* end of [s1arglst_bind_svarlst] *)</span>
      
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> s1explst_bind_svarlst <span class="keyword">(</span>
    loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1783"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> s1es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#8954"><span class="stacstuse">s1explst</span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span><span class="keyword">,</span> sub<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse">stasub_t</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="keyword">(</span>
      s1es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#8868"><span class="stacstuse">s1exp</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span>
    <span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span>
    <span class="keyword">,</span> sub<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse">stasub_t</span></a></span></a></span>
    <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s1es <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>s1e<span class="keyword">,</span> s1es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val+</span> cons <span class="keyword">(</span>s2v<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=</span> s2vs<span class="keyword">;</span> <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#2105"><span class="dyncstuse">s1exp_tr_up</span></a> <span class="keyword">(</span>s1e<span class="keyword">)</span>
        <span class="keyword">val</span> s2t_s2v <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#16824"><span class="dyncstuse">s2var_srt_get</span></a> s2v <span class="keyword">and</span> s2t_s2e <span class="keyword">=</span> s2e<span class="keyword">.</span>s2exp_srt
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> <span class="keyword">~</span><span class="keyword">(</span>s2t_s2e &lt;= s2t_s2v<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">begin</span>
          prerr_loc_error2 s1e<span class="keyword">.</span>s1exp_loc<span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: s1explst_bind_svarlst"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
          prerr ": the sort of the static expression ["<span class="keyword">;</span> prerr s1e<span class="keyword">;</span>
          prerr "] is expected to be ["<span class="keyword">;</span> prerr s2t_s2v<span class="keyword">;</span>
          prerr "], but it is ["<span class="keyword">;</span> prerr s2t_s2e<span class="keyword">;</span> prerr "] instead."<span class="keyword">;</span>
          <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [val]
</span>        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> sub := <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33428"><span class="dyncstuse">stasub_add</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2v<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">in</span>
        list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> aux <span class="keyword">(</span>s1es<span class="keyword">,</span> s2vs<span class="keyword">,</span> sub<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [aux]
</span>  <span class="keyword">val</span> ns1es <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2308"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_length</span></a> s1es <span class="keyword">and</span> ns2vs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2308"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_length</span></a> s2vs
<span class="keyword">in</span>
  <span class="keyword">if</span> ns1es &lt;&gt; ns2vs <span class="keyword">then</span> <span class="keyword">begin</span>
    prerr_loc_error2 loc0<span class="keyword">;</span>
    <span class="keyword">if</span> ns1es <span class="keyword">&lt;</span> ns2vs <span class="keyword">then</span> prerr ": more template arguments should be given."<span class="keyword">;</span>
    <span class="keyword">if</span> ns1es <span class="keyword">&gt;</span> ns2vs <span class="keyword">then</span> prerr ": less template arguments should be given."<span class="keyword">;</span>
    <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span>
    aux <span class="keyword">(</span>s1es<span class="keyword">,</span> s2vs<span class="keyword">,</span> sub<span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [if]
</span><span class="keyword">end</span> <span class="comment">(* end of [s1explst_bind_svarlst] *)</span>

<span class="comment">(* ****** ****** *)</span>
<span class="comment">//
</span><span class="comment">// HX: [s2e0] is assumed to be in WHNF
</span><span class="comment">//
</span><span class="keyword">fun</span> d1exp_tr_ann <span class="keyword">(</span>
    d1e0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#12909"><span class="stacstuse">d1exp</span></a></span><span class="keyword">,</span> s2e0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#20909"><span class="stacstuse">d2exp</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2e0<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Euni <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2ps<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
    <span class="keyword">case+</span> d1e0<span class="keyword">.</span>d1exp_node <span class="keyword">of</span>
    <span class="keyword">|</span> D1Elam_sta_ana <span class="keyword">(</span>loc_arg<span class="keyword">,</span> arg<span class="keyword">,</span> body<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">var</span> sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse">stasub_t</span></a></span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33402"><span class="dyncstuse">stasub_nil</span></a>
        <span class="keyword">val</span> s2vs <span class="keyword">=</span> s1arglst_bind_svarlst
          <span class="keyword">(</span>loc_arg<span class="keyword">,</span> arg<span class="keyword">,</span> s2vs<span class="keyword">,</span> sub<span class="keyword">)</span> <span class="comment">// end of [val]
</span>        <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf_s2expenv</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2854"><span class="dyncstuse">the_s2expenv_push</span></a> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2438"><span class="dyncstuse">the_s2expenv_add_svarlst</span></a> <span class="keyword">(</span>s2vs<span class="keyword">)</span>
        <span class="comment">// end of [val]
</span>        <span class="keyword">val</span> s2ps <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33917"><span class="dyncstuse">s2explst_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2ps<span class="keyword">)</span>
        <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33866"><span class="dyncstuse">s2exp_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">)</span>
        <span class="keyword">val</span> body <span class="keyword">=</span> d1exp_tr_ann <span class="keyword">(</span>body<span class="keyword">,</span> s2e<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2795"><span class="dyncstuse">the_s2expenv_pop</span></a> <span class="keyword">(</span><span class="prfexp">pf_s2expenv</span> <span class="keyword">|</span> <span class="comment">(*none*)</span><span class="keyword">)</span>
        <span class="comment">// end of [val]
</span>      <span class="keyword">in</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#30459"><span class="dyncstuse">d2exp_lam_sta</span></a> <span class="keyword">(</span>d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">,</span> s2vs<span class="keyword">,</span> s2ps<span class="keyword">,</span> body<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [D1Elam_sta_ana]
</span>    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> d2e0 <span class="keyword">=</span> d1exp_tr_ann <span class="keyword">(</span>d1e0<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">in</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#30459"><span class="dyncstuse">d2exp_lam_sta</span></a> <span class="keyword">(</span>d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">,</span> s2vs<span class="keyword">,</span> s2ps<span class="keyword">,</span> d2e0<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [_]
</span>    <span class="keyword">end</span> <span class="comment">(* end of [S2Euni] *)</span>
  <span class="keyword">|</span> S2Efun <span class="keyword">(</span>fc<span class="keyword">,</span> lin1<span class="keyword">,</span> s2fe<span class="keyword">,</span> npf1<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> s2e_res<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
    <span class="keyword">case+</span> d1e0<span class="keyword">.</span>d1exp_node <span class="keyword">of</span>
    <span class="keyword">|</span> D1Elam_dyn <span class="keyword">(</span>lin2<span class="keyword">,</span> p1t_arg<span class="keyword">,</span> d1e_body<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> <span class="keyword">@(</span>p2ts_arg<span class="keyword">,</span> d2e_body<span class="keyword">)</span> <span class="keyword">=</span> d1exp_arg_body_tr_ann <span class="keyword">(</span>
          d1e0<span class="keyword">,</span> fc<span class="keyword">,</span> lin1<span class="keyword">,</span> s2fe<span class="keyword">,</span> npf1<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> s2e_res<span class="keyword">,</span> lin2<span class="keyword">,</span> p1t_arg<span class="keyword">,</span> d1e_body
        <span class="keyword">)</span> <span class="comment">// end of [val]
</span>      <span class="keyword">in</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#30110"><span class="dyncstuse">d2exp_lam_dyn</span></a> <span class="keyword">(</span>d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">,</span> lin1<span class="keyword">,</span> npf1<span class="keyword">,</span> p2ts_arg<span class="keyword">,</span> d2e_body<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [D2Elam_dyn]
</span>    <span class="keyword">|</span> D1Elaminit_dyn <span class="keyword">(</span>lin2<span class="keyword">,</span> p1t_arg<span class="keyword">,</span> d1e_body<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> <span class="keyword">@(</span>p2ts_arg<span class="keyword">,</span> d2e_body<span class="keyword">)</span> <span class="keyword">=</span> d1exp_arg_body_tr_ann <span class="keyword">(</span>
          d1e0<span class="keyword">,</span> fc<span class="keyword">,</span> lin1<span class="keyword">,</span> s2fe<span class="keyword">,</span> npf1<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> s2e_res<span class="keyword">,</span> lin2<span class="keyword">,</span> p1t_arg<span class="keyword">,</span> d1e_body
        <span class="keyword">)</span> <span class="comment">// end of [val]
</span>      <span class="keyword">in</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#30195"><span class="dyncstuse">d2exp_laminit_dyn</span></a> <span class="keyword">(</span>d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">,</span> lin1<span class="keyword">,</span> npf1<span class="keyword">,</span> p2ts_arg<span class="keyword">,</span> d2e_body<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [D2Elam_dyn]
</span>    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#27763"><span class="dyncstuse">d2exp_ann_type</span></a> <span class="keyword">(</span>d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4666"><span class="dyncstuse">d1exp_tr</span></a> d1e0<span class="keyword">,</span> s2e0<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">(* end of [S2Efun] *)</span>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#27763"><span class="dyncstuse">d2exp_ann_type</span></a> <span class="keyword">(</span>d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4666"><span class="dyncstuse">d1exp_tr</span></a> d1e0<span class="keyword">,</span> s2e0<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">(* end of [d1exp_tr_ann] *)</span>

<span class="keyword">and</span> d1exp_arg_body_tr_ann <span class="keyword">(</span>
    d1e0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#12909"><span class="stacstuse">d1exp</span></a></span>
  <span class="keyword">,</span> fc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15340"><span class="stacstuse">$Syn<span class="keyword">.</span>funclo</span></a></span>
  <span class="keyword">,</span> lin1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
  <span class="keyword">,</span> s2fe<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5355"><span class="stacstuse">s2eff</span></a></span>
  <span class="keyword">,</span> npf1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
  <span class="keyword">,</span> s2es_arg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span>
  <span class="keyword">,</span> s2e_res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span>
  <span class="keyword">,</span> lin2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
  <span class="keyword">,</span> p1t_arg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#3808"><span class="stacstuse">p1at</span></a></span>
  <span class="keyword">,</span> d1e_body<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#12909"><span class="stacstuse">d1exp</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><span class="keyword">@(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12514"><span class="stacstuse">p2atlst</span></a><span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#20909"><span class="stacstuse">d2exp</span></a><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> fc <span class="keyword">of</span>
    <span class="keyword">|</span> $Syn<span class="keyword">.</span>FUNCLOclo knd <span class="keyword">when</span> knd <span class="keyword">=</span> 0 <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        prerr_loc_error2 d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">;</span>
        prerr ": function is given an unboxed closure type."<span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [FUNCLOclo when ...]
</span>    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> lin1 &lt;&gt; lin2 <span class="keyword">then</span> <span class="keyword">begin</span>
    prerr_loc_error2 d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">;</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: d1exp_arg_body_tr_ann"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
    <span class="keyword">if</span> lin1 <span class="keyword">&lt;</span> lin2 <span class="keyword">then</span> prerr ": linear function is given a nonlinear type."<span class="keyword">;</span>
    <span class="keyword">if</span> lin1 <span class="keyword">&gt;</span> lin2 <span class="keyword">then</span> prerr ": nonlinear function is given a linear type."<span class="keyword">;</span>
    <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [val]
</span>  <span class="keyword">var</span> wths1es <span class="keyword">=</span> WTHS1EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> p2t_arg <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4415"><span class="dyncstuse">p1at_arg_tr</span></a> <span class="keyword">(</span>p1t_arg<span class="keyword">,</span> wths1es<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="comment">// check for refval types
</span>    <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#13481"><span class="dyncstuse">wths1explst_is_none</span></a> wths1es <span class="keyword">then</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">else</span> <span class="keyword">begin</span>
      prerr_loc_error2 p1t_arg<span class="keyword">.</span>p1at_loc<span class="keyword">;</span>
      prerr ": the function argument cannot be ascribed refval types."<span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">(* end of [if] *)</span>
  <span class="comment">// end of [val]
</span>  <span class="keyword">var</span> npf2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0
  <span class="keyword">val</span> p2ts_arg <span class="keyword">=</span> <span class="keyword">(</span>
    <span class="keyword">case+</span> p2t_arg<span class="keyword">.</span>p2at_node <span class="keyword">of</span>
    <span class="keyword">|</span> P2Tlist <span class="keyword">(</span>npf<span class="keyword">,</span> p2ts<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>npf2 := npf<span class="keyword">;</span> p2ts<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>p2t_arg<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12514"><span class="stacstuse">p2atlst</span></a></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> npf1 &lt;&gt; npf2 <span class="keyword">then</span> <span class="keyword">begin</span> <span class="comment">// check for pfarity match
</span>    prerr_loc_error2 d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">;</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: d1exp_tr_ann"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
    <span class="keyword">if</span> npf1 <span class="keyword">&lt;</span> npf2 <span class="keyword">then</span> prerr ": less proof arguments are expected."<span class="keyword">;</span>
    <span class="keyword">if</span> npf1 <span class="keyword">&gt;</span> npf2 <span class="keyword">then</span> prerr ": more proof arguments are expected."<span class="keyword">;</span>
    <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> p2ts_arg <span class="keyword">=</span> <span class="keyword">let</span>
    <span class="keyword">val</span> ns2es <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2308"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_length</span></a> s2es_arg
    <span class="keyword">val</span> np2ts <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2308"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_length</span></a> p2ts_arg
    <span class="keyword">fun</span> aux <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span>
      <span class="keyword">(</span>p2ts<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12329"><span class="stacstuse">p2at</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> s2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12329"><span class="stacstuse">p2at</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span>
      <span class="keyword">case+</span> p2ts <span class="keyword">of</span>
      <span class="keyword">|</span> cons <span class="keyword">(</span>p2t<span class="keyword">,</span> p2ts<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val+</span> cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=</span> s2es
        <span class="keyword">in</span>
          cons <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#13751"><span class="dyncstuse">p2at_ann</span></a> <span class="keyword">(</span>p2t<span class="keyword">.</span>p2at_loc<span class="keyword">,</span> p2t<span class="keyword">,</span> s2e<span class="keyword">)</span><span class="keyword">,</span> aux <span class="keyword">(</span>p2ts<span class="keyword">,</span> s2es<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>            
  <span class="keyword">in</span>
    <span class="keyword">if</span> ns2es &lt;&gt; np2ts <span class="keyword">then</span> <span class="keyword">begin</span>
      prerr_loc_error2 d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: d1exp_tr_ann"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
      <span class="keyword">if</span> ns2es <span class="keyword">&lt;</span> np2ts <span class="keyword">then</span> prerr ": less arguments are expected."<span class="keyword">;</span>
      <span class="keyword">if</span> ns2es <span class="keyword">&gt;</span> np2ts <span class="keyword">then</span> prerr ": more arguments are expected."<span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12514"><span class="stacstuse">p2atlst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span>
      aux <span class="keyword">(</span>p2ts_arg<span class="keyword">,</span> s2es_arg<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [if]
</span>  <span class="keyword">end</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12514"><span class="stacstuse">p2atlst</span></a></span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf_env2</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5451"><span class="dyncstuse">trans2_env_push</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
    <span class="keyword">val</span> s2vs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3282"><span class="dyncstuse">s2varlst_of_s2varlstord</span></a> p2t_arg<span class="keyword">.</span>p2at_svs
  <span class="keyword">in</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2438"><span class="dyncstuse">the_s2expenv_add_svarlst</span></a> s2vs
  <span class="keyword">end</span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
    <span class="keyword">val</span> d2vs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3339"><span class="dyncstuse">d2varlst_of_d2varlstord</span></a> p2t_arg<span class="keyword">.</span>p2at_dvs
  <span class="keyword">in</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4339"><span class="dyncstuse">the_d2expenv_add_dvarlst</span></a> d2vs
  <span class="keyword">end</span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf_level</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3656"><span class="dyncstuse">d2var_current_level_inc</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">var</span> annerr<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span>
    d1e_body<span class="keyword">.</span>d1exp_node <span class="keyword">of</span>
    <span class="keyword">|</span> D1Eann_funclo _ <span class="keyword">=&gt;</span> <span class="keyword">(</span>annerr := annerr + 1<span class="keyword">)</span>
    <span class="keyword">|</span> D1Eann_effc _ <span class="keyword">=&gt;</span> <span class="keyword">(</span>annerr := annerr + 1<span class="keyword">)</span> <span class="comment">// less likely
</span>    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> <span class="keyword">(</span>annerr <span class="keyword">&gt;</span> 0<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">let</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> prerr_loc_error2 <span class="keyword">(</span>d1e0<span class="keyword">.</span>d1exp_loc<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> prerr ": the [funclo/effect] annonation is redundant."
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">in</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// redundant annotation is treated as an error
</span>  <span class="keyword">end</span> <span class="comment">// end of [val]
</span><span class="comment">//
</span>  <span class="keyword">val</span> d2e_body <span class="keyword">=</span> <span class="keyword">let</span>
    <span class="keyword">val</span> s2e_res <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#35358"><span class="dyncstuse">s2exp_whnf</span></a> <span class="keyword">(</span>s2e_res<span class="keyword">)</span> <span class="keyword">in</span> d1exp_tr_ann <span class="keyword">(</span>d1e_body<span class="keyword">,</span> s2e_res<span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [val]
</span><span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3789"><span class="dyncstuse">d2var_current_level_dec</span></a> <span class="keyword">(</span><span class="prfexp">pf_level</span> <span class="keyword">|</span> <span class="comment">(*none*)</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5392"><span class="dyncstuse">trans2_env_pop</span></a> <span class="keyword">(</span><span class="prfexp">pf_env2</span> <span class="keyword">|</span> <span class="comment">(*none*)</span><span class="keyword">)</span>
  <span class="keyword">val</span> loc_body <span class="keyword">=</span> d2e_body<span class="keyword">.</span>d2exp_loc
  <span class="keyword">val</span> d2e_body <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#27820"><span class="dyncstuse">d2exp_ann_seff</span></a> <span class="keyword">(</span>loc_body<span class="keyword">,</span> d2e_body<span class="keyword">,</span> s2fe<span class="keyword">)</span>
  <span class="keyword">val</span> d2e_body <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#27877"><span class="dyncstuse">d2exp_ann_funclo</span></a> <span class="keyword">(</span>loc_body<span class="keyword">,</span> d2e_body<span class="keyword">,</span> fc<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">@(</span>p2ts_arg<span class="keyword">,</span> d2e_body<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [d2exp_tr_arg_body_ann]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> m1acdef_tr
  <span class="keyword">(</span>knd<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> d2m<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2831"><span class="stacstuse">d2mac_t</span></a></span><span class="keyword">,</span> d1c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#17188"><span class="stacstuse">m1acdef</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> loc <span class="keyword">=</span> d1c<span class="keyword">.</span>m1acdef_loc <span class="keyword">and</span> name <span class="keyword">=</span> d1c<span class="keyword">.</span>m1acdef_sym
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf_d2expenv</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4651"><span class="dyncstuse">the_d2expenv_push</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#24333"><span class="dyncstuse">d2mac_arglst_get</span></a> d2m<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
    <span class="keyword">fun</span> aux <span class="keyword">(</span>args<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23934"><span class="stacstuse">macarglst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> args <span class="keyword">of</span>
      <span class="keyword">|</span> cons <span class="keyword">(</span>arg<span class="keyword">,</span> args<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> arg <span class="keyword">of</span>
            <span class="keyword">|</span> MACARGone <span class="keyword">(</span>d2v<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4185"><span class="dyncstuse">the_d2expenv_add_dmac_var</span></a> <span class="keyword">(</span>d2v<span class="keyword">)</span>
            <span class="keyword">|</span> MACARGlst <span class="keyword">(</span>_<span class="comment">(*n*)</span><span class="keyword">,</span> d2vs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4236"><span class="dyncstuse">the_d2expenv_add_dmac_varlst</span></a> <span class="keyword">(</span>d2vs<span class="keyword">)</span>
        <span class="keyword">in</span>
          aux args
        <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>      <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [aux]
</span>  <span class="keyword">}</span> <span class="comment">// end of [where]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3133"><span class="dyncstuse">macdef_inc</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> knd <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3249"><span class="dyncstuse">macro_level_dec</span></a> <span class="keyword">(</span>loc<span class="keyword">)</span>
  <span class="keyword">val</span> def <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4666"><span class="dyncstuse">d1exp_tr</span></a> <span class="keyword">(</span>d1c<span class="keyword">.</span>m1acdef_def<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> knd <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3210"><span class="dyncstuse">macro_level_inc</span></a> <span class="keyword">(</span>loc<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3157"><span class="dyncstuse">macdef_dec</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4592"><span class="dyncstuse">the_d2expenv_pop</span></a> <span class="keyword">(</span><span class="prfexp">pf_d2expenv</span> <span class="keyword">|</span> <span class="comment">(*none*)</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#24437"><span class="dyncstuse">d2mac_def_set</span></a> <span class="keyword">(</span>d2m<span class="keyword">,</span> def<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="comment">// empty
</span><span class="keyword">end</span> <span class="comment">// end of [m1acdef_tr]
</span>
<span class="keyword">fun</span> m1acdeflst_tr <span class="keyword">(</span>knd<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#17322"><span class="stacstuse">m1acdeflst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="comment">// knd: 0/1/2 =&gt; short/long/long rec
</span>  <span class="keyword">fn</span> aux1 <span class="keyword">(</span>d1c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#17188"><span class="stacstuse">m1acdef</span></a></span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloptr1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2831"><span class="stacstuse">d2mac_t</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
    <span class="keyword">val</span> args <span class="keyword">=</span> auxarglst d1c<span class="keyword">.</span>m1acdef_arg <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">fun</span> auxarg <span class="keyword">(</span>arg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36227"><span class="stacstuse">$Syn<span class="keyword">.</span>m0acarg</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23780"><span class="stacstuse">macarg</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
        <span class="keyword">fn</span> f <span class="keyword">(</span>x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#8529"><span class="stacstuse">$Syn<span class="keyword">.</span>i0de</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2719"><span class="stacstuse">d2var_t</span></a></span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#6454"><span class="dyncstuse">d2var_make</span></a> <span class="keyword">(</span>x<span class="keyword">.</span>i0de_loc<span class="keyword">,</span> x<span class="keyword">.</span>i0de_sym<span class="keyword">)</span>
      <span class="keyword">in</span>
        <span class="keyword">case+</span> arg <span class="keyword">of</span>
        <span class="keyword">|</span> $Syn<span class="keyword">.</span>M0ACARGone <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=&gt;</span> MACARGone <span class="keyword">(</span>f x<span class="keyword">)</span>
        <span class="keyword">|</span> $Syn<span class="keyword">.</span>M0ACARGlst <span class="keyword">(</span>xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
            <span class="keyword">val</span> d2vs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2567"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_map_fun</span></a> <span class="keyword">(</span>xs<span class="keyword">,</span> f<span class="keyword">)</span><span class="keyword">;</span> <span class="keyword">val</span> n <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2308"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_length</span></a> d2vs
          <span class="keyword">in</span>
            MACARGlst <span class="keyword">(</span>n<span class="keyword">,</span> d2vs<span class="keyword">)</span>
          <span class="keyword">end</span>
      <span class="keyword">end</span>
      <span class="keyword">fun</span> auxarglst <span class="keyword">(</span>args<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#36426"><span class="stacstuse">$Syn<span class="keyword">.</span>m0acarglst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23934"><span class="stacstuse">macarglst</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> args <span class="keyword">of</span>
        <span class="keyword">|</span> cons <span class="keyword">(</span>arg<span class="keyword">,</span> args<span class="keyword">)</span> <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>auxarg arg<span class="keyword">,</span> auxarglst args<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [auxarglst]
</span>    <span class="keyword">}</span> <span class="comment">// end of [where]
</span>    <span class="keyword">val</span> def <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#29313"><span class="dyncstuse">d2exp_empty</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#1761"><span class="dyncstuse">$Loc<span class="keyword">.</span>location_none</span></a><span class="keyword">)</span>
    <span class="keyword">val</span> d2m <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23982"><span class="dyncstuse">d2mac_make</span></a> <span class="keyword">(</span>
      d1c<span class="keyword">.</span>m1acdef_loc<span class="keyword">,</span> d1c<span class="keyword">.</span>m1acdef_sym<span class="keyword">,</span> knd<span class="keyword">,</span> args<span class="keyword">,</span> def
    <span class="keyword">)</span> <span class="comment">// end of [d2mac_make]
</span>  <span class="keyword">in</span>
    <span class="comment">// [knd &gt; 1] : recursive
</span>    <span class="keyword">if</span> knd <span class="keyword">&gt;</span> 1 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4134"><span class="dyncstuse">the_d2expenv_add_dmac_def</span></a> <span class="keyword">(</span>d2m<span class="keyword">)</span><span class="keyword">;</span> d2m
  <span class="keyword">end</span> <span class="comment">// end of [aux1]
</span>  <span class="keyword">fun</span> aux2 <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span>
    <span class="keyword">(</span>d2ms<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2831"><span class="stacstuse">d2mac_t</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#17188"><span class="stacstuse">m1acdef</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d2ms <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>d2m<span class="keyword">,</span> d2ms<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val+</span> cons <span class="keyword">(</span>d1c<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=</span> d1cs
        <span class="keyword">val</span> knd <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#24211"><span class="dyncstuse">d2mac_kind_get</span></a> <span class="keyword">(</span>d2m<span class="keyword">)</span>
      <span class="keyword">in</span>
        m1acdef_tr <span class="keyword">(</span>knd<span class="keyword">,</span> d2m<span class="keyword">,</span> d1c<span class="keyword">)</span><span class="keyword">;</span>
        <span class="comment">// [knd &lt;= 1] : non-recursive
</span>        <span class="keyword">if</span> knd &lt;= 1 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4134"><span class="dyncstuse">the_d2expenv_add_dmac_def</span></a> <span class="keyword">(</span>d2m<span class="keyword">)</span><span class="keyword">;</span>
        aux2 <span class="keyword">(</span>d2ms<span class="keyword">,</span> d1cs<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [aux2]
</span>  <span class="keyword">val</span> d2ms <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2688"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_map_cloptr</span></a> <span class="keyword">(</span>d1cs<span class="keyword">,</span> aux1<span class="keyword">)</span>
<span class="keyword">in</span>
  aux2 <span class="keyword">(</span>d2ms<span class="keyword">,</span> d1cs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [m1acdeflst_tr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">viewtypedef</span> <span class="staexp"><a name="24229"><span class="stacstdec">d2cstlst_vt <span class="keyword">=</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#22725"><span class="stacstuse">List_vt</span></a> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2635"><span class="stacstuse">d2cst_t</span></a></span></a></span>

<span class="keyword">fun</span> d1exp_arity_check
  <span class="keyword">(</span>d1e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#12909"><span class="stacstuse">d1exp</span></a></span><span class="keyword">,</span> ns<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">//
</span>  <span class="keyword">fn*</span> aux1 <span class="keyword">(</span>d1e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#12909"><span class="stacstuse">d1exp</span></a></span><span class="keyword">,</span> ns<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
    <span class="keyword">case+</span> ns <span class="keyword">of</span> list_cons <span class="keyword">(</span>n<span class="keyword">,</span> ns<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2 <span class="keyword">(</span>d1e<span class="keyword">,</span> n<span class="keyword">,</span> ns<span class="keyword">)</span> <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">end</span> <span class="comment">// end of [aux1]
</span><span class="comment">//
</span>  <span class="keyword">and</span> aux2 <span class="keyword">(</span>d1e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#12909"><span class="stacstuse">d1exp</span></a></span><span class="keyword">,</span> n<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> ns<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
<span class="comment">(*
    print "d1exp_arith_check: n = "; print n; print_newline ();
    print "d1exp_arith_check: d1e = "; print_d1exp d1e; print_newline ();
*)</span>
    <span class="keyword">case+</span> d1e<span class="keyword">.</span>d1exp_node <span class="keyword">of</span>
    <span class="keyword">|</span> D1Elam_dyn <span class="keyword">(</span>_<span class="comment">(*lin*)</span><span class="keyword">,</span> p1t<span class="keyword">,</span> d1e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> narg <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> p1t<span class="keyword">.</span>p1at_node <span class="keyword">of</span>
          <span class="keyword">|</span> P1Tlist <span class="keyword">(</span>_<span class="comment">(*npf*)</span><span class="keyword">,</span> p1ts<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2308"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_length</span></a> <span class="keyword">(</span>p1ts<span class="keyword">)</span> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> 1
        <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
      <span class="keyword">in</span>
        <span class="keyword">if</span> <span class="keyword">(</span>n <span class="keyword">=</span> narg<span class="keyword">)</span> <span class="keyword">then</span> aux1 <span class="keyword">(</span>d1e<span class="keyword">,</span> ns<span class="keyword">)</span> <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
      <span class="keyword">end</span> <span class="comment">// end of [D1Elam_dyn]
</span>    <span class="keyword">|</span> D1Elam_met <span class="keyword">(</span>_<span class="comment">(*loc*)</span><span class="keyword">,</span> _<span class="comment">(*met*)</span><span class="keyword">,</span> d1e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2 <span class="keyword">(</span>d1e<span class="keyword">,</span> n<span class="keyword">,</span> ns<span class="keyword">)</span>
    <span class="keyword">|</span> D1Elam_sta_ana <span class="keyword">(</span>_<span class="comment">(*loc*)</span><span class="keyword">,</span> _<span class="comment">(*s1as*)</span><span class="keyword">,</span> d1e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2 <span class="keyword">(</span>d1e<span class="keyword">,</span> n<span class="keyword">,</span> ns<span class="keyword">)</span>
    <span class="keyword">|</span> D1Elam_sta_syn <span class="keyword">(</span>_<span class="comment">(*loc*)</span><span class="keyword">,</span> _<span class="comment">(*s1qs*)</span><span class="keyword">,</span> d1e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux2 <span class="keyword">(</span>d1e<span class="keyword">,</span> n<span class="keyword">,</span> ns<span class="keyword">)</span>
    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">end</span> <span class="comment">// end of [aux2]
</span><span class="comment">//
</span><span class="keyword">in</span>
  aux1 <span class="keyword">(</span>d1e<span class="keyword">,</span> ns<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [d1exp_arity_check]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> i1mpdec_tr_d2cst_select
  <span class="keyword">(</span>d1c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#17374"><span class="stacstuse">i1mpdec</span></a></span><span class="keyword">,</span> d2is<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3671"><span class="stacstuse">d2itemlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2635"><span class="stacstuse">d2cst_t</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>d2is<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#3671"><span class="stacstuse">d2itemlst</span></a></span><span class="keyword">)</span>
    <span class="keyword">:&lt;</span><span class="staexp">cloptr1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fdyn2_2edats.html#24229"><span class="stacstuse">d2cstlst_vt</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d2is <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>d2i<span class="keyword">,</span> d2is<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d2i <span class="keyword">of</span>
      <span class="keyword">|</span> D2ITEMcst d2c <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> ns <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#4494"><span class="dyncstuse">d2cst_arilst_get</span></a> <span class="keyword">(</span>d2c<span class="keyword">)</span>
          <span class="keyword">val</span> ismat <span class="keyword">=</span> d1exp_arity_check <span class="keyword">(</span>d1c<span class="keyword">.</span>i1mpdec_def<span class="keyword">,</span> ns<span class="keyword">)</span>
        <span class="keyword">in</span> 
          <span class="keyword">if</span> <span class="keyword">(</span>ismat<span class="keyword">)</span> <span class="keyword">then</span> list_vt_cons <span class="keyword">(</span>d2c<span class="keyword">,</span> aux d2is<span class="keyword">)</span> <span class="keyword">else</span> aux d2is
        <span class="keyword">end</span>
      <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> aux d2is
      <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_vt_nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [aux]
</span>  <span class="keyword">val</span> d2cs <span class="keyword">=</span> aux <span class="keyword">(</span>d2is<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">case+</span> d2cs <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">~</span>list_vt_cons <span class="keyword">(</span>d2c1<span class="keyword">,</span> d2cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d2cs <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">~</span>list_vt_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> d2c1
    <span class="keyword">|</span> <span class="keyword">~</span>list_vt_cons <span class="keyword">(</span>d2c2<span class="keyword">,</span> d2cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> qid <span class="keyword">=</span> d1c<span class="keyword">.</span>i1mpdec_qid
        <span class="keyword">val</span> q <span class="keyword">=</span> qid<span class="keyword">.</span>impqi0de_qua <span class="keyword">and</span> id <span class="keyword">=</span> qid<span class="keyword">.</span>impqi0de_sym
      <span class="keyword">in</span>
        prerr_loc_error2 d1c<span class="keyword">.</span>i1mpdec_loc<span class="keyword">;</span>
        prerr ": the dynamic constants ["<span class="keyword">;</span>
        prerr d2c1<span class="keyword">;</span> prerr "] and ["<span class="keyword">;</span>
        prerr d2c2<span class="keyword">;</span> prerr "] cannot be resolved for ["<span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18123"><span class="dyncstuse">$Syn<span class="keyword">.</span>prerr_d0ynq</span></a> q<span class="keyword">;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5388"><span class="dyncstuse">$Sym<span class="keyword">.</span>prerr_symbol</span></a> id<span class="keyword">;</span> prerr "]."<span class="keyword">;</span>
        <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#3568"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_vt_free__boxed</span></a> <span class="keyword">(</span>d2cs<span class="keyword">)</span><span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2635"><span class="stacstuse">d2cst_t</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [list_vt_cons]
</span>    <span class="keyword">end</span> <span class="comment">// end of [list_vt_cons]
</span>  <span class="keyword">|</span> <span class="keyword">~</span>list_vt_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> qid <span class="keyword">=</span> d1c<span class="keyword">.</span>i1mpdec_qid
      <span class="keyword">val</span> q <span class="keyword">=</span> qid<span class="keyword">.</span>impqi0de_qua <span class="keyword">and</span> id <span class="keyword">=</span> qid<span class="keyword">.</span>impqi0de_sym
    <span class="keyword">in</span>
      prerr_loc_error2 d1c<span class="keyword">.</span>i1mpdec_loc<span class="keyword">;</span>
      prerr ": no dynamic constant can be found for ["<span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#18123"><span class="dyncstuse">$Syn<span class="keyword">.</span>prerr_d0ynq</span></a> q<span class="keyword">;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#5388"><span class="dyncstuse">$Sym<span class="keyword">.</span>prerr_symbol</span></a> id<span class="keyword">;</span> prerr "]."<span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2635"><span class="stacstuse">d2cst_t</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_vt_nil]
</span><span class="keyword">end</span> <span class="comment">// end of [i1mpdec_tr_d2cst_select]
</span>
<span class="keyword">fn</span> i1mpdec_tr
  <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1783"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> i1mparg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#5798"><span class="stacstuse">s1arglstlst</span></a></span><span class="keyword">,</span> d1c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#17374"><span class="stacstuse">i1mpdec</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23424"><span class="stacstuse">i2mpdec</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> t1mparg <span class="keyword">=</span> d1c<span class="keyword">.</span>i1mpdec_tmparg
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> <span class="keyword">(</span>i1mparg<span class="keyword">,</span> t1mparg<span class="keyword">)</span> <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">(</span>cons _<span class="keyword">,</span> cons _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        prerr_loc_error2 loc0<span class="keyword">;</span>
        prerr ": template implementation and instantiation may not be combined."<span class="keyword">;</span>
        <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [cons, cons]
</span>    <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> qid <span class="keyword">=</span> d1c<span class="keyword">.</span>i1mpdec_qid
  <span class="keyword">val</span> q <span class="keyword">=</span> qid<span class="keyword">.</span>impqi0de_qua <span class="keyword">and</span> id <span class="keyword">=</span> qid<span class="keyword">.</span>impqi0de_sym
  <span class="keyword">val</span> d2c <span class="keyword">=</span> <span class="keyword">begin</span>
    <span class="keyword">case+</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#4524"><span class="dyncstuse">the_d2expenv_find_qua</span></a> <span class="keyword">(</span>q<span class="keyword">,</span> id<span class="keyword">)</span> <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">~</span>Some_vt d2i <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d2i <span class="keyword">of</span>
      <span class="keyword">|</span> D2ITEMcst d2c <span class="keyword">=&gt;</span> d2c
      <span class="keyword">|</span> D2ITEMsymdef <span class="keyword">(</span>d2is<span class="keyword">)</span> <span class="keyword">=&gt;</span> i1mpdec_tr_d2cst_select <span class="keyword">(</span>d1c<span class="keyword">,</span> d2is<span class="keyword">)</span>
      <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          prerr_loc_error2 d1c<span class="keyword">.</span>i1mpdec_loc<span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: i1mpdec_tr"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
          prerr ": the identifier ["<span class="keyword">;</span>
          prerr q<span class="keyword">;</span> prerr id<span class="keyword">;</span>
          prerr "] should refer to a dynamic constant but it does not."<span class="keyword">;</span>
          <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2635"><span class="stacstuse">d2cst_t</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [_]
</span>      <span class="keyword">end</span> <span class="comment">(* end of [Some_vt] *)</span>
    <span class="keyword">|</span> <span class="keyword">~</span>None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        prerr_loc_error2 d1c<span class="keyword">.</span>i1mpdec_loc<span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: i1mpdec_tr"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
        prerr ": the dynamic identifier ["<span class="keyword">;</span>
        prerr q<span class="keyword">;</span> prerr id<span class="keyword">;</span>
        prerr "] is unrecognized."<span class="keyword">;</span>
        <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#2635"><span class="stacstuse">d2cst_t</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [None_vt]
</span>  <span class="keyword">end</span> <span class="comment">// end of [val]
</span><span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> dyncstimploc_posmark <span class="keyword">(</span>qid<span class="keyword">.</span>impqi0de_loc<span class="keyword">,</span> d2c<span class="keyword">)</span>
<span class="comment">//
</span><span class="comment">(*
  // automatic instantiation is not supported because it can readily
  // lead to confusion as to whether an implementation is actually compiled.
  fun aux1
    (s2vpss: s2qualst, s2e: s2exp, out: &amp;s2qualst): s2exp = begin
    case+ s2vpss of
    | cons (s2vps, s2vpss) =&gt; let
        val (sub, s2vs) = stasub_extend_svarlst (stasub_nil, s2vps.0)
        val s2ps = s2explst_subst (sub, s2vps.1)
        val s2e = s2exp_subst (sub, s2e)
      in
        out := @(s2vs, s2ps) :: out; aux1 (s2vpss, s2e, out)
      end
    | nil () =&gt; (out := s2qualst_reverse out; s2e)
  end // end of [aux1]
*)</span>
  <span class="keyword">fun</span> aux2_imp <span class="keyword">(</span>
      loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1783"><span class="stacstuse">loc_t</span></a></span>
    <span class="keyword">,</span> args<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#5798"><span class="stacstuse">s1arglstlst</span></a></span>
    <span class="keyword">,</span> s2vpss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse">s2qualst</span></a></span>
    <span class="keyword">,</span> s2e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span>
    <span class="keyword">,</span> out_imp<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse">s2qualst</span></a></span></a></span>
    <span class="keyword">)</span> <span class="keyword">:&lt;</span><span class="staexp">cloptr1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> args <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>arg<span class="keyword">,</span> args<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2vpss <span class="keyword">of</span>
      <span class="keyword">|</span> cons <span class="keyword">(</span>s2vps<span class="keyword">,</span> s2vpss<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">var</span> sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse">stasub_t</span></a></span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33402"><span class="dyncstuse">stasub_nil</span></a>
          <span class="keyword">val</span> s2vs <span class="keyword">=</span> s1arglst_bind_svarlst <span class="keyword">(</span>loc0<span class="keyword">,</span> arg<span class="keyword">,</span> s2vps<span class="keyword">.</span>0<span class="keyword">,</span> sub<span class="keyword">)</span>
          <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2438"><span class="dyncstuse">the_s2expenv_add_svarlst</span></a> s2vs
          <span class="keyword">val</span> s2ps <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33917"><span class="dyncstuse">s2explst_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2vps<span class="keyword">.</span>1<span class="keyword">)</span>
          <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33866"><span class="dyncstuse">s2exp_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">)</span>
          <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> out_imp := <span class="keyword">@(</span>s2vs<span class="keyword">,</span> s2ps<span class="keyword">)</span> :: out_imp
        <span class="keyword">in</span>
          aux2_imp <span class="keyword">(</span>loc0<span class="keyword">,</span> args<span class="keyword">,</span> s2vpss<span class="keyword">,</span> s2e<span class="keyword">,</span> out_imp<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>      <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          prerr_loc_error2 loc0<span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: i1mpdec_tr: aux2_imp"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
          prerr ": the implementation for ["<span class="keyword">;</span>
          prerr q<span class="keyword">;</span> prerr id<span class="keyword">;</span>
          prerr "] should be applied to less template arguments."<span class="keyword">;</span>
          <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [nil]
</span>      <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2vpss <span class="keyword">of</span>
          <span class="keyword">|</span> cons _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
              prerr_loc_error2 loc0<span class="keyword">;</span>
              <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: i1mpdec_tr: aux2_imp"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
              prerr ": the implementation for ["<span class="keyword">;</span>
              prerr q<span class="keyword">;</span> prerr id<span class="keyword">;</span>
              prerr "] should be applied to more template arguments."<span class="keyword">;</span>
              <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
              <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
            <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>          <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">in</span>
        s2e <span class="comment">// no automatic instantiation
</span>      <span class="keyword">end</span> <span class="comment">// end of [nil]
</span>  <span class="keyword">end</span> <span class="comment">// end of [aux2_imp]
</span>  <span class="keyword">fun</span> aux2_tmp <span class="keyword">(</span>
      loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1783"><span class="stacstuse">loc_t</span></a></span>
    <span class="keyword">,</span> args<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp1_2esats.html#9008"><span class="stacstuse">s1explstlst</span></a></span>
    <span class="keyword">,</span> s2vpss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse">s2qualst</span></a></span>
    <span class="keyword">,</span> s2e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span>
    <span class="keyword">,</span> out_tmparg<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span></a></span>
    <span class="keyword">,</span> out_tmpgua<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span></a></span>
    <span class="keyword">)</span> <span class="keyword">:&lt;</span><span class="staexp">cloptr1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> args <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>arg<span class="keyword">,</span> args<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2vpss <span class="keyword">of</span>
      <span class="keyword">|</span> cons <span class="keyword">(</span>s2vps<span class="keyword">,</span> s2vpss<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">var</span> sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse">stasub_t</span></a></span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33402"><span class="dyncstuse">stasub_nil</span></a>
          <span class="keyword">val</span> s2es <span class="keyword">=</span> s1explst_bind_svarlst <span class="keyword">(</span>loc0<span class="keyword">,</span> arg<span class="keyword">,</span> s2vps<span class="keyword">.</span>0<span class="keyword">,</span> sub<span class="keyword">)</span>
          <span class="keyword">val</span> s2ps <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33917"><span class="dyncstuse">s2explst_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2vps<span class="keyword">.</span>1<span class="keyword">)</span>
          <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33866"><span class="dyncstuse">s2exp_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">)</span>
          <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> out_tmparg := s2es :: out_tmparg
          <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> out_tmpgua := s2ps :: out_tmpgua
        <span class="keyword">in</span>
          aux2_tmp <span class="keyword">(</span>loc0<span class="keyword">,</span> args<span class="keyword">,</span> s2vpss<span class="keyword">,</span> s2e<span class="keyword">,</span> out_tmparg<span class="keyword">,</span> out_tmpgua<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>      <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          prerr_loc_error2 loc0<span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: i1mpdec_tr: aux2_tmp"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
          prerr ": the implementation for ["<span class="keyword">;</span>
          prerr q<span class="keyword">;</span> prerr id<span class="keyword">;</span>
          prerr "] should be applied to less template arguments."<span class="keyword">;</span>
          <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [nil]
</span>      <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2vpss <span class="keyword">of</span>
          <span class="keyword">|</span> cons _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
              prerr_loc_error2 loc0<span class="keyword">;</span>
              <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdebug_2esats.html#1975"><span class="dyncstuse">$Deb<span class="keyword">.</span>debug_prerrf</span></a> <span class="keyword">(</span>": %s: i1mpdec_tr: aux2_tmp"<span class="keyword">,</span> <span class="keyword">@(</span>THISFILENAME<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span>
              prerr ": the implementation for ["<span class="keyword">;</span>
              prerr q<span class="keyword">;</span> prerr id<span class="keyword">;</span>
              prerr "] should be applied to more template arguments."<span class="keyword">;</span>
              <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
              <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
            <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>          <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">in</span>
        s2e <span class="comment">// no automatic instantiation
</span>      <span class="keyword">end</span> <span class="comment">// end of [nil]
</span>  <span class="keyword">end</span> <span class="comment">// end of [aux2_tmp]
</span>  <span class="keyword">val</span> loc_id <span class="keyword">=</span> qid<span class="keyword">.</span>impqi0de_loc
  <span class="keyword">val</span> decarg <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#4538"><span class="dyncstuse">d2cst_decarg_get</span></a> d2c <span class="keyword">and</span> s2e_d2c <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#4635"><span class="dyncstuse">d2cst_typ_get</span></a> d2c
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> decarg <span class="keyword">of</span>
    <span class="keyword">|</span> cons _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> <span class="keyword">(</span>i1mparg<span class="keyword">,</span> t1mparg<span class="keyword">)</span> <span class="keyword">of</span>
      <span class="keyword">|</span> <span class="keyword">(</span>nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          prerr_loc_error2 loc0<span class="keyword">;</span>
          prerr ": the dynamic constant ["<span class="keyword">;</span>
          prerr d2c<span class="keyword">;</span> prerr "] requires a template implementation"<span class="keyword">;</span>
          <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [nil, nil]
</span>      <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [val]
</span>  <span class="keyword">var</span> out_imp<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse">s2qualst</span></a></span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">var</span> out_tmparg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">var</span> out_tmpgua<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span> <span class="keyword">=</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> s2e <span class="keyword">=</span> s2e_d2c
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf_s2expenv</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2854"><span class="dyncstuse">the_s2expenv_push</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
    <span class="keyword">case+</span> decarg <span class="keyword">of</span> cons _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3341"><span class="dyncstuse">template_level_inc</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">|</span> nil _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> s2e <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> i1mparg <span class="keyword">of</span>
    <span class="keyword">|</span> cons _ <span class="keyword">=&gt;</span> aux2_imp <span class="keyword">(</span>loc_id<span class="keyword">,</span> i1mparg<span class="keyword">,</span> decarg<span class="keyword">,</span> s2e<span class="keyword">,</span> out_imp<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2e
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span>
  <span class="keyword">val</span> s2e <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> t1mparg <span class="keyword">of</span>
    <span class="keyword">|</span> cons _ <span class="keyword">=&gt;</span> aux2_tmp
        <span class="keyword">(</span>loc_id<span class="keyword">,</span> t1mparg<span class="keyword">,</span> decarg<span class="keyword">,</span> s2e<span class="keyword">,</span> out_tmparg<span class="keyword">,</span> out_tmpgua<span class="keyword">)</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2e
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span>        
<span class="comment">(*
// val out_imp = $Lst.list_reverse (out_imp) // HX: a serious bug!!!
*)</span>
  <span class="keyword">val</span> out_imp <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#21490"><span class="dyncstuse">s2qualst_reverse</span></a> <span class="keyword">(</span>out_imp<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3462"><span class="dyncstuse">s2qualst_tmplev_set</span></a> <span class="keyword">(</span>out_imp<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3310"><span class="dyncstuse">template_level_get</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">val</span> out_tmparg <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2934"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_reverse</span></a> <span class="keyword">(</span>out_tmparg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span><span class="keyword">)</span>
  <span class="keyword">val</span> out_tmpgua <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2934"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_reverse</span></a> <span class="keyword">(</span>out_tmpgua<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span><span class="keyword">)</span>
  <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#35358"><span class="dyncstuse">s2exp_whnf</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span>
  <span class="keyword">val</span> d2e <span class="keyword">=</span> d1exp_tr_ann <span class="keyword">(</span>d1c<span class="keyword">.</span>i1mpdec_def<span class="keyword">,</span> s2e<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
    <span class="keyword">case+</span> decarg <span class="keyword">of</span> cons _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3373"><span class="dyncstuse">template_level_dec</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">|</span> nil _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2795"><span class="dyncstuse">the_s2expenv_pop</span></a> <span class="keyword">(</span><span class="prfexp">pf_s2expenv</span> <span class="keyword">|</span> <span class="comment">(*none*)</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#23701"><span class="dyncstuse">d2cst_def_set</span></a> <span class="keyword">(</span>d2c<span class="keyword">,</span> Some d2e<span class="keyword">)</span>
<span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33682"><span class="dyncstuse">i2mpdec_make</span></a> <span class="keyword">(</span>
    d1c<span class="keyword">.</span>i1mpdec_loc<span class="keyword">,</span> loc_id<span class="keyword">,</span> d2c<span class="keyword">,</span> out_imp<span class="keyword">,</span> out_tmparg<span class="keyword">,</span> out_tmpgua<span class="keyword">,</span> d2e
  <span class="keyword">)</span> <span class="comment">// end of [i2mpdec_make]
</span><span class="keyword">end</span> <span class="comment">// end of [i1mpdec_tr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> s1taload_tr <span class="keyword">(</span>
    loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1783"><span class="stacstuse">loc_t</span></a></span>
  <span class="keyword">,</span> idopt<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2129"><span class="stacstuse">symopt_t</span></a></span><span class="keyword">,</span> fil<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1655"><span class="stacstuse">fil_t</span></a></span><span class="keyword">,</span> loaded<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
  <span class="keyword">,</span> d1cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp1_2esats.html#12863"><span class="stacstuse">d1eclst</span></a></span>
  <span class="keyword">,</span> loadflag<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
  <span class="keyword">,</span> d2cs_loaded<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#20884"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#20884"><span class="stacstuse">d2eclst</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#20810"><span class="stacstuse">d2ec</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">(*
  val () = print "s1taload_tr: staid = "
  val () = case+ idopt of
    | Some id =&gt; $Sym.print_symbol id | None () =&gt; print "None"
  // end of [val]
  val () = print_newline ()
  val () = begin
    print "s1taload_tr: filename = "; $Fil.print_filename fil;
    print_newline ()
  end // end of [val]
*)</span>
  <span class="keyword">val</span> fil_sym <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ffilename_2esats.html#2394"><span class="dyncstuse">$Fil<span class="keyword">.</span>filename_full_sym</span></a> fil
  <span class="keyword">var</span> loaded<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf_token</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5088"><span class="dyncstuse">staload_level_push</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> qua <span class="keyword">=</span> <span class="comment">// qualified, that is, closed
</span>    <span class="keyword">(</span><span class="keyword">case+</span> idopt <span class="keyword">of</span> Some _ <span class="keyword">=&gt;</span> 1 <span class="keyword">|</span> None _ <span class="keyword">=&gt;</span> 0<span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span>
  <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> ans <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5286"><span class="dyncstuse">d2eclst_namespace_find</span></a> fil_sym
  <span class="keyword">val</span> d2cs <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> ans <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">~</span>Some_vt d2cs <span class="keyword">=&gt;</span> <span class="keyword">(</span>loaded := 1<span class="keyword">;</span> d2cs<span class="keyword">)</span>
    <span class="keyword">|</span> <span class="keyword">~</span>None_vt _ <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5627"><span class="dyncstuse">trans2_env_save</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">//
</span>        <span class="keyword">val</span> flag <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fposmark_2esats.html#1650"><span class="dyncstuse">$PM<span class="keyword">.</span>posmark_pause_get</span></a> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">val</span> d2cs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5117"><span class="dyncstuse">d1eclst_tr</span></a> d1cs
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> d2cs_loaded := d2cs
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fposmark_2esats.html#1680"><span class="dyncstuse">$PM<span class="keyword">.</span>posmark_resume_set</span></a> <span class="keyword">(</span>flag<span class="keyword">)</span>
<span class="comment">//
</span>        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5734"><span class="dyncstuse">trans2_env_namespace_add_topenv</span></a> <span class="keyword">(</span>fil_sym<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5656"><span class="dyncstuse">trans2_env_restore</span></a> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5231"><span class="dyncstuse">d2eclst_namespace_add</span></a> <span class="keyword">(</span>fil_sym<span class="keyword">,</span> d2cs<span class="keyword">)</span>
      <span class="keyword">in</span>
        d2cs
      <span class="keyword">end</span> <span class="comment">// end of [None_vt]
</span>  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#20884"><span class="stacstuse">d2eclst</span></a></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> d2cs_loaded := d2cs
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> idopt <span class="keyword">of</span>
    <span class="keyword">|</span> Some id <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2292"><span class="dyncstuse">the_s2expenv_add</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> S2ITEMfil fil<span class="keyword">)</span>
    <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fnamespace_2esats.html#1609"><span class="dyncstuse">$NS<span class="keyword">.</span>the_namespace_add</span></a> fil_sym <span class="comment">(* opened file *)</span>
      <span class="keyword">end</span> <span class="comment">// end of [None]
</span>  <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5144"><span class="dyncstuse">staload_level_pop</span></a> <span class="keyword">(</span><span class="prfexp">pf_token</span> <span class="keyword">|</span> <span class="comment">(*none*)</span><span class="keyword">)</span>
<span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#35086"><span class="dyncstuse">d2ec_staload</span></a> <span class="keyword">(</span>loc0<span class="keyword">,</span> qua<span class="keyword">,</span> fil<span class="keyword">,</span> loaded<span class="keyword">,</span> loadflag<span class="keyword">,</span> d2cs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s1taload_tr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5019"><span class="dyncstimp">overload_d2eclst_tr</span></a> <span class="keyword">(</span>d2cs<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> d2cs <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>d2c<span class="keyword">,</span> d2cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> d2c<span class="keyword">.</span>d2ec_node <span class="keyword">of</span>
        <span class="keyword">|</span> D2Csymintr ids <span class="keyword">=&gt;</span> symintr_tr <span class="keyword">(</span>ids<span class="keyword">)</span>
<span class="comment">(*
        | D2Csymelim ids =&gt; symelim_tr (ids) // is this really needed?
*)</span>
        <span class="keyword">|</span> D2Coverload <span class="keyword">(</span>id<span class="keyword">,</span> d2i<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
<span class="comment">(*
            val () = begin
              print "overload_d2eclst_tr: id = "; $Syn.print_i0de id; print_newline ();
              print "overload_d2eclst_tr: d2i = "; print_d2item d2i; print_newline ();
            end // end of [D2Coverload]
*)</span>
          <span class="keyword">in</span>
            <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4932"><span class="dyncstuse">overload_def_tr</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> d2i<span class="keyword">)</span>
          <span class="keyword">end</span> <span class="comment">// end of [D2Coverload]
</span>        <span class="keyword">|</span> D2Cinclude d2cs_include <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5019"><span class="dyncstuse">overload_d2eclst_tr</span></a> d2cs_include
        <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="comment">// end of [val]
</span>    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5019"><span class="dyncstuse">overload_d2eclst_tr</span></a> <span class="keyword">(</span>d2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [overload_d2eclst_tr]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5087"><span class="dyncstimp">d1ec_tr</span></a> <span class="keyword">(</span>d1c0<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> d1c0<span class="keyword">.</span>d1ec_node <span class="keyword">of</span>
  <span class="keyword">|</span> D1Cnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33866"><span class="dyncstuse">d2ec_none</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">)</span>
  <span class="keyword">|</span> D1Clist d1cs <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33897"><span class="dyncstuse">d2ec_list</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5117"><span class="dyncstuse">d1eclst_tr</span></a> d1cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Clist]
</span>  <span class="keyword">|</span> D1Cinclude d1cs <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fposmark_2esats.html#1650"><span class="dyncstuse">$PM<span class="keyword">.</span>posmark_pause_get</span></a> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">val</span> d2cs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5117"><span class="dyncstuse">d1eclst_tr</span></a> d1cs
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fposmark_2esats.html#1680"><span class="dyncstuse">$PM<span class="keyword">.</span>posmark_resume_set</span></a> <span class="keyword">(</span>flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33943"><span class="dyncstuse">d2ec_include</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> d2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cinclude]
</span>  <span class="keyword">|</span> D1Csymintr ids <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> symintr_tr <span class="keyword">(</span>ids<span class="keyword">)</span> <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33992"><span class="dyncstuse">d2ec_symintr</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> ids<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Csymintr]
</span>  <span class="keyword">|</span> D1Csymelim ids <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> symelim_tr <span class="keyword">(</span>ids<span class="keyword">)</span> <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34045"><span class="dyncstuse">d2ec_symelim</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> ids<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Csymelim]
</span>  <span class="keyword">|</span> D1Ce1xpdef <span class="keyword">(</span>id<span class="keyword">,</span> def<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2292"><span class="dyncstuse">the_s2expenv_add</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> S2ITEMe1xp def<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3987"><span class="dyncstuse">the_d2expenv_add</span></a> <span class="keyword">(</span>id<span class="keyword">,</span> D2ITEMe1xp def<span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33866"><span class="dyncstuse">d2ec_none</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Ce1xpdef]
</span>  <span class="keyword">|</span> D1Cdatsrts <span class="keyword">(</span>para<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#3782"><span class="dyncstuse">d1atsrtdeclst_tr</span></a> d1cs<span class="keyword">;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33866"><span class="dyncstuse">d2ec_none</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cdatsrts]
</span>  <span class="keyword">|</span> D1Csrtdefs d1cs <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#3586"><span class="dyncstuse">s1rtdeflst_tr</span></a> d1cs<span class="keyword">;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33866"><span class="dyncstuse">d2ec_none</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Csrtdefs]
</span>  <span class="keyword">|</span> D1Cstacons <span class="keyword">(</span>absknd<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#3628"><span class="dyncstuse">s1taconlst_tr</span></a> <span class="keyword">(</span>absknd<span class="keyword">,</span> d1cs<span class="keyword">)</span><span class="keyword">;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33866"><span class="dyncstuse">d2ec_none</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cstacons]
</span>  <span class="keyword">|</span> D1Cstacsts d1cs <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#3692"><span class="dyncstuse">s1tacstlst_tr</span></a> d1cs<span class="keyword">;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33866"><span class="dyncstuse">d2ec_none</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cstacsts]
</span>  <span class="keyword">|</span> D1Cstavars d1cs <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> d2cs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#3734"><span class="dyncstuse">s1tavarlst_tr</span></a> d1cs <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34098"><span class="dyncstuse">d2ec_stavars</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> d2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cstavars]
</span>  <span class="keyword">|</span> D1Csexpdefs <span class="keyword">(</span>os1t<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> d2c <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#3885"><span class="dyncstuse">s1expdeflst_tr</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#1722"><span class="dyncstuse">s1rtopt_tr</span></a> os1t<span class="keyword">,</span> d1cs<span class="keyword">)</span>
      <span class="keyword">val</span> d2c <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33866"><span class="dyncstuse">d2ec_none</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">)</span>
    <span class="keyword">}</span> <span class="comment">// end of [D1Csexpdefs]
</span>  <span class="keyword">|</span> D1Csaspdec <span class="keyword">(</span>d1c<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34148"><span class="dyncstuse">d2ec_saspdec</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#3945"><span class="dyncstuse">s1aspdec_tr</span></a> d1c<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Csaspdec]
</span>  <span class="keyword">|</span> D1Cdcstdecs <span class="keyword">(</span>dck<span class="keyword">,</span> decarg<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf_s2expenv</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2854"><span class="dyncstuse">the_s2expenv_push</span></a> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">val</span> s2vpss <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#3398"><span class="dyncstuse">s1qualstlst_tr</span></a> <span class="keyword">(</span>decarg<span class="keyword">)</span>
      <span class="keyword">val</span> d2cs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#3988"><span class="dyncstuse">d1cstdeclst_tr</span></a> <span class="keyword">(</span>dck<span class="keyword">,</span> s2vpss<span class="keyword">,</span> d1cs<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2795"><span class="dyncstuse">the_s2expenv_pop</span></a> <span class="keyword">(</span><span class="prfexp">pf_s2expenv</span> <span class="keyword">|</span> <span class="comment">(*none*)</span><span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34195"><span class="dyncstuse">d2ec_dcstdec</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> dck<span class="keyword">,</span> d2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cdcstdecs]
</span>  <span class="keyword">|</span> D1Cdatdecs <span class="keyword">(</span>dtk<span class="keyword">,</span> d1cs_dat<span class="keyword">,</span> d1cs_def<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> s2cs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4105"><span class="dyncstuse">d1atdeclst_tr</span></a> <span class="keyword">(</span>dtk<span class="keyword">,</span> d1cs_dat<span class="keyword">,</span> d1cs_def<span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34261"><span class="dyncstuse">d2ec_datdec</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> dtk<span class="keyword">,</span> s2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cdatdecs]
</span>  <span class="keyword">|</span> D1Cexndecs <span class="keyword">(</span>d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> d2cs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4234"><span class="dyncstuse">e1xndeclst_tr</span></a> d1cs <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34389"><span class="dyncstuse">d2ec_exndec</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> d2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cexndecs]
</span>  <span class="keyword">|</span> D1Cclassdec <span class="keyword">(</span>id<span class="keyword">,</span> sup<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> c1lassdec_tr <span class="keyword">(</span>id<span class="keyword">,</span> sup<span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33866"><span class="dyncstuse">d2ec_none</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cclassdec]
</span>  <span class="keyword">|</span> D1Coverload <span class="keyword">(</span>id<span class="keyword">,</span> qid<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> d2i <span class="keyword">=</span> overload_tr <span class="keyword">(</span>id<span class="keyword">,</span> qid<span class="keyword">)</span> <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34326"><span class="dyncstuse">d2ec_overload</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> id<span class="keyword">,</span> d2i<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Coverload]
</span>  <span class="keyword">|</span> D1Cextype <span class="keyword">(</span>name<span class="keyword">,</span> s1e_def<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> s2e_def <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#2785"><span class="dyncstuse">s1exp_tr_dn_viewt0ype</span></a> s1e_def
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34437"><span class="dyncstuse">d2ec_extype</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> name<span class="keyword">,</span> s2e_def<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cextype]
</span>  <span class="keyword">|</span> D1Cextval <span class="keyword">(</span>name<span class="keyword">,</span> d1e_def<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34496"><span class="dyncstuse">d2ec_extval</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> name<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#4666"><span class="dyncstuse">d1exp_tr</span></a> d1e_def<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cextval]
</span>  <span class="keyword">|</span> D1Cextcode <span class="keyword">(</span>pos<span class="keyword">,</span> code<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34555"><span class="dyncstuse">d2ec_extcode</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> pos<span class="keyword">,</span> code<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cextcode]
</span>  <span class="keyword">|</span> D1Cvaldecs <span class="keyword">(</span>valknd<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> d2cs <span class="keyword">=</span> v1aldeclst_tr <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a><span class="comment">(*isrec*)</span><span class="keyword">,</span> d1cs<span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34618"><span class="dyncstuse">d2ec_valdecs</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> valknd<span class="keyword">,</span> d2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cvaldecs]
</span>  <span class="keyword">|</span> D1Cvaldecs_par <span class="keyword">(</span>d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> d2cs <span class="keyword">=</span> v1aldeclst_tr <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a><span class="comment">(*isrec*)</span><span class="keyword">,</span> d1cs<span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34685"><span class="dyncstuse">d2ec_valdecs_par</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> d2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cvaldecs_par]
</span>  <span class="keyword">|</span> D1Cvaldecs_rec <span class="keyword">(</span>d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> d2cs <span class="keyword">=</span> v1aldeclst_tr <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a><span class="comment">(*isrec*)</span><span class="keyword">,</span> d1cs<span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34739"><span class="dyncstuse">d2ec_valdecs_rec</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> d2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cvaldecs_rec]
</span>  <span class="keyword">|</span> D1Cfundecs <span class="keyword">(</span>funknd<span class="keyword">,</span> decarg<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf_s2expenv</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2854"><span class="dyncstuse">the_s2expenv_push</span></a> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
        <span class="keyword">case+</span> decarg <span class="keyword">of</span> cons _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3341"><span class="dyncstuse">template_level_inc</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">|</span> nil _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [val]
</span>      <span class="keyword">val</span> s2vpss <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#3398"><span class="dyncstuse">s1qualstlst_tr</span></a> <span class="keyword">(</span>decarg<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3462"><span class="dyncstuse">s2qualst_tmplev_set</span></a> <span class="keyword">(</span>s2vpss<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3310"><span class="dyncstuse">template_level_get</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">val</span> level <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3577"><span class="dyncstuse">d2var_current_level_get</span></a> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">val</span> d2cs <span class="keyword">=</span> f1undeclst_tr <span class="keyword">(</span>funknd<span class="keyword">,</span> level<span class="keyword">,</span> s2vpss<span class="keyword">,</span> d1cs<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#2795"><span class="dyncstuse">the_s2expenv_pop</span></a> <span class="keyword">(</span><span class="prfexp">pf_s2expenv</span> <span class="keyword">|</span> <span class="comment">(*none*)</span><span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
        <span class="keyword">case+</span> decarg <span class="keyword">of</span> cons _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#3373"><span class="dyncstuse">template_level_dec</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">|</span> nil _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [val]
</span>    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34794"><span class="dyncstuse">d2ec_fundecs</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> s2vpss<span class="keyword">,</span> funknd<span class="keyword">,</span> d2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cfundecs]
</span>  <span class="keyword">|</span> D1Cvardecs <span class="keyword">(</span>d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> d2cs <span class="keyword">=</span> v1ardeclst_tr d1cs
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34882"><span class="dyncstuse">d2ec_vardecs</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> d2cs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cvardecs]
</span>  <span class="keyword">|</span> D1Cmacdefs <span class="keyword">(</span>knd<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
       <span class="comment">// knd: 0/1/2 =&gt; short/long/long rec
</span>       <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> m1acdeflst_tr <span class="keyword">(</span>knd<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">in</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#33866"><span class="dyncstuse">d2ec_none</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cmacdefs]
</span>  <span class="keyword">|</span> D1Cimpdec <span class="keyword">(</span>i1mparg<span class="keyword">,</span> d1c<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> loc0 <span class="keyword">=</span> d1c0<span class="keyword">.</span>d1ec_loc
      <span class="keyword">val</span> d2c <span class="keyword">=</span> i1mpdec_tr <span class="keyword">(</span>loc0<span class="keyword">,</span> i1mparg<span class="keyword">,</span> d1c<span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34933"><span class="dyncstuse">d2ec_impdec</span></a> <span class="keyword">(</span>loc0<span class="keyword">,</span> d2c<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Cimpdec]
</span>  <span class="keyword">|</span> D1Clocal <span class="keyword">(</span>d1cs_head<span class="keyword">,</span> d1cs_body<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf1_env</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5451"><span class="dyncstuse">trans2_env_push</span></a> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">val</span> d2cs_head <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5117"><span class="dyncstuse">d1eclst_tr</span></a> d1cs_head
      <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf2_env</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5451"><span class="dyncstuse">trans2_env_push</span></a> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">val</span> d2cs_body <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5117"><span class="dyncstuse">d1eclst_tr</span></a> d1cs_body
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_5fenv_2esats.html#5502"><span class="dyncstuse">trans2_env_localjoin</span></a> <span class="keyword">(</span><span class="prfexp">pf1_env</span><span class="keyword">,</span> <span class="prfexp">pf2_env</span> <span class="keyword">|</span> <span class="comment">(*none*)</span><span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#34979"><span class="dyncstuse">d2ec_local</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> d2cs_head<span class="keyword">,</span> d2cs_body<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D1Clocal]
</span>  <span class="keyword">|</span> D1Cdynload <span class="keyword">(</span>fil<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#35042"><span class="dyncstuse">d2ec_dynload</span></a> <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> fil<span class="keyword">)</span>
  <span class="keyword">|</span> D1Cstaload <span class="keyword">(</span>idopt<span class="keyword">,</span> fil<span class="keyword">,</span> loaded<span class="keyword">,</span> loadflag<span class="keyword">,</span> d1cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">var</span> d2cs_loaded<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#20884"><span class="stacstuse">d2eclst</span></a></span> <span class="keyword">=</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">val</span> d2c0 <span class="keyword">=</span> s1taload_tr
        <span class="keyword">(</span>d1c0<span class="keyword">.</span>d1ec_loc<span class="keyword">,</span> idopt<span class="keyword">,</span> fil<span class="keyword">,</span> loaded<span class="keyword">,</span> d1cs<span class="keyword">,</span> loadflag<span class="keyword">,</span> d2cs_loaded<span class="keyword">)</span>
      <span class="comment">// end of [val]
</span>      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> idopt <span class="keyword">of</span>
        <span class="keyword">|</span> None _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5019"><span class="dyncstuse">overload_d2eclst_tr</span></a> <span class="keyword">(</span>d2cs_loaded<span class="keyword">)</span> <span class="keyword">|</span> Some _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="comment">(*named*)</span><span class="keyword">)</span>
      <span class="comment">// end of [val]
</span>    <span class="keyword">in</span>
      d2c0
    <span class="keyword">end</span> <span class="comment">// end of [D1Cstaload]
</span><span class="comment">(*
  | _ =&gt; begin
      prerr_loc_interror d1c0.d1ec_loc;
      prerr ": d1ec_tr: not available yet.\n";
      $Err.abort {d2ec} ()
    end // end of [_]
*)</span>
<span class="keyword">end</span> <span class="comment">// end of [d1ec_tr]
</span>
<span class="comment">(* ****** ****** *)</span>
<span class="comment">//
</span><span class="comment">// HX: [list_map_fun] is tail-recursive!
</span><span class="comment">//
</span><span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5117"><span class="dyncstimp">d1eclst_tr</span></a> <span class="keyword">(</span>d1cs<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2567"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_map_fun</span></a> <span class="keyword">(</span>d1cs<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ftrans2_2esats.html#5087"><span class="dyncstuse">d1ec_tr</span></a><span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [ats_trans2_dyn2.dats] *)</span>
</pre>
</body>
</html>
