<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">// A formalization of simply typed call-by-value lambda-calculus with
</span><span class="comment">// products and fixed-points that makes use of an encoding based on
</span><span class="comment">// a form of first-order abstract syntax. This example was meant to
</span><span class="comment">// gain some experience with first-order abstract syntax.
</span>
<span class="comment">// August 2005:
</span><span class="comment">// It is completed by Hongwei Xi.
</span>
<span class="comment">// January 2007:
</span><span class="comment">// It is ported to ATS/Geizella by Hongwei Xi
</span>
<span class="keyword">datasort</span> <span class="staexp">tm <span class="keyword">=</span>
  <span class="keyword">|</span> tmvar <span class="keyword">of</span> int
  <span class="keyword">|</span> tmlam <span class="keyword">of</span> tm
  <span class="keyword">|</span> tmapp <span class="keyword">of</span> <span class="keyword">(</span>tm<span class="keyword">,</span> tm<span class="keyword">)</span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="459"><span class="stacstdec">tmshi <span class="keyword">(</span>tm<span class="keyword">,</span> tm<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">,</span>l<span class="keyword">:</span>nat</span> <span class="keyword">|</span> <span class="staexp">i <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7223"><span class="stacstuse">&gt;=</span></a> l</span><span class="keyword">}</span> TMSHIvargte <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#398"><span class="stacstuse">tmvar</span></a> i<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#398"><span class="stacstuse">tmvar</span></a> <span class="keyword">(</span>i<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span><span class="keyword">,</span> l<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">,</span>l<span class="keyword">:</span>nat</span> <span class="keyword">|</span> <span class="staexp">i <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> l</span><span class="keyword">}</span> TMSHIvarlt <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#398"><span class="stacstuse">tmvar</span></a> i<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#398"><span class="stacstuse">tmvar</span></a> i<span class="keyword">,</span> l<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">l<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      TMSHIlam <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#415"><span class="stacstuse">tmlam</span></a> t<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#415"><span class="stacstuse">tmlam</span></a> t'<span class="keyword">,</span> l<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#459"><span class="stacstuse">tmshi</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">,</span> l<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">,</span>t1'<span class="keyword">,</span>t2'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">l<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      TMSHIapp <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#431"><span class="stacstuse">tmapp</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#431"><span class="stacstuse">tmapp</span></a> <span class="keyword">(</span>t1'<span class="keyword">,</span> t2'<span class="keyword">)</span><span class="keyword">,</span> l<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#459"><span class="stacstuse">tmshi</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t1'<span class="keyword">,</span> l<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#459"><span class="stacstuse">tmshi</span></a> <span class="keyword">(</span>t2<span class="keyword">,</span> t2'<span class="keyword">,</span> l<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">datasort</span> <span class="staexp">tms <span class="keyword">=</span> tmsnil <span class="keyword">|</span> tmsmore <span class="keyword">of</span> <span class="keyword">(</span>tms<span class="keyword">,</span> tm<span class="keyword">)</span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="874"><span class="stacstdec">subshi <span class="keyword">(</span>tms<span class="keyword">,</span> tms<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> SUBSHInil <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#834"><span class="stacstuse">tmsnil</span></a><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#834"><span class="stacstuse">tmsnil</span></a><span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">,</span>ts'<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span>
      SUBSHImore <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#843"><span class="stacstuse">tmsmore</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#843"><span class="stacstuse">tmsmore</span></a> <span class="keyword">(</span>ts'<span class="keyword">,</span> t'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#874"><span class="stacstuse">subshi</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> ts'<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#459"><span class="stacstuse">tmshi</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">,</span> 0<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">extern</span> <span class="keyword">prval</span> <a name="1068"><span class="dyncstdec"><span class="prfexp">subshiFun <span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>th<span class="keyword">:</span>tms<span class="keyword">}</span><span class="keyword">[</span>th'<span class="keyword">:</span>tms<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#874"><span class="stacstuse">subshi</span></a> <span class="keyword">(</span>th<span class="keyword">,</span> th'<span class="keyword">)</span></span></span></span></a>

<span class="comment">//
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1129"><span class="stacstdec">TMI <span class="keyword">(</span>int<span class="keyword">,</span> tm<span class="keyword">,</span> tms<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> TMIone <span class="staexp"><span class="keyword">(</span>0<span class="keyword">,</span> t<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#843"><span class="stacstuse">tmsmore</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>int</span> <span class="keyword">|</span> <span class="staexp">i <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7153"><span class="stacstuse"><span class="keyword">&gt;</span></span></a> 0</span><span class="keyword">}</span>
      TMIshi <span class="staexp"><span class="keyword">(</span>i<span class="keyword">,</span> t<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#843"><span class="stacstuse">tmsmore</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> t'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1129"><span class="stacstuse">TMI</span></a> <span class="keyword">(</span>i<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4689"><span class="stacstuse">-</span></a>1<span class="keyword">,</span> t<span class="keyword">,</span> ts<span class="keyword">)</span></span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1308"><span class="stacstdec">subst <span class="keyword">(</span>tms<span class="keyword">,</span> tm<span class="keyword">,</span> tm<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>nat</span><span class="keyword">}</span> SUBvar <span class="staexp"><span class="keyword">(</span>ts<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#398"><span class="stacstuse">tmvar</span></a> i<span class="keyword">,</span> t<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1129"><span class="stacstuse">TMI</span></a> <span class="keyword">(</span>i<span class="keyword">,</span> t<span class="keyword">,</span> ts<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">,</span>ts'<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span>
      SUBlam <span class="staexp"><span class="keyword">(</span>ts<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#415"><span class="stacstuse">tmlam</span></a> t<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#415"><span class="stacstuse">tmlam</span></a> t'<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#874"><span class="stacstuse">subshi</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> ts'<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1308"><span class="stacstuse">subst</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#843"><span class="stacstuse">tmsmore</span></a> <span class="keyword">(</span>ts'<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#398"><span class="stacstuse">tmvar</span></a> 0<span class="keyword">)</span><span class="keyword">,</span> t<span class="keyword">,</span> t'<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">,</span>t1'<span class="keyword">,</span>t2'<span class="keyword">:</span>tm</span><span class="keyword">}</span>
      SUBapp <span class="staexp"><span class="keyword">(</span>ts<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#431"><span class="stacstuse">tmapp</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#431"><span class="stacstuse">tmapp</span></a> <span class="keyword">(</span>t1'<span class="keyword">,</span> t2'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1308"><span class="stacstuse">subst</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> t1<span class="keyword">,</span> t1'<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1308"><span class="stacstuse">subst</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> t2<span class="keyword">,</span> t2'<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="1682"><span class="stacstdec">subst1 <span class="keyword">(</span>t1<span class="keyword">:</span>tm<span class="keyword">,</span> t2<span class="keyword">:</span>tm<span class="keyword">,</span> t3<span class="keyword">:</span>tm<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1308"><span class="stacstuse">subst</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#843"><span class="stacstuse">tmsmore</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#834"><span class="stacstuse">tmsnil</span></a><span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> t2<span class="keyword">,</span> t3<span class="keyword">)</span></span></a></span>

<span class="comment">//
</span>
<span class="keyword">datasort</span> <span class="staexp">tp <span class="keyword">=</span> tpunit <span class="keyword">|</span> tpfun <span class="keyword">of</span> <span class="keyword">(</span>tp<span class="keyword">,</span> tp<span class="keyword">)</span></span>

<span class="keyword">datasort</span> <span class="staexp">tps <span class="keyword">=</span> tpsnil <span class="keyword">|</span> tpsmore <span class="keyword">of</span> <span class="keyword">(</span>tps<span class="keyword">,</span> tp<span class="keyword">)</span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1852"><span class="stacstdec">TPI <span class="keyword">(</span>int<span class="keyword">,</span> tp<span class="keyword">,</span> tps<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">Ts<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span> TPIone <span class="staexp"><span class="keyword">(</span>0<span class="keyword">,</span> T<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span>Ts<span class="keyword">,</span> T<span class="keyword">)</span><span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">Ts<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">,</span>T'<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>int</span> <span class="keyword">|</span> <span class="staexp">i <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7153"><span class="stacstuse"><span class="keyword">&gt;</span></span></a> 0</span><span class="keyword">}</span>
      TPIshi <span class="staexp"><span class="keyword">(</span>i<span class="keyword">,</span> T<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span>Ts<span class="keyword">,</span> T'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1852"><span class="stacstuse">TPI</span></a> <span class="keyword">(</span>i<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4689"><span class="stacstuse">-</span></a>1<span class="keyword">,</span> T<span class="keyword">,</span> Ts<span class="keyword">)</span></span></span>

<span class="comment">//
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="2035"><span class="stacstdec">DER <span class="keyword">(</span>tps<span class="keyword">,</span> tm<span class="keyword">,</span> tp<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>nat</span><span class="keyword">}</span> DERvar <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#398"><span class="stacstuse">tmvar</span></a> i<span class="keyword">,</span> T<span class="keyword">,</span> 0<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1852"><span class="stacstuse">TPI</span></a> <span class="keyword">(</span>i<span class="keyword">,</span> T<span class="keyword">,</span> G<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERlam <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#415"><span class="stacstuse">tmlam</span></a> t<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1778"><span class="stacstuse">tpfun</span></a> <span class="keyword">(</span>T1<span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">,</span> s<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> T1<span class="keyword">)</span><span class="keyword">,</span> t<span class="keyword">,</span> T2<span class="keyword">,</span> s<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s1<span class="keyword">,</span>s2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERapp <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#431"><span class="stacstuse">tmapp</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">,</span> s1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>s2<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> t1<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1778"><span class="stacstuse">tpfun</span></a> <span class="keyword">(</span>T1<span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">,</span> s1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> t2<span class="keyword">,</span> T1<span class="keyword">,</span> s2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="2419"><span class="stacstdec">DER0 <span class="keyword">(</span>G<span class="keyword">:</span>tps<span class="keyword">,</span> t<span class="keyword">:</span>tm<span class="keyword">,</span> T<span class="keyword">:</span>tp<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>s<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span></span></a></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="2481"><span class="stacstdec">INS <span class="keyword">(</span>tps<span class="keyword">,</span> tp<span class="keyword">,</span> int<span class="keyword">,</span> tps<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span> INSone <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> T<span class="keyword">,</span> 0<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> T<span class="keyword">)</span><span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G1<span class="keyword">,</span>G2<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">,</span>T'<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      INSshi <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> T'<span class="keyword">)</span><span class="keyword">,</span> T<span class="keyword">,</span> i<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> T'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2481"><span class="stacstuse">INS</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> T<span class="keyword">,</span> i<span class="keyword">,</span> G2<span class="keyword">)</span></span></span>

<span class="keyword">prfun</span> <span class="prfexp">dershiVarGte <span class="staexp"><span class="keyword">{</span>G<span class="keyword">,</span>G'<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">,</span>T'<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>i1<span class="keyword">,</span>i2<span class="keyword">:</span>nat <span class="keyword">|</span> i1 <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7223"><span class="stacstuse">&gt;=</span></a> i2<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>i1<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>i1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1852"><span class="stacstuse">TPI</span></a> <span class="keyword">(</span>i1<span class="keyword">,</span> T<span class="keyword">,</span> G<span class="keyword">)</span></span><span class="keyword">,</span> i2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2481"><span class="stacstuse">INS</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> T'<span class="keyword">,</span> i2<span class="keyword">,</span> G'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1852"><span class="stacstuse">TPI</span></a> <span class="keyword">(</span>i1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">,</span> T<span class="keyword">,</span> G'<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> i2 <span class="keyword">of</span>
    <span class="keyword">|</span> INSone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> TPIshi i1
    <span class="keyword">|</span> INSshi i2 <span class="keyword">=&gt;</span> <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">TPIshi i1 <span class="keyword">=</span> i1</span> <span class="keyword">in</span> TPIshi <span class="keyword">(</span>dershiVarGte <span class="keyword">(</span>i1<span class="keyword">,</span> i2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">end</span></span>

<span class="keyword">prfun</span> <span class="prfexp">dershiVarLt <span class="staexp"><span class="keyword">{</span>G<span class="keyword">,</span>G'<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">,</span>T'<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>i1<span class="keyword">,</span>i2<span class="keyword">:</span>nat <span class="keyword">|</span> i1 <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> i2<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>i1<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>i1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1852"><span class="stacstuse">TPI</span></a> <span class="keyword">(</span>i1<span class="keyword">,</span> T<span class="keyword">,</span> G<span class="keyword">)</span></span><span class="keyword">,</span> i2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2481"><span class="stacstuse">INS</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> T'<span class="keyword">,</span> i2<span class="keyword">,</span> G'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1852"><span class="stacstuse">TPI</span></a> <span class="keyword">(</span>i1<span class="keyword">,</span> T<span class="keyword">,</span> G'<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">INSshi i2 <span class="keyword">=</span> i2</span> <span class="keyword">in</span>
     <span class="keyword">case+</span> i1 <span class="keyword">of</span>
       <span class="keyword">|</span> TPIone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> TPIone <span class="keyword">(</span><span class="keyword">)</span>
       <span class="keyword">|</span> TPIshi i1 <span class="keyword">=&gt;</span> TPIshi <span class="keyword">(</span>dershiVarLt <span class="keyword">(</span>i1<span class="keyword">,</span> i2<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">dershi <span class="staexp"><span class="keyword">{</span>G<span class="keyword">,</span>G'<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">,</span>T'<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>i<span class="keyword">,</span>s<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>s<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>d<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span></span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2481"><span class="stacstuse">INS</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> T'<span class="keyword">,</span> i<span class="keyword">,</span> G'<span class="keyword">)</span></span><span class="keyword">,</span> pf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#459"><span class="stacstuse">tmshi</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">,</span> i<span class="keyword">)</span></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G'<span class="keyword">,</span> t'<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> d <span class="keyword">of</span>
    <span class="keyword">|</span> DERvar <span class="staexp"><span class="keyword">{</span>G<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>i'<span class="keyword">}</span></span> <span class="keyword">(</span>i'<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">sif</span> <span class="staexp">i' <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7223"><span class="stacstuse">&gt;=</span></a> i</span> <span class="keyword">then</span>
           <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">TMSHIvargte <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> pf</span> <span class="keyword">in</span> DERvar <span class="keyword">(</span>dershiVarGte <span class="keyword">(</span>i'<span class="keyword">,</span> i<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">end</span>
        <span class="keyword">else</span>
           <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">TMSHIvarlt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> pf</span> <span class="keyword">in</span> DERvar <span class="keyword">(</span>dershiVarLt <span class="keyword">(</span>i'<span class="keyword">,</span> i<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">end</span>
      <span class="keyword">end</span>

    <span class="keyword">|</span> DERlam d <span class="keyword">=&gt;</span>
        <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">TMSHIlam pf <span class="keyword">=</span> pf</span> <span class="keyword">in</span>
          DERlam <span class="keyword">(</span>dershi <span class="keyword">(</span>d<span class="keyword">,</span> INSshi i<span class="keyword">,</span> pf<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>

    <span class="keyword">|</span> DERapp <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">)</span> <span class="keyword">=&gt;</span>
        <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">TMSHIapp <span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span> <span class="keyword">=</span> pf</span> <span class="keyword">in</span>
           DERapp <span class="keyword">(</span>dershi <span class="keyword">(</span>d1<span class="keyword">,</span> i<span class="keyword">,</span> pf1<span class="keyword">)</span><span class="keyword">,</span> dershi <span class="keyword">(</span>d2<span class="keyword">,</span> i<span class="keyword">,</span> pf2<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">dershi0 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">,</span>T'<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>s<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>s<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>d<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span></span><span class="keyword">,</span>  pf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#459"><span class="stacstuse">tmshi</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">,</span> 0<span class="keyword">)</span></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> T'<span class="keyword">)</span><span class="keyword">,</span> t'<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span></span> <span class="keyword">=</span> dershi <span class="keyword">(</span>d<span class="keyword">,</span> INSone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> pf<span class="keyword">)</span></span>

<span class="comment">//
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="4085"><span class="stacstdec">DERS <span class="keyword">(</span>tps<span class="keyword">,</span> tms<span class="keyword">,</span> tps<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G0<span class="keyword">:</span>tps</span><span class="keyword">}</span> DERSnil <span class="staexp"><span class="keyword">(</span>G0<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#834"><span class="stacstuse">tmsnil</span></a><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1812"><span class="stacstuse">tpsnil</span></a><span class="keyword">,</span> 0<span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G0<span class="keyword">,</span>G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">,</span>n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERSmore <span class="staexp"><span class="keyword">(</span>G0<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#843"><span class="stacstuse">tmsmore</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> T<span class="keyword">)</span><span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#4085"><span class="stacstuse">DERS</span></a> <span class="keyword">(</span>G0<span class="keyword">,</span> ts<span class="keyword">,</span> G<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G0<span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="4325"><span class="stacstdec">DERS0 <span class="keyword">(</span>G1<span class="keyword">:</span>tps<span class="keyword">,</span> ts<span class="keyword">:</span>tms<span class="keyword">,</span> G2<span class="keyword">:</span>tps<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#4085"><span class="stacstuse">DERS</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> ts<span class="keyword">,</span> G2<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="keyword">prfun</span> <span class="prfexp">dersshi <span class="staexp"><span class="keyword">{</span>G0<span class="keyword">,</span>G<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>ts<span class="keyword">,</span>ts'<span class="keyword">:</span>tms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>ds<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#4085"><span class="stacstuse">DERS</span></a> <span class="keyword">(</span>G0<span class="keyword">,</span> ts<span class="keyword">,</span> G<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> pf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#874"><span class="stacstuse">subshi</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> ts'<span class="keyword">)</span></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#4085"><span class="stacstuse">DERS</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span>G0<span class="keyword">,</span> T<span class="keyword">)</span><span class="keyword">,</span> ts'<span class="keyword">,</span> G<span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>ds<span class="keyword">,</span> pf<span class="keyword">)</span> <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">(</span>DERSnil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> SUBSHInil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> DERSnil <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">|</span> <span class="keyword">(</span>DERSmore <span class="keyword">(</span>ds<span class="keyword">,</span> d<span class="keyword">)</span><span class="keyword">,</span> SUBSHImore <span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
        DERSmore <span class="keyword">(</span>dersshi <span class="keyword">(</span>ds<span class="keyword">,</span> pf1<span class="keyword">)</span><span class="keyword">,</span> dershi0 <span class="keyword">(</span>d<span class="keyword">,</span> pf2<span class="keyword">)</span><span class="keyword">)</span></span>
<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma10 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>ts<span class="keyword">:</span>tms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>i<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>i<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>ds<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#4325"><span class="stacstuse">DERS0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> ts<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">,</span> i1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1852"><span class="stacstuse">TPI</span></a> <span class="keyword">(</span>i<span class="keyword">,</span> T<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">,</span> i2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1129"><span class="stacstuse">TMI</span></a> <span class="keyword">(</span>i<span class="keyword">,</span> t'<span class="keyword">,</span> ts<span class="keyword">)</span></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2419"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> t'<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> i1 <span class="keyword">of</span>
    <span class="keyword">|</span> TPIone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">let</span>
           <span class="keyword">prval</span> <span class="prfexp">TMIone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> i2</span>
           <span class="keyword">prval</span> <span class="prfexp">DERSmore <span class="keyword">(</span>_<span class="keyword">,</span> d<span class="keyword">)</span> <span class="keyword">=</span> ds</span>
        <span class="keyword">in</span>
           d
        <span class="keyword">end</span>
      <span class="keyword">end</span>

    <span class="keyword">|</span> TPIshi i1 <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">let</span>
           <span class="keyword">prval</span> <span class="prfexp">TMIshi i2 <span class="keyword">=</span> i2</span>
           <span class="keyword">prval</span> <span class="prfexp">DERSmore <span class="keyword">(</span>ds<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=</span> ds</span>
        <span class="keyword">in</span>
           lemma10 <span class="keyword">(</span>ds<span class="keyword">,</span> i1<span class="keyword">,</span> i2<span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">end</span></span>

<span class="keyword">prfun</span> <span class="prfexp">lemma10' <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>ts<span class="keyword">:</span>tms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>i<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>i<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>ds<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#4325"><span class="stacstuse">DERS0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> ts<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1852"><span class="stacstuse">TPI</span></a> <span class="keyword">(</span>i<span class="keyword">,</span> T<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>t'<span class="keyword">:</span>tm<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1129"><span class="stacstuse">TMI</span></a> <span class="keyword">(</span>i<span class="keyword">,</span> t'<span class="keyword">,</span> ts<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> i <span class="keyword">of</span>
  <span class="keyword">|</span> TPIone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">DERSmore <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>ts1<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">}</span></span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=</span> ds</span>
    <span class="keyword">in</span>
      TMIone <span class="staexp"><span class="keyword">{</span>ts1<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> TPIshi i <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">DERSmore <span class="keyword">(</span>ds<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=</span> ds</span> <span class="keyword">in</span> TMIshi <span class="keyword">(</span>lemma10' <span class="keyword">(</span>ds<span class="keyword">,</span> i<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">end</span>
    <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">substLemma <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>ts<span class="keyword">:</span>tms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>s<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>s<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>ds<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#4325"><span class="stacstuse">DERS0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> ts<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">,</span> d<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span></span><span class="keyword">,</span> pf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1308"><span class="stacstuse">subst</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> t<span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2419"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> t'<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> d <span class="keyword">of</span>
    <span class="keyword">|</span> DERvar i1 <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">SUBvar i2 <span class="keyword">=</span> pf</span> <span class="keyword">in</span>
          lemma10 <span class="keyword">(</span>ds<span class="keyword">,</span> i1<span class="keyword">,</span> i2<span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">end</span>

    <span class="keyword">|</span> DERlam d <span class="keyword">=&gt;</span>
        <span class="keyword">let</span>
           <span class="keyword">prval</span> <span class="prfexp">SUBlam <span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span> <span class="keyword">=</span> pf</span>
           <span class="keyword">prval</span> <span class="prfexp">ds <span class="keyword">=</span> DERSmore <span class="keyword">(</span>dersshi <span class="keyword">(</span>ds<span class="keyword">,</span> pf1<span class="keyword">)</span><span class="keyword">,</span> DERvar <span class="keyword">(</span>TPIone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>
        <span class="keyword">in</span>
           DERlam <span class="keyword">(</span>substLemma <span class="keyword">(</span>ds<span class="keyword">,</span> d<span class="keyword">,</span> pf2<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>

    <span class="keyword">|</span> DERapp <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">)</span> <span class="keyword">=&gt;</span>
        <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">SUBapp <span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span> <span class="keyword">=</span> pf</span> <span class="keyword">in</span>
           DERapp <span class="keyword">(</span>substLemma <span class="keyword">(</span>ds<span class="keyword">,</span> d1<span class="keyword">,</span> pf1<span class="keyword">)</span><span class="keyword">,</span> substLemma <span class="keyword">(</span>ds<span class="keyword">,</span> d2<span class="keyword">,</span> pf2<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span></span>

<span class="keyword">prfn</span> <span class="prfexp">substLemma0 <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">,</span>t2<span class="keyword">,</span>t2'<span class="keyword">:</span>tm<span class="keyword">}</span></span>
     <span class="keyword">(</span>d1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2419"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1812"><span class="stacstuse">tpsnil</span></a><span class="keyword">,</span> t1<span class="keyword">,</span> T1<span class="keyword">)</span></span><span class="keyword">,</span>
      d2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2419"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1812"><span class="stacstuse">tpsnil</span></a><span class="keyword">,</span> T1<span class="keyword">)</span><span class="keyword">,</span> t2<span class="keyword">,</span> T2<span class="keyword">)</span></span><span class="keyword">,</span>
      pf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1682"><span class="stacstuse">subst1</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">,</span> t2'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2419"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1812"><span class="stacstuse">tpsnil</span></a><span class="keyword">,</span> t2'<span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span>
  substLemma <span class="keyword">(</span>DERSmore <span class="keyword">(</span>DERSnil<span class="keyword">,</span> d1<span class="keyword">)</span><span class="keyword">,</span> d2<span class="keyword">,</span> pf<span class="keyword">)</span></span>

<span class="comment">//
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="6496"><span class="stacstdec">ISV <span class="keyword">(</span>tm<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> ISVlam <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#415"><span class="stacstuse">tmlam</span></a> t<span class="keyword">)</span></span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="6545"><span class="stacstdec">RED <span class="keyword">(</span>tm<span class="keyword">,</span> tm<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">,</span>t1'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      REDapp1 <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#431"><span class="stacstuse">tmapp</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#431"><span class="stacstuse">tmapp</span></a> <span class="keyword">(</span>t1'<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> s<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#6545"><span class="stacstuse">RED</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t1'<span class="keyword">,</span> s<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">,</span>t2'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      REDapp2 <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#431"><span class="stacstuse">tmapp</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#431"><span class="stacstuse">tmapp</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2'<span class="keyword">)</span><span class="keyword">,</span> s<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#6496"><span class="stacstuse">ISV</span></a> t1<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#6545"><span class="stacstuse">RED</span></a> <span class="keyword">(</span>t2<span class="keyword">,</span> t2'<span class="keyword">,</span> s<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>v<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span> REDapp3 <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#431"><span class="stacstuse">tmapp</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#415"><span class="stacstuse">tmlam</span></a> t<span class="keyword">,</span> v<span class="keyword">)</span><span class="keyword">,</span> t'<span class="keyword">,</span> 0<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#6496"><span class="stacstuse">ISV</span></a> v<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1682"><span class="stacstuse">subst1</span></a> <span class="keyword">(</span>v<span class="keyword">,</span> t<span class="keyword">,</span> t'<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="6868"><span class="stacstdec">RED0 <span class="keyword">(</span>t<span class="keyword">:</span>tm<span class="keyword">,</span> t'<span class="keyword">:</span>tm<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>s<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#6545"><span class="stacstuse">RED</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">,</span> s<span class="keyword">)</span></span></a></span>

<span class="comment">// Subject Reduction Theorem
</span>
<span class="keyword">prfun</span> <span class="prfexp">subjectReduction <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>s<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>s<span class="keyword">&gt;.</span></span>
   <span class="keyword">(</span>d<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1812"><span class="stacstuse">tpsnil</span></a><span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span></span><span class="keyword">,</span> pf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#6868"><span class="stacstuse">RED0</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2419"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1812"><span class="stacstuse">tpsnil</span></a><span class="keyword">,</span> t'<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> pf <span class="keyword">of</span>
    <span class="keyword">|</span> REDapp1 pf <span class="keyword">=&gt;</span>
        <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">DERapp <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">)</span> <span class="keyword">=</span> d</span> <span class="keyword">in</span>
          DERapp <span class="keyword">(</span>subjectReduction <span class="keyword">(</span>d1<span class="keyword">,</span> pf<span class="keyword">)</span><span class="keyword">,</span> d2<span class="keyword">)</span>
        <span class="keyword">end</span>

    <span class="keyword">|</span> REDapp2 <span class="keyword">(</span>_<span class="keyword">,</span> pf<span class="keyword">)</span> <span class="keyword">=&gt;</span>
        <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">DERapp <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">)</span> <span class="keyword">=</span> d</span> <span class="keyword">in</span>
          DERapp <span class="keyword">(</span>d1<span class="keyword">,</span> subjectReduction <span class="keyword">(</span>d2<span class="keyword">,</span> pf<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>

    <span class="keyword">|</span> REDapp3 <span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span> <span class="keyword">=&gt;</span>
        <span class="keyword">let</span>
           <span class="keyword">prval</span> <span class="prfexp">DERapp <span class="keyword">(</span>DERlam d1<span class="keyword">,</span> d2<span class="keyword">)</span> <span class="keyword">=</span> d</span>
        <span class="keyword">in</span>
            substLemma0 <span class="keyword">(</span>d2<span class="keyword">,</span> d1<span class="keyword">,</span> pf2<span class="keyword">)</span>
        <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="7493"><span class="stacstdec">ORELSE <span class="keyword">(</span>p1<span class="keyword">:</span> prop<span class="keyword">,</span> p2<span class="keyword">:</span> prop<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  inl <span class="staexp"><span class="keyword">(</span>p1<span class="keyword">,</span> p2<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">p1</span> <span class="keyword">|</span> inr <span class="staexp"><span class="keyword">(</span>p1<span class="keyword">,</span> p2<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">p2</span></span>

<span class="neuexp"><span class="keyword">infixl</span> ORELSE</span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">substLemma' <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>ts<span class="keyword">:</span>tms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>s<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>s<span class="keyword">&gt;.</span></span>
   <span class="keyword">(</span>ds<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#4325"><span class="stacstuse">DERS0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> ts<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">,</span> d<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>t'<span class="keyword">:</span>tm<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1308"><span class="stacstuse">subst</span></a> <span class="keyword">(</span>ts<span class="keyword">,</span> t<span class="keyword">,</span> t'<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> d <span class="keyword">of</span>
    <span class="keyword">|</span> DERvar i <span class="keyword">=&gt;</span> SUBvar <span class="keyword">(</span>lemma10' <span class="keyword">(</span>ds<span class="keyword">,</span> i<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">|</span> DERlam d <span class="keyword">=&gt;</span>
        <span class="keyword">let</span>
           <span class="keyword">prval</span> <span class="prfexp">pf1 <span class="keyword">=</span> subshiFun <span class="staexp"><span class="keyword">{</span>ts<span class="keyword">}</span></span></span>
           <span class="keyword">prval</span> <span class="prfexp">ds <span class="keyword">=</span> DERSmore <span class="keyword">(</span>dersshi <span class="keyword">(</span>ds<span class="keyword">,</span> pf1<span class="keyword">)</span><span class="keyword">,</span> DERvar <span class="keyword">(</span>TPIone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>
           <span class="keyword">prval</span> <span class="prfexp">pf2 <span class="keyword">=</span> substLemma' <span class="keyword">(</span>ds<span class="keyword">,</span> d<span class="keyword">)</span></span>
        <span class="keyword">in</span>
           SUBlam <span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span>
        <span class="keyword">end</span>

    <span class="keyword">|</span> DERapp <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">)</span> <span class="keyword">=&gt;</span> SUBapp <span class="keyword">(</span>substLemma' <span class="keyword">(</span>ds<span class="keyword">,</span> d1<span class="keyword">)</span><span class="keyword">,</span> substLemma' <span class="keyword">(</span>ds<span class="keyword">,</span> d2<span class="keyword">)</span><span class="keyword">)</span></span>

<span class="keyword">prfn</span> <span class="prfexp">substLemma0' <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">,</span>t2<span class="keyword">:</span>tm<span class="keyword">}</span></span>
   <span class="keyword">(</span>d1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2419"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1812"><span class="stacstuse">tpsnil</span></a><span class="keyword">,</span> t1<span class="keyword">,</span> T1<span class="keyword">)</span></span><span class="keyword">,</span> d2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2419"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1821"><span class="stacstuse">tpsmore</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1812"><span class="stacstuse">tpsnil</span></a><span class="keyword">,</span> T1<span class="keyword">)</span><span class="keyword">,</span> t2<span class="keyword">,</span> T2<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>t2'<span class="keyword">:</span>tm<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1682"><span class="stacstuse">subst1</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">,</span> t2'<span class="keyword">)</span></span> <span class="keyword">=</span>
  substLemma' <span class="keyword">(</span>DERSmore <span class="keyword">(</span>DERSnil<span class="keyword">,</span> d1<span class="keyword">)</span><span class="keyword">,</span> d2<span class="keyword">)</span></span>

<span class="comment">// Progress Theorem
</span>
<span class="keyword">prfun</span> <span class="prfexp">progress <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>s<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>s<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>d<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#2035"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#1812"><span class="stacstuse">tpsnil</span></a><span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#6496"><span class="stacstuse">ISV</span></a> t<span class="keyword">)</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#7493"><span class="stacstuse">ORELSE</span></a> <span class="keyword">[</span>t'<span class="keyword">:</span>tm<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dfoas_2edats.html#6868"><span class="stacstuse">RED0</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span></span> <span class="keyword">=</span> 
  <span class="keyword">case+</span> d <span class="keyword">of</span>
    <span class="keyword">|</span> DERlam _ <span class="keyword">=&gt;</span> inl <span class="keyword">(</span>ISVlam<span class="keyword">)</span>

    <span class="keyword">|</span> DERapp <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case</span> progress d1 <span class="keyword">of</span>
        <span class="keyword">|</span> inl pf1_l <span class="keyword">=&gt;</span>
          <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">ISVlam <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> pf1_l</span> <span class="keyword">in</span>
             <span class="keyword">case+</span> progress d2 <span class="keyword">of</span>
               <span class="keyword">|</span> inl pf2_l <span class="keyword">=&gt;</span>
                 <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">DERlam <span class="keyword">(</span>d1<span class="keyword">)</span> <span class="keyword">=</span> d1</span> <span class="keyword">in</span>
                    inr <span class="keyword">(</span>REDapp3 <span class="keyword">(</span>pf2_l<span class="keyword">,</span> substLemma0' <span class="keyword">(</span>d2<span class="keyword">,</span> d1<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
                 <span class="keyword">end</span>
               <span class="keyword">|</span> inr pf2_r <span class="keyword">=&gt;</span> inr <span class="keyword">(</span>REDapp2 <span class="keyword">(</span>pf1_l<span class="keyword">,</span> pf2_r<span class="keyword">)</span><span class="keyword">)</span>
          <span class="keyword">end</span>

        <span class="keyword">|</span> inr pf1_r <span class="keyword">=&gt;</span> inr <span class="keyword">(</span>REDapp1 pf1_r<span class="keyword">)</span>
      <span class="keyword">end</span>

    <span class="keyword">|</span> DERvar i <span class="keyword">=/=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">case+</span> i <span class="keyword">of</span> TPIone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">|</span> TPIshi _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span></span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [STLC-foas.dats] *)</span>
</pre>
</body>
</html>
