<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">//
</span><span class="comment">// simply typed lambda calculus is strongly-normalizing
</span><span class="comment">// This formalization uses first-order abstract syntax for lambda-terms.
</span><span class="comment">// There are several unproven lemmas, which can certainly be finished
</span><span class="comment">// but require significant effort that is uninspiring and tedious.
</span><span class="comment">//
</span>
<span class="comment">// April 2006:
</span><span class="comment">// The code is written by Kevin Donnelly and Hongwei Xi.
</span>
<span class="comment">// January 2007:
</span><span class="comment">// The code is ported to ATS/Geizella by Hongwei Xi
</span>
<span class="comment">// March 3rd, 2008
</span><span class="comment">// It is ported to ATS/Anairiats by Hongwei Xi
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">datasort</span> <span class="staexp">tm <span class="keyword">=</span> tmvar <span class="keyword">of</span> int <span class="keyword">|</span> tmlam <span class="keyword">of</span> tm <span class="keyword">|</span> tmapp <span class="keyword">of</span> <span class="keyword">(</span>tm<span class="keyword">,</span> tm<span class="keyword">)</span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="575"><span class="stacstdec">ISE <span class="keyword">(</span>tm<span class="keyword">)</span></span></a></span> <span class="keyword">=</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t2<span class="keyword">:</span>tm</span><span class="keyword">}</span> ISE <span class="staexp"><span class="keyword">(</span>tmapp <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="633"><span class="stacstdec">tmshi <span class="keyword">(</span>tm<span class="keyword">,</span> tm<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">,</span>l<span class="keyword">:</span>nat</span> <span class="keyword">|</span> <span class="staexp">i &gt;= l</span><span class="keyword">}</span> TMSHIvargte <span class="staexp"><span class="keyword">(</span>tmvar i<span class="keyword">,</span> tmvar <span class="keyword">(</span>i+1<span class="keyword">)</span><span class="keyword">,</span> l<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">,</span>l<span class="keyword">:</span>nat</span> <span class="keyword">|</span> <span class="staexp">i <span class="keyword">&lt;</span> l</span><span class="keyword">}</span> TMSHIvarlt <span class="staexp"><span class="keyword">(</span>tmvar i<span class="keyword">,</span> tmvar i<span class="keyword">,</span> l<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">l<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      TMSHIlam <span class="staexp"><span class="keyword">(</span>tmlam t<span class="keyword">,</span> tmlam t'<span class="keyword">,</span> l<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">tmshi <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">,</span> l+1<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">,</span>t1'<span class="keyword">,</span>t2'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">l<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      TMSHIapp <span class="staexp"><span class="keyword">(</span>tmapp <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> tmapp <span class="keyword">(</span>t1'<span class="keyword">,</span> t2'<span class="keyword">)</span><span class="keyword">,</span> l<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span>tmshi <span class="keyword">(</span>t1<span class="keyword">,</span> t1'<span class="keyword">,</span> l<span class="keyword">)</span><span class="keyword">,</span> tmshi <span class="keyword">(</span>t2<span class="keyword">,</span> t2'<span class="keyword">,</span> l<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">datasort</span> <span class="staexp">tms <span class="keyword">=</span> tmsnil <span class="keyword">|</span> tmsmore <span class="keyword">of</span> <span class="keyword">(</span>tms<span class="keyword">,</span> tm<span class="keyword">)</span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1048"><span class="stacstdec">subshi <span class="keyword">(</span>tms<span class="keyword">,</span> tms<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> SUBSHInil <span class="staexp"><span class="keyword">(</span>tmsnil<span class="keyword">,</span> tmsnil<span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">,</span>ts'<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span>
      SUBSHImore <span class="staexp"><span class="keyword">(</span>tmsmore <span class="keyword">(</span>ts<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> tmsmore <span class="keyword">(</span>ts'<span class="keyword">,</span> t'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span>subshi <span class="keyword">(</span>ts<span class="keyword">,</span> ts'<span class="keyword">)</span><span class="keyword">,</span> tmshi <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">,</span> 0<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="comment">//
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1242"><span class="stacstdec">TMI <span class="keyword">(</span>int<span class="keyword">,</span> tm<span class="keyword">,</span> tms<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> TMIone <span class="staexp"><span class="keyword">(</span>0<span class="keyword">,</span> t<span class="keyword">,</span> tmsmore <span class="keyword">(</span>ts<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>int</span> <span class="keyword">|</span> <span class="staexp">i <span class="keyword">&gt;</span> 0</span><span class="keyword">}</span>
      TMIshi <span class="staexp"><span class="keyword">(</span>i<span class="keyword">,</span> t<span class="keyword">,</span> tmsmore <span class="keyword">(</span>ts<span class="keyword">,</span> t'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">TMI <span class="keyword">(</span>i-1<span class="keyword">,</span> t<span class="keyword">,</span> ts<span class="keyword">)</span></span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1421"><span class="stacstdec">subst <span class="keyword">(</span>tms<span class="keyword">,</span> tm<span class="keyword">,</span> tm<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>nat</span><span class="keyword">}</span> SUBvar <span class="staexp"><span class="keyword">(</span>ts<span class="keyword">,</span> tmvar i<span class="keyword">,</span> t<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">TMI <span class="keyword">(</span>i<span class="keyword">,</span> t<span class="keyword">,</span> ts<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">,</span>ts'<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span>
      SUBlam <span class="staexp"><span class="keyword">(</span>ts<span class="keyword">,</span> tmlam t<span class="keyword">,</span> tmlam t'<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span>subshi <span class="keyword">(</span>ts<span class="keyword">,</span> ts'<span class="keyword">)</span><span class="keyword">,</span> subst <span class="keyword">(</span>tmsmore <span class="keyword">(</span>ts'<span class="keyword">,</span> tmvar 0<span class="keyword">)</span><span class="keyword">,</span> t<span class="keyword">,</span> t'<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">,</span>t1'<span class="keyword">,</span>t2'<span class="keyword">:</span>tm</span><span class="keyword">}</span>
      SUBapp <span class="staexp"><span class="keyword">(</span>ts<span class="keyword">,</span> tmapp <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> tmapp <span class="keyword">(</span>t1'<span class="keyword">,</span> t2'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span>subst <span class="keyword">(</span>ts<span class="keyword">,</span> t1<span class="keyword">,</span> t1'<span class="keyword">)</span><span class="keyword">,</span> subst <span class="keyword">(</span>ts<span class="keyword">,</span> t2<span class="keyword">,</span> t2'<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="1795"><span class="stacstdec">subst1 <span class="keyword">(</span>t1<span class="keyword">:</span>tm<span class="keyword">,</span> t2<span class="keyword">:</span>tm<span class="keyword">,</span> t3<span class="keyword">:</span>tm<span class="keyword">)</span> <span class="keyword">=</span> subst <span class="keyword">(</span>tmsmore <span class="keyword">(</span>tmsnil<span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> t2<span class="keyword">,</span> t3<span class="keyword">)</span></span></a></span>

<span class="comment">//
</span>
<span class="keyword">datasort</span> <span class="staexp">tp <span class="keyword">=</span> tpbas <span class="keyword">|</span> tpfun <span class="keyword">of</span> <span class="keyword">(</span>tp<span class="keyword">,</span> tp<span class="keyword">)</span></span>

<span class="keyword">datasort</span> <span class="staexp">tps <span class="keyword">=</span> tpsnil <span class="keyword">|</span> tpsmore <span class="keyword">of</span> <span class="keyword">(</span>tps<span class="keyword">,</span> tp<span class="keyword">)</span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1964"><span class="stacstdec">TP <span class="keyword">(</span>tp<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span> 
  <span class="keyword">|</span> TPbas <span class="staexp"><span class="keyword">(</span>tpbas<span class="keyword">,</span> 0<span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      TPfun <span class="staexp"><span class="keyword">(</span>tpfun <span class="keyword">(</span>T1<span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">,</span> n1+n2+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span>TP <span class="keyword">(</span>T1<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> TP <span class="keyword">(</span>T2<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="2105"><span class="stacstdec">TP0 <span class="keyword">(</span>T<span class="keyword">:</span>tp<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> TP <span class="keyword">(</span>T<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="comment">//
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="2150"><span class="stacstdec">TPI <span class="keyword">(</span>int<span class="keyword">,</span> tp<span class="keyword">,</span> tps<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span> TPIone <span class="staexp"><span class="keyword">(</span>0<span class="keyword">,</span> T<span class="keyword">,</span> tpsmore <span class="keyword">(</span>G<span class="keyword">,</span> T<span class="keyword">)</span><span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">,</span>T'<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>int</span> <span class="keyword">|</span> <span class="staexp">i <span class="keyword">&gt;</span> 0</span><span class="keyword">}</span>
      TPIshi <span class="staexp"><span class="keyword">(</span>i<span class="keyword">,</span> T<span class="keyword">,</span> tpsmore <span class="keyword">(</span>G<span class="keyword">,</span> T'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">TPI <span class="keyword">(</span>i-1<span class="keyword">,</span> T<span class="keyword">,</span> G<span class="keyword">)</span></span></span>

<span class="comment">//
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="2328"><span class="stacstdec">DER <span class="keyword">(</span>tps<span class="keyword">,</span> tm<span class="keyword">,</span> tp<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>nat</span><span class="keyword">}</span> DERvar <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> tmvar i<span class="keyword">,</span> T<span class="keyword">,</span> 0<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">TPI <span class="keyword">(</span>i<span class="keyword">,</span> T<span class="keyword">,</span> G<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERlam <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> tmlam t<span class="keyword">,</span> tpfun <span class="keyword">(</span>T1<span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">,</span> s+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">DER <span class="keyword">(</span>tpsmore <span class="keyword">(</span>G<span class="keyword">,</span> T1<span class="keyword">)</span><span class="keyword">,</span> t<span class="keyword">,</span> T2<span class="keyword">,</span> s<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s1<span class="keyword">,</span>s2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERapp <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> tmapp <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">,</span> s1+s2+1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span>DER <span class="keyword">(</span>G<span class="keyword">,</span> t1<span class="keyword">,</span> tpfun <span class="keyword">(</span>T1<span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">,</span> s1<span class="keyword">)</span><span class="keyword">,</span> DER <span class="keyword">(</span>G<span class="keyword">,</span> t2<span class="keyword">,</span> T1<span class="keyword">,</span> s2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="2712"><span class="stacstdec">DER0 <span class="keyword">(</span>G<span class="keyword">:</span>tps<span class="keyword">,</span> t<span class="keyword">:</span>tm<span class="keyword">,</span> T<span class="keyword">:</span>tp<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>s<span class="keyword">:</span>nat<span class="keyword">]</span> DER <span class="keyword">(</span>G<span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> s<span class="keyword">)</span></span></a></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="2774"><span class="stacstdec">INS <span class="keyword">(</span>tps<span class="keyword">,</span> tp<span class="keyword">,</span> int<span class="keyword">,</span> tps<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span> INSone <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> T<span class="keyword">,</span> 0<span class="keyword">,</span> tpsmore <span class="keyword">(</span>G<span class="keyword">,</span> T<span class="keyword">)</span><span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G1<span class="keyword">,</span>G2<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">,</span>T'<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      INSshi <span class="staexp"><span class="keyword">(</span>tpsmore <span class="keyword">(</span>G1<span class="keyword">,</span> T'<span class="keyword">)</span><span class="keyword">,</span> T<span class="keyword">,</span> i+1<span class="keyword">,</span> tpsmore <span class="keyword">(</span>G2<span class="keyword">,</span> T'<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">INS <span class="keyword">(</span>G1<span class="keyword">,</span> T<span class="keyword">,</span> i<span class="keyword">,</span> G2<span class="keyword">)</span></span></span>

<span class="comment">//
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="2980"><span class="stacstdec">RED <span class="keyword">(</span>tm<span class="keyword">,</span> tm<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">:</span>nat</span><span class="keyword">}</span> REDlam <span class="staexp"><span class="keyword">(</span>tmlam t<span class="keyword">,</span> tmlam t'<span class="keyword">,</span> s+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">RED <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">,</span> s<span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">,</span>t1'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      REDapp1 <span class="staexp"><span class="keyword">(</span>tmapp <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> tmapp <span class="keyword">(</span>t1'<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> s+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">RED <span class="keyword">(</span>t1<span class="keyword">,</span> t1'<span class="keyword">,</span> s<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">,</span>t2'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      REDapp2 <span class="staexp"><span class="keyword">(</span>tmapp <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> tmapp <span class="keyword">(</span>t1<span class="keyword">,</span> t2'<span class="keyword">)</span><span class="keyword">,</span> s+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">RED <span class="keyword">(</span>t2<span class="keyword">,</span> t2'<span class="keyword">,</span> s<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>v<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span> REDapp3 <span class="staexp"><span class="keyword">(</span>tmapp <span class="keyword">(</span>tmlam t<span class="keyword">,</span> v<span class="keyword">)</span><span class="keyword">,</span> t'<span class="keyword">,</span> 0<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">subst1 <span class="keyword">(</span>v<span class="keyword">,</span> t<span class="keyword">,</span> t'<span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="3356"><span class="stacstdec">RED0 <span class="keyword">(</span>t<span class="keyword">:</span>tm<span class="keyword">,</span> t'<span class="keyword">:</span>tm<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>s<span class="keyword">:</span>nat<span class="keyword">]</span> RED <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">,</span> s<span class="keyword">)</span></span></a></span>

<span class="comment">//
</span>
<span class="comment">(* Strong Normalization *)</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="3441"><span class="stacstdec">SN <span class="keyword">(</span>tm<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      SN <span class="staexp"><span class="keyword">(</span>t<span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span> <span class="keyword">(</span>RED0 <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> <span class="keyword">[</span>n'<span class="keyword">:</span>nat <span class="keyword">|</span> n' <span class="keyword">&lt;</span> n<span class="keyword">]</span> SN <span class="keyword">(</span>t'<span class="keyword">,</span> n'<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="3563"><span class="stacstdec">SN0 <span class="keyword">(</span>t<span class="keyword">:</span>tm<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> SN <span class="keyword">(</span>t<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="comment">// SN is closed under reduction
</span><span class="keyword">prfn</span> <span class="prfexp">forwardSN <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span>
  <span class="keyword">(</span>sn<span class="keyword">:</span><span class="staexp">SN<span class="keyword">(</span>t<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> red<span class="keyword">:</span><span class="staexp">RED0<span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>n'<span class="keyword">:</span>nat <span class="keyword">|</span> n' <span class="keyword">&lt;</span> n<span class="keyword">]</span> SN<span class="keyword">(</span>t'<span class="keyword">,</span> n'<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">SN fsn <span class="keyword">=</span> sn</span> <span class="keyword">in</span> fsn red <span class="keyword">end</span></span>

<span class="keyword">extern</span> <span class="keyword">prval</span> <a name="3779"><span class="dyncstdec"><span class="prfexp">backwardSN <span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span> <span class="keyword">(</span><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span> RED0 <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> SN0 t'<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> SN0 t</span></span></span></a>

<span class="comment">(* Reducibility *)</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="3878"><span class="stacstdec">R<span class="keyword">(</span>tm<span class="keyword">,</span> tp<span class="keyword">)</span></span></a></span> <span class="keyword">=</span> 
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> Rbas<span class="staexp"><span class="keyword">(</span>t<span class="keyword">,</span> tpbas<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp">SN0 t</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp</span><span class="keyword">}</span>
      Rfun <span class="staexp"><span class="keyword">(</span>t<span class="keyword">,</span> tpfun <span class="keyword">(</span>T1<span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><span class="keyword">{</span>t1<span class="keyword">:</span>tm<span class="keyword">}</span> R <span class="keyword">(</span>t1<span class="keyword">,</span> T1<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> R <span class="keyword">(</span>tmapp <span class="keyword">(</span>t<span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="comment">// sequence of redubility predicates for a substitution
</span><span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="4098"><span class="stacstdec">RS <span class="keyword">(</span>tms<span class="keyword">,</span> tps<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> RSnil <span class="staexp"><span class="keyword">(</span>tmsnil<span class="keyword">,</span> tpsnil<span class="keyword">,</span> 0<span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">ts<span class="keyword">:</span>tms</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>tps</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> 
      RSmore <span class="staexp"><span class="keyword">(</span>tmsmore <span class="keyword">(</span>ts<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> tpsmore<span class="keyword">(</span>G<span class="keyword">,</span> T<span class="keyword">)</span><span class="keyword">,</span> n+1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span>RS<span class="keyword">(</span>ts<span class="keyword">,</span> G<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">,</span> R<span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="4280"><span class="stacstdec">RS0<span class="keyword">(</span>ts<span class="keyword">:</span>tms<span class="keyword">,</span> G<span class="keyword">:</span>tps<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> RS<span class="keyword">(</span>ts<span class="keyword">,</span> G<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="comment">// definition of neutral terms
</span><span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="4363"><span class="stacstdec">NEU<span class="keyword">(</span>tm<span class="keyword">)</span></span></a></span> <span class="keyword">=</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>int</span><span class="keyword">}</span> NEUvar<span class="staexp"><span class="keyword">(</span>tmvar i<span class="keyword">)</span></span> <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">:</span>tm</span><span class="keyword">}</span> NEUapp<span class="staexp"><span class="keyword">(</span>tmapp<span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">extern</span> <span class="keyword">prval</span> <a name="4446"><span class="dyncstdec"><span class="prfexp">lamSN <span class="keyword">:</span>
  <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">,</span>t2<span class="keyword">,</span>t3<span class="keyword">:</span>tm<span class="keyword">}</span> <span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span> <span class="keyword">(</span>subst1 <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">,</span> t3<span class="keyword">)</span><span class="keyword">,</span> SN <span class="keyword">(</span>t3<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">-&gt;</span> SN <span class="keyword">(</span>t2<span class="keyword">,</span> n<span class="keyword">)</span></span></span></span></a>

<span class="keyword">prfun</span> <span class="prfexp">appSN1 <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">,</span>t2<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>sn<span class="keyword">:</span> <span class="staexp">SN<span class="keyword">(</span>tmapp <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">SN0 t1</span> <span class="keyword">=</span>
  <span class="keyword">let</span>
     <span class="keyword">prval</span> <span class="prfexp">SN fsn <span class="keyword">=</span> sn</span>
     <span class="keyword">prfn</span> <span class="prfexp">fsn1 <span class="staexp"><span class="keyword">{</span>t1'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>red<span class="keyword">:</span> <span class="staexp">RED0 <span class="keyword">(</span>t1<span class="keyword">,</span> t1'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">SN0 <span class="keyword">(</span>t1'<span class="keyword">)</span></span> <span class="keyword">=</span>
       appSN1 <span class="keyword">(</span>fsn <span class="keyword">(</span>REDapp1 <span class="keyword">(</span>red<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>
  <span class="keyword">in</span>
     backwardSN <span class="keyword">(</span>fsn1<span class="keyword">)</span>
  <span class="keyword">end</span></span>

<span class="comment">(* CR 2 *)</span>
<span class="comment">// R is preserved by forward reduction
</span><span class="keyword">prfun</span> <span class="prfexp">cr2 <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>tp<span class="keyword">:</span> <span class="staexp">TP <span class="keyword">(</span>T<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> r<span class="keyword">:</span> <span class="staexp">R<span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span></span><span class="keyword">,</span> rd <span class="keyword">:</span> <span class="staexp">RED0<span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">R<span class="keyword">(</span>t'<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> r <span class="keyword">of</span>
  <span class="keyword">|</span> Rbas sn <span class="keyword">=&gt;</span> Rbas <span class="keyword">(</span>forwardSN <span class="keyword">(</span>sn<span class="keyword">,</span> rd<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> Rfun <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">}</span></span> fr <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">TPfun <span class="keyword">(</span>_<span class="keyword">,</span> tp2<span class="keyword">)</span> <span class="keyword">=</span> tp</span>
    <span class="keyword">in</span>
      Rfun <span class="keyword">(</span><span class="keyword">lam</span> <span class="keyword">(</span>r<span class="keyword">)</span> <span class="keyword">=&lt;&gt;</span> cr2 <span class="keyword">(</span>tp2<span class="keyword">,</span> fr r<span class="keyword">,</span> REDapp1 rd<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span></span> <span class="comment">// end of [cr2]
</span>
<span class="comment">(* CR 1 *)</span>
<span class="comment">// R implies strongly normalizing
</span><span class="keyword">prfun</span> <span class="prfexp">cr1 <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">,</span> 0<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>tp<span class="keyword">:</span> <span class="staexp">TP <span class="keyword">(</span>T<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> pf<span class="keyword">:</span> <span class="staexp">R<span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp">SN0 t</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> pf <span class="keyword">of</span>
  <span class="keyword">|</span> Rbas sn <span class="keyword">=&gt;</span> sn
  <span class="keyword">|</span> Rfun fr <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">TPfun <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">)</span> <span class="keyword">=</span> tp</span>
    <span class="keyword">in</span>
      appSN1 <span class="keyword">(</span>cr1 <span class="keyword">(</span>tp2<span class="keyword">,</span> fr <span class="keyword">(</span>cr4 tp1<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span> <span class="comment">// end of [cr1]
</span>
<span class="comment">(* CR4 *)</span>
<span class="keyword">and</span> cr4 <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">,</span> 2<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>tp<span class="keyword">:</span> <span class="staexp">TP <span class="keyword">(</span>T<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>tmvar 0<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prfn</span> <span class="prfexp">fr <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>red<span class="keyword">:</span> <span class="staexp">RED0 <span class="keyword">(</span>tmvar 0<span class="keyword">,</span> t<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> red <span class="keyword">of</span> REDlam _ <span class="keyword">=/=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span></span>
<span class="keyword">in</span>
  cr3 <span class="keyword">(</span>NEUvar <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> tp<span class="keyword">,</span> fr<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [cr4]
</span>
<span class="comment">(* CR 3*)</span>
<span class="comment">// (NEU t and for all t' such that t --&gt; t' we have R(t',T)) implies R(t,T)
</span><span class="keyword">and</span> cr3 <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">,</span> 1<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>
    neu<span class="keyword">:</span> <span class="staexp">NEU<span class="keyword">(</span>t<span class="keyword">)</span></span>
  <span class="keyword">,</span> tp<span class="keyword">:</span> <span class="staexp">TP<span class="keyword">(</span>T<span class="keyword">,</span> n<span class="keyword">)</span></span>
  <span class="keyword">,</span> fr <span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span> RED0<span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> R<span class="keyword">(</span>t'<span class="keyword">,</span> T<span class="keyword">)</span></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp">R<span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span> 
  <span class="keyword">prval</span> <span class="prfexp">fsn <span class="keyword">=</span> <span class="keyword">lam</span> <span class="staexp"><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">=&gt;</span> <span class="keyword">lam</span> <span class="keyword">(</span>red<span class="keyword">:</span><span class="staexp">RED0<span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">=&lt;&gt;</span> cr1 <span class="keyword">(</span>tp<span class="keyword">,</span> fr red<span class="keyword">)</span></span>
  <span class="keyword">prval</span> <span class="prfexp">sn <span class="keyword">=</span> backwardSN fsn</span>
<span class="keyword">in</span>
  <span class="keyword">case+</span> tp <span class="keyword">of</span>
  <span class="keyword">|</span> TPbas<span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> Rbas sn
  <span class="keyword">|</span> TPfun <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n1<span class="keyword">,</span>n2<span class="keyword">}</span></span> <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prfn</span> <span class="prfexp">fr <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>r1<span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>t1<span class="keyword">,</span> T1<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>tmapp <span class="keyword">(</span>t<span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span>
        cr3a <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">,</span> neu<span class="keyword">,</span> r1<span class="keyword">,</span> cr1 <span class="keyword">(</span>tp1<span class="keyword">,</span> r1<span class="keyword">)</span><span class="keyword">,</span> fr<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      Rfun fr
    <span class="keyword">end</span>
<span class="keyword">end</span> <span class="comment">// end of [cr3]
</span>
<span class="keyword">and</span> cr3a <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t1<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">,</span>n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n2<span class="keyword">,</span> m+2<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>
    tp1<span class="keyword">:</span> <span class="staexp">TP <span class="keyword">(</span>T1<span class="keyword">,</span> n1<span class="keyword">)</span></span>
  <span class="keyword">,</span> tp2<span class="keyword">:</span> <span class="staexp">TP <span class="keyword">(</span>T2<span class="keyword">,</span> n2<span class="keyword">)</span></span>
  <span class="keyword">,</span> neu<span class="keyword">:</span> <span class="staexp">NEU t</span><span class="keyword">,</span> r1<span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>t1<span class="keyword">,</span> T1<span class="keyword">)</span></span>
  <span class="keyword">,</span> sn1<span class="keyword">:</span> <span class="staexp">SN <span class="keyword">(</span>t1<span class="keyword">,</span> m<span class="keyword">)</span></span>
  <span class="keyword">,</span> f<span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span> RED0 <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> R <span class="keyword">(</span>t'<span class="keyword">,</span> tpfun <span class="keyword">(</span>T1<span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">)</span></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>tmapp <span class="keyword">(</span>t<span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prfn</span> <span class="prfexp">ff <span class="staexp"><span class="keyword">{</span>tt<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>rd<span class="keyword">:</span> <span class="staexp">RED0 <span class="keyword">(</span>tmapp <span class="keyword">(</span>t<span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> tt<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>tt<span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> rd <span class="keyword">of</span>
    <span class="keyword">|</span> REDapp1 rd <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp">Rfun fr <span class="keyword">=</span> f rd</span>
      <span class="keyword">in</span>
        fr <span class="keyword">(</span>r1<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> REDapp2 rd <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp">SN fsn1 <span class="keyword">=</span> sn1</span>
      <span class="keyword">in</span>
        cr3a <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">,</span> neu<span class="keyword">,</span> cr2 <span class="keyword">(</span>tp1<span class="keyword">,</span> r1<span class="keyword">,</span> rd<span class="keyword">)</span><span class="keyword">,</span> fsn1 rd<span class="keyword">,</span> f<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> REDapp3 _ <span class="keyword">=/=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">case+</span> neu <span class="keyword">of</span> NEUvar<span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">|</span> NEUapp<span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span></span>
<span class="keyword">in</span>
  cr3  <span class="keyword">(</span>NEUapp<span class="keyword">,</span> tp2<span class="keyword">,</span> ff<span class="keyword">)</span>
<span class="keyword">end</span></span> <span class="comment">// end of [cr3a]
</span>
<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">mainLemmaVar <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>ts<span class="keyword">:</span>tms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>i<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>i<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>tpi<span class="keyword">:</span> <span class="staexp">TPI <span class="keyword">(</span>i<span class="keyword">,</span> T<span class="keyword">,</span> G<span class="keyword">)</span></span><span class="keyword">,</span> tmi<span class="keyword">:</span> <span class="staexp">TMI <span class="keyword">(</span>i<span class="keyword">,</span> t<span class="keyword">,</span> ts<span class="keyword">)</span></span><span class="keyword">,</span> rs<span class="keyword">:</span> <span class="staexp">RS0 <span class="keyword">(</span>ts<span class="keyword">,</span> G<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>tpi<span class="keyword">,</span> tmi<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>TPIone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> TMIone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>  <span class="keyword">=&gt;</span> <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">RSmore <span class="keyword">(</span>_<span class="keyword">,</span> r<span class="keyword">)</span> <span class="keyword">=</span> rs</span> <span class="keyword">in</span> r <span class="keyword">end</span>
  <span class="keyword">|</span> <span class="keyword">(</span>TPIshi tpi<span class="keyword">,</span> TMIshi tmi<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">RSmore <span class="keyword">(</span>rs<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=</span> rs</span> <span class="keyword">in</span> mainLemmaVar <span class="keyword">(</span>tpi<span class="keyword">,</span> tmi<span class="keyword">,</span> rs<span class="keyword">)</span> <span class="keyword">end</span>
    <span class="keyword">end</span></span>

<span class="keyword">extern</span> <span class="keyword">prval</span> <a name="7259"><span class="dyncstdec"><span class="prfexp">der2tp<span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>tps<span class="keyword">}</span> <span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span> <span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span> DER0 <span class="keyword">(</span>G<span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> TP0 T</span></span></span></a>

<span class="keyword">extern</span> <span class="keyword">prval</span> <a name="7331"><span class="dyncstdec"><span class="prfexp">lemma10 <span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span> subst <span class="keyword">(</span>tmsnil<span class="keyword">,</span> t<span class="keyword">,</span> t<span class="keyword">)</span></span></span></span></a>

<span class="keyword">extern</span> <span class="keyword">prval</span> <a name="7383"><span class="dyncstdec"><span class="prfexp">lemma20 <span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>ts<span class="keyword">,</span>ts'<span class="keyword">:</span>tms<span class="keyword">}</span> <span class="keyword">{</span>t<span class="keyword">,</span>t1<span class="keyword">,</span>t'<span class="keyword">,</span>t''<span class="keyword">:</span>tm<span class="keyword">}</span> <span class="keyword">(</span>
  subshi <span class="keyword">(</span>ts<span class="keyword">,</span> ts'<span class="keyword">)</span><span class="keyword">,</span> subst <span class="keyword">(</span>tmsmore <span class="keyword">(</span>ts'<span class="keyword">,</span> tmvar 0<span class="keyword">)</span><span class="keyword">,</span> t<span class="keyword">,</span> t'<span class="keyword">)</span><span class="keyword">,</span> subst1 <span class="keyword">(</span>t1<span class="keyword">,</span> t'<span class="keyword">,</span> t''<span class="keyword">)</span>
<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> subst <span class="keyword">(</span>tmsmore <span class="keyword">(</span>ts<span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> t<span class="keyword">,</span> t''<span class="keyword">)</span></span></span></span></a>

<span class="keyword">extern</span> <span class="keyword">prval</span> <a name="7561"><span class="dyncstdec"><span class="prfexp">reduceFun <span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>f<span class="keyword">,</span>t<span class="keyword">:</span>tm<span class="keyword">}</span> <span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp<span class="keyword">}</span> <span class="keyword">(</span>
    TP0 T1
  <span class="keyword">,</span> TP0 T2
  <span class="keyword">,</span> R<span class="keyword">(</span>t<span class="keyword">,</span> T1<span class="keyword">)</span>
  <span class="keyword">,</span> <span class="keyword">{</span>t1<span class="keyword">,</span>t2<span class="keyword">:</span>tm<span class="keyword">}</span> <span class="keyword">(</span>subst1 <span class="keyword">(</span>t1<span class="keyword">,</span> f<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> R<span class="keyword">(</span>t1<span class="keyword">,</span> T1<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> R<span class="keyword">(</span>t2<span class="keyword">,</span> T2<span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> R<span class="keyword">(</span>tmapp <span class="keyword">(</span>tmlam f<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span></span></span></a>

<span class="keyword">prfun</span> <span class="prfexp">mainLemma <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>tps<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>ts<span class="keyword">:</span>tms<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n+1<span class="keyword">,</span> 0<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>der<span class="keyword">:</span> <span class="staexp">DER <span class="keyword">(</span>G<span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> rs<span class="keyword">:</span> <span class="staexp">RS0 <span class="keyword">(</span>ts<span class="keyword">,</span> G<span class="keyword">)</span></span><span class="keyword">,</span> sub<span class="keyword">:</span> <span class="staexp">subst <span class="keyword">(</span>ts<span class="keyword">,</span> t<span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>t'<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> der <span class="keyword">of</span>
  <span class="keyword">|</span> DERvar tpi <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">SUBvar tmi <span class="keyword">=</span> sub</span>
    <span class="keyword">in</span>
      mainLemmaVar <span class="keyword">(</span>tpi<span class="keyword">,</span> tmi<span class="keyword">,</span> rs<span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERapp <span class="keyword">(</span>der1<span class="keyword">,</span> der2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">SUBapp <span class="keyword">(</span>sub1<span class="keyword">,</span> sub2<span class="keyword">)</span> <span class="keyword">=</span> sub</span>
      <span class="keyword">prval</span> <span class="prfexp">r1 <span class="keyword">=</span> mainLemma <span class="keyword">(</span>der1<span class="keyword">,</span> rs<span class="keyword">,</span> sub1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">Rfun fr1 <span class="keyword">=</span> r1</span>
      <span class="keyword">prval</span> <span class="prfexp">r2 <span class="keyword">=</span> mainLemma <span class="keyword">(</span>der2<span class="keyword">,</span> rs<span class="keyword">,</span> sub2<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      fr1 r2
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERlam <span class="keyword">(</span>der0<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span> 
      <span class="keyword">prval</span> <span class="prfexp">TPfun<span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>s1<span class="keyword">,</span>s2<span class="keyword">}</span></span> <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">)</span> <span class="keyword">=</span> der2tp der</span>
      <span class="keyword">prval</span> <span class="prfexp">SUBlam <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>f<span class="keyword">,</span>f'<span class="keyword">}</span></span> <span class="keyword">(</span>pf<span class="keyword">,</span> sublam<span class="keyword">)</span> <span class="keyword">=</span> sub</span>
      <span class="keyword">prfun</span> <span class="prfexp">fr <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">,</span> m+1<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>r<span class="keyword">:</span> <span class="staexp">R<span class="keyword">(</span>t<span class="keyword">,</span>T1<span class="keyword">)</span></span><span class="keyword">,</span> sn2<span class="keyword">:</span> <span class="staexp">SN<span class="keyword">(</span>t<span class="keyword">,</span>m<span class="keyword">)</span></span><span class="keyword">)</span>
        <span class="keyword">:</span> <span class="staexp">R<span class="keyword">(</span>tmapp <span class="keyword">(</span>tmlam f'<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
        <span class="keyword">prfn</span> <span class="prfexp">gr <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">,</span>t2<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>sub1<span class="keyword">:</span> <span class="staexp">subst1 <span class="keyword">(</span>t1<span class="keyword">,</span> f'<span class="keyword">,</span> t2<span class="keyword">)</span></span><span class="keyword">,</span> r<span class="keyword">:</span> <span class="staexp">R<span class="keyword">(</span>t1<span class="keyword">,</span>T1<span class="keyword">)</span></span><span class="keyword">)</span>
          <span class="keyword">:</span> <span class="staexp">R<span class="keyword">(</span>t2<span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">rs' <span class="keyword">=</span> RSmore <span class="keyword">(</span>rs<span class="keyword">,</span> r<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">sub0 <span class="keyword">=</span> lemma20 <span class="keyword">(</span>pf<span class="keyword">,</span> sublam<span class="keyword">,</span> sub1<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">r' <span class="keyword">=</span> mainLemma <span class="keyword">(</span>der0<span class="keyword">,</span> rs'<span class="keyword">,</span> sub0<span class="keyword">)</span></span>
        <span class="keyword">in</span>
          r'
        <span class="keyword">end</span></span>
      <span class="keyword">in</span>
        reduceFun<span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">,</span> r<span class="keyword">,</span> gr<span class="keyword">)</span>
      <span class="keyword">end</span></span>

      <span class="keyword">prfn</span> <span class="prfexp">f <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>r<span class="keyword">:</span> <span class="staexp">R<span class="keyword">(</span>t<span class="keyword">,</span>T1<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>tmapp <span class="keyword">(</span>tmlam f'<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span>
       fr<span class="keyword">(</span>r<span class="keyword">,</span> cr1 <span class="keyword">(</span>tp1<span class="keyword">,</span> r<span class="keyword">)</span><span class="keyword">)</span></span>
    <span class="keyword">in</span>
      Rfun f
    <span class="keyword">end</span>
<span class="keyword">end</span></span> <span class="comment">// end of [mainLemma]
</span>
<span class="comment">// all typable terms are reducible
</span><span class="keyword">prfn</span> <span class="prfexp">reduce <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="keyword">(</span>der<span class="keyword">:</span> <span class="staexp">DER0 <span class="keyword">(</span>tpsnil<span class="keyword">,</span>t<span class="keyword">,</span>T<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">R <span class="keyword">(</span>t<span class="keyword">,</span>T<span class="keyword">)</span></span> <span class="keyword">=</span>
  mainLemma<span class="keyword">(</span>der<span class="keyword">,</span> RSnil<span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> lemma10<span class="keyword">)</span></span>

<span class="comment">// the final payoff
</span><span class="keyword">prfn</span> <span class="prfexp">normalize <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="keyword">(</span>der<span class="keyword">:</span> <span class="staexp">DER0 <span class="keyword">(</span>tpsnil<span class="keyword">,</span>t<span class="keyword">,</span>T<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">SN0 t</span> <span class="keyword">=</span> 
  cr1<span class="keyword">(</span>der2tp der<span class="keyword">,</span> reduce der<span class="keyword">)</span></span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [STLC-SN-foas.dats] *)</span>
</pre>
</body>
</html>
