<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">(*
**
** A simple GTK/CAIRO example: demonstrating binary search
**
** Author: Hongwei Xi (hwxi AT cs DOT bu DOT edu)
** Time: July, 2010
**
*)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"contrib/cairo/SATS/cairo.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"contrib/cairo/SATS/cairo_extra.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> draw_intarray
  <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>pos<span class="keyword">}</span></span> <span class="keyword">(</span>
    cr<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse">cairo_ref</span></a></span></a> l</span><span class="keyword">,</span> W<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span><span class="keyword">,</span> H<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span><span class="keyword">,</span> A<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#13879"><span class="stacstuse">array</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> n<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14493"><span class="stacstuse">int</span></a> n</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22483"><span class="dyncstuse">cairo_rectangle</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> <span class="keyword">~</span>W/2<span class="keyword">,</span> <span class="keyword">~</span>H/2<span class="keyword">,</span> W<span class="keyword">,</span> H<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 1.0<span class="keyword">,</span> 1.0<span class="keyword">,</span> 1.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#17329"><span class="dyncstuse">cairo_fill</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> w <span class="keyword">=</span> W / n
  <span class="keyword">fun</span> loop <span class="staexp"><span class="keyword">{</span>i<span class="keyword">:</span>nat <span class="keyword">|</span> i <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#7364"><span class="stacstuse">&lt;=</span></a> n<span class="keyword">}</span></span>
    <span class="keyword">(</span>cr<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse">cairo_ref</span></a></span></a> l</span><span class="keyword">,</span> x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14493"><span class="stacstuse">int</span></a> i</span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
    <span class="keyword">if</span> i <span class="keyword">&lt;</span> n <span class="keyword">then</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22352"><span class="dyncstuse">cairo_move_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> x<span class="keyword">,</span> <span class="keyword">~</span>H/2<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22902"><span class="dyncstuse">cairo_rel_line_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> H<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#18617"><span class="dyncstuse">cairo_stroke</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37061"><span class="dyncstuse">cairo_translate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> x + w/2<span class="keyword">,</span> 0.0<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.25<span class="keyword">,</span> 0.25<span class="keyword">,</span> 0.25<span class="keyword">)</span>
<span class="comment">//
</span>      <span class="keyword">val</span> txt <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fprintf_2esats.html#3415"><span class="dyncstuse">sprintf</span></a> <span class="keyword">(</span>"%2.2i"<span class="keyword">,</span> <span class="keyword">@(</span>A[<span class="prfexp">i</span><span class="keyword">]</span><span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_5fextra_2esats.html#1918"><span class="dyncstuse">cairo_show_text_inbox</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> w<span class="keyword">,</span> H<span class="keyword">,</span> txt<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fstring_2esats.html#21215"><span class="dyncstuse">strptr_free</span></a> <span class="keyword">(</span>txt<span class="keyword">)</span>
<span class="comment">//
</span>      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
    <span class="keyword">in</span>
      loop <span class="keyword">(</span>cr<span class="keyword">,</span> x+w<span class="keyword">,</span> i+1<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22352"><span class="dyncstuse">cairo_move_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> x<span class="keyword">,</span> <span class="keyword">~</span>H/2<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22902"><span class="dyncstuse">cairo_rel_line_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> H<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#18617"><span class="dyncstuse">cairo_stroke</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>    
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">(* end of [if] *)</span>
  <span class="comment">// end of [loop]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> loop <span class="keyword">(</span>cr<span class="keyword">,</span> <span class="keyword">~</span>W/2<span class="keyword">,</span> 0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#18617"><span class="dyncstuse">cairo_stroke</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
<span class="comment">//
</span><span class="keyword">}</span> <span class="comment">// end of [draw_intarray]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span><span class="keyword">{</span><span class="staexp">a<span class="keyword">:</span>t@ype</span><span class="keyword">}</span>
array_copy <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="keyword">(</span>
    A<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#13879"><span class="stacstuse">array</span></a> <span class="keyword">(</span>a<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> n<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14665"><span class="stacstuse">size_t</span></a> n</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#13879"><span class="stacstuse">array</span></a> <span class="keyword">(</span>a<span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span> B <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">vbox pf1_arr</span> <span class="keyword">|</span> p1<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2farray_2esats.html#15098"><span class="dyncstuse">array_get_view_ptr</span></a> <span class="keyword">(</span>A<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf2_gc</span><span class="keyword">,</span> <span class="prfexp">pf2_arr</span> <span class="keyword">|</span> p2<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2farray_2esats.html#4051"><span class="dyncstuse">array_ptr_alloc_tsz</span></a> <span class="staexp"><span class="keyword">{</span>a<span class="keyword">}</span></span> <span class="keyword">(</span>n<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#3997"><span class="dyncstuse">sizeof&lt;</span></a><span class="staexp">a</span><span class="keyword">&gt;</span><span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> free_gc_elim <span class="keyword">(</span>pf2_gc<span class="keyword">)</span></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2farray_2esats.html#11509"><span class="dyncstuse">array_ptr_copy_tsz</span></a> <span class="keyword">(</span><span class="keyword">!</span>p1<span class="keyword">,</span> <span class="keyword">!</span>p2<span class="keyword">,</span> n<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#3997"><span class="dyncstuse">sizeof&lt;</span></a><span class="staexp">a</span><span class="keyword">&gt;</span><span class="keyword">)</span>
  <span class="keyword">val</span> B <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2farray_2esats.html#14952"><span class="dyncstuse">array_make_view_ptr</span></a> <span class="staexp"><span class="keyword">{</span>a<span class="keyword">}</span></span> <span class="keyword">(</span><span class="prfexp">pf2_arr</span> <span class="keyword">|</span> p2<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [array_copy]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">datatype</span> <span class="staexp"><a name="1989"><span class="stacstdec">trace</span></a></span> <span class="keyword">=</span>
  TRACE <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a><span class="comment">(*lb*)</span><span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a><span class="comment">(*ub*)</span><span class="keyword">)</span></span>
<span class="keyword">typedef</span> <span class="staexp"><a name="2039"><span class="stacstdec">tracelst <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#20377"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#1989"><span class="stacstuse">trace</span></a><span class="keyword">)</span></span></a></span>

<span class="keyword">fun</span> bsearch <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="keyword">(</span>
    A<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#13879"><span class="stacstuse">array</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> n<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14665"><span class="stacstuse">size_t</span></a> n</span><span class="keyword">,</span> x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#2039"><span class="stacstuse">tracelst</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux
    <span class="staexp"><span class="keyword">{</span>i<span class="keyword">:</span>nat<span class="keyword">;</span>j<span class="keyword">:</span>int <span class="keyword">|</span> i <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#7364"><span class="stacstuse">&lt;=</span></a> j<a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">;</span> j<a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1 <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#7364"><span class="stacstuse">&lt;=</span></a> n<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>j<a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#4689"><span class="stacstuse">-</span></a>i<span class="keyword">&gt;.</span></span>
    <span class="keyword">(</span>lb<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14493"><span class="stacstuse">int</span></a> i</span><span class="keyword">,</span> ub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14493"><span class="stacstuse">int</span></a> j</span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#2039"><span class="stacstuse">tracelst</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
    <span class="keyword">val</span> tr <span class="keyword">=</span> TRACE <span class="keyword">(</span>lb<span class="keyword">,</span> ub<span class="keyword">)</span>
    <span class="keyword">val</span> trs <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">if</span> lb &lt;= ub <span class="keyword">then</span> <span class="keyword">let</span>
      <span class="keyword">val</span> m <span class="keyword">=</span> <span class="keyword">(</span>lb + ub<span class="keyword">)</span> / 2
      <span class="keyword">val</span> x <span class="keyword">=</span> A[<span class="prfexp">m</span><span class="keyword">]</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> x0 &lt;= x <span class="keyword">then</span> aux <span class="keyword">(</span>lb<span class="keyword">,</span> m-1<span class="keyword">)</span> <span class="keyword">else</span> aux <span class="keyword">(</span>m+1<span class="keyword">,</span> ub<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span>
      list_nil <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#2039"><span class="stacstuse">tracelst</span></a></span> <span class="comment">(* end of [if] *)</span>
  <span class="keyword">in</span>
    list_cons <span class="keyword">(</span>tr<span class="keyword">,</span> trs<span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [aux]
</span>  <span class="keyword">val</span> n <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fsizetype_2esats.html#6020"><span class="dyncstuse">int1_of_size1</span></a> <span class="keyword">(</span>n<span class="keyword">)</span>
<span class="keyword">in</span>
  aux <span class="keyword">(</span>0<span class="keyword">,</span> n-1<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [bsearch]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">#define</span> <span class="neuexp">N 100</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"libc/SATS/random.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"libc/SATS/stdlib.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anon*)</span> <span class="keyword">=</span> "prelude/DATS/array.dats"</span>
<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anon*)</span> <span class="keyword">=</span> "prelude/DATS/list.dats"</span>
<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anon*)</span> <span class="keyword">=</span> "prelude/DATS/reference.dats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2frandom_2esats.html#1793"><span class="dyncstuse">srand48_with_time</span></a> <span class="keyword">(</span><span class="keyword">)</span>

<span class="keyword">#define</span> <span class="neuexp">ASZ 20</span>
<span class="keyword">val</span> key0 <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2frandom_2esats.html#2996"><span class="dyncstuse">randint</span></a> <span class="keyword">(</span>N<span class="keyword">)</span>
<span class="keyword">val</span> A0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#13879"><span class="stacstuse">array</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a><span class="keyword">,</span> ASZ<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf_gc</span><span class="keyword">,</span> <span class="prfexp">pf_arr</span> <span class="keyword">|</span> p_arr<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2farray_2esats.html#3887"><span class="dyncstuse">array_ptr_alloc&lt;</span></a><span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>ASZ<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp">pf <span class="keyword">=</span> unit_v <span class="keyword">(</span><span class="keyword">)</span></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2farray_2esats.html#6187"><span class="dyncstuse">array_ptr_initialize_fun_tsz</span></a>
    <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#21611"><span class="stacstuse">unit_v</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">!</span>p_arr<span class="keyword">,</span> ASZ<span class="keyword">,</span> <span class="keyword">lam</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> _<span class="keyword">,</span> x<span class="keyword">)</span> <span class="keyword">=&gt;</span> x := <span class="keyword">$effmask_ref</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2frandom_2esats.html#2996"><span class="dyncstuse">randint</span></a> <span class="keyword">(</span>N<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#3997"><span class="dyncstuse">sizeof&lt;</span></a><span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span><span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp">unit_v <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> pf</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2fstdlib_2esats.html#3388"><span class="dyncstuse">qsort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">!</span>p_arr<span class="keyword">,</span> ASZ<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#3997"><span class="dyncstuse">sizeof&lt;</span></a><span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span><span class="keyword">,</span> <span class="keyword">lam</span> <span class="keyword">(</span>x1<span class="keyword">,</span> x2<span class="keyword">)</span> <span class="keyword">=&gt;</span> compare <span class="keyword">(</span>x1<span class="keyword">,</span> x2<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> free_gc_elim <span class="keyword">(</span>pf_gc<span class="keyword">)</span></span>
<span class="keyword">in</span>
  <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2farray_2esats.html#14952"><span class="dyncstuse">array_make_view_ptr</span></a> <span class="keyword">(</span><span class="prfexp">pf_arr</span> <span class="keyword">|</span> p_arr<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [val]
</span>
<span class="keyword">val</span> theTracelst <span class="keyword">=</span> bsearch <span class="keyword">(</span>A0<span class="keyword">,</span> ASZ<span class="keyword">,</span> key0<span class="keyword">)</span>
<span class="comment">(*
val () = (
  print "length of [theTracelst] = "; print (list_length theTracelst); print_newline ()
) // end of [val]
*)</span>
<span class="keyword">val</span> theTracelstRef <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2freference_2esats.html#1991"><span class="dyncstuse">ref&lt;</span></a><span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#2039"><span class="stacstuse">tracelst</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>list_nil<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> update_theTracelstRef <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14138"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> trs <span class="keyword">=</span> <span class="keyword">!</span>theTracelstRef
<span class="keyword">in</span>
  <span class="keyword">case+</span> trs <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>tr<span class="keyword">,</span> trs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">!</span>theTracelstRef := trs<span class="keyword">;</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#4303"><span class="dyncstuse">true</span></a><span class="keyword">)</span>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#4347"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [update_theTracelstRef]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">extern</span> <span class="keyword">fun</span> <a name="3930"><span class="dyncstdec">draw_trace <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>cr<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse">cairo_ref</span></a></span></a> l</span><span class="keyword">,</span> w<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span><span class="keyword">,</span> h<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span><span class="keyword">,</span> n<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> tr<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#1989"><span class="stacstuse">trace</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span></span></a>
<span class="comment">// end of [draw_trace]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#3930"><span class="dyncstimp">draw_trace</span></a>
  <span class="keyword">(</span>cr<span class="keyword">,</span> w<span class="keyword">,</span> h<span class="keyword">,</span> n<span class="keyword">,</span> tr<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> TRACE <span class="keyword">(</span>lb<span class="keyword">,</span> ub<span class="keyword">)</span> <span class="keyword">=</span> tr
  <span class="keyword">val</span> nw <span class="keyword">=</span> w / n <span class="keyword">and</span> nh <span class="keyword">=</span> h / n
<span class="comment">//
</span>  <span class="keyword">val</span> x <span class="keyword">=</span> lb * nw + nw / 2 <span class="keyword">and</span> y <span class="keyword">=</span> nh / 2
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22352"><span class="dyncstuse">cairo_move_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> <span class="keyword">~</span>w/2+x<span class="keyword">,</span> y<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22902"><span class="dyncstuse">cairo_rel_line_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> <span class="keyword">~</span>nw/6<span class="keyword">,</span> nh/3<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22902"><span class="dyncstuse">cairo_rel_line_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span>  nw/3<span class="keyword">,</span>  0.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21493"><span class="dyncstuse">cairo_close_path</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#17329"><span class="dyncstuse">cairo_fill</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> x <span class="keyword">=</span> ub * nw + nw / 2 <span class="keyword">and</span> y <span class="keyword">=</span> <span class="keyword">~</span>nh / 2
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22352"><span class="dyncstuse">cairo_move_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> <span class="keyword">~</span>w/2+x<span class="keyword">,</span> y<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22902"><span class="dyncstuse">cairo_rel_line_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> <span class="keyword">~</span>nw/6<span class="keyword">,</span> <span class="keyword">~</span>nh/3<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22902"><span class="dyncstuse">cairo_rel_line_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span>  nw/3<span class="keyword">,</span>  0.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21493"><span class="dyncstuse">cairo_close_path</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#17329"><span class="dyncstuse">cairo_fill</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> lb &lt;= ub <span class="keyword">then</span> <span class="keyword">let</span>
    <span class="keyword">val</span> m <span class="keyword">=</span> <span class="keyword">(</span>lb+ub<span class="keyword">)</span> / 2
    <span class="keyword">val</span> x <span class="keyword">=</span> <span class="keyword">~</span>w/2+m*nw <span class="keyword">and</span> y <span class="keyword">=</span> <span class="keyword">~</span>nh/2
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22483"><span class="dyncstuse">cairo_rectangle</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> x<span class="keyword">,</span> y<span class="keyword">,</span> nw<span class="keyword">,</span> nh<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 1.0<span class="keyword">,</span> 1.0<span class="keyword">,</span> 0.0<span class="keyword">)</span> <span class="comment">// yellow
</span>    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#17329"><span class="dyncstuse">cairo_fill</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
<span class="comment">//
</span>    <span class="keyword">val</span> m <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2finteger_2esats.html#9644"><span class="dyncstuse">int1_of_int</span></a> <span class="keyword">(</span>m<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> assert <span class="keyword">(</span>m &gt;= 0 &amp;&amp; m <span class="keyword">&lt;</span> ASZ<span class="keyword">)</span>
    <span class="keyword">val</span> m <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fsizetype_2esats.html#6250"><span class="dyncstuse">size1_of_int1</span></a> <span class="keyword">(</span>m<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37061"><span class="dyncstuse">cairo_translate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> x + nw/2<span class="keyword">,</span> 0.0<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.25<span class="keyword">,</span> 0.25<span class="keyword">,</span> 0.25<span class="keyword">)</span>
    <span class="keyword">val</span> txt <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fprintf_2esats.html#3415"><span class="dyncstuse">sprintf</span></a> <span class="keyword">(</span>"%2.2i"<span class="keyword">,</span> <span class="keyword">@(</span>A0[<span class="prfexp">m</span><span class="keyword">]</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_5fextra_2esats.html#1918"><span class="dyncstuse">cairo_show_text_inbox</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> nw<span class="keyword">,</span> nh<span class="keyword">,</span> txt<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fstring_2esats.html#21215"><span class="dyncstuse">strptr_free</span></a> <span class="keyword">(</span>txt<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
  <span class="keyword">in</span>
    <span class="comment">// nothing
</span>  <span class="keyword">end</span> <span class="comment">// end of [val]
</span><span class="comment">//
</span><span class="keyword">in</span>
  <span class="comment">// nothing
</span><span class="keyword">end</span> <span class="comment">// end of [draw_trace]
</span>
<span class="keyword">extern</span> <span class="keyword">fun</span> <a name="5370"><span class="dyncstdec">draw_main <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>cr<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse">cairo_ref</span></a></span></a> l</span><span class="keyword">,</span> width<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> height<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span></span></a>
<span class="keyword">implement</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#5370"><span class="dyncstimp">draw_main</span></a>
  <span class="keyword">(</span>cr<span class="keyword">,</span> width<span class="keyword">,</span> height<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> n <span class="keyword">=</span> ASZ
  <span class="keyword">val</span> w0 <span class="keyword">=</span> double_of <span class="keyword">(</span>width<span class="keyword">)</span>
  <span class="keyword">val</span> w <span class="keyword">=</span> n*w0/<span class="keyword">(</span>n+2<span class="keyword">)</span>
  <span class="keyword">val</span> h <span class="keyword">=</span> double_of <span class="keyword">(</span>height<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37061"><span class="dyncstuse">cairo_translate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> w0/2<span class="keyword">,</span> h/3<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> txt <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fprintf_2esats.html#3415"><span class="dyncstuse">sprintf</span></a> <span class="keyword">(</span>"searching for key = %i"<span class="keyword">,</span> <span class="keyword">@(</span>key0<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_5fextra_2esats.html#1918"><span class="dyncstuse">cairo_show_text_inbox</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> w0/2<span class="keyword">,</span> 2*h/3<span class="keyword">,</span> txt<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fstring_2esats.html#21215"><span class="dyncstuse">strptr_free</span></a> <span class="keyword">(</span>txt<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37061"><span class="dyncstuse">cairo_translate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> w0/2<span class="keyword">,</span> h/2<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> draw_intarray <span class="keyword">(</span>cr<span class="keyword">,</span> w<span class="keyword">,</span> h/n<span class="keyword">,</span> A0<span class="keyword">,</span> n<span class="keyword">)</span>
  <span class="keyword">val</span> trs <span class="keyword">=</span> <span class="keyword">!</span>theTracelstRef
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>
    <span class="keyword">case+</span> trs <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>tr<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
      <span class="keyword">in</span>
        <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#3930"><span class="dyncstuse">draw_trace</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> w<span class="keyword">,</span> h<span class="keyword">,</span> n<span class="keyword">,</span> tr<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [draw_main]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"contrib/glib/SATS/glib.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"contrib/glib/SATS/glib-object.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"contrib/GTK/SATS/gdk.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"contrib/GTK/SATS/gtk.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"contrib/GTK/SATS/gtkclassdec.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{^
GtkWidget *the_drawingarea = NULL;
ats_ptr_type
the_drawingarea_get () {
  if (the_drawingarea == NULL) {
    fprintf (stderr, "exit(the_drawingarea_get): not initialized yet\n"); exit(1);
  } // end of [if]
  return the_drawingarea ;
} // end of [the_drawingarea_get]
ats_void_type
the_drawingarea_initset (ats_ptr_type x) {
  static int the_drawingarea_initset_flag = 0 ;
  if (the_drawingarea_initset_flag) {
    fprintf (stderr, "exit(the_drawingarea_initset): already initialized\n"); exit(1);
  } // end of [if]
  the_drawingarea_initset_flag = 1 ; the_drawingarea = x ; return ;
} // end of [the_drawingarea_initset]
%}</span> <span class="comment">// end of [%{^] 
</span><span class="keyword">extern</span>
<span class="keyword">fun</span> <a name="7228"><span class="dyncstdec">the_drawingarea_get <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>l<span class="keyword">:</span>agz<span class="keyword">]</span>
  <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#5512"><span class="stacstuse">GtkDrawingArea</span></a><span class="keyword">,</span> l<span class="keyword">)</span> <span class="keyword">-&lt;</span>lin<span class="keyword">,</span>prf<span class="keyword">&gt;</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a> <span class="keyword">|</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#5512"><span class="stacstuse">GtkDrawingArea</span></a><span class="keyword">,</span> l<span class="keyword">)</span><span class="keyword">)</span></span></span></a>
  <span class="keyword">=</span> "the_drawingarea_get"
<span class="comment">// end of [the_drawingarea_get]
</span><span class="keyword">extern</span>
<span class="keyword">fun</span> <a name="7407"><span class="dyncstdec">the_drawingarea_initset
  <span class="keyword">(</span>x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#5253"><span class="stacstuse">GtkDrawingArea_ref1</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span></span></a> <span class="keyword">=</span> "the_drawingarea_initset"
<span class="comment">// end of [the_drawingarea_initset]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{^
extern
ats_void_type
mainats (ats_int_type argc, ats_ptr_type argv) ;
%}</span> <span class="comment">// end of [%{^]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> fnext <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> ans <span class="keyword">=</span> update_theTracelstRef <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> <span class="keyword">~</span>ans <span class="keyword">then</span> <span class="keyword">!</span>theTracelstRef := theTracelst
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_darea</span> <span class="keyword">|</span> darea<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#7228"><span class="dyncstuse">the_drawingarea_get</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span><span class="keyword">,</span> <span class="prfexp">fpf</span> <span class="keyword">|</span> p<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#6599"><span class="dyncstuse">gtk_widget_getref_allocation</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#8193"><span class="dyncstuse">gtk_widget_queue_draw_area</span></a> <span class="keyword">(</span>darea<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">,</span> p<span class="keyword">-&gt;</span>width<span class="keyword">,</span> p<span class="keyword">-&gt;</span>height<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf</span><span class="keyword">,</span> <span class="prfexp">pf</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_darea <span class="keyword">(</span>darea<span class="keyword">)</span></span>
<span class="keyword">in</span>
  <span class="comment">// nothing
</span><span class="keyword">end</span> <span class="comment">// end of [fnext]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> fexpose
  <span class="staexp"><span class="keyword">{</span>c<span class="keyword">:</span>cls <span class="keyword">|</span> c <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#8412"><span class="stacstuse">&lt;=</span></a> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#5512"><span class="stacstuse">GtkDrawingArea</span></a><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>darea<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a></span></a> <span class="keyword">(</span>c<span class="keyword">,</span> l<span class="keyword">)</span></span><span class="keyword">,</span> event<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgdk_2fgdkevents_2esats.html#7291"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgdk_2fgdkevents_2esats.html#7291"><span class="stacstuse">GdkEvent</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2151"><span class="stacstuse">gboolean</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#8286"><span class="dyncstuse">clstrans</span></a> <span class="staexp"><span class="keyword">{</span>c<span class="keyword">,</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#5512"><span class="stacstuse">GtkDrawingArea</span></a><span class="keyword">,</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#1995"><span class="stacstuse">GtkWidget</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_win</span> <span class="keyword">|</span> win<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#5831"><span class="dyncstuse">gtk_widget_get_window</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> assert_errmsg <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2389"><span class="dyncstuse">g_object_isnot_null</span></a> <span class="keyword">(</span>win<span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">#LOCATION</span><span class="keyword">)</span>
  <span class="keyword">val</span> cr <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgdk_2fgdkcairo_2esats.html#1652"><span class="dyncstuse">gdk_cairo_create</span></a> <span class="keyword">(</span>win<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf_win</span><span class="keyword">,</span> <span class="prfexp">win</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span><span class="keyword">,</span> <span class="prfexp">fpf</span> <span class="keyword">|</span> p<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#6599"><span class="dyncstuse">gtk_widget_getref_allocation</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#5370"><span class="dyncstuse">draw_main</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> <span class="keyword">(</span>int_of<span class="keyword">)</span>p<span class="keyword">-&gt;</span>width<span class="keyword">,</span> <span class="keyword">(</span>int_of<span class="keyword">)</span>p<span class="keyword">-&gt;</span>height<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf</span><span class="keyword">,</span> <span class="prfexp">pf</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7088"><span class="dyncstuse">cairo_destroy</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
<span class="keyword">in</span>
  GFALSE <span class="comment">// HX: what does this mean?
</span><span class="keyword">end</span> <span class="comment">// end of [fexpose]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> ftimeout
  <span class="keyword">(</span>_<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2414"><span class="stacstuse">gpointer</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2151"><span class="stacstuse">gboolean</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_darea</span> <span class="keyword">|</span> darea<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#7228"><span class="dyncstuse">the_drawingarea_get</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_win</span> <span class="keyword">|</span> win<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#5831"><span class="dyncstuse">gtk_widget_get_window</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
  <span class="keyword">val</span> res <span class="keyword">=</span> update_theTracelstRef <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> res <span class="keyword">then</span> <span class="keyword">(</span>
    <span class="keyword">if</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2389"><span class="dyncstuse">g_object_isnot_null</span></a> <span class="keyword">(</span>win<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span><span class="keyword">,</span> <span class="prfexp">fpf</span> <span class="keyword">|</span> p<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#6599"><span class="dyncstuse">gtk_widget_getref_allocation</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#8193"><span class="dyncstuse">gtk_widget_queue_draw_area</span></a> <span class="keyword">(</span>darea<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">,</span> p<span class="keyword">-&gt;</span>width<span class="keyword">,</span> p<span class="keyword">-&gt;</span>height<span class="keyword">)</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf</span><span class="keyword">,</span> <span class="prfexp">pf</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">// end of [if]
</span>  <span class="keyword">)</span> <span class="comment">// end of [val]
</span>  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf_win</span><span class="keyword">,</span> <span class="prfexp">win</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_darea <span class="keyword">(</span>darea<span class="keyword">)</span></span>
<span class="keyword">in</span>
  GTRUE
<span class="keyword">end</span> <span class="comment">// end of [ftimeout]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">macdef</span> <span class="neuexp">gs <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgbasics_2esats.html#9569"><span class="dyncstuse">gstring_of_string</span></span></a>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">val</span> theTimeInterval <span class="keyword">=</span> 1000

<span class="keyword">extern</span> <span class="keyword">fun</span> <a name="9514"><span class="dyncstdec">main1 <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span></span></a> <span class="keyword">=</span> "main1"

<span class="keyword">implement</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#9514"><span class="dyncstimp">main1</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2frandom_2esats.html#1793"><span class="dyncstuse">srand48_with_time</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> window <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwindow_2esats.html#1688"><span class="dyncstuse">gtk_window_new</span></a> <span class="keyword">(</span>GTK_WINDOW_TOPLEVEL<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span>
    <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwindow_2esats.html#3391"><span class="dyncstuse">gtk_window_set_default_size</span></a> <span class="keyword">(</span>window<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>400<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>400<span class="keyword">)</span>
  <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"cairo: binary search"
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwindow_2esats.html#2106"><span class="dyncstuse">gtk_window_set_title</span></a> <span class="keyword">(</span>window<span class="keyword">,</span> x<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_window</span> <span class="keyword">|</span> window_<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2770"><span class="dyncstuse">g_object_vref</span></a> <span class="keyword">(</span>window<span class="keyword">)</span>
  <span class="keyword">val</span> _sid <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1933"><span class="dyncstuse">g_signal_connect0</span></a>
    <span class="keyword">(</span>window_<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"delete-event"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#2382"><span class="dyncstuse">gtk_widget_destroy</span></a><span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
  <span class="keyword">val</span> _sid <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#2245"><span class="dyncstuse">g_signal_connect1</span></a>
    <span class="keyword">(</span>window<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"destroy"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkmain_2esats.html#1611"><span class="dyncstuse">gtk_main_quit</span></a><span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> vbox0 <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkvbox_2esats.html#1510"><span class="dyncstuse">gtk_vbox_new</span></a> <span class="keyword">(</span>GFALSE<span class="comment">(*homo*)</span><span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>10<span class="comment">(*spacing*)</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkcontainer_2esats.html#1510"><span class="dyncstuse">gtk_container_add</span></a> <span class="keyword">(</span>window<span class="keyword">,</span> vbox0<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> hbox1 <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkhbox_2esats.html#1510"><span class="dyncstuse">gtk_hbox_new</span></a> <span class="keyword">(</span>GFALSE<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> hbox1<span class="keyword">,</span> GFALSE<span class="keyword">,</span> GFALSE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgobject_2esats.html#1980"><span class="dyncstuse">g_object_unref</span></a> <span class="keyword">(</span>hbox1<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> darea <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkdrawingarea_2esats.html#1510"><span class="dyncstuse">gtk_drawing_area_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> darea<span class="keyword">,</span> GTRUE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> _sid <span class="keyword">=</span> g_signal_connect
    <span class="keyword">(</span>darea<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"expose-event"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a> <span class="keyword">(</span>fexpose<span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fbsearch_5fdemo_2edats.html#7407"><span class="dyncstuse">the_drawingarea_initset</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> hsep <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkhseparator_2esats.html#1510"><span class="dyncstuse">gtk_hseparator_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> hsep<span class="keyword">,</span> GFALSE<span class="keyword">,</span> GFALSE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgobject_2esats.html#1980"><span class="dyncstuse">g_object_unref</span></a> <span class="keyword">(</span>hsep<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> hbox1 <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkhbox_2esats.html#1510"><span class="dyncstuse">gtk_hbox_new</span></a> <span class="keyword">(</span>GFALSE<span class="comment">(*homo*)</span><span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>5<span class="comment">(*spacing*)</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1510"><span class="dyncstuse">gtk_box_pack_start</span></a> <span class="keyword">(</span>vbox0<span class="keyword">,</span> hbox1<span class="keyword">,</span> GFALSE<span class="keyword">,</span> GTRUE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>10<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"_Close"
  <span class="keyword">val</span> btn_close <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbutton_2esats.html#1762"><span class="dyncstuse">gtk_button_new_with_mnemonic</span></a> <span class="keyword">(</span>x<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
  <span class="keyword">val</span> _sid <span class="keyword">=</span> g_signal_connect
    <span class="keyword">(</span>btn_close<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"clicked"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a><span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkmain_2esats.html#1611"><span class="dyncstuse">gtk_main_quit</span></a><span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer_vt<span class="keyword">)</span>window<span class="keyword">)</span>
  <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1779"><span class="dyncstuse">gtk_box_pack_end</span></a> <span class="keyword">(</span>hbox1<span class="keyword">,</span> btn_close<span class="keyword">,</span> GFALSE<span class="keyword">,</span> GFALSE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>4<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgobject_2esats.html#1980"><span class="dyncstuse">g_object_unref</span></a> <span class="keyword">(</span>btn_close<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span>gs<span class="keyword">)</span>"_Next"
  <span class="keyword">val</span> btn_next <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbutton_2esats.html#1762"><span class="dyncstuse">gtk_button_new_with_mnemonic</span></a> <span class="keyword">(</span>x<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
  <span class="keyword">val</span> _sid <span class="keyword">=</span> g_signal_connect
    <span class="keyword">(</span>btn_next<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"clicked"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a><span class="keyword">(</span>fnext<span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
  <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkbox_2esats.html#1779"><span class="dyncstuse">gtk_box_pack_end</span></a> <span class="keyword">(</span>hbox1<span class="keyword">,</span> btn_next<span class="keyword">,</span> GFALSE<span class="keyword">,</span> GFALSE<span class="keyword">,</span> <span class="keyword">(</span>guint<span class="keyword">)</span>4<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgobject_2esats.html#1980"><span class="dyncstuse">g_object_unref</span></a> <span class="keyword">(</span>btn_next<span class="keyword">)</span>
<span class="comment">(*
  val _rid = gtk_timeout_add ((guint32)theTimeInterval, ftimeout, (gpointer)null)
*)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgobject_2esats.html#1980"><span class="dyncstuse">g_object_unref</span></a> <span class="keyword">(</span>hbox1<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgobject_2esats.html#1980"><span class="dyncstuse">g_object_unref</span></a> <span class="keyword">(</span>vbox0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3566"><span class="dyncstuse">gtk_widget_show_all</span></a> <span class="keyword">(</span>window<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_window <span class="keyword">(</span>window<span class="keyword">)</span></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkmain_2esats.html#1510"><span class="dyncstuse">gtk_main</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [main1]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#6301"><span class="dyncstimp">main_dummy</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{$
ats_void_type
mainats (
  ats_int_type argc, ats_ptr_type argv
) {
  gtk_init ((int*)&amp;argc, (char***)&amp;argv) ; main1 () ; return ;
} // end of [mainats]
%}</span> <span class="comment">// end of [%{$]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [bsearch_demo.dats] *)</span>
</pre>
</body>
</html>
