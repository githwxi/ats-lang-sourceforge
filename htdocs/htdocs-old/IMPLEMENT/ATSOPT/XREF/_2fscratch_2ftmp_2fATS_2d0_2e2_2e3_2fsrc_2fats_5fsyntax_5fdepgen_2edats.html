<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">(* ******************************************************************* *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(*                         Applied Type System                         *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(*                              Hongwei Xi                             *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(* ******************************************************************* *)</span>

<span class="comment">(*
** ATS/Anairiats - Unleashing the Potential of Types!
**
** Copyright (C) 2002-2010 Hongwei Xi.
**
** All rights reserved
**
** ATS is free software;  you can  redistribute it and/or modify it under
** the terms of  the GNU GENERAL PUBLIC LICENSE (GPL) as published by the
** Free Software Foundation; either version 3, or (at  your  option)  any
** later version.
** 
** ATS is distributed in the hope that it will be useful, but WITHOUT ANY
** WARRANTY; without  even  the  implied  warranty  of MERCHANTABILITY or
** FITNESS FOR A PARTICULAR PURPOSE.  See the  GNU General Public License
** for more details.
** 
** You  should  have  received  a  copy of the GNU General Public License
** along  with  ATS;  see the  file COPYING.  If not, please write to the
** Free Software Foundation,  51 Franklin Street, Fifth Floor, Boston, MA
** 02110-1301, USA.
*)</span>

<span class="comment">(* ****** ****** *)</span>
<span class="comment">//
</span><span class="comment">// Author: Hongwei Xi (hwxi AT cs DOT bu DOT edu)
</span><span class="comment">// Start time: June 2010
</span><span class="comment">//
</span><span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">Lst <span class="keyword">=</span> "ats_list.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"ats_reference.sats"</span>
<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anon*)</span> <span class="keyword">=</span> "ats_reference.dats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">Fil <span class="keyword">=</span> "ats_filename.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Par <span class="keyword">=</span> "ats_parser.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"ats_syntax.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">COMARG <span class="keyword">=</span> "ats_comarg.sats"</span>
<span class="keyword">typedef</span> <span class="staexp"><a name="1807"><span class="stacstdec">comarg <span class="keyword">=</span> $COMARG<span class="keyword">.</span>comarg</span></a></span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">local</span>

<span class="keyword">viewtypedef</span> <span class="staexp"><a name="1872"><span class="stacstdec">deplst <span class="keyword">=</span> List_vt <span class="keyword">(</span>string<span class="keyword">)</span></span></a></span>
<span class="keyword">val</span> the_deplst
  <span class="keyword">:</span> <span class="staexp">ref <span class="keyword">(</span>deplst<span class="keyword">)</span></span> <span class="keyword">=</span> ref_make_elt&lt;<span class="staexp">deplst</span><span class="keyword">&gt;</span> <span class="keyword">(</span>list_vt_nil<span class="keyword">)</span>
<span class="comment">// end of [val]
</span>
<span class="keyword">in</span> <span class="comment">// in of [local]
</span>
<span class="keyword">fun</span> the_deplst_get
  <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">deplst</span> <span class="keyword">=</span> lst <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">vbox pf</span> <span class="keyword">|</span> p<span class="keyword">)</span> <span class="keyword">=</span> ref_get_view_ptr <span class="keyword">(</span>the_deplst<span class="keyword">)</span>
  <span class="keyword">val</span> lst <span class="keyword">=</span> <span class="keyword">!</span>p
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">!</span>p := list_vt_nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [the_deplst_get]
</span>
<span class="keyword">fun</span> the_deplst_push
  <span class="keyword">(</span>dep<span class="keyword">:</span> <span class="staexp">string</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">vbox pf</span> <span class="keyword">|</span> p<span class="keyword">)</span> <span class="keyword">=</span> ref_get_view_ptr <span class="keyword">(</span>the_deplst<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">!</span>p := list_vt_cons <span class="keyword">(</span>dep<span class="keyword">,</span> <span class="keyword">!</span>p<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [the_deplst_push]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">extern</span> <span class="comment">// HX-2010-07-19: for ATS/GEIZELLA only
</span><span class="keyword">fun</span> <a name="2424"><span class="dyncstdec">string_index_of_char_from_right
  <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="keyword">(</span>str<span class="keyword">:</span> <span class="staexp">string n</span><span class="keyword">,</span> c<span class="keyword">:</span> <span class="staexp">char</span><span class="keyword">)</span><span class="keyword">:&lt;&gt;</span> <span class="staexp">ssizeBtw <span class="keyword">(</span>~1<span class="keyword">,</span> n<span class="keyword">)</span></span></span></a>
  <span class="keyword">=</span> "atspre_string_index_of_char_from_right"
<span class="comment">// end of [string_index_of_char_from_right]
</span>
<span class="keyword">fun</span> fprint_target <span class="staexp"><span class="keyword">{</span>m<span class="keyword">:</span>file_mode<span class="keyword">}</span></span> <span class="keyword">(</span>
    <span class="prfexp">pf<span class="keyword">:</span> <span class="staexp">file_mode_lte <span class="keyword">(</span>m<span class="keyword">,</span> w<span class="keyword">)</span></span></span> <span class="keyword">|</span> out<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span>FILE m</span><span class="keyword">,</span> basename<span class="keyword">:</span> <span class="staexp">string</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp">void</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> <span class="keyword">[</span><span class="staexp">n<span class="keyword">:</span>int</span><span class="keyword">]</span> basename <span class="keyword">=</span> string1_of_string <span class="keyword">(</span>basename<span class="keyword">)</span>
  <span class="keyword">val</span> k <span class="keyword">=</span> string_index_of_char_from_right <span class="keyword">(</span>basename<span class="keyword">,</span> '.'<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> 0 <span class="keyword">of</span>
  <span class="keyword">|</span> _ <span class="keyword">when</span> k &gt;= 0 <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> k <span class="keyword">=</span> size_of_ssize <span class="keyword">(</span>k<span class="keyword">)</span>
      <span class="keyword">fun</span> pr <span class="staexp"><span class="keyword">{</span>i<span class="keyword">:</span>nat <span class="keyword">|</span> i &lt;= n<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n-i<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>
          out<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span>FILE m</span>
        <span class="keyword">,</span> basename<span class="keyword">:</span> <span class="staexp">string n</span><span class="keyword">,</span> k<span class="keyword">:</span> <span class="staexp">size_t</span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp">size_t i</span>
        <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp">void</span> <span class="keyword">=</span>
        <span class="keyword">if</span> string_isnot_at_end <span class="keyword">(</span>basename<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">let</span>
          <span class="keyword">val</span> c <span class="keyword">=</span>  <span class="keyword">if</span> i <span class="keyword">=</span> k <span class="keyword">then</span> '_' <span class="keyword">else</span> basename[<span class="prfexp">i</span><span class="keyword">]</span>
          <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fprint_char <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> c<span class="keyword">)</span>
        <span class="keyword">in</span>
          pr <span class="keyword">(</span>out<span class="keyword">,</span> basename<span class="keyword">,</span> k<span class="keyword">,</span> i+1<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [if]
</span>      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> pr <span class="keyword">(</span>out<span class="keyword">,</span> basename<span class="keyword">,</span> k<span class="keyword">,</span> 0<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fprint_string <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ".o"<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">// end of [_ when ...]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> fprint_string <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> basename<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="comment">// nothing
</span><span class="keyword">end</span> <span class="comment">// end of [fprint_target]
</span>
<span class="keyword">implement</span>
fprint_depgen <span class="staexp"><span class="keyword">{</span>m<span class="keyword">}</span></span>
  <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> basename<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> deplst <span class="keyword">=</span> the_deplst_get <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> deplst <span class="keyword">=</span> $Lst<span class="keyword">.</span>list_vt_reverse <span class="keyword">(</span>deplst<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fprint_target <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> basename<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fprint_string <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> " :"<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> loop <span class="keyword">(</span>out<span class="keyword">,</span> deplst<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
    <span class="keyword">fun</span> loop <span class="keyword">(</span>
        out<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span>FILE m</span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp">deplst</span>
      <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp">void</span> <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
      <span class="keyword">|</span> <span class="keyword">~</span>list_vt_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fprintf1_exn <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> " %s"<span class="keyword">,</span> <span class="keyword">@(</span>x<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">in</span> loop <span class="keyword">(</span>out<span class="keyword">,</span> xs<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [list_vt_cons]
</span>      <span class="keyword">|</span> <span class="keyword">~</span>list_vt_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="comment">// end of [loop]
</span>  <span class="keyword">}</span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fprint_newline <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="comment">// nothing
</span><span class="keyword">end</span> <span class="comment">// end of [fprint_depgen]
</span>
<span class="keyword">end</span> <span class="comment">// end of [local]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">extern</span> <span class="keyword">fun</span> <a name="4196"><span class="dyncstdec">depgen_d0ec <span class="keyword">(</span>d<span class="keyword">:</span> <span class="staexp">d0ec</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">void</span></span></a>
<span class="keyword">extern</span> <span class="keyword">fun</span> <a name="4235"><span class="dyncstdec">depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">:</span> <span class="staexp">d0exp</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">void</span></span></a>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> depgen_d0explst <span class="keyword">(</span>d0es<span class="keyword">:</span> <span class="staexp">d0explst</span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp">void</span> <span class="keyword">=</span> $Lst<span class="keyword">.</span>list_foreach_fun <span class="keyword">(</span>d0es<span class="keyword">,</span> depgen_d0exp<span class="keyword">)</span>
<span class="comment">// end of [depgen_d0explst]
</span>
<span class="keyword">fun</span> depgen_d0explstlst <span class="keyword">(</span>d0ess<span class="keyword">:</span> <span class="staexp">d0explstlst</span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp">void</span> <span class="keyword">=</span> $Lst<span class="keyword">.</span>list_foreach_fun <span class="keyword">(</span>d0ess<span class="keyword">,</span> depgen_d0explst<span class="keyword">)</span>
<span class="comment">// end of [depgen_d0explstlst]
</span>
<span class="keyword">fun</span> depgen_d0expopt
  <span class="keyword">(</span>x<span class="keyword">:</span> <span class="staexp">d0expopt</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">void</span> <span class="keyword">=</span> <span class="keyword">case+</span> x <span class="keyword">of</span>
  <span class="keyword">|</span> Some d0e <span class="keyword">=&gt;</span> depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span> <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [depgen_d0expopt]
</span>
<span class="keyword">fun</span> depgen_labd0explst
  <span class="keyword">(</span>ld0es<span class="keyword">:</span> <span class="staexp">labd0explst</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">void</span> <span class="keyword">=</span> <span class="keyword">case+</span> ld0es <span class="keyword">of</span>
  <span class="keyword">|</span> LABD0EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> LABD0EXPLSTcons <span class="keyword">(</span>_<span class="keyword">,</span> d0e<span class="keyword">,</span> ld0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span><span class="keyword">;</span> depgen_labd0explst <span class="keyword">(</span>ld0es<span class="keyword">)</span>
    <span class="keyword">)</span> <span class="comment">// end of [LABD0EXPLSTcons]
</span><span class="comment">// end of [depgen_labd0explst]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> depgen_c0lau <span class="keyword">(</span>c0l<span class="keyword">:</span> <span class="staexp">c0lau</span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp">void</span> <span class="keyword">=</span> depgen_d0exp <span class="keyword">(</span>c0l<span class="keyword">.</span>c0lau_body<span class="keyword">)</span>
<span class="keyword">fun</span> depgen_c0laulst <span class="keyword">(</span>c0ls<span class="keyword">:</span> <span class="staexp">c0laulst</span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp">void</span> <span class="keyword">=</span> $Lst<span class="keyword">.</span>list_foreach_fun <span class="keyword">(</span>c0ls<span class="keyword">,</span> depgen_c0lau<span class="keyword">)</span>
<span class="comment">// end of [depgen_c0laulst]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> depgen_v0aldec
  <span class="keyword">(</span>v0d<span class="keyword">:</span> <span class="staexp">v0aldec</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0exp <span class="keyword">(</span>v0d<span class="keyword">.</span>v0aldec_def<span class="keyword">)</span>
<span class="comment">// end of [depgen_v0aldec]
</span>
<span class="keyword">fun</span> depgen_f0undec
  <span class="keyword">(</span>f0d<span class="keyword">:</span> <span class="staexp">f0undec</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0exp <span class="keyword">(</span>f0d<span class="keyword">.</span>f0undec_def<span class="keyword">)</span>
<span class="comment">// end of [depgen_f0undec]
</span>
<span class="keyword">fun</span> depgen_v0ardec
  <span class="keyword">(</span>v0d<span class="keyword">:</span> <span class="staexp">v0ardec</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0expopt <span class="keyword">(</span>v0d<span class="keyword">.</span>v0ardec_ini<span class="keyword">)</span>
<span class="comment">// end of [depgen_v0ardec]
</span>
<span class="keyword">fun</span> depgen_guad0ec_node
  <span class="keyword">(</span>node<span class="keyword">:</span> <span class="staexp">guad0ec_node</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp">void</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> node <span class="keyword">of</span>
  <span class="keyword">|</span> GD0Cone <span class="keyword">(</span>_<span class="keyword">,</span> d0cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0eclst <span class="keyword">(</span>d0cs<span class="keyword">)</span>
  <span class="keyword">|</span> GD0Ctwo <span class="keyword">(</span>_<span class="keyword">,</span> d0cs1<span class="keyword">,</span> d0cs2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0eclst <span class="keyword">(</span>d0cs1<span class="keyword">)</span><span class="keyword">;</span> depgen_d0eclst <span class="keyword">(</span>d0cs2<span class="keyword">)</span>
    <span class="keyword">)</span> <span class="comment">// end of [GD0Ctwo]
</span>  <span class="keyword">|</span> GD0Ccons <span class="keyword">(</span>_<span class="keyword">,</span> d0cs<span class="keyword">,</span> _<span class="keyword">,</span> gd0cnode<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0eclst <span class="keyword">(</span>d0cs<span class="keyword">)</span><span class="keyword">;</span> depgen_guad0ec_node gd0cnode
    <span class="keyword">)</span> <span class="comment">// end of [GD0Ccons]
</span><span class="comment">// end of [depgen_guad0ec_node]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
depgen_d0exp <span class="keyword">(</span>d0e0<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> d0e0<span class="keyword">.</span>d0exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> D0Eann <span class="keyword">(</span>d0e<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span>
  <span class="keyword">|</span> D0Eapp <span class="keyword">(</span>d0e1<span class="keyword">,</span> d0e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0exp <span class="keyword">(</span>d0e1<span class="keyword">)</span><span class="keyword">;</span> depgen_d0exp <span class="keyword">(</span>d0e2<span class="keyword">)</span>
    <span class="keyword">)</span>
  <span class="keyword">|</span> D0Earrinit <span class="keyword">(</span>_<span class="keyword">,</span> od0e<span class="keyword">,</span> d0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0expopt <span class="keyword">(</span>od0e<span class="keyword">)</span><span class="keyword">;</span> depgen_d0explst <span class="keyword">(</span>d0es<span class="keyword">)</span>
    <span class="keyword">)</span> <span class="comment">// end of [D0Earrinit]
</span>  <span class="keyword">|</span> D0Earrsize <span class="keyword">(</span>_<span class="keyword">,</span> d0e_elts<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0exp <span class="keyword">(</span>d0e_elts<span class="keyword">)</span>
  <span class="keyword">|</span> D0Earrsub <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> d0ess<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0explstlst <span class="keyword">(</span>d0ess<span class="keyword">)</span>
  <span class="keyword">|</span> D0Ecaseof <span class="keyword">(</span>_<span class="keyword">,</span> d0e<span class="keyword">,</span> c0ls<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span><span class="keyword">;</span> depgen_c0laulst <span class="keyword">(</span>c0ls<span class="keyword">)</span>
    <span class="keyword">)</span> <span class="comment">// end of [D0Ecaseof]
</span><span class="comment">(*
  | D0Echar _ =&gt; ()
  | D0Ecstsp _ =&gt; ()
  | D0Ecrypt _ =&gt; ()
  | D0Edelay _ =&gt; ()
  | D0Edynload _ =&gt; ()
  | D0Eeffmask _ =&gt; ()
  | D0Eempty _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Eexist <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span>
<span class="comment">(*
  | D0Eextval _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Efix <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span>
<span class="comment">(*
  | D0Efloat _ =&gt; ()
  | D0Efloatsp _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Efoldat <span class="keyword">(</span>d0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0explst <span class="keyword">(</span>d0es<span class="keyword">)</span>
  <span class="keyword">|</span> D0Efor <span class="keyword">(</span>
      _<span class="keyword">,</span> _<span class="keyword">,</span> d0e_ini<span class="keyword">,</span> d0e_test<span class="keyword">,</span> d0e_post<span class="keyword">,</span> d0e_body
    <span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0exp <span class="keyword">(</span>d0e_ini<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0exp <span class="keyword">(</span>d0e_test<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0exp <span class="keyword">(</span>d0e_post<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0exp <span class="keyword">(</span>d0e_body<span class="keyword">)</span>
    <span class="keyword">}</span> <span class="comment">// end of [D0Efor]
</span>  <span class="keyword">|</span> D0Efreeat d0es <span class="keyword">=&gt;</span> depgen_d0explst <span class="keyword">(</span>d0es<span class="keyword">)</span>
<span class="comment">(*
  | D0Eide _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Eif <span class="keyword">(</span>
      _<span class="keyword">,</span> d0e_test<span class="keyword">,</span> d0e_then<span class="keyword">,</span> od0e_else
    <span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0exp <span class="keyword">(</span>d0e_test<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0exp <span class="keyword">(</span>d0e_then<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0expopt <span class="keyword">(</span>od0e_else<span class="keyword">)</span>
    <span class="keyword">}</span> <span class="comment">// end of [D0Eif]
</span><span class="comment">(*
  | D0Eint _ =&gt; ()
  | D0Eintsp _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Elam <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span>
  <span class="keyword">|</span> D0Elet <span class="keyword">(</span>d0cs<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0eclst <span class="keyword">(</span>d0cs<span class="keyword">)</span><span class="keyword">;</span> depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span>
    <span class="keyword">)</span> <span class="comment">// end of [D0Elet]
</span>  <span class="keyword">|</span> D0Elist d0es <span class="keyword">=&gt;</span> depgen_d0explst <span class="keyword">(</span>d0es<span class="keyword">)</span>
  <span class="keyword">|</span> D0Elist2 <span class="keyword">(</span>d0es1<span class="keyword">,</span> d0es2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0explst <span class="keyword">(</span>d0es1<span class="keyword">)</span><span class="keyword">;</span> depgen_d0explst <span class="keyword">(</span>d0es2<span class="keyword">)</span>
    <span class="keyword">)</span> <span class="comment">// end of [D0Elist2]
</span><span class="comment">(*
  | D0Eloopexn _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Elst <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span>
  <span class="keyword">|</span> D0Emacsyn <span class="keyword">(</span>_<span class="keyword">,</span> d0e<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span>
<span class="comment">(*
  | D0Eopide _ =&gt; ()
  | D0Eptrof _ =&gt; ()
  | D0Eqid _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Eraise d0e <span class="keyword">=&gt;</span> depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span>
  <span class="keyword">|</span> D0Erec <span class="keyword">(</span>_<span class="keyword">,</span> ld0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_labd0explst <span class="keyword">(</span>ld0es<span class="keyword">)</span>
<span class="comment">(*
  | D0Escaseof _ =&gt; ()
  | D0Esel_lab _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Esel_ind <span class="keyword">(</span>_<span class="keyword">,</span> d0ess<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0explstlst <span class="keyword">(</span>d0ess<span class="keyword">)</span>
  <span class="keyword">|</span> D0Eseq <span class="keyword">(</span>d0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0explst <span class="keyword">(</span>d0es<span class="keyword">)</span>
<span class="comment">(*
  | D0Esexparg _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Esif <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> d0e_then<span class="keyword">,</span> d0e_else<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0exp <span class="keyword">(</span>d0e_then<span class="keyword">)</span><span class="keyword">;</span> depgen_d0exp <span class="keyword">(</span>d0e_else<span class="keyword">)</span>
    <span class="keyword">)</span> <span class="comment">// end of [D0Esif]
</span><span class="comment">(*
  | D0Estring _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Estruct <span class="keyword">(</span>ld0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_labd0explst <span class="keyword">(</span>ld0es<span class="keyword">)</span>
<span class="comment">(*
  | D0Etmpid _ =&gt; ()
  | D0Etop _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Etrywith <span class="keyword">(</span>_<span class="keyword">,</span> d0e<span class="keyword">,</span> c0ls<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span><span class="keyword">;</span> depgen_c0laulst <span class="keyword">(</span>c0ls<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [D0Etrywith]
</span>  <span class="keyword">|</span> D0Etup <span class="keyword">(</span>_<span class="keyword">,</span> d0es<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0explst <span class="keyword">(</span>d0es<span class="keyword">)</span>
  <span class="keyword">|</span> D0Etup2 <span class="keyword">(</span>_<span class="keyword">,</span> d0es1<span class="keyword">,</span> d0es2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0explst <span class="keyword">(</span>d0es1<span class="keyword">)</span><span class="keyword">;</span> depgen_d0explst <span class="keyword">(</span>d0es2<span class="keyword">)</span>
    <span class="keyword">)</span> <span class="comment">// end of [D0Etup2]
</span>  <span class="keyword">|</span> D0Eviewat _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> D0Ewhere <span class="keyword">(</span>d0e<span class="keyword">,</span> d0cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0exp <span class="keyword">(</span>d0e<span class="keyword">)</span><span class="keyword">;</span> depgen_d0eclst <span class="keyword">(</span>d0cs<span class="keyword">)</span>
    <span class="keyword">)</span> <span class="comment">// end of [D0Ewhere]
</span>  <span class="keyword">|</span> D0Ewhile <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> d0e_test<span class="keyword">,</span> d0e_body<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>
      depgen_d0exp <span class="keyword">(</span>d0e_test<span class="keyword">)</span><span class="keyword">;</span> depgen_d0exp <span class="keyword">(</span>d0e_body<span class="keyword">)</span>
    <span class="keyword">)</span> <span class="comment">// end of [D0Ewhile]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [depgen_d0exp]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
depgen_d0ec <span class="keyword">(</span>d<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> d<span class="keyword">.</span>d0ec_node <span class="keyword">of</span>
<span class="comment">(*
  | D0Cfixity _ =&gt; ()
  | D0Cnonfix _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Cinclude
      <span class="keyword">(</span>stadyn<span class="keyword">,</span> basename<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> test <span class="keyword">=</span> test_file_exists <span class="keyword">(</span>basename<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> test <span class="keyword">then</span> the_deplst_push <span class="keyword">(</span>basename<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [DOCinclude]
</span><span class="comment">(*
  | D0Csymintr _ =&gt; ()
  | D0Ce0xpdef _ =&gt; ()
  | D0Ce0xpact _ =&gt; ()
  | D0Cdatsrts _ =&gt; ()
  | D0Csrtdefs _ =&gt; ()
  | D0Cstacons _ =&gt; ()
  | D0Cstacsts _ =&gt; ()
  | D0Cstavars _ =&gt; ()
  | D0Csexpdefs _ =&gt; ()
  | D0Csaspdec _ =&gt; ()
  | D0Cdcstdecs _ =&gt; ()
  | D0Cdatdecs _ =&gt; ()
  | D0Cexndecs _ =&gt; ()
  | D0Cclassdec _ =&gt; ()
  | D0Coverload _ =&gt; ()
  | D0Cextype _ =&gt; ()
  | D0Cextval _ =&gt; ()
  | D0Cextcode _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Cvaldecs <span class="keyword">(</span>_<span class="keyword">,</span> v0d<span class="keyword">,</span> v0ds<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_v0aldec <span class="keyword">(</span>v0d<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> $Lst<span class="keyword">.</span>list_foreach_fun <span class="keyword">(</span>v0ds<span class="keyword">,</span> depgen_v0aldec<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">// end of [D0Cvaldecs]
</span>  <span class="keyword">|</span> D0Cvaldecs_rec <span class="keyword">(</span>v0d<span class="keyword">,</span> v0ds<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_v0aldec <span class="keyword">(</span>v0d<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> $Lst<span class="keyword">.</span>list_foreach_fun <span class="keyword">(</span>v0ds<span class="keyword">,</span> depgen_v0aldec<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">// end of [D0Cvaldecs]
</span>  <span class="keyword">|</span> D0Cfundecs <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> f0d<span class="keyword">,</span> f0ds<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_f0undec <span class="keyword">(</span>f0d<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> $Lst<span class="keyword">.</span>list_foreach_fun <span class="keyword">(</span>f0ds<span class="keyword">,</span> depgen_f0undec<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">// end of [D0Cfundecs]
</span>  <span class="keyword">|</span> D0Cvardecs <span class="keyword">(</span>v0d<span class="keyword">,</span> v0ds<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_v0ardec <span class="keyword">(</span>v0d<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> $Lst<span class="keyword">.</span>list_foreach_fun <span class="keyword">(</span>v0ds<span class="keyword">,</span> depgen_v0ardec<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="comment">// nothing
</span>    <span class="keyword">end</span> <span class="comment">// end of [D0Cvardecs]
</span><span class="comment">(*
  | D0Cmacdefs _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Cimpdec <span class="keyword">(</span>_<span class="keyword">,</span> i0d<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_d0exp <span class="keyword">(</span>i0d<span class="keyword">.</span>i0mpdec_def<span class="keyword">)</span>
<span class="comment">(*
  | D0Cdynload _ =&gt; ()
*)</span>
  <span class="keyword">|</span> D0Cstaload <span class="keyword">(</span>_<span class="keyword">,</span> basename<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> test <span class="keyword">=</span> test_file_exists <span class="keyword">(</span>basename<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> test <span class="keyword">then</span> the_deplst_push <span class="keyword">(</span>basename<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [DOCstaload]
</span>  <span class="keyword">|</span> D0Clocal <span class="keyword">(</span>ds1<span class="keyword">,</span> ds2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0eclst <span class="keyword">(</span>ds1<span class="keyword">)</span><span class="keyword">;</span> <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> depgen_d0eclst <span class="keyword">(</span>ds2<span class="keyword">)</span>
    <span class="keyword">}</span> <span class="comment">// end of [D0Clocal]
</span>  <span class="keyword">|</span> D0Cguadec <span class="keyword">(</span>_<span class="keyword">,</span> gd0c<span class="keyword">)</span> <span class="keyword">=&gt;</span> depgen_guad0ec_node <span class="keyword">(</span>gd0c<span class="keyword">.</span>guad0ec_node<span class="keyword">)</span>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [depgen_d0ec]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> depgen_d0eclst <span class="keyword">(</span>ds<span class="keyword">)</span> <span class="keyword">=</span> $Lst<span class="keyword">.</span>list_foreach_fun <span class="keyword">(</span>ds<span class="keyword">,</span> depgen_d0ec<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [ats_syntax_depgen.dats] *)</span>
</pre>
</body>
</html>
