<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">(*
**
** A simple GTK/CAIRO example: a clock @ home
** The part of clock drawing is largely taken from
** a cairo example I did in December 2009
**
** Author: Hongwei Xi (hwxi AT cs DOT bu DOT edu)
** Time: April, 2010
**
*)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anon*)</span> <span class="keyword">=</span> "prelude/DATS/reference.dats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"libc/SATS/math.sats"</span>
<span class="keyword">macdef</span> <span class="neuexp">PI <span class="keyword">=</span> M_PI</span>
<span class="keyword">macdef</span> <span class="neuexp">PI2 <span class="keyword">=</span> PI/2</span>

<span class="keyword">staload</span> <span class="staexp">"libc/SATS/time.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"contrib/cairo/SATS/cairo.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">stadef</span> <span class="staexp"><a name="506"><span class="stacstdec">dbl <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14376"><span class="stacstuse">double</span></a></span></a></span>
<span class="keyword">stadef</span> <span class="staexp"><a name="526"><span class="stacstdec">cr <span class="keyword">(</span>l<span class="keyword">:</span>addr<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse">cairo_ref</span></a> l</span></a></span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> draw_hand <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>cr<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#526"><span class="stacstuse"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#526"><span class="stacstuse">cr</span></a></span></a> l</span><span class="keyword">,</span> bot<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#506"><span class="stacstuse">dbl</span></a></span><span class="keyword">,</span> top<span class="keyword">:</span><span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#506"><span class="stacstuse">dbl</span></a></span><span class="keyword">,</span> len<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#506"><span class="stacstuse">dbl</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22352"><span class="dyncstuse">cairo_move_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> bot/2<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22221"><span class="dyncstuse">cairo_line_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> len<span class="keyword">,</span> top/2<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22221"><span class="dyncstuse">cairo_line_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> len<span class="keyword">,</span> <span class="keyword">~</span>top/2<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#22221"><span class="dyncstuse">cairo_line_to</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> <span class="keyword">~</span>bot/2<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21493"><span class="dyncstuse">cairo_close_path</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
<span class="keyword">in</span>
  <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#17329"><span class="dyncstuse">cairo_fill</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [draw_hand]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">val</span> theLastSec <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2freference_2esats.html#2028"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>~1<span class="keyword">)</span>

<span class="keyword">fn</span> draw_clock <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span> <span class="keyword">(</span>
    cr<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#526"><span class="stacstuse"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#526"><span class="stacstuse">cr</span></a></span></a> l</span>
  <span class="keyword">,</span> h<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15918"><span class="stacstuse">natLt</span></a> 24</span><span class="keyword">,</span> m<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15918"><span class="stacstuse">natLt</span></a> 60</span><span class="keyword">,</span> s<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15918"><span class="stacstuse">natLt</span></a> 60</span> <span class="comment">// hour and minute
</span>  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">//
</span>  <span class="keyword">val</span> dim <span class="keyword">=</span> 100.0 <span class="comment">// please scale it!
</span>  <span class="keyword">val</span> rad <span class="keyword">=</span> 0.375 * dim
<span class="comment">//
</span>  <span class="keyword">val</span> h <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">if</span> h &gt;= 12 <span class="keyword">then</span> h - 12 <span class="keyword">else</span> h<span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15918"><span class="stacstuse">natLt</span></a> 12</span>
  <span class="keyword">val</span> s_ang <span class="keyword">=</span> s * <span class="keyword">(</span>PI / 30<span class="keyword">)</span> - PI2
  <span class="comment">// val m_ang = m * (PI / 30) + s * (PI / 1800) - PI2
</span>  <span class="keyword">val</span> m_ang <span class="keyword">=</span> m * <span class="keyword">(</span>PI / 30<span class="keyword">)</span> - PI2
  <span class="keyword">val</span> h_ang <span class="keyword">=</span> h * <span class="keyword">(</span>PI / 6<span class="keyword">)</span> + m * <span class="keyword">(</span>PI / 360<span class="keyword">)</span> - PI2
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21630"><span class="dyncstuse">cairo_arc</span></a>
    <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> rad<span class="keyword">,</span> 0.0<span class="keyword">,</span> 2 * PI<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 1.0<span class="keyword">,</span> 1.0<span class="keyword">,</span> 1.0<span class="keyword">)</span>
<span class="comment">(*
  val () = cairo_set_source_rgb (cr, 1.0, 0.50, 0.50)
*)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#17329"><span class="dyncstuse">cairo_fill</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21630"><span class="dyncstuse">cairo_arc</span></a>
    <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> rad<span class="keyword">,</span> 0.0<span class="keyword">,</span> 2 * PI<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 1.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
<span class="comment">(*
  val () = cairo_set_source_rgb (cr, 1.0, 0.0, 1.0)
*)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#13534"><span class="dyncstuse">cairo_set_line_width</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 4.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#18617"><span class="dyncstuse">cairo_stroke</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> rad1 <span class="keyword">=</span> 0.90 * rad
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21630"><span class="dyncstuse">cairo_arc</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> <span class="keyword">~</span>rad1<span class="keyword">,</span> <span class="keyword">~</span>rad1<span class="keyword">,</span> rad1<span class="keyword">,</span>  0.0<span class="keyword">,</span> PI2<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21630"><span class="dyncstuse">cairo_arc</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> <span class="keyword">~</span>rad1<span class="keyword">,</span>  rad1<span class="keyword">,</span> rad1<span class="keyword">,</span> <span class="keyword">~</span>PI2<span class="keyword">,</span>  0.<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21630"><span class="dyncstuse">cairo_arc</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span>  rad1<span class="keyword">,</span>  rad1<span class="keyword">,</span> rad1<span class="keyword">,</span> <span class="keyword">~</span>PI<span class="keyword">,</span> <span class="keyword">~</span>PI2<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21630"><span class="dyncstuse">cairo_arc</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span>  rad1<span class="keyword">,</span> <span class="keyword">~</span>rad1<span class="keyword">,</span> rad1<span class="keyword">,</span>  PI2<span class="keyword">,</span>  PI<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#17329"><span class="dyncstuse">cairo_fill</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> h_l <span class="keyword">=</span> 0.60 * rad
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37367"><span class="dyncstuse">cairo_rotate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> h_ang<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> draw_hand <span class="keyword">(</span>cr<span class="keyword">,</span> 3.0<span class="keyword">,</span> 1.5<span class="keyword">,</span> h_l<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37367"><span class="dyncstuse">cairo_rotate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> h_ang+PI<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> draw_hand <span class="keyword">(</span>cr<span class="keyword">,</span> 3.0<span class="keyword">,</span> 1.5<span class="keyword">,</span> h_l/4<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> m_l <span class="keyword">=</span> 0.85 * rad
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37367"><span class="dyncstuse">cairo_rotate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> m_ang<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> draw_hand <span class="keyword">(</span>cr<span class="keyword">,</span> 2.0<span class="keyword">,</span> 1.0<span class="keyword">,</span> m_l<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37367"><span class="dyncstuse">cairo_rotate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> m_ang+PI<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> draw_hand <span class="keyword">(</span>cr<span class="keyword">,</span> 2.0<span class="keyword">,</span> 1.0<span class="keyword">,</span> h_l/4<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> s_l <span class="keyword">=</span> 0.85 * rad
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 1.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37367"><span class="dyncstuse">cairo_rotate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> s_ang<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> draw_hand <span class="keyword">(</span>cr<span class="keyword">,</span> 1.0<span class="keyword">,</span> 0.5<span class="keyword">,</span> m_l<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 1.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37367"><span class="dyncstuse">cairo_rotate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> s_ang+PI<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> draw_hand <span class="keyword">(</span>cr<span class="keyword">,</span> 1.0<span class="keyword">,</span> 0.5<span class="keyword">,</span> h_l/4<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#9191"><span class="dyncstuse">cairo_set_source_rgb</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21375"><span class="dyncstuse">cairo_new_sub_path</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#21630"><span class="dyncstuse">cairo_arc</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> 0.0<span class="keyword">,</span> 0.0<span class="keyword">,</span> 2.5<span class="keyword">,</span> 0.0<span class="keyword">,</span> 2 * PI<span class="keyword">)</span>  
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#17329"><span class="dyncstuse">cairo_fill</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="comment">// nothing
</span><span class="keyword">end</span> <span class="comment">// end of [draw_clock]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">extern</span> <span class="keyword">fun</span> <a name="3692"><span class="dyncstdec">draw_main <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>cr<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#1850"><span class="stacstuse">cairo_ref</span></a></span></a> l</span><span class="keyword">,</span> width<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> height<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14520"><span class="stacstuse">int</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span></span></a>
<span class="keyword">implement</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#3692"><span class="dyncstimp">draw_main</span></a>
  <span class="keyword">(</span>cr<span class="keyword">,</span> width<span class="keyword">,</span> height<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> w <span class="keyword">=</span> <span class="keyword">(</span>double_of<span class="keyword">)</span>width
  <span class="keyword">val</span> h <span class="keyword">=</span> <span class="keyword">(</span>double_of<span class="keyword">)</span>height
  <span class="keyword">val</span> mn <span class="keyword">=</span> min <span class="keyword">(</span>w<span class="keyword">,</span> h<span class="keyword">)</span>
  <span class="keyword">val</span> xc <span class="keyword">=</span> w / 2 <span class="keyword">and</span> yc <span class="keyword">=</span> h / 2
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf0</span> <span class="keyword">|</span> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7321"><span class="dyncstuse">cairo_save</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37061"><span class="dyncstuse">cairo_translate</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> xc<span class="keyword">,</span> yc<span class="keyword">)</span>
  <span class="keyword">val</span> alpha <span class="keyword">=</span> mn / 100
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#37198"><span class="dyncstuse">cairo_scale</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> alpha<span class="keyword">,</span> alpha<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">var</span> t<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#2030"><span class="stacstuse">time_t</span></a></span> <span class="comment">// unintialized
</span>  <span class="keyword">val</span> yn <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#3276"><span class="dyncstuse">time_get_and_set</span></a> <span class="keyword">(</span>t<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> assert_errmsg <span class="keyword">(</span>yn<span class="keyword">,</span> <span class="keyword">#LOCATION</span><span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#8913"><span class="dyncstuse">opt_unsome</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#2030"><span class="stacstuse">time_t</span></a><span class="keyword">}</span></span> <span class="keyword">(</span>t<span class="keyword">)</span></span>
  <span class="keyword">var</span> tm<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#1631"><span class="stacstuse">tm_struct</span></a></span> <span class="comment">// unintialized
</span>  <span class="keyword">val</span> _ptr <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#4221"><span class="dyncstuse">localtime_r</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> tm<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> assert_errmsg <span class="keyword">(</span>_ptr <span class="keyword">&gt;</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">,</span> <span class="keyword">#LOCATION</span><span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#8913"><span class="dyncstuse">opt_unsome</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#1631"><span class="stacstuse">tm_struct</span></a><span class="keyword">}</span></span> <span class="keyword">(</span>tm<span class="keyword">)</span></span>
  <span class="keyword">val</span> hr <span class="keyword">=</span> tm<span class="keyword">.</span>tm_hour <span class="keyword">and</span> mt <span class="keyword">=</span> tm<span class="keyword">.</span>tm_min <span class="keyword">and</span> sd <span class="keyword">=</span> tm<span class="keyword">.</span>tm_sec
  <span class="keyword">val</span> hr <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2finteger_2esats.html#9644"><span class="dyncstuse">int1_of_int</span></a> <span class="keyword">(</span>hr<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> assert <span class="keyword">(</span>0 &lt;= hr &amp;&amp; hr <span class="keyword">&lt;</span> 24<span class="keyword">)</span>
  <span class="keyword">val</span> mt <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2finteger_2esats.html#9644"><span class="dyncstuse">int1_of_int</span></a> <span class="keyword">(</span>mt<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> assert <span class="keyword">(</span>0 &lt;= mt &amp;&amp; mt <span class="keyword">&lt;</span> 60<span class="keyword">)</span>
  <span class="keyword">val</span> sd <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2finteger_2esats.html#9644"><span class="dyncstuse">int1_of_int</span></a> <span class="keyword">(</span>sd<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> assert <span class="keyword">(</span>0 &lt;= sd &amp;&amp; sd <span class="keyword">&lt;</span> 60<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> draw_clock <span class="keyword">(</span>cr<span class="keyword">,</span> hr<span class="keyword">,</span> mt<span class="keyword">,</span> sd<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7438"><span class="dyncstuse">cairo_restore</span></a> <span class="keyword">(</span><span class="prfexp">pf0</span> <span class="keyword">|</span> cr<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [draw_main]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"contrib/glib/SATS/glib.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"contrib/glib/SATS/glib-object.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"contrib/GTK/SATS/gdk.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"contrib/GTK/SATS/gtkclassdec.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"contrib/GTK/SATS/gtk.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{^
extern
ats_void_type mainats (ats_int_type argc, ats_ptr_type argv) ;
%}</span> <span class="comment">// end of [%{^]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{^
GtkWidget *the_drawingarea = NULL;
ats_ptr_type
the_drawingarea_get () {
  if (the_drawingarea == NULL) {
    fprintf (stderr, "exit(the_drawingarea_get): not initialized yet\n"); exit(1);
  } // end of [if]
  return the_drawingarea ;
} // end of [the_drawingarea_get]
ats_void_type
the_drawingarea_initset (ats_ptr_type x) {
  static int the_drawingarea_initset_flag = 0 ;
  if (the_drawingarea_initset_flag) {
    fprintf (stderr, "exit(the_drawingarea_initset): already initialized\n"); exit(1);
  } // end of [if]
  the_drawingarea_initset_flag = 1 ; the_drawingarea = x ; return ;
} // end of [the_drawingarea_initset]
%}</span> <span class="comment">// end of [%{^] 
</span><span class="keyword">extern</span>
<span class="keyword">fun</span> <a name="5773"><span class="dyncstdec">the_drawingarea_get <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>l<span class="keyword">:</span>agz<span class="keyword">]</span>
  <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#5512"><span class="stacstuse">GtkDrawingArea</span></a><span class="keyword">,</span> l<span class="keyword">)</span> <span class="keyword">-&lt;</span>lin<span class="keyword">,</span>prf<span class="keyword">&gt;</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a> <span class="keyword">|</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#5512"><span class="stacstuse">GtkDrawingArea</span></a><span class="keyword">,</span> l<span class="keyword">)</span><span class="keyword">)</span></span></span></a>
  <span class="keyword">=</span> "the_drawingarea_get"
<span class="comment">// end of [the_drawingarea_get]
</span><span class="keyword">extern</span>
<span class="keyword">fun</span> <a name="5952"><span class="dyncstdec">the_drawingarea_initset
  <span class="keyword">(</span>x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#5253"><span class="stacstuse">GtkDrawingArea_ref1</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span></span></a> <span class="keyword">=</span> "the_drawingarea_initset"
<span class="comment">// end of [the_drawingarea_initset]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> draw_drawingarea
  <span class="staexp"><span class="keyword">{</span>c<span class="keyword">:</span>cls <span class="keyword">|</span> c <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#8412"><span class="stacstuse">&lt;=</span></a> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#5512"><span class="stacstuse">GtkDrawingArea</span></a><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>l<span class="keyword">:</span>agz<span class="keyword">}</span></span>
  <span class="keyword">(</span>darea<span class="keyword">:</span> <span class="staexp"><span class="keyword">!</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2742"><span class="stacstuse">gobjref</span></a></span></a> <span class="keyword">(</span>c<span class="keyword">,</span> l<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">//
</span>  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#8286"><span class="dyncstuse">clstrans</span></a> <span class="staexp"><span class="keyword">{</span>c<span class="keyword">,</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#5512"><span class="stacstuse">GtkDrawingArea</span></a><span class="keyword">,</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtkclassdec_2esats.html#1995"><span class="stacstuse">GtkWidget</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span></span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_win</span> <span class="keyword">|</span> win<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#5831"><span class="dyncstuse">gtk_widget_get_window</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">if</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2389"><span class="dyncstuse">g_object_isnot_null</span></a> <span class="keyword">(</span>win<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">let</span>
    <span class="keyword">val</span> cr <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgdk_2fgdkcairo_2esats.html#1652"><span class="dyncstuse">gdk_cairo_create</span></a> <span class="keyword">(</span>win<span class="keyword">)</span>
    <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf_win</span><span class="keyword">,</span> <span class="prfexp">win</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span><span class="keyword">,</span> <span class="prfexp">fpf</span> <span class="keyword">|</span> p<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#6599"><span class="dyncstuse">gtk_widget_getref_allocation</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#3692"><span class="dyncstuse">draw_main</span></a> <span class="keyword">(</span>cr<span class="keyword">,</span> <span class="keyword">(</span>int_of<span class="keyword">)</span>p<span class="keyword">-&gt;</span>width<span class="keyword">,</span> <span class="keyword">(</span>int_of<span class="keyword">)</span>p<span class="keyword">-&gt;</span>height<span class="keyword">)</span>
    <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf</span><span class="keyword">,</span> <span class="prfexp">pf</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fcairo_2fSATS_2fcairo_2esats.html#7088"><span class="dyncstuse">cairo_destroy</span></a> <span class="keyword">(</span>cr<span class="keyword">)</span>
  <span class="keyword">in</span>
    <span class="comment">// nothing
</span>  <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">let</span>
    <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf_win</span><span class="keyword">,</span> <span class="prfexp">win</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
  <span class="keyword">in</span>
    <span class="comment">// nothing
</span>  <span class="keyword">end</span> <span class="comment">(* end of [if] *)</span>
<span class="keyword">end</span> <span class="comment">// end of [draw_drawingarea]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> fexpose <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2151"><span class="stacstuse">gboolean</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_darea</span> <span class="keyword">|</span> darea<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#5773"><span class="dyncstuse">the_drawingarea_get</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> _ <span class="keyword">=</span> draw_drawingarea <span class="keyword">(</span>darea<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_darea <span class="keyword">(</span>darea<span class="keyword">)</span></span>
<span class="keyword">in</span>
  GFALSE
<span class="keyword">end</span> <span class="comment">// end of [fexpose]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> sec_changed
  <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#14138"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">var</span> t<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#2030"><span class="stacstuse">time_t</span></a></span> <span class="comment">// unintialized
</span>  <span class="keyword">val</span> yn <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#3276"><span class="dyncstuse">time_get_and_set</span></a> <span class="keyword">(</span>t<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> assert_errmsg <span class="keyword">(</span>yn<span class="keyword">,</span> <span class="keyword">#LOCATION</span><span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#8913"><span class="dyncstuse">opt_unsome</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#2030"><span class="stacstuse">time_t</span></a><span class="keyword">}</span></span> <span class="keyword">(</span>t<span class="keyword">)</span></span>
  <span class="keyword">var</span> tm<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#1631"><span class="stacstuse">tm_struct</span></a></span> <span class="comment">// unintialized
</span>  <span class="keyword">val</span> _ptr <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#4221"><span class="dyncstuse">localtime_r</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> tm<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> assert_errmsg <span class="keyword">(</span>_ptr <span class="keyword">&gt;</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">,</span> <span class="keyword">#LOCATION</span><span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#8913"><span class="dyncstuse">opt_unsome</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2ftrunk_2flibc_2fSATS_2ftime_2esats.html#1631"><span class="stacstuse">tm_struct</span></a><span class="keyword">}</span></span> <span class="keyword">(</span>tm<span class="keyword">)</span></span>
  <span class="keyword">val</span> sd <span class="keyword">=</span> tm<span class="keyword">.</span>tm_sec
  <span class="keyword">val</span> sd_old <span class="keyword">=</span> <span class="keyword">!</span>theLastSec
<span class="keyword">in</span>
  sd &lt;&gt; sd_old
<span class="keyword">end</span> <span class="comment">// end of [sec_changed]
</span>
<span class="keyword">fun</span> ftimeout
  <span class="keyword">(</span>_<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2414"><span class="stacstuse">gpointer</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2esats.html#2151"><span class="stacstuse">gboolean</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_darea</span> <span class="keyword">|</span> darea<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#5773"><span class="dyncstuse">the_drawingarea_get</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_win</span> <span class="keyword">|</span> win<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#5831"><span class="dyncstuse">gtk_widget_get_window</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">if</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2389"><span class="dyncstuse">g_object_isnot_null</span></a> <span class="keyword">(</span>win<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">let</span>
    <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf_win</span><span class="keyword">,</span> <span class="prfexp">win</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">pf</span><span class="keyword">,</span> <span class="prfexp">fpf</span> <span class="keyword">|</span> p<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#6599"><span class="dyncstuse">gtk_widget_getref_allocation</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> sec_changed <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">then</span>
      <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#8193"><span class="dyncstuse">gtk_widget_queue_draw_area</span></a> <span class="keyword">(</span>darea<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>0<span class="keyword">,</span> p<span class="keyword">-&gt;</span>width<span class="keyword">,</span> p<span class="keyword">-&gt;</span>height<span class="keyword">)</span>
    <span class="comment">// end of [val]
</span>    <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf</span><span class="keyword">,</span> <span class="prfexp">pf</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
    <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_darea <span class="keyword">(</span>darea<span class="keyword">)</span></span>
  <span class="keyword">in</span>
    GTRUE
  <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">let</span>
    <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fextern_2esats.html#2253"><span class="dyncstuse">minus_addback</span></a> <span class="keyword">(</span><span class="prfexp">fpf_win</span><span class="keyword">,</span> <span class="prfexp">win</span> <span class="keyword">|</span> darea<span class="keyword">)</span></span>
    <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_darea <span class="keyword">(</span>darea<span class="keyword">)</span></span>
  <span class="keyword">in</span>
    GFALSE <span class="comment">// HX: terminating the timer
</span>  <span class="keyword">end</span> <span class="comment">// end of [if]
</span><span class="keyword">end</span> <span class="comment">// end of [ftimeout]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">extern</span> <span class="keyword">fun</span> <a name="8228"><span class="dyncstdec">main1 <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span></span></a> <span class="keyword">=</span> "main1"

<span class="keyword">implement</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#8228"><span class="dyncstimp">main1</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> window <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwindow_2esats.html#1688"><span class="dyncstuse">gtk_window_new</span></a> <span class="keyword">(</span>GTK_WINDOW_TOPLEVEL<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwindow_2esats.html#3391"><span class="dyncstuse">gtk_window_set_default_size</span></a> <span class="keyword">(</span>window<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>400<span class="keyword">,</span> <span class="keyword">(</span>gint<span class="keyword">)</span>400<span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_x</span> <span class="keyword">|</span> x<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2fgbasics_2esats.html#9569"><span class="dyncstuse">gstring_of_string</span></a><span class="keyword">)</span>"ATS: gtkcairoclock"
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwindow_2esats.html#2106"><span class="dyncstuse">gtk_window_set_title</span></a> <span class="keyword">(</span>window<span class="keyword">,</span> x<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_x <span class="keyword">(</span>x<span class="keyword">)</span></span>
<span class="comment">//
</span>  <span class="keyword">val</span> darea <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkdrawingarea_2esats.html#1510"><span class="dyncstuse">gtk_drawing_area_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkcontainer_2esats.html#1510"><span class="dyncstuse">gtk_container_add</span></a> <span class="keyword">(</span>window<span class="keyword">,</span> darea<span class="keyword">)</span>
  <span class="keyword">val</span> _sid <span class="keyword">=</span> g_signal_connect
    <span class="keyword">(</span>darea<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"expose-event"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a> <span class="keyword">(</span>fexpose<span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fGTK_2fgtkcairoclock_2edats.html#5952"><span class="dyncstuse">the_drawingarea_initset</span></a> <span class="keyword">(</span>darea<span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="prfexp">fpf_window</span> <span class="keyword">|</span> window_<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2770"><span class="dyncstuse">g_object_vref</span></a> <span class="keyword">(</span>window<span class="keyword">)</span>
  <span class="keyword">val</span> _sid <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1933"><span class="dyncstuse">g_signal_connect0</span></a>
    <span class="keyword">(</span>window_<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"delete-event"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkmain_2esats.html#1611"><span class="dyncstuse">gtk_main_quit</span></a><span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
  <span class="keyword">val</span> _sid <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#2245"><span class="dyncstuse">g_signal_connect1</span></a>
    <span class="keyword">(</span>window<span class="keyword">,</span> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fgobject_2fgsignal_2esats.html#1539"><span class="dyncstuse">gsignal</span></a><span class="keyword">)</span>"destroy-event"<span class="keyword">,</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fglib_2fSATS_2fglib_2dobject_2esats.html#2992"><span class="dyncstuse">G_CALLBACK</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#2382"><span class="dyncstuse">gtk_widget_destroy</span></a><span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
<span class="comment">//
</span>  <span class="keyword">val</span> _rid <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkmain_2esats.html#1687"><span class="dyncstuse">gtk_timeout_add</span></a> <span class="keyword">(</span><span class="keyword">(</span>guint32<span class="keyword">)</span>100U<span class="keyword">,</span> ftimeout<span class="keyword">,</span> <span class="keyword">(</span>gpointer<span class="keyword">)</span><a href="XREF/_2ftmp_2ftrunk_2fprelude_2fSATS_2fpointer_2esats.html#2941"><span class="dyncstuse">null</span></a><span class="keyword">)</span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkwidget_2esats.html#3566"><span class="dyncstuse">gtk_widget_show_all</span></a> <span class="keyword">(</span>window<span class="keyword">)</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fpf_window <span class="keyword">(</span>window<span class="keyword">)</span></span>
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2ftrunk_2fcontrib_2fGTK_2fSATS_2fgtk_2fgtkmain_2esats.html#1510"><span class="dyncstuse">gtk_main</span></a> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [main1]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2ftmp_2ftrunk_2fprelude_2fbasics_5fdyn_2esats.html#6301"><span class="dyncstimp">main_dummy</span></a> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{$
ats_void_type
mainats (
  ats_int_type argc, ats_ptr_type argv
) {
  gtk_init ((int*)&amp;argc, (char***)&amp;argv) ; main1 () ; return ;
} // end of [mainats]
%}</span> <span class="comment">// end of [%{$]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [gtkcairolock.dats] *)</span>
</pre>
</body>
</html>
