<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">(***********************************************************************)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(*                         Applied Type System                         *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(*                              Hongwei Xi                             *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(***********************************************************************)</span>

<span class="comment">(*
** ATS/Anairiats - Unleashing the Potential of Types!
**
** Copyright (C) 2002-2008 Hongwei Xi, Boston University
**
** All rights reserved
**
** ATS is free software;  you can  redistribute it and/or modify it under
** the terms of  the GNU GENERAL PUBLIC LICENSE (GPL) as published by the
** Free Software Foundation; either version 3, or (at  your  option)  any
** later version.
** 
** ATS is distributed in the hope that it will be useful, but WITHOUT ANY
** WARRANTY; without  even  the  implied  warranty  of MERCHANTABILITY or
** FITNESS FOR A PARTICULAR PURPOSE.  See the  GNU General Public License
** for more details.
** 
** You  should  have  received  a  copy of the GNU General Public License
** along  with  ATS;  see the  file COPYING.  If not, please write to the
** Free Software Foundation,  51 Franklin Street, Fifth Floor, Boston, MA
** 02110-1301, USA.
*)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">// Author: Hongwei Xi (hwxi AT cs DOT bu DOT edu)
</span><span class="comment">// Time: December 2007
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* Mainly for testing exhaustiveness of pattern mattching  *)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{^
#include "ats_intinf.cats"
%}</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">Err <span class="keyword">=</span> "ats_error.sats"</span>
<span class="keyword">staload</span> <span class="staexp">IntInf <span class="keyword">=</span> "ats_intinf.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Lst <span class="keyword">=</span> "ats_list.sats"</span>
<span class="keyword">staload</span> <span class="staexp">SDC <span class="keyword">=</span> "ats_stadyncst2.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"ats_staexp2.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"ats_dynexp2.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"ats_patcst2.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">#define</span> <span class="neuexp">nil list_nil</span>
<span class="keyword">#define</span> <span class="neuexp">:: list_cons</span>
<span class="keyword">#define</span> <span class="neuexp">cons list_cons</span>

<span class="keyword">macdef</span> <span class="neuexp">singleton <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> cons <span class="keyword">(</span><span class="keyword">,(</span>x<span class="keyword">)</span><span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span></span>

<span class="comment">(* ****** ****** *)</span>

<span class="neuexp"><span class="keyword">overload</span> <span class="keyword">&lt;</span> <span class="keyword">with</span> $IntInf<span class="keyword">.</span>lt_intinf_intinf</span>
<span class="neuexp"><span class="keyword">overload</span> <span class="keyword">=</span> <span class="keyword">with</span> $IntInf<span class="keyword">.</span>eq_intinf_intinf</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">macdef</span> <span class="neuexp">fprint_label <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flabel_2esats.html#2567"><span class="dyncstuse">$Lab<span class="keyword">.</span>fprint_label</span></span></a>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> prerr_interror <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> prerr "INTERNAL ERROR (ats_patcst2)"

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">assume</span> <span class="staexp">intinfset_t <span class="keyword">=</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1851"><span class="stacstuse">intinf_t</span></a></span> <span class="comment">// of increasing order
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1717"><span class="dyncstimp">intinflst_of_intinfset</span></a> <span class="keyword">(</span>xs<span class="keyword">)</span> <span class="keyword">=</span> xs

<span class="keyword">fun</span> intinfset_add
  <span class="keyword">(</span>xs0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1686"><span class="stacstuse">intinfset_t</span></a></span><span class="keyword">,</span> x0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1851"><span class="stacstuse">intinf_t</span></a></span><span class="keyword">,</span> err<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1686"><span class="stacstuse">intinfset_t</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> xs0 <span class="keyword">of</span>
  <span class="keyword">|</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> x <span class="keyword">&lt;</span> x0 <span class="keyword">then</span> x :: intinfset_add <span class="keyword">(</span>xs<span class="keyword">,</span> x0<span class="keyword">,</span> err<span class="keyword">)</span>
      <span class="keyword">else</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> x0 <span class="keyword">&lt;</span> x <span class="keyword">then</span> x0 :: xs0 <span class="keyword">else</span> <span class="keyword">(</span>err := 1<span class="keyword">;</span> xs0<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>x0<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>

<span class="keyword">fun</span> intinfset_sing <span class="keyword">(</span>x<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1851"><span class="stacstuse">intinf_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1686"><span class="stacstuse">intinfset_t</span></a></span> <span class="keyword">=</span> cons <span class="keyword">(</span>x<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> p2atcst_lst <span class="keyword">(</span>p2tcs0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1783"><span class="stacstuse">p2atcst</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">(*
  val () = begin
    print "p2atcst_lst: p2tcs0 = "; print p2tcs0; print_newline ()
  end // end of [val]
*)</span>
  <span class="keyword">fun</span> aux
    <span class="keyword">(</span>d2c_cons<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2560"><span class="stacstuse">d2con_t</span></a></span><span class="keyword">,</span> d2c_nil<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2560"><span class="stacstuse">d2con_t</span></a></span><span class="keyword">,</span> p2tcs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1783"><span class="stacstuse">p2atcst</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> p2tcs <span class="keyword">of</span>
    <span class="keyword">|</span> p2tc_elt :: p2tcs <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> p2tc_lst <span class="keyword">=</span> aux <span class="keyword">(</span>d2c_cons<span class="keyword">,</span> d2c_nil<span class="keyword">,</span> p2tcs<span class="keyword">)</span>
      <span class="keyword">in</span>
        P2TCcon <span class="keyword">(</span>d2c_cons<span class="keyword">,</span> <span class="keyword">'[</span>p2tc_elt<span class="keyword">,</span> p2tc_lst<span class="keyword">]</span><span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> P2TCcon <span class="keyword">(</span>d2c_nil<span class="keyword">,</span> <span class="keyword">'[</span><span class="keyword">]</span><span class="keyword">)</span>
  <span class="keyword">val</span> d2c_nil <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstadyncst2_2esats.html#6268"><span class="dyncstuse">$SDC<span class="keyword">.</span>d2conref_con_get</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstadyncst2_2esats.html#6315"><span class="dyncstuse">$SDC<span class="keyword">.</span>List_nil</span></a><span class="keyword">)</span>
  <span class="keyword">val</span> d2c_cons <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstadyncst2_2esats.html#6268"><span class="dyncstuse">$SDC<span class="keyword">.</span>d2conref_con_get</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstadyncst2_2esats.html#6341"><span class="dyncstuse">$SDC<span class="keyword">.</span>List_cons</span></a><span class="keyword">)</span>
  <span class="keyword">val</span> p2tcs1 <span class="keyword">=</span> aux <span class="keyword">(</span>d2c_cons<span class="keyword">,</span> d2c_nil<span class="keyword">,</span> p2tcs0<span class="keyword">)</span>
<span class="comment">(*
  val () = begin
    print "p2atcst_lst: p2tcs1 = "; print p2tcs1; print_newline ()
  end
*)</span>
<span class="keyword">in</span>
  p2tcs1
<span class="keyword">end</span> <span class="comment">// end of [p2atcst_lst]
</span>
<span class="keyword">fun</span> labp2atcstlst_of_labp2atlst <span class="keyword">(</span>lp2ts<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12202"><span class="stacstuse">labp2atlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2177"><span class="stacstuse">labp2atcstlst</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> lp2ts <span class="keyword">of</span>
  <span class="keyword">|</span> LABP2ATLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> p2t<span class="keyword">,</span> lp2ts<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> p2tc <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2635"><span class="dyncstuse">p2atcst_of_p2at</span></a> p2t
      <span class="keyword">val</span> lp2tcs <span class="keyword">=</span> labp2atcstlst_of_labp2atlst lp2ts
    <span class="keyword">in</span>
      LABP2ATCSTLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> p2tc<span class="keyword">,</span> lp2tcs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> LABP2ATCSTLSTnil <span class="keyword">(</span><span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2635"><span class="dyncstimp">p2atcst_of_p2at</span></a> p2t0 <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> p2t0<span class="keyword">.</span>p2at_node <span class="keyword">of</span>
  <span class="keyword">|</span> P2Tann <span class="keyword">(</span>p2t<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2635"><span class="dyncstuse">p2atcst_of_p2at</span></a> p2t
  <span class="keyword">|</span> P2Tany <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> P2TCany <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> P2Tas <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> p2t<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2635"><span class="dyncstuse">p2atcst_of_p2at</span></a> p2t
  <span class="keyword">|</span> P2Tbool b <span class="keyword">=&gt;</span> P2TCbool b
  <span class="keyword">|</span> P2Tchar c <span class="keyword">=&gt;</span> P2TCchar c
  <span class="keyword">|</span> P2Tcon <span class="keyword">(</span>_<span class="keyword">,</span> d2c<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">,</span> p2ts<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      P2TCcon <span class="keyword">(</span>d2c<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2674"><span class="dyncstuse">p2atcstlst_of_p2atlst</span></a> p2ts<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> P2Tempty <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> P2TCempty <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> P2Texist <span class="keyword">(</span>_<span class="keyword">,</span> p2t<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2635"><span class="dyncstuse">p2atcst_of_p2at</span></a> p2t
  <span class="keyword">|</span> P2Tfloat f<span class="comment">(*string*)</span> <span class="keyword">=&gt;</span> P2TCfloat f
  <span class="keyword">|</span> P2Tint <span class="keyword">(</span>s<span class="comment">(*string*)</span><span class="keyword">,</span> i<span class="comment">(*intinf*)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> P2TCint i
  <span class="keyword">|</span> P2Tlist _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      prerr_interror <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      prerr ": p2atcst_of_p2at: p2t0 = "<span class="keyword">;</span> prerr p2t0<span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1783"><span class="stacstuse">p2atcst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [P2Tlist]
</span>  <span class="keyword">|</span> P2Tlst p2ts <span class="keyword">=&gt;</span> p2atcst_lst <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2674"><span class="dyncstuse">p2atcstlst_of_p2atlst</span></a> p2ts<span class="keyword">)</span>
  <span class="keyword">|</span> P2Trec <span class="keyword">(</span>recknd<span class="keyword">,</span> _<span class="comment">(*npf*)</span><span class="keyword">,</span> lp2ts<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      P2TCrec <span class="keyword">(</span>recknd<span class="keyword">,</span> labp2atcstlst_of_labp2atlst lp2ts<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [P2Trec]
</span>  <span class="keyword">|</span> P2Tstring s <span class="keyword">=&gt;</span> P2TCstring s
  <span class="keyword">|</span> P2Tvar _ <span class="keyword">=&gt;</span> P2TCany <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> P2Tvbox _ <span class="keyword">=&gt;</span> P2TCany <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [p2atcst_of_p2at]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2674"><span class="dyncstimp">p2atcstlst_of_p2atlst</span></a> <span class="keyword">(</span>p2ts<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> p2ts <span class="keyword">of</span>
  <span class="keyword">|</span> cons <span class="keyword">(</span>p2t<span class="keyword">,</span> p2ts<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      cons <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2635"><span class="dyncstuse">p2atcst_of_p2at</span></a> p2t<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2674"><span class="dyncstuse">p2atcstlst_of_p2atlst</span></a> p2ts<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// end of [nil]
</span><span class="comment">// end of [p2atcstlst_of_p2atlst]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> fprint_intinfset <span class="staexp"><span class="keyword">{</span>m<span class="keyword">:</span>file_mode<span class="keyword">}</span></span>
  <span class="keyword">(</span><span class="prfexp">pf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#10177"><span class="stacstuse">file_mode_lte</span></a> <span class="keyword">(</span>m<span class="keyword">,</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20767"><span class="stacstuse">w</span></a><span class="keyword">)</span></span></span> <span class="keyword">|</span> out<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse">FILE</span></a></span></a> m</span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1686"><span class="stacstuse">intinfset_t</span></a></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>out<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse">FILE</span></a></span></a> m</span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1686"><span class="stacstuse">intinfset_t</span></a></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> x :: xs <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> i <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ", "<span class="keyword">)</span><span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fintinf_2esats.html#4138"><span class="dyncstuse">$IntInf<span class="keyword">.</span>fprint_intinf</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> x<span class="keyword">)</span><span class="keyword">;</span> aux <span class="keyword">(</span>out<span class="keyword">,</span> i+1<span class="keyword">,</span> xs<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [::]
</span>    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// end of [nil]
</span>  <span class="keyword">end</span> <span class="comment">// end of [aux]
</span><span class="keyword">in</span>
  aux <span class="keyword">(</span>out<span class="keyword">,</span> 0<span class="keyword">,</span> xs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [fprint_intinfset]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2759"><span class="dyncstimp">fprint_p2atcst</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> p2tc<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">macdef</span> <span class="neuexp">prstr <span class="keyword">(</span>s<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span>pf <span class="keyword">|</span> out<span class="keyword">,</span> <span class="keyword">,(</span>s<span class="keyword">)</span><span class="keyword">)</span></span>  
<span class="keyword">in</span>
  <span class="keyword">case+</span> p2tc <span class="keyword">of</span>
  <span class="keyword">|</span> P2TCany <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '_'<span class="keyword">)</span>
  <span class="keyword">|</span> P2TCbool b <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> name <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">if</span> b <span class="keyword">then</span> "true" <span class="keyword">else</span> "false"<span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15989"><span class="stacstuse">string</span></a></span>
    <span class="keyword">in</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> name<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [P2TCbool]
</span>  <span class="keyword">|</span> P2TCchar c <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fprintf_2esats.html#2234"><span class="dyncstuse">fprintf1_exn</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "'%c'"<span class="keyword">,</span> <span class="keyword">@(</span>c<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> P2TCcon <span class="keyword">(</span>d2c<span class="keyword">,</span> p2tcs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#23451"><span class="dyncstuse">fprint_d2con</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> d2c<span class="keyword">)</span><span class="keyword">;</span>
      prstr "("<span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2855"><span class="dyncstuse">fprint_p2atcstlst</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> p2tcs<span class="keyword">)</span><span class="keyword">;</span>
      prstr ")"
    <span class="keyword">end</span> <span class="comment">// end of [P2TCcon]
</span>  <span class="keyword">|</span> P2TCempty <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "()"<span class="keyword">)</span>
  <span class="keyword">|</span> P2TCfloat f<span class="comment">(*string*)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> f<span class="keyword">)</span>
  <span class="keyword">|</span> P2TCint int <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fintinf_2esats.html#4138"><span class="dyncstuse">$IntInf<span class="keyword">.</span>fprint_intinf</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> int<span class="keyword">)</span>
  <span class="keyword">|</span> P2TCintc ints <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      prstr "[^"<span class="keyword">;</span>
      fprint_intinfset <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ints<span class="keyword">)</span><span class="keyword">;</span>
      prstr "]"
    <span class="keyword">end</span>
  <span class="keyword">|</span> P2TCrec <span class="keyword">(</span>recknd<span class="keyword">,</span> lp2tcs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> recknd <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <span class="keyword">begin</span>
        <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '\''<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span>
        <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fchar_2esats.html#5444"><span class="dyncstuse">fprint1_char</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> '@'<span class="keyword">)</span>
      <span class="keyword">end</span><span class="keyword">;</span>
      prstr "{"<span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3183"><span class="dyncstuse">fprint_labp2atcstlst</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> lp2tcs<span class="keyword">)</span><span class="keyword">;</span>
      prstr "}"
    <span class="keyword">end</span> <span class="comment">// end of [P2TCrec]
</span>  <span class="keyword">|</span> P2TCstring s <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fprintf_2esats.html#2234"><span class="dyncstuse">fprintf1_exn</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "\"%s\""<span class="keyword">,</span> <span class="keyword">@(</span>s<span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [fprint_p2atcst]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2855"><span class="dyncstimp">fprint_p2atcstlst</span></a> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">}</span></span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> p2tcs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>out<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse">FILE</span></a></span></a> m</span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> p2tcs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> p2tcs <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>p2tc<span class="keyword">,</span> p2tcs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> i <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ", "<span class="keyword">)</span><span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2759"><span class="dyncstuse">fprint_p2atcst</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> p2tc<span class="keyword">)</span><span class="keyword">;</span> aux <span class="keyword">(</span>out<span class="keyword">,</span> i+1<span class="keyword">,</span> p2tcs<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [aux]
</span><span class="keyword">in</span>
  aux <span class="keyword">(</span>out<span class="keyword">,</span> 0<span class="keyword">,</span> p2tcs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [fprint_p2atcstlst]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3183"><span class="dyncstimp">fprint_labp2atcstlst</span></a> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">}</span></span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> lp2tcs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>out<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse">FILE</span></a></span></a> m</span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> lp2tcs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2177"><span class="stacstuse">labp2atcstlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> lp2tcs <span class="keyword">of</span>
    <span class="keyword">|</span> LABP2ATCSTLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> p2tc<span class="keyword">,</span> lp2tcs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> i <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> ", "<span class="keyword">)</span><span class="keyword">;</span>
        fprint_label <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> l<span class="keyword">)</span><span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fSATS_2fstring_2esats.html#8037"><span class="dyncstuse">fprint1_string</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> "= "<span class="keyword">)</span><span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2759"><span class="dyncstuse">fprint_p2atcst</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> p2tc<span class="keyword">)</span><span class="keyword">;</span>
        aux <span class="keyword">(</span>out<span class="keyword">,</span> i + 1<span class="keyword">,</span> lp2tcs<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> LABP2ATCSTLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">in</span>
  aux <span class="keyword">(</span>out<span class="keyword">,</span> 0<span class="keyword">,</span> lp2tcs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [fprint_labp2atcstlst]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2957"><span class="dyncstimp">fprint_p2atcstlstlst</span></a> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">}</span></span> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> p2tcss<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>out<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#20956"><span class="stacstuse">FILE</span></a></span></a> m</span><span class="keyword">,</span> p2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2526"><span class="stacstuse">p2atcstlstlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> p2tcss <span class="keyword">of</span>
    <span class="keyword">|</span> cons <span class="keyword">(</span>p2tcs<span class="keyword">,</span> p2tcss<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2855"><span class="dyncstuse">fprint_p2atcstlst</span></a> <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">,</span> p2tcs<span class="keyword">)</span><span class="keyword">;</span> fprint_newline <span class="keyword">(</span><span class="prfexp">pf</span> <span class="keyword">|</span> out<span class="keyword">)</span><span class="keyword">;</span>
        aux <span class="keyword">(</span>out<span class="keyword">,</span> p2tcss<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">in</span>
  aux <span class="keyword">(</span>out<span class="keyword">,</span> p2tcss<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [fprint_p2atcstlstlst]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3367"><span class="dyncstimp">print_p2atcst</span></a> <span class="keyword">(</span>p2tc<span class="keyword">)</span> <span class="keyword">=</span> print_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2759"><span class="dyncstuse">fprint_p2atcst</span></a><span class="keyword">,</span> p2tc<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3404"><span class="dyncstimp">prerr_p2atcst</span></a> <span class="keyword">(</span>p2tc<span class="keyword">)</span> <span class="keyword">=</span> prerr_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2759"><span class="dyncstuse">fprint_p2atcst</span></a><span class="keyword">,</span> p2tc<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3511"><span class="dyncstimp">print_p2atcstlst</span></a> <span class="keyword">(</span>p2tcs<span class="keyword">)</span> <span class="keyword">=</span> print_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2855"><span class="dyncstuse">fprint_p2atcstlst</span></a><span class="keyword">,</span> p2tcs<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3554"><span class="dyncstimp">prerr_p2atcstlst</span></a> <span class="keyword">(</span>p2tcs<span class="keyword">)</span> <span class="keyword">=</span> prerr_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2855"><span class="dyncstuse">fprint_p2atcstlst</span></a><span class="keyword">,</span> p2tcs<span class="keyword">)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3673"><span class="dyncstimp">print_p2atcstlstlst</span></a> <span class="keyword">(</span>p2tcss<span class="keyword">)</span> <span class="keyword">=</span> print_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2957"><span class="dyncstuse">fprint_p2atcstlstlst</span></a><span class="keyword">,</span> p2tcss<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3722"><span class="dyncstimp">prerr_p2atcstlstlst</span></a> <span class="keyword">(</span>p2tcss<span class="keyword">)</span> <span class="keyword">=</span> prerr_mac <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2957"><span class="dyncstuse">fprint_p2atcstlstlst</span></a><span class="keyword">,</span> p2tcss<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> p2atcst_con_complement
  <span class="keyword">(</span>d2c0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2560"><span class="stacstuse">d2con_t</span></a></span><span class="keyword">,</span> d2cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2977"><span class="stacstuse">d2conlst</span></a></span><span class="keyword">,</span> p2tcs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>d2cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2977"><span class="stacstuse">d2conlst</span></a></span><span class="keyword">,</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2434"><span class="stacstuse">p2atcstlst_vt</span></a></span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
    <span class="keyword">case+</span> d2cs <span class="keyword">of</span>
    <span class="keyword">|</span> D2CONLSTcons <span class="keyword">(</span>d2c<span class="keyword">,</span> d2cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> d2c0 <span class="keyword">=</span> d2c <span class="keyword">then</span> <span class="keyword">let</span>
          <span class="keyword">val</span> res <span class="keyword">=</span>
            aux1 <span class="keyword">(</span>d2c<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3923"><span class="dyncstuse">p2atcstlst_complement</span></a> p2tcs<span class="keyword">,</span> res<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
            <span class="keyword">fun</span> aux1
              <span class="keyword">(</span>d2c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2560"><span class="stacstuse">d2con_t</span></a></span><span class="keyword">,</span> p2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2526"><span class="stacstuse">p2atcstlstlst</span></a></span><span class="keyword">,</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2434"><span class="stacstuse">p2atcstlst_vt</span></a></span><span class="keyword">)</span>
              <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2434"><span class="stacstuse">p2atcstlst_vt</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> p2tcss <span class="keyword">of</span>
              <span class="keyword">|</span> p2tcs :: p2tcss <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
                  aux1 <span class="keyword">(</span>d2c<span class="keyword">,</span> p2tcss<span class="keyword">,</span> list_vt_cons <span class="keyword">(</span>P2TCcon <span class="keyword">(</span>d2c<span class="keyword">,</span> p2tcs<span class="keyword">)</span><span class="keyword">,</span> res<span class="keyword">)</span><span class="keyword">)</span>
                <span class="keyword">end</span>
              <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> res
          <span class="keyword">}</span> <span class="comment">// end [where]
</span>        <span class="keyword">in</span>
          aux <span class="keyword">(</span>d2cs<span class="keyword">,</span> res<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">let</span>
          <span class="keyword">val</span> p2tcs_any <span class="keyword">=</span>
            aux2 <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#22496"><span class="dyncstuse">d2con_arity_full_get</span></a> d2c<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
            <span class="keyword">fun</span> aux2 <span class="keyword">(</span>n<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span> <span class="keyword">=</span>
              <span class="keyword">if</span> n <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> aux2 <span class="keyword">(</span>n-1<span class="keyword">,</span> cons <span class="keyword">(</span>P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> res<span class="keyword">)</span><span class="keyword">)</span>
              <span class="keyword">else</span> res
          <span class="keyword">}</span> <span class="comment">// end of [where]
</span>          <span class="keyword">val</span> res <span class="keyword">=</span> list_vt_cons <span class="keyword">(</span>P2TCcon <span class="keyword">(</span>d2c<span class="keyword">,</span> p2tcs_any<span class="keyword">)</span><span class="keyword">,</span> res<span class="keyword">)</span>
        <span class="keyword">in</span>
          aux <span class="keyword">(</span>d2cs<span class="keyword">,</span> res<span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">end</span> <span class="comment">// end of [D2CONLSTcons]
</span>    <span class="keyword">|</span> D2CONLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#4588"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_vt_reverse_list</span></a> <span class="keyword">(</span>res<span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [aux]
</span><span class="keyword">in</span>
  aux <span class="keyword">(</span>d2cs<span class="keyword">,</span> list_vt_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [p2atcst_con_complement]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3874"><span class="dyncstimp">p2atcst_complement</span></a> <span class="keyword">(</span>p2tc0<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> p2tc0 <span class="keyword">of</span>
  <span class="keyword">|</span> P2TCany <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> P2TCbool b <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>P2TCbool <span class="keyword">~</span>b<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> P2TCchar _ <span class="keyword">=&gt;</span> singleton <span class="keyword">(</span>P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="comment">// conservative estimation
</span>  <span class="keyword">|</span> P2TCcon <span class="keyword">(</span>d2c0<span class="keyword">,</span> p2tcs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> tag <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#22664"><span class="dyncstuse">d2con_tag_get</span></a> d2c0
    <span class="keyword">in</span>
      <span class="keyword">if</span> tag &gt;= 0 <span class="keyword">then</span> <span class="keyword">let</span>
        <span class="keyword">val</span> s2c0 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#22300"><span class="dyncstuse">d2con_scst_get</span></a> d2c0
        <span class="keyword">val</span> d2cs <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#14613"><span class="dyncstuse">s2cst_conlst_get</span></a> s2c0 <span class="keyword">of</span>
          <span class="keyword">|</span> Some d2cs <span class="keyword">=&gt;</span> d2cs <span class="keyword">|</span> None _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
              prerr_interror <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
              prerr ": p2atcst_complement: s2c0 = "<span class="keyword">;</span> prerr s2c0<span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
              <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2977"><span class="stacstuse">d2conlst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
            <span class="keyword">end</span> <span class="comment">// end of [None]
</span>        <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2977"><span class="stacstuse">d2conlst</span></a></span> <span class="comment">// end of [val]
</span>      <span class="keyword">in</span>
        p2atcst_con_complement <span class="keyword">(</span>d2c0<span class="keyword">,</span> d2cs<span class="keyword">,</span> p2tcs<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span> <span class="comment">// associated with a extensible sum
</span>        singleton <span class="keyword">(</span>P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [P2TCcon]
</span>  <span class="keyword">|</span> P2TCempty <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> P2TCfloat _ <span class="keyword">=&gt;</span> singleton <span class="keyword">(</span>P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="comment">// conservative estimation
</span>  <span class="keyword">|</span> P2TCint x <span class="keyword">=&gt;</span> singleton <span class="keyword">(</span>P2TCintc <span class="keyword">(</span>intinfset_sing x<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> P2TCintc xs <span class="keyword">=&gt;</span> aux xs <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">fun</span> aux <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1851"><span class="stacstuse">intinf_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
        cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> P2TCint x :: aux <span class="keyword">(</span>xs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">}</span> <span class="comment">// end of [where]
</span>  <span class="keyword">|</span> P2TCrec <span class="keyword">(</span>knd<span class="keyword">,</span> lp2tcs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> lp2tcss <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3993"><span class="dyncstuse">labp2atcstlst_complement</span></a> lp2tcs
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2688"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_map_cloptr</span></a> <span class="keyword">(</span>lp2tcss<span class="keyword">,</span> <span class="keyword">lam</span> lp2tcs <span class="keyword">=&lt;</span><span class="staexp">cloptr</span><span class="keyword">&gt;</span> P2TCrec <span class="keyword">(</span>knd<span class="keyword">,</span> lp2tcs<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> P2TCstring _ <span class="keyword">=&gt;</span> singleton <span class="keyword">(</span>P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>  <span class="comment">// conservative estimation
</span><span class="comment">(*
  | _ =&gt; begin
      prerr_interror ();
      prerr ": p2atcst_complement: p2tc0 = "; prerr p2tc0; prerr_newline ();
      $Err.abort {p2atcstlst} ()
    end // end of [_]
*)</span>
<span class="keyword">end</span> <span class="comment">// end of [p2atcst_complement]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3923"><span class="dyncstimp">p2atcstlst_complement</span></a> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">}</span></span> <span class="keyword">(</span>p2tcs0<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> p2tcs0 <span class="keyword">of</span>
  <span class="keyword">|</span> p2tc1 :: p2tcs1 <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> p2tcs1_any <span class="keyword">=</span> aux p2tcs1 <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">fun</span> aux <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="keyword">(</span>p2tcs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2304"><span class="stacstuse">p2atcstlst</span></a> n</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2304"><span class="stacstuse">p2atcstlst</span></a> n</span> <span class="keyword">=</span>
          <span class="keyword">case+</span> p2tcs <span class="keyword">of</span>
          <span class="keyword">|</span> _ :: p2tcs <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> aux p2tcs<span class="keyword">)</span> <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">}</span> <span class="comment">// end of [where]
</span>      <span class="keyword">val</span> p2tcss <span class="keyword">=</span> aux <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3923"><span class="dyncstuse">p2atcstlst_complement</span></a> p2tcs1<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">fun</span> aux <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span>
          <span class="keyword">(</span>p2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2478"><span class="stacstuse">p2atcstlstlst</span></a> n</span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2478"><span class="stacstuse">p2atcstlstlst</span></a> <span class="keyword">(</span>n<a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#4972"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">=</span>
          <span class="keyword">case+</span> p2tcss <span class="keyword">of</span>
          <span class="keyword">|</span> p2tcs :: p2tcss <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>p2tc1 :: p2tcs<span class="keyword">,</span> aux p2tcss<span class="keyword">)</span>
          <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">}</span> <span class="comment">// end of [where]
</span>      <span class="keyword">val</span> p2tcss <span class="keyword">=</span> aux <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3874"><span class="dyncstuse">p2atcst_complement</span></a> p2tc1<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">fun</span> aux <span class="keyword">(</span>p2tcs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2478"><span class="stacstuse">p2atcstlstlst</span></a> <span class="keyword">(</span>n<span class="keyword">)</span></span> <span class="keyword">=</span>
        <span class="keyword">case+</span> p2tcs <span class="keyword">of</span>
        <span class="keyword">|</span> p2tc :: p2tcs <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>p2tc :: p2tcs1_any<span class="keyword">,</span> aux p2tcs<span class="keyword">)</span>
        <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> p2tcss
      <span class="keyword">}</span> <span class="comment">// end of [where]
</span>    <span class="keyword">in</span>
      p2tcss
    <span class="keyword">end</span> <span class="comment">// end of [::]
</span>  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// end of [nil]
</span><span class="keyword">end</span> <span class="comment">// end of [p2atcstlst_commplement]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3993"><span class="dyncstimp">labp2atcstlst_complement</span></a> <span class="keyword">(</span>lp2tcs0<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> lp2tcs0 <span class="keyword">of</span>
  <span class="keyword">|</span> LABP2ATCSTLSTcons <span class="keyword">(</span>l1<span class="keyword">,</span> p2tc1<span class="keyword">,</span> lp2tcs1<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> lp2tcs1_any <span class="keyword">=</span> aux lp2tcs1 <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">fun</span> aux <span class="keyword">(</span>lp2tcs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2177"><span class="stacstuse">labp2atcstlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2177"><span class="stacstuse">labp2atcstlst</span></a></span> <span class="keyword">=</span>
          <span class="keyword">case+</span> lp2tcs <span class="keyword">of</span>
          <span class="keyword">|</span> LABP2ATCSTLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> _<span class="keyword">,</span> lp2tcs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
              LABP2ATCSTLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> aux lp2tcs<span class="keyword">)</span>
            <span class="keyword">end</span>
          <span class="keyword">|</span> LABP2ATCSTLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> LABP2ATCSTLSTnil <span class="keyword">(</span><span class="keyword">)</span>
        <span class="comment">// end of [aux]
</span>      <span class="keyword">}</span> <span class="comment">// end of [where]
</span>      <span class="keyword">val</span> lp2tcss <span class="keyword">=</span> aux <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3993"><span class="dyncstuse">labp2atcstlst_complement</span></a> lp2tcs1<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">fun</span> aux <span class="keyword">(</span>lp2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2571"><span class="stacstuse">labp2atcstlstlst</span></a></span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2571"><span class="stacstuse">labp2atcstlstlst</span></a></span> <span class="keyword">=</span>
          <span class="keyword">case+</span> lp2tcss <span class="keyword">of</span>
          <span class="keyword">|</span> lp2tcs :: lp2tcss <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
              cons <span class="keyword">(</span>LABP2ATCSTLSTcons <span class="keyword">(</span>l1<span class="keyword">,</span> p2tc1<span class="keyword">,</span> lp2tcs<span class="keyword">)</span><span class="keyword">,</span> aux lp2tcss<span class="keyword">)</span>
            <span class="keyword">end</span>
          <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
        <span class="comment">// end of [aux]
</span>      <span class="keyword">}</span> <span class="comment">// end of [where]
</span>      <span class="keyword">val</span> lp2tcss <span class="keyword">=</span> aux <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3874"><span class="dyncstuse">p2atcst_complement</span></a> p2tc1<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">fun</span> aux <span class="keyword">(</span>p2tcs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2571"><span class="stacstuse">labp2atcstlstlst</span></a></span> <span class="keyword">=</span>
        <span class="keyword">case+</span> p2tcs <span class="keyword">of</span>
        <span class="keyword">|</span> cons <span class="keyword">(</span>p2tc<span class="keyword">,</span> p2tcs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
            cons <span class="keyword">(</span>LABP2ATCSTLSTcons <span class="keyword">(</span>l1<span class="keyword">,</span> p2tc<span class="keyword">,</span> lp2tcs1_any<span class="keyword">)</span><span class="keyword">,</span> aux p2tcs<span class="keyword">)</span>
          <span class="keyword">end</span>
        <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> lp2tcss
      <span class="keyword">}</span> <span class="comment">// end of [where]
</span>    <span class="keyword">in</span>
      lp2tcss
    <span class="keyword">end</span>
  <span class="keyword">|</span> LABP2ATCSTLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [labp2atcstlst_commplement]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4064"><span class="dyncstimp">c2lau_pat_complement</span></a> <span class="keyword">(</span>c2l<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> c2l<span class="keyword">.</span>c2lau_gua <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons _ <span class="keyword">=&gt;</span> <span class="keyword">let</span> <span class="comment">// the most conservative estimation
</span>      <span class="keyword">fun</span> aux <span class="staexp"><span class="keyword">{</span>i<span class="keyword">,</span>j<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>i<span class="keyword">&gt;.</span></span>
        <span class="keyword">(</span>p2ts<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#12477"><span class="stacstuse">p2atlst</span></a> i</span><span class="keyword">,</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2304"><span class="stacstuse">p2atcstlst</span></a> j</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2304"><span class="stacstuse">p2atcstlst</span></a> <span class="keyword">(</span>i<a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#4972"><span class="stacstuse">+</span></a>j<span class="keyword">)</span></span> <span class="keyword">=</span>
        <span class="keyword">case+</span> p2ts <span class="keyword">of</span>
        <span class="keyword">|</span> cons <span class="keyword">(</span>_<span class="keyword">,</span> p2ts<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>p2ts<span class="keyword">,</span> cons <span class="keyword">(</span>P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> res<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> res
      <span class="keyword">val</span> p2tcs <span class="keyword">=</span> aux <span class="keyword">(</span>c2l<span class="keyword">.</span>c2lau_pat<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">in</span>
      cons <span class="keyword">(</span>p2tcs<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> list_nil _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3923"><span class="dyncstuse">p2atcstlst_complement</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2674"><span class="dyncstuse">p2atcstlst_of_p2atlst</span></a> c2l<span class="keyword">.</span>c2lau_pat<span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span> <span class="comment">// end of [c2lau_pat_complement]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4149"><span class="dyncstimp">p2atcst_intersect_test</span></a> <span class="keyword">(</span>p2tc1<span class="keyword">,</span> p2tc2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>p2tc1<span class="keyword">,</span> p2tc2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>P2TCbool b1<span class="keyword">,</span> P2TCbool b2<span class="keyword">)</span> <span class="keyword">=&gt;</span> b1 <span class="keyword">=</span> b2
  <span class="keyword">|</span> <span class="keyword">(</span>P2TCchar c1<span class="keyword">,</span> P2TCchar c2<span class="keyword">)</span> <span class="keyword">=&gt;</span> c1 <span class="keyword">=</span> c2
  <span class="keyword">|</span> <span class="keyword">(</span>P2TCcon <span class="keyword">(</span>d2c1<span class="keyword">,</span> p2tcs1<span class="keyword">)</span><span class="keyword">,</span> P2TCcon <span class="keyword">(</span>d2c2<span class="keyword">,</span> p2tcs2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> d2c1 <span class="keyword">=</span> d2c2 <span class="keyword">then</span> <span class="keyword">let</span>
        <span class="keyword">val</span> sgn <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#3105"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_length_compare</span></a> <span class="keyword">(</span>p2tcs1<span class="keyword">,</span> p2tcs2<span class="keyword">)</span>
        <span class="comment">// run-time check needed for type-checking
</span>        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#5696"><span class="dyncstuse">assert_errmsg_bool1</span></a> <span class="keyword">(</span>sgn <span class="keyword">=</span> 0<span class="keyword">,</span> "p2atcst_intersect_test"<span class="keyword">)</span>
      <span class="keyword">in</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4208"><span class="dyncstuse">p2atcstlst_intersect_test</span></a> <span class="keyword">(</span>p2tcs1<span class="keyword">,</span> p2tcs2<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [P2TCcon, P2TCcon]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>P2TCempty <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> P2TCempty <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>P2TCint i1<span class="keyword">,</span> P2TCint i2<span class="keyword">)</span> <span class="keyword">=&gt;</span> i1 <span class="keyword">=</span> i2
  <span class="keyword">|</span> <span class="keyword">(</span>P2TCint i<span class="keyword">,</span> P2TCintc xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>i<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">fun</span> aux <span class="keyword">(</span>i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1851"><span class="stacstuse">intinf_t</span></a></span><span class="keyword">,</span> xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1686"><span class="stacstuse">intinfset_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
        <span class="keyword">|</span> list_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
            <span class="keyword">if</span> i <span class="keyword">&lt;</span> x <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> <span class="keyword">(</span><span class="keyword">if</span> x <span class="keyword">&lt;</span> i <span class="keyword">then</span> aux <span class="keyword">(</span>i<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a><span class="keyword">)</span>
          <span class="keyword">end</span>
        <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
    <span class="keyword">}</span> <span class="comment">// end of [where]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>P2TCintc xs<span class="keyword">,</span> P2TCint i<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>xs<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">fun</span> aux <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1686"><span class="stacstuse">intinfset_t</span></a></span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fdynexp2_2esats.html#1851"><span class="stacstuse">intinf_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
        <span class="keyword">|</span> list_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
            <span class="keyword">if</span> i <span class="keyword">&lt;</span> x <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> <span class="keyword">(</span><span class="keyword">if</span> x <span class="keyword">&lt;</span> i <span class="keyword">then</span> aux <span class="keyword">(</span>xs<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a><span class="keyword">)</span>
          <span class="keyword">end</span>
        <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
    <span class="keyword">}</span> <span class="comment">// end of [where]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>P2TCintc _<span class="keyword">,</span> P2TCintc _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>P2TCrec <span class="keyword">(</span>_<span class="keyword">,</span> lp2atcs1<span class="keyword">)</span><span class="keyword">,</span> P2TCrec <span class="keyword">(</span>_<span class="keyword">,</span> lp2atcs2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4300"><span class="dyncstuse">labp2atcstlst_intersect_test</span></a> <span class="keyword">(</span>lp2atcs1<span class="keyword">,</span> lp2atcs2<span class="keyword">)</span>
    <span class="comment">// end of [P2TCrec, P2TCrec]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">(* end of [p2atcst_intersect_test] *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4208"><span class="dyncstimp">p2atcstlst_intersect_test</span></a> <span class="keyword">(</span>p2tcs1<span class="keyword">,</span> p2tcs2<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> p2tcs1 <span class="keyword">of</span>
  <span class="keyword">|</span> cons <span class="keyword">(</span>p2tc1<span class="keyword">,</span> p2tcs1<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val+</span> cons <span class="keyword">(</span>p2tc2<span class="keyword">,</span> p2tcs2<span class="keyword">)</span> <span class="keyword">=</span> p2tcs2
    <span class="keyword">in</span>
      <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4149"><span class="dyncstuse">p2atcst_intersect_test</span></a> <span class="keyword">(</span>p2tc1<span class="keyword">,</span> p2tc2<span class="keyword">)</span> <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4208"><span class="dyncstuse">p2atcstlst_intersect_test</span></a> <span class="keyword">(</span>p2tcs1<span class="keyword">,</span> p2tcs2<span class="keyword">)</span>
      <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
<span class="comment">(* end of [p2atcstlst_intersect_test] *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4300"><span class="dyncstimp">labp2atcstlst_intersect_test</span></a> <span class="keyword">(</span>lp2tcs1<span class="keyword">,</span> lp2tcs2<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>lp2tcs1<span class="keyword">,</span> lp2tcs2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>LABP2ATCSTLSTcons <span class="keyword">(</span>l1<span class="keyword">,</span> p2tc1<span class="keyword">,</span> lp2tcs1<span class="keyword">)</span><span class="keyword">,</span>
     LABP2ATCSTLSTcons <span class="keyword">(</span>l2<span class="keyword">,</span> p2tc2<span class="keyword">,</span> lp2tcs2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
      <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4149"><span class="dyncstuse">p2atcst_intersect_test</span></a> <span class="keyword">(</span>p2tc1<span class="keyword">,</span> p2tc2<span class="keyword">)</span> <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4300"><span class="dyncstuse">labp2atcstlst_intersect_test</span></a> <span class="keyword">(</span>lp2tcs1<span class="keyword">,</span> lp2tcs2<span class="keyword">)</span>
      <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="comment">// end of [LABP2ATCSTLSTcons, LABP2ATCSTLSTcons]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
<span class="comment">(* end of [labp2atcstlst_intersect_test] *)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4398"><span class="dyncstimp">p2atcst_difference</span></a> <span class="keyword">(</span>p2tc1<span class="keyword">,</span> p2tc2<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>p2tc1<span class="keyword">,</span> p2tc2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>P2TCany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#3874"><span class="dyncstuse">p2atcst_complement</span></a> p2tc2
  <span class="keyword">|</span> <span class="keyword">(</span>P2TCbool b1<span class="keyword">,</span> P2TCbool b2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> b1 <span class="keyword">=</span> b2 <span class="keyword">then</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">else</span> cons <span class="keyword">(</span>p2tc1<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [P2TCbool, P2TCbool]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>P2TCchar c1<span class="keyword">,</span> P2TCchar c2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> c1 <span class="keyword">=</span> c2 <span class="keyword">then</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">else</span> cons <span class="keyword">(</span>p2tc1<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [P2TCchar, P2TCchar]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>P2TCcon <span class="keyword">(</span>d2c1<span class="keyword">,</span> p2tcs1<span class="keyword">)</span><span class="keyword">,</span> P2TCcon <span class="keyword">(</span>d2c2<span class="keyword">,</span> p2tcs2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
    <span class="keyword">if</span> d2c1 <span class="keyword">=</span> d2c2 <span class="keyword">then</span> <span class="keyword">let</span>
      <span class="keyword">fun</span> aux <span class="keyword">(</span>d2c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2560"><span class="stacstuse">d2con_t</span></a></span><span class="keyword">,</span> p2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2526"><span class="stacstuse">p2atcstlstlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span> <span class="keyword">=</span>
        <span class="keyword">case+</span> p2tcss <span class="keyword">of</span>
        <span class="keyword">|</span> p2tcs :: p2tcss <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>P2TCcon <span class="keyword">(</span>d2c<span class="keyword">,</span> p2tcs<span class="keyword">)</span><span class="keyword">,</span> aux <span class="keyword">(</span>d2c<span class="keyword">,</span> p2tcss<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">val</span> sgn <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#3105"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_length_compare</span></a> <span class="keyword">(</span>p2tcs1<span class="keyword">,</span> p2tcs2<span class="keyword">)</span>
      <span class="comment">// run-time check needed for type-checking
</span>      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#5696"><span class="dyncstuse">assert_errmsg_bool1</span></a> <span class="keyword">(</span>sgn <span class="keyword">=</span> 0<span class="keyword">,</span> "p2atcst_difference: P2TCcon"<span class="keyword">)</span>
    <span class="keyword">in</span>
      aux <span class="keyword">(</span>d2c1<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4459"><span class="dyncstuse">p2atcstlst_difference</span></a> <span class="keyword">(</span>p2tcs1<span class="keyword">,</span> p2tcs2<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span>
      cons <span class="keyword">(</span>p2tc1<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [P2TCcon, P2TCcon]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>P2TCempty <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> P2TCempty <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>P2TCint i1<span class="keyword">,</span> P2TCint i2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> i1 <span class="keyword">=</span> i2 <span class="keyword">then</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">else</span> cons <span class="keyword">(</span>p2tc1<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [P2TCint, P2TCint]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>P2TCstring s1<span class="keyword">,</span> P2TCstring s2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> s1 <span class="keyword">=</span> s2 <span class="keyword">then</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">else</span> cons <span class="keyword">(</span>p2tc1<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [P2TCstring, P2TCstring]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>P2TCintc xs<span class="keyword">,</span> P2TCint x<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">var</span> err<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0
      <span class="keyword">val</span> xs <span class="keyword">=</span> intinfset_add <span class="keyword">(</span>xs<span class="keyword">,</span> x<span class="keyword">,</span> err<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> err <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> cons <span class="keyword">(</span>p2tc1<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">else</span> cons <span class="keyword">(</span>P2TCintc xs<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [P2TCintc, P2TCint]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>P2TCrec <span class="keyword">(</span>knd1<span class="keyword">,</span> lp2tcs1<span class="keyword">)</span><span class="keyword">,</span>
     P2TCrec <span class="keyword">(</span>knd2<span class="keyword">,</span> lp2tcs2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> lp2tcss <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4567"><span class="dyncstuse">labp2atcstlst_difference</span></a> <span class="keyword">(</span>lp2tcs1<span class="keyword">,</span> lp2tcs2<span class="keyword">)</span>
    <span class="keyword">in</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2688"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_map_cloptr</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2177"><span class="stacstuse">labp2atcstlst</span></a><span class="keyword">,</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1783"><span class="stacstuse">p2atcst</span></a><span class="keyword">}</span></span>
        <span class="keyword">(</span>lp2tcss<span class="keyword">,</span> <span class="keyword">lam</span> <span class="keyword">(</span>lp2tcs<span class="keyword">)</span> <span class="keyword">=&lt;</span><span class="staexp">cloptr</span><span class="keyword">&gt;</span> P2TCrec <span class="keyword">(</span>knd1<span class="keyword">,</span> lp2tcs<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [P2TCrec, P2TCrec]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      prerr_interror <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      prerr ": p2atcst_difference: failed"<span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [_, _]
</span><span class="comment">(* end of [p2atcst_difference] *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4459"><span class="dyncstimp">p2atcstlst_difference</span></a> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">}</span></span> <span class="keyword">(</span>p2tcs1<span class="keyword">,</span> p2tcs2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> p2tcs1 <span class="keyword">of</span>
  <span class="keyword">|</span> cons <span class="keyword">(</span>p2tc1<span class="keyword">,</span> p2tcs1<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val+</span> cons <span class="keyword">(</span>p2tc2<span class="keyword">,</span> p2tcs2<span class="keyword">)</span> <span class="keyword">=</span> p2tcs2
      <span class="keyword">val</span> p2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1783"><span class="stacstuse">p2atcst</span></a><span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span>
        aux <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4459"><span class="dyncstuse">p2atcstlst_difference</span></a> <span class="keyword">(</span>p2tcs1<span class="keyword">,</span> p2tcs2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">fun</span> aux <span class="keyword">(</span>p2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1783"><span class="stacstuse">p2atcst</span></a><span class="keyword">,</span> n<a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#5059"><span class="stacstuse">-</span></a>1<span class="keyword">)</span><span class="keyword">)</span></span><span class="keyword">)</span>
          <span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1783"><span class="stacstuse">p2atcst</span></a><span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">case+</span> p2tcss <span class="keyword">of</span>
          <span class="keyword">|</span> cons <span class="keyword">(</span>p2tcs<span class="keyword">,</span> p2tcss<span class="keyword">)</span> <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>p2tc1 :: p2tcs<span class="keyword">,</span> aux p2tcss<span class="keyword">)</span>
          <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">}</span> <span class="comment">// end of [where]
</span>      <span class="keyword">val</span> p2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1783"><span class="stacstuse">p2atcst</span></a><span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span>
        aux <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4398"><span class="dyncstuse">p2atcst_difference</span></a> <span class="keyword">(</span>p2tc1<span class="keyword">,</span> p2tc2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">fun</span> aux <span class="keyword">(</span>p2tcs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span><span class="keyword">)</span>
          <span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21858"><span class="stacstuse">list</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#1783"><span class="stacstuse">p2atcst</span></a><span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">case+</span> p2tcs <span class="keyword">of</span>
          <span class="keyword">|</span> cons <span class="keyword">(</span>p2tc<span class="keyword">,</span> p2tcs<span class="keyword">)</span> <span class="keyword">=&gt;</span> cons <span class="keyword">(</span>p2tc :: p2tcs1<span class="keyword">,</span> aux p2tcs<span class="keyword">)</span>
          <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> p2tcss
      <span class="keyword">}</span> <span class="comment">// end of [where]
</span>    <span class="keyword">in</span>
      p2tcss
    <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">(* end of [p2atcstlst_difference] *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4567"><span class="dyncstimp">labp2atcstlst_difference</span></a> <span class="keyword">(</span>lp2tcs1<span class="keyword">,</span> lp2tcs2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>lp2tcs1<span class="keyword">,</span> lp2tcs2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>LABP2ATCSTLSTcons <span class="keyword">(</span>l1<span class="keyword">,</span> p2tc1<span class="keyword">,</span> lp2tcs1<span class="keyword">)</span><span class="keyword">,</span>
     LABP2ATCSTLSTcons <span class="keyword">(</span>l2<span class="keyword">,</span> p2tc2<span class="keyword">,</span> lp2tcs2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> lp2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2177"><span class="stacstuse">labp2atcstlst</span></a><span class="keyword">)</span></span> <span class="keyword">=</span>
        aux <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4567"><span class="dyncstuse">labp2atcstlst_difference</span></a> <span class="keyword">(</span>lp2tcs1<span class="keyword">,</span> lp2tcs2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">fun</span> aux <span class="keyword">(</span>lp2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2177"><span class="stacstuse">labp2atcstlst</span></a><span class="keyword">)</span></span><span class="keyword">)</span>
          <span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2177"><span class="stacstuse">labp2atcstlst</span></a><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">case+</span> lp2tcss <span class="keyword">of</span>
          <span class="keyword">|</span> cons <span class="keyword">(</span>lp2tcs<span class="keyword">,</span> lp2tcss<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
              cons <span class="keyword">(</span>LABP2ATCSTLSTcons <span class="keyword">(</span>l1<span class="keyword">,</span> p2tc1<span class="keyword">,</span> lp2tcs<span class="keyword">)</span><span class="keyword">,</span> aux lp2tcss<span class="keyword">)</span>
            <span class="keyword">end</span> <span class="comment">// end of [cons]  
</span>          <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">}</span> <span class="comment">// end of [where]
</span>      <span class="keyword">val</span> lp2tcss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2177"><span class="stacstuse">labp2atcstlst</span></a><span class="keyword">)</span></span> <span class="keyword">=</span>
        aux <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#4398"><span class="dyncstuse">p2atcst_difference</span></a> <span class="keyword">(</span>p2tc1<span class="keyword">,</span> p2tc2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
        <span class="keyword">fun</span> aux <span class="keyword">(</span>p2tcs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2347"><span class="stacstuse">p2atcstlst</span></a></span><span class="keyword">)</span>
          <span class="keyword">:&lt;</span><span class="staexp">cloref1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fpatcst2_2esats.html#2177"><span class="stacstuse">labp2atcstlst</span></a><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">case+</span> p2tcs <span class="keyword">of</span>
          <span class="keyword">|</span> cons <span class="keyword">(</span>p2tc<span class="keyword">,</span> p2tcs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
              cons <span class="keyword">(</span>LABP2ATCSTLSTcons <span class="keyword">(</span>l1<span class="keyword">,</span> p2tc<span class="keyword">,</span> lp2tcs1<span class="keyword">)</span><span class="keyword">,</span> aux p2tcs<span class="keyword">)</span>
            <span class="keyword">end</span> <span class="comment">// end of [cons]  
</span>          <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> lp2tcss
      <span class="keyword">}</span> <span class="comment">// end of [where]
</span>    <span class="keyword">in</span>
      lp2tcss
    <span class="keyword">end</span> <span class="comment">// end of [cons]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">(* end of [labp2atcstlst_difference] *)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [ats_patcst2.dats] *)</span>
</pre>
</body>
</html>
