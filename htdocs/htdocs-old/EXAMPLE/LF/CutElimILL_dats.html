<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">(*
 * An implementation of Gentzen's cut elimination for intuitionistic linear
 * propositional logic with:
 *
 * 1. linear implication,
 * 2. linear multiplicative conjunction,
 * 3. linear additive conjunction, and
 * 4. linear additive disjunction
 *
 *)</span>

<span class="comment">// March 2005:
</span><span class="comment">// The code is completed by Sa Cui with some help from Hongwei Xi 
</span>
<span class="comment">// January 2007:
</span><span class="comment">// The code is ported to ATS/Geizella by Hongwei Xi
</span>
<span class="comment">// March 5th, 2008
</span><span class="comment">// It is verified by ATS/Anairiats (without any changes being made).
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="neuexp"><span class="keyword">nonfix</span></span> land
<span class="neuexp"><span class="keyword">nonfix</span></span> lor

<span class="keyword">datasort</span> <span class="staexp">form  <span class="keyword">=</span> <span class="comment">(* sort for formulas *)</span>
  <span class="keyword">|</span> ltimes <span class="keyword">of</span> <span class="keyword">(</span>form<span class="keyword">,</span> form<span class="keyword">)</span> <span class="comment">// linear multplicative and
</span>  <span class="keyword">|</span> land <span class="keyword">of</span> <span class="keyword">(</span>form<span class="keyword">,</span> form<span class="keyword">)</span>  <span class="comment">// linear additive and
</span>  <span class="keyword">|</span> lor <span class="keyword">of</span> <span class="keyword">(</span>form<span class="keyword">,</span> form<span class="keyword">)</span> <span class="comment">// linear additive or
</span>  <span class="keyword">|</span> limp <span class="keyword">of</span> <span class="keyword">(</span>form<span class="keyword">,</span> form<span class="keyword">)</span></span> <span class="comment">// linear implicative
</span>
<span class="keyword">datasort</span> <span class="staexp">seq <span class="keyword">=</span> <span class="comment">(* sort for sequents *)</span>
  <span class="keyword">|</span> none <span class="keyword">|</span> more <span class="keyword">of</span> <span class="keyword">(</span>seq<span class="keyword">,</span> form<span class="keyword">,</span> int<span class="keyword">)</span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="870"><span class="stacstdec">FM <span class="keyword">(</span>form<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span> 
    FMand1 <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#591"><span class="stacstuse">ltimes</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> n1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n2<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A2<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>
  
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span> 
    FMand2 <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#646"><span class="stacstuse">land</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> n1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n2<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A2<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span> 
    FMor <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#695"><span class="stacstuse">lor</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> n1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n2<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A2<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>   

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span> 
    FMimp <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#741"><span class="stacstuse">limp</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> n1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n2<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A2<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="1287"><span class="stacstdec">FM0 <span class="keyword">(</span>A <span class="keyword">:</span> form<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1332"><span class="stacstdec">SEQeq <span class="keyword">(</span>seq<span class="keyword">,</span> seq<span class="keyword">)</span></span></a></span> <span class="keyword">=</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> SEQeq <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> G<span class="keyword">)</span></span></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1382"><span class="stacstdec">SEQ <span class="keyword">(</span>seq<span class="keyword">,</span> int<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>

  <span class="keyword">|</span> SEQnone <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#828"><span class="stacstuse">none</span></a><span class="keyword">,</span> 0<span class="keyword">,</span> 0<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">,</span>w<span class="keyword">,</span>i<span class="keyword">:</span>nat</span> <span class="keyword">|</span> <span class="staexp">i <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> 2</span><span class="keyword">}</span>
      SEQmore <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> i<span class="keyword">)</span><span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">,</span> w<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>i<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1382"><span class="stacstuse">SEQ</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> n<span class="keyword">,</span> w<span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="1539"><span class="stacstdec">SEQ0 <span class="keyword">(</span>G<span class="keyword">:</span>seq<span class="keyword">,</span> w<span class="keyword">:</span>int<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1382"><span class="stacstuse">SEQ</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> n<span class="keyword">,</span> w<span class="keyword">)</span></span></a></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1593"><span class="stacstdec">IN <span class="keyword">(</span>form<span class="keyword">,</span> int<span class="keyword">,</span> seq<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i<span class="keyword">:</span>two</span><span class="keyword">}</span> INone <span class="staexp"><span class="keyword">(</span>A<span class="keyword">,</span> i<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> i<span class="keyword">)</span><span class="keyword">,</span> 0<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>A'<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">k<span class="keyword">,</span>i<span class="keyword">,</span>i'<span class="keyword">:</span>nat</span> <span class="keyword">|</span> <span class="staexp">i <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> 2</span><span class="keyword">;</span> <span class="staexp">i' <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> 2</span><span class="keyword">}</span>
      INshi <span class="staexp"><span class="keyword">(</span>A<span class="keyword">,</span> i<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A'<span class="keyword">,</span> i'<span class="keyword">)</span><span class="keyword">,</span> k<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1593"><span class="stacstuse">IN</span></a> <span class="keyword">(</span>A<span class="keyword">,</span> i<span class="keyword">,</span> G<span class="keyword">,</span> k<span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="1806"><span class="stacstdec">IN0 <span class="keyword">(</span>A<span class="keyword">:</span>form<span class="keyword">,</span>i<span class="keyword">:</span>int<span class="keyword">,</span>G<span class="keyword">:</span>seq<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>k<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1593"><span class="stacstuse">IN</span></a> <span class="keyword">(</span>A<span class="keyword">,</span> i<span class="keyword">,</span> G<span class="keyword">,</span> k<span class="keyword">)</span></span></a></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1867"><span class="stacstdec">COMB <span class="keyword">(</span>seq<span class="keyword">,</span> seq<span class="keyword">,</span> seq<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>

  <span class="keyword">|</span> COMBnone <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#828"><span class="stacstuse">none</span></a><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#828"><span class="stacstuse">none</span></a><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#828"><span class="stacstuse">none</span></a><span class="keyword">,</span> 0<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">,</span>i1<span class="keyword">,</span>i2<span class="keyword">:</span>nat</span> <span class="keyword">|</span> <span class="staexp">i1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>i2 <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> 2</span><span class="keyword">}</span>
      COMBmore <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A<span class="keyword">,</span> i1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> A<span class="keyword">,</span> i2<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G3<span class="keyword">,</span> A<span class="keyword">,</span> i1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>i2<span class="keyword">)</span><span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">,</span> n<span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="2105"><span class="stacstdec">COMB0 <span class="keyword">(</span>G1<span class="keyword">:</span>seq<span class="keyword">,</span> G2<span class="keyword">:</span>seq<span class="keyword">,</span> G3<span class="keyword">:</span>seq<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="2177"><span class="stacstdec">ADD <span class="keyword">(</span>seq<span class="keyword">,</span> form<span class="keyword">,</span> seq<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> ADDone <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> 0<span class="keyword">)</span><span class="keyword">,</span> A<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> 0<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">,</span>G'<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">,</span>A'<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">k<span class="keyword">,</span>i<span class="keyword">:</span>nat</span> <span class="keyword">|</span> <span class="staexp">i <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> 2</span><span class="keyword">}</span>
    ADDshi <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A'<span class="keyword">,</span> i<span class="keyword">)</span><span class="keyword">,</span> A<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G'<span class="keyword">,</span> A'<span class="keyword">,</span> i<span class="keyword">)</span><span class="keyword">,</span> k<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2177"><span class="stacstuse">ADD</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> G'<span class="keyword">,</span> k<span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="2404"><span class="stacstdec">ADD0 <span class="keyword">(</span>G<span class="keyword">:</span>seq<span class="keyword">,</span> A<span class="keyword">:</span>form<span class="keyword">,</span> G'<span class="keyword">:</span>seq<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>k<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2177"><span class="stacstuse">ADD</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> G'<span class="keyword">,</span> k<span class="keyword">)</span></span></a></span>

<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="2471"><span class="stacstdec">DER <span class="keyword">(</span>seq<span class="keyword">,</span> form<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> DERaxi <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> 0<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1539"><span class="stacstuse">SEQ0</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1806"><span class="stacstuse">IN0</span></a> <span class="keyword">(</span>A<span class="keyword">,</span> 1<span class="keyword">,</span> G<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> DERleft <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2707"><span class="stacstuse">DERL</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> DERright <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#3592"><span class="stacstuse">DERR</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span>

<span class="keyword">and</span> <span class="staexp"><a name="2707"><span class="stacstdec">DERL <span class="keyword">(</span>seq<span class="keyword">,</span> form<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G1<span class="keyword">,</span>G2<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">,</span>A3<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERLtimes <span class="staexp"><span class="keyword">(</span>G2<span class="keyword">,</span> A3<span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A1<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> A2<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> A3<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">,</span> 
              <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#591"><span class="stacstuse">ltimes</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> G2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G1<span class="keyword">,</span>G2<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">,</span>A3<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERLand1 <span class="staexp"><span class="keyword">(</span>G2<span class="keyword">,</span> A3<span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A1<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> A3<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#646"><span class="stacstuse">land</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> G2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G1<span class="keyword">,</span>G2<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">,</span>A3<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERLand2 <span class="staexp"><span class="keyword">(</span>G2<span class="keyword">,</span> A3<span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A2<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> A3<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#646"><span class="stacstuse">land</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> G2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G1<span class="keyword">,</span>G2<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">,</span>A3<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERLor <span class="staexp"><span class="keyword">(</span>G2<span class="keyword">,</span> A3<span class="keyword">,</span> n1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n2<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A1<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> A3<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A2<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> A3<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">,</span> 
         <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#695"><span class="stacstuse">lor</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> G2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">,</span>G4<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">,</span>A3<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERLimp <span class="staexp"><span class="keyword">(</span>G4<span class="keyword">,</span> A3<span class="keyword">,</span> n1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n2<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A1<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> A2<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> A3<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">,</span>
         <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G3<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#741"><span class="stacstuse">limp</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> G4<span class="keyword">)</span><span class="keyword">)</span></span>

<span class="keyword">and</span> <span class="staexp"><a name="3592"><span class="stacstdec">DERR <span class="keyword">(</span>seq<span class="keyword">,</span> form<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERRand1 <span class="staexp"><span class="keyword">(</span>G3<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#591"><span class="stacstuse">ltimes</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> n1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n2<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A1<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> A2<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span><span class="keyword">)</span></span>
  
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERRand2 <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#646"><span class="stacstuse">land</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> n1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n2<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A1<span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A2<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERRor1 <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#695"><span class="stacstuse">lor</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A1<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERRor2 <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#695"><span class="stacstuse">lor</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A2<span class="keyword">,</span> n<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERRimp <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#741"><span class="stacstuse">limp</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A1<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> A2<span class="keyword">,</span> n<span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="4195"><span class="stacstdec">DER0 <span class="keyword">(</span>G<span class="keyword">:</span>seq<span class="keyword">,</span> A<span class="keyword">:</span>form<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a><span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="comment">//
</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="4253"><span class="stacstdec">EXCH <span class="keyword">(</span>seq<span class="keyword">,</span> seq<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A1<span class="keyword">,</span>A2<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">i1<span class="keyword">,</span>i2<span class="keyword">:</span>two</span><span class="keyword">}</span> 
    EXCHone <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A1<span class="keyword">,</span> i1<span class="keyword">)</span><span class="keyword">,</span> A2<span class="keyword">,</span> i2<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A2<span class="keyword">,</span> i2<span class="keyword">)</span><span class="keyword">,</span> A1<span class="keyword">,</span> i1<span class="keyword">)</span><span class="keyword">,</span> 0<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G1<span class="keyword">,</span>G2<span class="keyword">:</span>seq</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">A<span class="keyword">:</span>form</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">,</span>i<span class="keyword">:</span>nat</span> <span class="keyword">|</span> <span class="staexp">i <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> 2</span><span class="keyword">}</span>
    EXCHshi <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A<span class="keyword">,</span> i<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> A<span class="keyword">,</span> i<span class="keyword">)</span><span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4253"><span class="stacstuse">EXCH</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> n<span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="4522"><span class="stacstdec">EXCH0 <span class="keyword">(</span>G1<span class="keyword">:</span>seq<span class="keyword">,</span> G2<span class="keyword">:</span>seq<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4253"><span class="stacstuse">EXCH</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma01 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">,</span>w<span class="keyword">,</span>k<span class="keyword">,</span>i<span class="keyword">:</span>nat <span class="keyword">|</span> i <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> 2<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>k<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>g<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1382"><span class="stacstuse">SEQ</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> n<span class="keyword">,</span> w<span class="keyword">)</span></span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1593"><span class="stacstuse">IN</span></a> <span class="keyword">(</span>A<span class="keyword">,</span> i<span class="keyword">,</span> G<span class="keyword">,</span> k<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>n <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7223"><span class="stacstuse">&gt;=</span></a> k<span class="keyword">;</span> w <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7223"><span class="stacstuse">&gt;=</span></a> i<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> i <span class="keyword">of</span>
    <span class="keyword">|</span> INone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">SEQmore g' <span class="keyword">=</span> g</span> <span class="keyword">in</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">end</span>
    <span class="keyword">|</span> INshi i' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
         <span class="keyword">prval</span> <span class="prfexp">SEQmore g' <span class="keyword">=</span> g</span>
         <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma01 <span class="keyword">(</span>g'<span class="keyword">,</span> i'<span class="keyword">)</span></span>
      <span class="keyword">in</span>
         <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma02 <span class="staexp"><span class="keyword">{</span>G<span class="keyword">,</span>G'<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">,</span>w<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>g<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1382"><span class="stacstuse">SEQ</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> n<span class="keyword">,</span> w<span class="keyword">)</span></span><span class="keyword">,</span> ex<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4522"><span class="stacstuse">EXCH0</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> G'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>n <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7223"><span class="stacstuse">&gt;=</span></a> 2<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> ex <span class="keyword">of</span>
    <span class="keyword">|</span> EXCHone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">SEQmore <span class="keyword">(</span>SEQmore g'<span class="keyword">)</span> <span class="keyword">=</span> g</span> <span class="keyword">in</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">end</span>
    <span class="keyword">|</span> EXCHshi ex' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
         <span class="keyword">prval</span> <span class="prfexp">SEQmore g' <span class="keyword">=</span> g</span>
         <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma02 <span class="keyword">(</span>g'<span class="keyword">,</span> ex'<span class="keyword">)</span></span>
      <span class="keyword">in</span>
         <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma03 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">,</span>G3'<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> ex<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4522"><span class="stacstuse">EXCH0</span></a> <span class="keyword">(</span>G3<span class="keyword">,</span> G3'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>n <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7223"><span class="stacstuse">&gt;=</span></a> 2<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#15389"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> 
  <span class="keyword">case+</span> ex <span class="keyword">of</span>
    <span class="keyword">|</span> EXCHone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">COMBmore <span class="keyword">(</span>COMBmore c'<span class="keyword">)</span> <span class="keyword">=</span> c</span> <span class="keyword">in</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">end</span>
    <span class="keyword">|</span> EXCHshi ex' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
         <span class="keyword">prval</span> <span class="prfexp">COMBmore c' <span class="keyword">=</span> c</span>
         <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma03 <span class="keyword">(</span>c'<span class="keyword">,</span> ex'<span class="keyword">)</span></span>
      <span class="keyword">in</span>
         <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span></span>

<span class="comment">// [COMB] is functional
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma10 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G12<span class="keyword">,</span>G21<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n1<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>c12<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G12<span class="keyword">,</span> n1<span class="keyword">)</span></span><span class="keyword">,</span> c21<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> G1<span class="keyword">,</span> G21<span class="keyword">,</span> n2<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>n1 <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7435"><span class="stacstuse">==</span></a> n2<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1332"><span class="stacstuse">SEQeq</span></a> <span class="keyword">(</span>G12<span class="keyword">,</span> G21<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>c12<span class="keyword">,</span> c21<span class="keyword">)</span> <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">(</span>COMBnone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> COMBnone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> SEQeq
    <span class="keyword">|</span> <span class="keyword">(</span>COMBmore c12<span class="keyword">,</span> COMBmore c21<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">SEQeq <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma10 <span class="keyword">(</span>c12<span class="keyword">,</span> c21<span class="keyword">)</span></span> <span class="keyword">in</span> SEQeq <span class="keyword">end</span></span>

<span class="comment">// [COMB] is commutative
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma11 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> G1<span class="keyword">,</span> G3<span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> c <span class="keyword">of</span>
    <span class="keyword">|</span> COMBnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> COMBnone
    <span class="keyword">|</span> COMBmore c' <span class="keyword">=&gt;</span> COMBmore <span class="keyword">(</span>lemma11 c'<span class="keyword">)</span></span>

<span class="comment">// [COMB] is associative
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma12 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G12<span class="keyword">,</span>G3<span class="keyword">,</span>G123<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>c12<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G12<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> c123<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G12<span class="keyword">,</span> G3<span class="keyword">,</span> G123<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>G23<span class="keyword">:</span>seq<span class="keyword">]</span> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> G3<span class="keyword">,</span> G23<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G23<span class="keyword">,</span> G123<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> 
  <span class="keyword">case+</span> <span class="keyword">(</span>c12<span class="keyword">,</span> c123<span class="keyword">)</span> <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">(</span>COMBnone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> COMBnone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>COMBnone<span class="keyword">,</span> COMBnone<span class="keyword">)</span>

    <span class="keyword">|</span> <span class="keyword">(</span>COMBmore <span class="keyword">(</span>c1<span class="keyword">)</span><span class="keyword">,</span> COMBmore <span class="keyword">(</span>c2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> 
      <span class="keyword">let</span>
         <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>pf1<span class="keyword">,</span> pf2<span class="keyword">)</span> <span class="keyword">=</span> lemma12 <span class="keyword">(</span>c1<span class="keyword">,</span> c2<span class="keyword">)</span></span>
      <span class="keyword">in</span>
	 <span class="keyword">(</span>COMBmore <span class="keyword">(</span>pf1<span class="keyword">)</span><span class="keyword">,</span> COMBmore <span class="keyword">(</span>pf2<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span></span>

<span class="keyword">prfn</span> <span class="prfexp">lemma13 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">,</span>G21<span class="keyword">,</span>G22<span class="keyword">:</span>seq<span class="keyword">}</span></span>
  <span class="keyword">(</span>c1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span></span><span class="keyword">,</span> c2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G21<span class="keyword">,</span> G22<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>G<span class="keyword">:</span>seq<span class="keyword">]</span> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G22<span class="keyword">,</span> G<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G21<span class="keyword">,</span> G<span class="keyword">,</span> G3<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span> 
     <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> c4<span class="keyword">)</span> <span class="keyword">=</span> lemma12 <span class="keyword">(</span>c2<span class="keyword">,</span> lemma11 c1<span class="keyword">)</span></span> 
  <span class="keyword">in</span>
     <span class="keyword">(</span>lemma11 c3<span class="keyword">,</span> c4<span class="keyword">)</span>
  <span class="keyword">end</span></span>

<span class="keyword">prfn</span> <span class="prfexp">lemma14 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">,</span>G21<span class="keyword">,</span>G22<span class="keyword">:</span>seq<span class="keyword">}</span></span>
  <span class="keyword">(</span>c1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span></span><span class="keyword">,</span> c2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G21<span class="keyword">,</span> G22<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>G<span class="keyword">:</span>seq<span class="keyword">]</span> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G21<span class="keyword">,</span> G<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> G22<span class="keyword">,</span> G3<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span> 
     <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> c4<span class="keyword">)</span> <span class="keyword">=</span> lemma13 <span class="keyword">(</span>c1<span class="keyword">,</span> lemma11 c2<span class="keyword">)</span></span> 
  <span class="keyword">in</span>
     <span class="keyword">(</span>c3<span class="keyword">,</span> lemma11 c4<span class="keyword">)</span>
  <span class="keyword">end</span></span>

<span class="keyword">prfn</span> <span class="prfexp">lemma15 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">,</span>G21<span class="keyword">,</span>G22<span class="keyword">:</span>seq<span class="keyword">}</span></span>
  <span class="keyword">(</span>c1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span></span><span class="keyword">,</span> c2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G21<span class="keyword">,</span> G22<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>G<span class="keyword">:</span>seq<span class="keyword">]</span> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G21<span class="keyword">,</span> G1<span class="keyword">,</span> G<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> G22<span class="keyword">,</span> G3<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span> 
     <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> c4<span class="keyword">)</span> <span class="keyword">=</span> lemma14 <span class="keyword">(</span>c1<span class="keyword">,</span> c2<span class="keyword">)</span></span> 
  <span class="keyword">in</span>
     <span class="keyword">(</span>lemma11 c3<span class="keyword">,</span> c4<span class="keyword">)</span>
  <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma20 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>m<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span></span><span class="keyword">,</span> g<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1382"><span class="stacstuse">SEQ</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> m<span class="keyword">,</span> 0<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1332"><span class="stacstuse">SEQeq</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G3<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>c<span class="keyword">,</span> g<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>COMBnone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> SEQnone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> SEQeq
  <span class="keyword">|</span> <span class="keyword">(</span>COMBmore c'<span class="keyword">,</span> SEQmore g'<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">SEQeq <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma20 <span class="keyword">(</span>c'<span class="keyword">,</span> g'<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      SEQeq <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span></span>

<span class="keyword">prfun</span> <span class="prfexp">lemma21 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>m<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span></span><span class="keyword">,</span> g<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1382"><span class="stacstuse">SEQ</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> m<span class="keyword">,</span> 0<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1332"><span class="stacstuse">SEQeq</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> G3<span class="keyword">)</span></span> <span class="keyword">=</span>
  lemma20 <span class="keyword">(</span>lemma11 c<span class="keyword">,</span> g<span class="keyword">)</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma30 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">,</span>w<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>g<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1382"><span class="stacstuse">SEQ</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> n<span class="keyword">,</span> w<span class="keyword">)</span></span><span class="keyword">,</span> ex<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4522"><span class="stacstuse">EXCH0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1382"><span class="stacstuse">SEQ</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> n<span class="keyword">,</span> w<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> g <span class="keyword">of</span>
  <span class="keyword">|</span> SEQnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=/=&gt;</span> <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma02 <span class="keyword">(</span>g<span class="keyword">,</span> ex<span class="keyword">)</span></span> <span class="keyword">in</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">end</span> 
  <span class="keyword">|</span> SEQmore <span class="keyword">(</span>SEQnone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=/=&gt;</span> <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma02 <span class="keyword">(</span>g<span class="keyword">,</span> ex<span class="keyword">)</span></span> <span class="keyword">in</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">end</span>
  <span class="keyword">|</span> SEQmore <span class="keyword">(</span>SEQmore g'<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> ex <span class="keyword">of</span>
    <span class="keyword">|</span> EXCHone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>  SEQmore <span class="keyword">(</span>SEQmore g'<span class="keyword">)</span>
    <span class="keyword">|</span> EXCHshi ex' <span class="keyword">=&gt;</span> SEQmore <span class="keyword">(</span>lemma30 <span class="keyword">(</span>SEQmore g'<span class="keyword">,</span> ex'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma31 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>k<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>k<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1593"><span class="stacstuse">IN</span></a> <span class="keyword">(</span>A<span class="keyword">,</span> 1<span class="keyword">,</span> G1<span class="keyword">,</span> k<span class="keyword">)</span></span><span class="keyword">,</span> ex<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4522"><span class="stacstuse">EXCH0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1806"><span class="stacstuse">IN0</span></a> <span class="keyword">(</span>A<span class="keyword">,</span> 1<span class="keyword">,</span> G2<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> i <span class="keyword">of</span>
  <span class="keyword">|</span> INone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> ex <span class="keyword">of</span>
    <span class="keyword">|</span> EXCHone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> INshi INone <span class="keyword">|</span> EXCHshi ex' <span class="keyword">=&gt;</span> INone
    <span class="keyword">end</span>
  <span class="keyword">|</span> INshi i' <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> ex <span class="keyword">of</span>
    <span class="keyword">|</span> EXCHone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> i' <span class="keyword">of</span>
      <span class="keyword">|</span> INone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> INone <span class="keyword">|</span> INshi i1 <span class="keyword">=&gt;</span> INshi <span class="keyword">(</span>INshi i1<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> EXCHshi ex' <span class="keyword">=&gt;</span> INshi <span class="keyword">(</span>lemma31 <span class="keyword">(</span>i'<span class="keyword">,</span> ex'<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma32 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G1'<span class="keyword">,</span>G2'<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>add<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G1'<span class="keyword">,</span> A<span class="keyword">,</span> G1<span class="keyword">)</span></span><span class="keyword">,</span> ex<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4253"><span class="stacstuse">EXCH</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>G2'<span class="keyword">:</span>seq<span class="keyword">]</span> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4253"><span class="stacstuse">EXCH</span></a> <span class="keyword">(</span>G1'<span class="keyword">,</span> G2'<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G2'<span class="keyword">,</span> A<span class="keyword">,</span> G2<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>ex<span class="keyword">,</span> add<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>EXCHone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> ADDone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>EXCHone<span class="keyword">,</span> ADDshi ADDone<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>EXCHone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> ADDshi <span class="keyword">(</span>ADDone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>EXCHone<span class="keyword">,</span> ADDone<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>EXCHone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> ADDshi <span class="keyword">(</span>ADDshi add'<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> 
      <span class="keyword">(</span>EXCHone<span class="keyword">,</span> ADDshi <span class="keyword">(</span>ADDshi add'<span class="keyword">)</span><span class="keyword">)</span>	
  <span class="keyword">|</span> <span class="keyword">(</span>EXCHshi ex'<span class="keyword">,</span> ADDone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>EXCHshi ex'<span class="keyword">,</span> ADDone<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>EXCHshi ex'<span class="keyword">,</span> ADDshi add'<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>ex1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma32 <span class="keyword">(</span>add'<span class="keyword">,</span> ex'<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>EXCHshi ex1<span class="keyword">,</span> ADDshi add1<span class="keyword">)</span>
    <span class="keyword">end</span></span> 

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma33 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">,</span>G3'<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> ex<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4522"><span class="stacstuse">EXCH0</span></a> <span class="keyword">(</span>G3<span class="keyword">,</span> G3'<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>G1'<span class="keyword">,</span>G2'<span class="keyword">:</span>seq<span class="keyword">]</span> 
      <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4522"><span class="stacstuse">EXCH0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G1'<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4522"><span class="stacstuse">EXCH0</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> G2'<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1'<span class="keyword">,</span> G2'<span class="keyword">,</span> G3'<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> c <span class="keyword">of</span>
  <span class="keyword">|</span> COMBnone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=/=&gt;</span> <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma03 <span class="keyword">(</span>c<span class="keyword">,</span> ex<span class="keyword">)</span></span> <span class="keyword">in</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">end</span>
  <span class="keyword">|</span> COMBmore <span class="keyword">(</span>COMBnone <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=/=&gt;</span> <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma03 <span class="keyword">(</span>c<span class="keyword">,</span> ex<span class="keyword">)</span></span> <span class="keyword">in</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">end</span>
  <span class="keyword">|</span> COMBmore <span class="keyword">(</span>COMBmore c'<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> ex <span class="keyword">of</span>
    <span class="keyword">|</span> EXCHone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>EXCHone<span class="keyword">,</span> EXCHone<span class="keyword">,</span> COMBmore <span class="keyword">(</span>COMBmore c'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">|</span> EXCHshi ex' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>ex1<span class="keyword">,</span> ex2<span class="keyword">,</span> c1<span class="keyword">)</span> <span class="keyword">=</span> lemma33 <span class="keyword">(</span>COMBmore c'<span class="keyword">,</span> ex'<span class="keyword">)</span></span>
      <span class="keyword">in</span>
        <span class="keyword">(</span>EXCHshi ex1<span class="keyword">,</span> EXCHshi ex2<span class="keyword">,</span> COMBmore c1<span class="keyword">)</span>
       <span class="keyword">end</span>
    <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">exchGeneral <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
     <span class="keyword">(</span>d<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> ex<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4522"><span class="stacstuse">EXCH0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> d <span class="keyword">of</span>
  <span class="keyword">|</span> DERaxi <span class="keyword">(</span>g<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=&gt;</span> DERaxi <span class="keyword">(</span>lemma30 <span class="keyword">(</span>g<span class="keyword">,</span> ex<span class="keyword">)</span><span class="keyword">,</span> lemma31 <span class="keyword">(</span>i<span class="keyword">,</span> ex<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLtimes <span class="keyword">(</span>d1<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>ex1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma32 <span class="keyword">(</span>add<span class="keyword">,</span> ex<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> EXCHshi <span class="keyword">(</span>EXCHshi ex1<span class="keyword">)</span><span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLtimes <span class="keyword">(</span>d1'<span class="keyword">,</span> add1<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
     
  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLand1 <span class="keyword">(</span>d1<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>ex1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma32 <span class="keyword">(</span>add<span class="keyword">,</span> ex<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> EXCHshi ex1<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLand1 <span class="keyword">(</span>d1'<span class="keyword">,</span> add1<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
    
  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLand2 <span class="keyword">(</span>d1<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>ex1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma32 <span class="keyword">(</span>add<span class="keyword">,</span> ex<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> EXCHshi ex1<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLand2 <span class="keyword">(</span>d1'<span class="keyword">,</span> add1<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLor <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>ex1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma32 <span class="keyword">(</span>add<span class="keyword">,</span> ex<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> EXCHshi ex1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d2<span class="keyword">,</span> EXCHshi ex1<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLor <span class="keyword">(</span>d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> add1<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>ex1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma32 <span class="keyword">(</span>add<span class="keyword">,</span> ex<span class="keyword">)</span></span> 
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>ex11<span class="keyword">,</span> ex21<span class="keyword">,</span> c1<span class="keyword">)</span> <span class="keyword">=</span> lemma33 <span class="keyword">(</span>c<span class="keyword">,</span> ex1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> ex11<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d2<span class="keyword">,</span> EXCHshi ex21<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> c1<span class="keyword">,</span> add1<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand1 <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>ex1<span class="keyword">,</span> ex2<span class="keyword">,</span> c1<span class="keyword">)</span> <span class="keyword">=</span> lemma33 <span class="keyword">(</span>c<span class="keyword">,</span> ex<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> ex1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d2<span class="keyword">,</span> ex2<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERright <span class="keyword">(</span>DERRand1 <span class="keyword">(</span>d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> c1<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand2 <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> ex<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d2<span class="keyword">,</span> ex<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERright <span class="keyword">(</span>DERRand2 <span class="keyword">(</span>d1'<span class="keyword">,</span> d2'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRor1 d1<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> ex<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERright <span class="keyword">(</span>DERRor1 d1'<span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRor2 d1<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> ex<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERright <span class="keyword">(</span>DERRor2 d1'<span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRimp d1<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> EXCHshi ex<span class="keyword">)</span></span>
    <span class="keyword">in</span> 
      DERright <span class="keyword">(</span>DERRimp d1'<span class="keyword">)</span>
    <span class="keyword">end</span></span>

<span class="comment">//
</span>
<span class="keyword">prfn</span> <span class="prfexp">exch <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A1<span class="keyword">,</span>A2<span class="keyword">,</span>A3<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">,</span>i1<span class="keyword">,</span>i2<span class="keyword">:</span>nat <span class="keyword">|</span> i1 <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> 2<span class="keyword">;</span> i2 <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> 2<span class="keyword">}</span></span>
  <span class="keyword">(</span>d<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A1<span class="keyword">,</span> i1<span class="keyword">)</span><span class="keyword">,</span> A2<span class="keyword">,</span> i2<span class="keyword">)</span><span class="keyword">,</span> A3<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A2<span class="keyword">,</span> i2<span class="keyword">)</span><span class="keyword">,</span> A1<span class="keyword">,</span> i1<span class="keyword">)</span><span class="keyword">,</span> A3<span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span>
  exchGeneral <span class="keyword">(</span>d<span class="keyword">,</span> EXCHone<span class="keyword">)</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">thin <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">,</span>A'<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>d<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A'<span class="keyword">,</span> 0<span class="keyword">)</span><span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span> 
  <span class="keyword">case+</span> d <span class="keyword">of</span>
  <span class="keyword">|</span> DERaxi <span class="keyword">(</span>g<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=&gt;</span> DERaxi <span class="keyword">(</span>SEQmore g<span class="keyword">,</span> INshi i<span class="keyword">)</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLtimes <span class="keyword">(</span>d1<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>exch <span class="keyword">(</span>thin d1<span class="keyword">)</span><span class="keyword">,</span> EXCHshi EXCHone<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">add' <span class="keyword">=</span> ADDshi add</span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLtimes <span class="keyword">(</span>d1'<span class="keyword">,</span> add'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLand1 <span class="keyword">(</span>d1<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exch <span class="keyword">(</span>thin d1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">add' <span class="keyword">=</span> ADDshi add</span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLand1 <span class="keyword">(</span>d1'<span class="keyword">,</span> add'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
  
  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLand2 <span class="keyword">(</span>d1<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exch <span class="keyword">(</span>thin d1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">add' <span class="keyword">=</span> ADDshi add</span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLand2 <span class="keyword">(</span>d1'<span class="keyword">,</span> add'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLor <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> exch <span class="keyword">(</span>thin d1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> exch <span class="keyword">(</span>thin d2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">add' <span class="keyword">=</span> ADDshi add</span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLor <span class="keyword">(</span>d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> add'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thin d1</span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> exch <span class="keyword">(</span>thin d2<span class="keyword">)</span></span> 
      <span class="keyword">prval</span> <span class="prfexp">c' <span class="keyword">=</span> COMBmore c</span>
      <span class="keyword">prval</span> <span class="prfexp">add' <span class="keyword">=</span> ADDshi add</span> 
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> c'<span class="keyword">,</span> add'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand1 <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> 
      DERright <span class="keyword">(</span>DERRand1 <span class="keyword">(</span>thin d1<span class="keyword">,</span> thin d2<span class="keyword">,</span> COMBmore c<span class="keyword">)</span><span class="keyword">)</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand2 <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> DERright <span class="keyword">(</span>DERRand2 <span class="keyword">(</span>thin d1<span class="keyword">,</span> thin d2<span class="keyword">)</span><span class="keyword">)</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRor1 d1<span class="keyword">)</span> <span class="keyword">=&gt;</span> DERright <span class="keyword">(</span>DERRor1 <span class="keyword">(</span>thin d1<span class="keyword">)</span><span class="keyword">)</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRor2 d1<span class="keyword">)</span> <span class="keyword">=&gt;</span> DERright <span class="keyword">(</span>DERRor2 <span class="keyword">(</span>thin d1<span class="keyword">)</span><span class="keyword">)</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRimp d1<span class="keyword">)</span> <span class="keyword">=&gt;</span> DERright <span class="keyword">(</span>DERRimp <span class="keyword">(</span>exch <span class="keyword">(</span>thin d1<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>

<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">thick <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">,</span>A1<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span> 
  <span class="keyword">(</span>d<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A1<span class="keyword">,</span> 0<span class="keyword">)</span><span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> A<span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> d <span class="keyword">of</span>
  <span class="keyword">|</span> DERaxi <span class="keyword">(</span>g<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">SEQmore g' <span class="keyword">=</span> g <span class="keyword">and</span> INshi i' <span class="keyword">=</span> i</span>
    <span class="keyword">in</span>
      DERaxi <span class="keyword">(</span>g'<span class="keyword">,</span> i'<span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLtimes <span class="keyword">(</span>d1<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">ADDshi add' <span class="keyword">=</span> add</span>	
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thick <span class="keyword">(</span>exch <span class="keyword">(</span>exchGeneral <span class="keyword">(</span>d1<span class="keyword">,</span> EXCHshi EXCHone<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLtimes <span class="keyword">(</span>d1'<span class="keyword">,</span> add'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
 
  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLand1 <span class="keyword">(</span>d1<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">ADDshi add' <span class="keyword">=</span> add</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d1<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLand1 <span class="keyword">(</span>d1'<span class="keyword">,</span> add'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>  

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLand2 <span class="keyword">(</span>d1<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">ADDshi add' <span class="keyword">=</span> add</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d1<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLand2 <span class="keyword">(</span>d1'<span class="keyword">,</span> add'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLor <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">ADDshi add' <span class="keyword">=</span> add</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d2<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLor <span class="keyword">(</span>d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> add'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">,</span> add<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">ADDshi add' <span class="keyword">=</span> add</span>
      <span class="keyword">prval</span> <span class="prfexp">COMBmore c' <span class="keyword">=</span> c</span> 
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thick d1</span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d2<span class="keyword">)</span></span>
    <span class="keyword">in</span> 
      DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> c'<span class="keyword">,</span> add'<span class="keyword">)</span><span class="keyword">)</span> 
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand1 <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">COMBmore c' <span class="keyword">=</span> c</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thick d1</span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> thick d2</span> 
    <span class="keyword">in</span>
      DERright <span class="keyword">(</span>DERRand1 <span class="keyword">(</span>d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> c'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
    
 <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand2 <span class="keyword">(</span>d1<span class="keyword">,</span> d2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> DERright <span class="keyword">(</span>DERRand2 <span class="keyword">(</span>thick d1<span class="keyword">,</span> thick d2<span class="keyword">)</span><span class="keyword">)</span>
 <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRor1 d1<span class="keyword">)</span> <span class="keyword">=&gt;</span> DERright <span class="keyword">(</span>DERRor1 <span class="keyword">(</span>thick d1<span class="keyword">)</span><span class="keyword">)</span>
 <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRor2 d1<span class="keyword">)</span> <span class="keyword">=&gt;</span> DERright <span class="keyword">(</span>DERRor2 <span class="keyword">(</span>thick d1<span class="keyword">)</span><span class="keyword">)</span>
 <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRimp d'<span class="keyword">)</span> <span class="keyword">=&gt;</span> DERright <span class="keyword">(</span>DERRimp <span class="keyword">(</span>thick <span class="keyword">(</span>exch d'<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">end</span></span> <span class="comment">// end of [thick]
</span>
<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma40 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">,</span>G21<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> add<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G21<span class="keyword">,</span> A<span class="keyword">,</span> G2<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>G4<span class="keyword">:</span>seq<span class="keyword">]</span> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G21<span class="keyword">,</span> G4<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G4<span class="keyword">,</span> A<span class="keyword">,</span> G3<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> add <span class="keyword">of</span>
  <span class="keyword">|</span> ADDone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span> 
      <span class="keyword">prval</span> <span class="prfexp">COMBmore c' <span class="keyword">=</span> c</span> 
    <span class="keyword">in</span> 
      <span class="keyword">(</span>COMBmore c'<span class="keyword">,</span> ADDone<span class="keyword">)</span>
    <span class="keyword">end</span>
     
  <span class="keyword">|</span> ADDshi add' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">COMBmore c' <span class="keyword">=</span> c</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma40 <span class="keyword">(</span>c'<span class="keyword">,</span> add'<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>COMBmore c1<span class="keyword">,</span> ADDshi add1<span class="keyword">)</span>
    <span class="keyword">end</span> 
<span class="keyword">end</span></span> <span class="comment">// end of [lemma40]
</span>
<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma41
  <span class="staexp"><span class="keyword">{</span>G11<span class="keyword">,</span>G22<span class="keyword">,</span>G33<span class="keyword">,</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A1<span class="keyword">,</span>A2<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>c1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G11<span class="keyword">,</span> G22<span class="keyword">,</span> G33<span class="keyword">)</span></span><span class="keyword">,</span> add<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2177"><span class="stacstuse">ADD</span></a> <span class="keyword">(</span>G33<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#741"><span class="stacstuse">limp</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> G1<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> c2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>Gtmp1<span class="keyword">,</span>Gtmp2<span class="keyword">:</span>seq<span class="keyword">]</span> 
      <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G22<span class="keyword">,</span> G2<span class="keyword">,</span> Gtmp1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G11<span class="keyword">,</span> Gtmp1<span class="keyword">,</span> Gtmp2<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>Gtmp2<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#741"><span class="stacstuse">limp</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> A2<span class="keyword">)</span><span class="keyword">,</span> G3<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span>   
  <span class="keyword">case+</span> add <span class="keyword">of</span>
  <span class="keyword">|</span> ADDone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">COMBmore c1' <span class="keyword">=</span> c1</span>
      <span class="keyword">prval</span> <span class="prfexp">COMBmore c2' <span class="keyword">=</span> c2</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> c4<span class="keyword">)</span> <span class="keyword">=</span> lemma12 <span class="keyword">(</span>c1'<span class="keyword">,</span> c2'<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>COMBmore c3<span class="keyword">,</span> COMBmore c4<span class="keyword">,</span> ADDone<span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> ADDshi add' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">COMBmore c1' <span class="keyword">=</span> c1</span>
      <span class="keyword">prval</span> <span class="prfexp">COMBmore c2' <span class="keyword">=</span> c2</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> c4<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma41 <span class="keyword">(</span>c1'<span class="keyword">,</span> add'<span class="keyword">,</span> c2'<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      <span class="keyword">(</span>COMBmore c3<span class="keyword">,</span> COMBmore c4<span class="keyword">,</span> ADDshi add1<span class="keyword">)</span>
    <span class="keyword">end</span></span>

<span class="keyword">prfun</span> <span class="prfexp">lemma42 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>k<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>k<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1593"><span class="stacstuse">IN</span></a> <span class="keyword">(</span>A<span class="keyword">,</span> 1<span class="keyword">,</span> G1<span class="keyword">,</span> k<span class="keyword">)</span></span><span class="keyword">,</span> g<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1539"><span class="stacstuse">SEQ0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> 1<span class="keyword">)</span></span><span class="keyword">,</span> c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2177"><span class="stacstuse">ADD</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> A<span class="keyword">,</span> G3<span class="keyword">,</span> k<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> i <span class="keyword">of</span>
  <span class="keyword">|</span> INone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">SEQmore g' <span class="keyword">=</span> g</span>
      <span class="keyword">prval</span> <span class="prfexp">COMBmore c' <span class="keyword">=</span> c</span>
      <span class="keyword">prval</span> <span class="prfexp">SEQeq <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma21 <span class="keyword">(</span>c'<span class="keyword">,</span> g'<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      ADDone
    <span class="keyword">end</span>
   
  <span class="keyword">|</span> INshi i' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">SEQmore g' <span class="keyword">=</span> g</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma01 <span class="keyword">(</span>g'<span class="keyword">,</span> i'<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">COMBmore c' <span class="keyword">=</span> c</span>
      <span class="keyword">prval</span> <span class="prfexp">i1 <span class="keyword">=</span> lemma42 <span class="keyword">(</span>i'<span class="keyword">,</span> g'<span class="keyword">,</span> c'<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      ADDshi i1
    <span class="keyword">end</span>
<span class="keyword">end</span></span> <span class="comment">// end of [lemma42]
</span>
<span class="keyword">prfun</span> <span class="prfexp">lemma43 <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">,</span>G11<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> add<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G11<span class="keyword">,</span> A<span class="keyword">,</span> G1<span class="keyword">)</span></span><span class="keyword">)</span>
  <span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>G4<span class="keyword">:</span>seq<span class="keyword">]</span> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#1867"><span class="stacstuse">COMB</span></a> <span class="keyword">(</span>G11<span class="keyword">,</span> G2<span class="keyword">,</span> G4<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2404"><span class="stacstuse">ADD0</span></a> <span class="keyword">(</span>G4<span class="keyword">,</span> A<span class="keyword">,</span> G3<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma40 <span class="keyword">(</span>lemma11 c<span class="keyword">,</span> add<span class="keyword">)</span></span>
<span class="keyword">in</span>
  <span class="keyword">(</span>lemma11 c1<span class="keyword">,</span> add1<span class="keyword">)</span>
<span class="keyword">end</span></span> <span class="comment">// end of [lemma43]
</span>
<span class="comment">(***** cut elimination in intuitionistic linear logic *****)</span>

<span class="keyword">prfun</span> <span class="prfexp">cut
  <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A1<span class="keyword">,</span>A2<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">,</span>n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>m<span class="keyword">,</span> n2<span class="keyword">,</span> n1<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>
    a<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> m<span class="keyword">)</span></span>
  <span class="keyword">,</span> d1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A1<span class="keyword">,</span> n1<span class="keyword">)</span></span>
  <span class="keyword">,</span> d2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> A1<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> A2<span class="keyword">,</span> n2<span class="keyword">)</span></span>
  <span class="keyword">,</span> c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4195"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span>G3<span class="keyword">,</span> A2<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d2 <span class="keyword">of</span>
  <span class="keyword">|</span> DERaxi <span class="keyword">(</span>g<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">SEQmore g' <span class="keyword">=</span> g</span>
      <span class="keyword">prval</span> <span class="prfexp">SEQeq <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma20 <span class="keyword">(</span>c<span class="keyword">,</span> g'<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      <span class="keyword">case+</span> i <span class="keyword">of</span>
      <span class="keyword">|</span> INone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> d1
      <span class="keyword">|</span> INshi i' <span class="keyword">=/=&gt;</span> <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> lemma01 <span class="keyword">(</span>g'<span class="keyword">,</span> i'<span class="keyword">)</span></span> <span class="keyword">in</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">end</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLtimes <span class="keyword">(</span>d21<span class="keyword">,</span> add2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> add2 <span class="keyword">of</span>
    <span class="keyword">|</span> ADDone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d1 <span class="keyword">of</span>
      <span class="keyword">|</span> DERaxi <span class="keyword">(</span>g<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">d <span class="keyword">=</span> exchGeneral <span class="keyword">(</span>d21<span class="keyword">,</span> EXCHshi EXCHone<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">add2' <span class="keyword">=</span> lemma42 <span class="keyword">(</span>i<span class="keyword">,</span> g<span class="keyword">,</span> c<span class="keyword">)</span></span>
        <span class="keyword">in</span>
          DERleft <span class="keyword">(</span>DERLtimes <span class="keyword">(</span>d21'<span class="keyword">,</span> add2'<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>

      <span class="keyword">|</span> DERleft d1 <span class="keyword">=&gt;</span> cutAux <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">)</span>

      <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand1 <span class="keyword">(</span>d11<span class="keyword">,</span> d12<span class="keyword">,</span> c1<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c2<span class="keyword">,</span> c3<span class="keyword">)</span> <span class="keyword">=</span> lemma12 <span class="keyword">(</span>c1<span class="keyword">,</span> c<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">FMand1 <span class="keyword">(</span>a1<span class="keyword">,</span> a2<span class="keyword">)</span> <span class="keyword">=</span> a</span>
          <span class="keyword">prval</span> <span class="prfexp">d <span class="keyword">=</span> exch <span class="keyword">(</span>exchGeneral <span class="keyword">(</span>d21<span class="keyword">,</span> EXCHshi EXCHone<span class="keyword">)</span><span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> thick d</span>
          <span class="keyword">prval</span> <span class="prfexp">d12' <span class="keyword">=</span> thin d12</span>
          <span class="keyword">prval</span> <span class="prfexp">d3 <span class="keyword">=</span> cut <span class="keyword">(</span>a2<span class="keyword">,</span> d12'<span class="keyword">,</span> d21'<span class="keyword">,</span> COMBmore c2<span class="keyword">)</span></span> 
        <span class="keyword">in</span>
          cut <span class="keyword">(</span>a1<span class="keyword">,</span> d11<span class="keyword">,</span> d3<span class="keyword">,</span> c3<span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> ADDshi add2' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thin <span class="keyword">(</span>thin d1<span class="keyword">)</span></span>
        <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> exch <span class="keyword">(</span>exchGeneral <span class="keyword">(</span>d21<span class="keyword">,</span> EXCHshi EXCHone<span class="keyword">)</span><span class="keyword">)</span></span>
        <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> add3<span class="keyword">)</span> <span class="keyword">=</span> lemma40 <span class="keyword">(</span>c<span class="keyword">,</span> add2'<span class="keyword">)</span></span>
        <span class="keyword">prval</span> <span class="prfexp">d3 <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1'<span class="keyword">,</span> d21'<span class="keyword">,</span> COMBmore <span class="keyword">(</span>COMBmore c3<span class="keyword">)</span><span class="keyword">)</span></span>
      <span class="keyword">in</span>
        DERleft <span class="keyword">(</span>DERLtimes <span class="keyword">(</span>d3<span class="keyword">,</span> add3<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLand1 <span class="keyword">(</span>d21<span class="keyword">,</span> add2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> add2 <span class="keyword">of</span>
    <span class="keyword">|</span> ADDone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d1 <span class="keyword">of</span>
      <span class="keyword">|</span> DERaxi <span class="keyword">(</span>g<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d21<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">add2' <span class="keyword">=</span> lemma42 <span class="keyword">(</span>i<span class="keyword">,</span> g<span class="keyword">,</span> c<span class="keyword">)</span></span>
        <span class="keyword">in</span>
          DERleft <span class="keyword">(</span>DERLand1 <span class="keyword">(</span>d21'<span class="keyword">,</span> add2'<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>

      <span class="keyword">|</span> DERleft d1 <span class="keyword">=&gt;</span> cutAux <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">)</span>

      <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand2 <span class="keyword">(</span>d11<span class="keyword">,</span> d12<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d21<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">FMand2 <span class="keyword">(</span>a1<span class="keyword">,</span> a2<span class="keyword">)</span> <span class="keyword">=</span> a</span>
        <span class="keyword">in</span>
          cut <span class="keyword">(</span>a1<span class="keyword">,</span> d11<span class="keyword">,</span> d21'<span class="keyword">,</span> c<span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">end</span>

    <span class="keyword">|</span> ADDshi add2' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thin d1</span>
        <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> exch d21</span>
        <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c2<span class="keyword">,</span> add3<span class="keyword">)</span> <span class="keyword">=</span> lemma40 <span class="keyword">(</span>c<span class="keyword">,</span> add2'<span class="keyword">)</span></span>
        <span class="keyword">prval</span> <span class="prfexp">d3 <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1'<span class="keyword">,</span> d21'<span class="keyword">,</span> COMBmore c2<span class="keyword">)</span></span>
      <span class="keyword">in</span>
        DERleft <span class="keyword">(</span>DERLand1 <span class="keyword">(</span>d3<span class="keyword">,</span> add3<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLand2 <span class="keyword">(</span>d21<span class="keyword">,</span> add2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> add2 <span class="keyword">of</span>
    <span class="keyword">|</span> ADDone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d1 <span class="keyword">of</span>
      <span class="keyword">|</span> DERaxi <span class="keyword">(</span>g<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d21<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">add2' <span class="keyword">=</span> lemma42 <span class="keyword">(</span>i<span class="keyword">,</span> g<span class="keyword">,</span> c<span class="keyword">)</span></span>
        <span class="keyword">in</span>
          DERleft <span class="keyword">(</span>DERLand2 <span class="keyword">(</span>d21'<span class="keyword">,</span> add2'<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>

      <span class="keyword">|</span> DERleft d1 <span class="keyword">=&gt;</span> cutAux <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">)</span>

      <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand2 <span class="keyword">(</span>d11<span class="keyword">,</span> d12<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d21<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">FMand2 <span class="keyword">(</span>a1<span class="keyword">,</span> a2<span class="keyword">)</span> <span class="keyword">=</span> a</span>
        <span class="keyword">in</span>
          cut <span class="keyword">(</span>a2<span class="keyword">,</span> d12<span class="keyword">,</span> d21'<span class="keyword">,</span> c<span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">end</span>

    <span class="keyword">|</span> ADDshi add2' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thin d1</span>
        <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> exch d21</span>
        <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c2<span class="keyword">,</span> add3<span class="keyword">)</span> <span class="keyword">=</span> lemma40 <span class="keyword">(</span>c<span class="keyword">,</span> add2'<span class="keyword">)</span></span>
        <span class="keyword">prval</span> <span class="prfexp">d3 <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1'<span class="keyword">,</span> d21'<span class="keyword">,</span> COMBmore c2<span class="keyword">)</span></span>
      <span class="keyword">in</span>
        DERleft <span class="keyword">(</span>DERLand2 <span class="keyword">(</span>d3<span class="keyword">,</span> add3<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLor <span class="keyword">(</span>d21<span class="keyword">,</span> d22<span class="keyword">,</span> add2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> add2 <span class="keyword">of</span>
    <span class="keyword">|</span> ADDone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d1 <span class="keyword">of</span>
      <span class="keyword">|</span> DERaxi <span class="keyword">(</span>g<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d21<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">d22' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d22<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">add2' <span class="keyword">=</span> lemma42 <span class="keyword">(</span>i<span class="keyword">,</span> g<span class="keyword">,</span> c<span class="keyword">)</span></span>
        <span class="keyword">in</span>
          DERleft <span class="keyword">(</span>DERLor <span class="keyword">(</span>d21'<span class="keyword">,</span> d22'<span class="keyword">,</span> add2'<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>

      <span class="keyword">|</span> DERleft d1 <span class="keyword">=&gt;</span> cutAux <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">)</span>

      <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRor1 d11<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d21<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">FMor <span class="keyword">(</span>a1<span class="keyword">,</span> a2<span class="keyword">)</span> <span class="keyword">=</span> a</span>
        <span class="keyword">in</span>
          cut <span class="keyword">(</span>a1<span class="keyword">,</span> d11<span class="keyword">,</span> d21'<span class="keyword">,</span> c<span class="keyword">)</span>
        <span class="keyword">end</span>

      <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRor2 d11<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">d22' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d22<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">FMor <span class="keyword">(</span>a1<span class="keyword">,</span> a2<span class="keyword">)</span> <span class="keyword">=</span> a</span>
        <span class="keyword">in</span>
          cut <span class="keyword">(</span>a2<span class="keyword">,</span> d11<span class="keyword">,</span> d22'<span class="keyword">,</span> c<span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">end</span>

    <span class="keyword">|</span> ADDshi add2' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c2<span class="keyword">,</span> add3<span class="keyword">)</span> <span class="keyword">=</span> lemma40 <span class="keyword">(</span>c<span class="keyword">,</span> add2'<span class="keyword">)</span></span>
        <span class="keyword">prval</span> <span class="prfexp">d11' <span class="keyword">=</span> thin d1</span> 
        <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d11'<span class="keyword">,</span> exch d21<span class="keyword">,</span> COMBmore c2<span class="keyword">)</span></span>
        <span class="keyword">prval</span> <span class="prfexp">d12' <span class="keyword">=</span> thin d1</span>
        <span class="keyword">prval</span> <span class="prfexp">d22' <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d12'<span class="keyword">,</span> exch d22<span class="keyword">,</span> COMBmore c2<span class="keyword">)</span></span>
      <span class="keyword">in</span>
        DERleft <span class="keyword">(</span>DERLor <span class="keyword">(</span>d21'<span class="keyword">,</span> d22'<span class="keyword">,</span> add3<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d21<span class="keyword">,</span> d22<span class="keyword">,</span> c2<span class="keyword">,</span> add2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> add2 <span class="keyword">of</span>
    <span class="keyword">|</span> ADDone <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d1 <span class="keyword">of</span>
      <span class="keyword">|</span> DERaxi <span class="keyword">(</span>g<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">COMBmore c2' <span class="keyword">=</span> c2</span>
          <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> thick d21</span>
          <span class="keyword">prval</span> <span class="prfexp">d22' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d22<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">add3 <span class="keyword">=</span> lemma42 <span class="keyword">(</span>i<span class="keyword">,</span> g<span class="keyword">,</span> c<span class="keyword">)</span></span>
        <span class="keyword">in</span>
          DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d21'<span class="keyword">,</span> d22'<span class="keyword">,</span> c2'<span class="keyword">,</span> add3<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>

      <span class="keyword">|</span> DERleft d1 <span class="keyword">=&gt;</span> cutAux <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d2<span class="keyword">,</span> c<span class="keyword">)</span> 
                  
      <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRimp d1'<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">COMBmore c2' <span class="keyword">=</span> c2</span>
          <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> c4<span class="keyword">)</span> <span class="keyword">=</span> lemma15 <span class="keyword">(</span>c<span class="keyword">,</span> c2'<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">FMimp <span class="keyword">(</span>a1<span class="keyword">,</span> a2<span class="keyword">)</span> <span class="keyword">=</span> a</span>
          <span class="keyword">prval</span> <span class="prfexp">d3 <span class="keyword">=</span> cut <span class="keyword">(</span>a1<span class="keyword">,</span> thick d21<span class="keyword">,</span> d1'<span class="keyword">,</span> c3<span class="keyword">)</span></span> 
        <span class="keyword">in</span>
          cut <span class="keyword">(</span>a2<span class="keyword">,</span> d3<span class="keyword">,</span> thick <span class="keyword">(</span>exch d22<span class="keyword">)</span><span class="keyword">,</span> c4<span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">end</span>

    <span class="keyword">|</span> ADDshi add2' <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp">COMBmore <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>_n<span class="keyword">,</span>i1<span class="keyword">,</span>_i2<span class="keyword">}</span></span> c2' <span class="keyword">=</span> c2</span>
      <span class="keyword">in</span>
        <span class="keyword">sif</span> <span class="staexp"><span class="keyword">(</span>i1 <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7435"><span class="stacstuse">==</span></a> 0<span class="keyword">)</span></span> <span class="keyword">then</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thin d1</span>
          <span class="keyword">prval</span> <span class="prfexp">d22' <span class="keyword">=</span> exch d22</span>
          <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> add3<span class="keyword">)</span> <span class="keyword">=</span> lemma40 <span class="keyword">(</span>c<span class="keyword">,</span> add2'<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c4<span class="keyword">,</span> c5<span class="keyword">)</span> <span class="keyword">=</span> lemma13 <span class="keyword">(</span>c3<span class="keyword">,</span> c2'<span class="keyword">)</span></span>	            
          <span class="keyword">prval</span> <span class="prfexp">d3 <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1'<span class="keyword">,</span> d22'<span class="keyword">,</span> COMBmore c4<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> thick d21</span>
        <span class="keyword">in</span> 
          DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d21'<span class="keyword">,</span> d3<span class="keyword">,</span> c5<span class="keyword">,</span> add3<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">let</span>
          <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> add3<span class="keyword">)</span> <span class="keyword">=</span> lemma40 <span class="keyword">(</span>c<span class="keyword">,</span> add2'<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c4<span class="keyword">,</span> c5<span class="keyword">)</span> <span class="keyword">=</span> lemma14 <span class="keyword">(</span>c3<span class="keyword">,</span> c2'<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">d3 <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d21<span class="keyword">,</span> c4<span class="keyword">)</span></span>
          <span class="keyword">prval</span> <span class="prfexp">d22' <span class="keyword">=</span> thick <span class="keyword">(</span>exch d22<span class="keyword">)</span></span>
        <span class="keyword">in</span>
          DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d3<span class="keyword">,</span> d22'<span class="keyword">,</span> c5<span class="keyword">,</span> add3<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">end</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand1 <span class="keyword">(</span>d21<span class="keyword">,</span> d22<span class="keyword">,</span> c2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">COMBmore <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>_n<span class="keyword">,</span>i1<span class="keyword">,</span>_i2<span class="keyword">}</span></span> c2' <span class="keyword">=</span> c2</span>
    <span class="keyword">in</span>
      <span class="keyword">sif</span> <span class="staexp"><span class="keyword">(</span>i1 <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7435"><span class="stacstuse">==</span></a> 0<span class="keyword">)</span></span> <span class="keyword">then</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> c4<span class="keyword">)</span> <span class="keyword">=</span> lemma13 <span class="keyword">(</span>c<span class="keyword">,</span> c2'<span class="keyword">)</span></span>
        <span class="keyword">prval</span> <span class="prfexp">d3 <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d22<span class="keyword">,</span> c3<span class="keyword">)</span></span>
      <span class="keyword">in</span>
        DERright <span class="keyword">(</span>DERRand1 <span class="keyword">(</span>thick d21<span class="keyword">,</span> d3<span class="keyword">,</span> c4<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> c4<span class="keyword">)</span> <span class="keyword">=</span> lemma14 <span class="keyword">(</span>c<span class="keyword">,</span> c2'<span class="keyword">)</span></span>
        <span class="keyword">prval</span> <span class="prfexp">d3 <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d21<span class="keyword">,</span> c3<span class="keyword">)</span></span>
      <span class="keyword">in</span>
        DERright <span class="keyword">(</span>DERRand1 <span class="keyword">(</span>d3<span class="keyword">,</span> thick d22<span class="keyword">,</span> c4<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRand2 <span class="keyword">(</span>d21<span class="keyword">,</span> d22<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d21<span class="keyword">,</span> c<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d22' <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d22<span class="keyword">,</span> c<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERright <span class="keyword">(</span>DERRand2 <span class="keyword">(</span>d21'<span class="keyword">,</span> d22'<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRor1 d21<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      DERright <span class="keyword">(</span>DERRor1 <span class="keyword">(</span>cut <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d21<span class="keyword">,</span> c<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRor2 d22<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      DERright <span class="keyword">(</span>DERRor2 <span class="keyword">(</span>cut <span class="keyword">(</span>a<span class="keyword">,</span> d1<span class="keyword">,</span> d22<span class="keyword">,</span> c<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span> 

  <span class="keyword">|</span> DERright <span class="keyword">(</span>DERRimp d2'<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">d1' <span class="keyword">=</span> thin d1 <span class="keyword">and</span> d3 <span class="keyword">=</span> exch d2'</span>
    <span class="keyword">in</span> 
      DERright <span class="keyword">(</span>DERRimp <span class="keyword">(</span>cut <span class="keyword">(</span>a<span class="keyword">,</span> d1'<span class="keyword">,</span> d3<span class="keyword">,</span> COMBmore c<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span> <span class="comment">// end of [cut]
</span>
<span class="keyword">and</span> cutAux
  <span class="staexp"><span class="keyword">{</span>G1<span class="keyword">,</span>G2<span class="keyword">,</span>G3<span class="keyword">:</span>seq<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>A1<span class="keyword">,</span>A2<span class="keyword">:</span>form<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">,</span>n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>m<span class="keyword">,</span> n2<span class="keyword">,</span> n1<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>
    a<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#870"><span class="stacstuse">FM</span></a> <span class="keyword">(</span>A1<span class="keyword">,</span> m<span class="keyword">)</span></span>
  <span class="keyword">,</span> d1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2707"><span class="stacstuse">DERL</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> A1<span class="keyword">,</span> n1<span class="keyword">)</span></span>
  <span class="keyword">,</span> d2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2471"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#835"><span class="stacstuse">more</span></a> <span class="keyword">(</span>G2<span class="keyword">,</span> A1<span class="keyword">,</span> 1<span class="keyword">)</span><span class="keyword">,</span> A2<span class="keyword">,</span> n2<span class="keyword">)</span></span>
  <span class="keyword">,</span> c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#2105"><span class="stacstuse">COMB0</span></a> <span class="keyword">(</span>G1<span class="keyword">,</span> G2<span class="keyword">,</span> G3<span class="keyword">)</span></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fCutElimILL_2edats.html#4195"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span>G3<span class="keyword">,</span> A2<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> d1 <span class="keyword">of</span>
  <span class="keyword">|</span> DERLtimes <span class="keyword">(</span>d1'<span class="keyword">,</span> add<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma43 <span class="keyword">(</span>c<span class="keyword">,</span> add<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> exch <span class="keyword">(</span>thin <span class="keyword">(</span>exch <span class="keyword">(</span>thin d2<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> COMBmore <span class="keyword">(</span>COMBmore c1<span class="keyword">)</span><span class="keyword">)</span></span>  
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLtimes <span class="keyword">(</span>d<span class="keyword">,</span> add1<span class="keyword">)</span><span class="keyword">)</span> 
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERLand1 <span class="keyword">(</span>d1'<span class="keyword">,</span> add<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma43 <span class="keyword">(</span>c<span class="keyword">,</span> add<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> exch <span class="keyword">(</span>thin d2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> COMBmore c1<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLand1 <span class="keyword">(</span>d<span class="keyword">,</span> add1<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERLand2 <span class="keyword">(</span>d1'<span class="keyword">,</span> add<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma43 <span class="keyword">(</span>c<span class="keyword">,</span> add<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> exch <span class="keyword">(</span>thin d2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d1'<span class="keyword">,</span> d2'<span class="keyword">,</span> COMBmore c1<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLand2 <span class="keyword">(</span>d<span class="keyword">,</span> add1<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERLor <span class="keyword">(</span>d11<span class="keyword">,</span> d12<span class="keyword">,</span> add<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=</span> lemma43 <span class="keyword">(</span>c<span class="keyword">,</span> add<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d21' <span class="keyword">=</span> exch <span class="keyword">(</span>thin d2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d11' <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d11<span class="keyword">,</span> d21'<span class="keyword">,</span> COMBmore c1<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d22' <span class="keyword">=</span> exch <span class="keyword">(</span>thin d2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d12' <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d12<span class="keyword">,</span> d22'<span class="keyword">,</span> COMBmore c1<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLor <span class="keyword">(</span>d11'<span class="keyword">,</span> d12'<span class="keyword">,</span> add1<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>

  <span class="keyword">|</span> DERLimp <span class="keyword">(</span>d11<span class="keyword">,</span> d12<span class="keyword">,</span> c1<span class="keyword">,</span> add1<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp"><span class="keyword">(</span>c3<span class="keyword">,</span> c4<span class="keyword">,</span> add3<span class="keyword">)</span> <span class="keyword">=</span> lemma41 <span class="keyword">(</span>c1<span class="keyword">,</span> add1<span class="keyword">,</span> c<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d2' <span class="keyword">=</span> exch <span class="keyword">(</span>thin d2<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">d3 <span class="keyword">=</span> cut <span class="keyword">(</span>a<span class="keyword">,</span> d12<span class="keyword">,</span> d2'<span class="keyword">,</span> COMBmore c3<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      DERleft <span class="keyword">(</span>DERLimp <span class="keyword">(</span>d11<span class="keyword">,</span> d3<span class="keyword">,</span> c4<span class="keyword">,</span> add3<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span></span> <span class="comment">// end of [cutAux]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [CutElimILL.dats] *)</span>
</pre>
</body>
</html>
