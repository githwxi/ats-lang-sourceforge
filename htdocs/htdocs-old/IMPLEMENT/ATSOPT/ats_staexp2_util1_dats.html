<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">(***********************************************************************)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(*                         Applied Type System                         *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(*                              Hongwei Xi                             *)</span>
<span class="comment">(*                                                                     *)</span>
<span class="comment">(***********************************************************************)</span>

<span class="comment">(*
** ATS/Anairiats - Unleashing the Potential of Types!
**
** Copyright (C) 2002-2008 Hongwei Xi, Boston University
**
** All rights reserved
**
** ATS is free software;  you can  redistribute it and/or modify it under
** the terms of  the GNU GENERAL PUBLIC LICENSE (GPL) as published by the
** Free Software Foundation; either version 3, or (at  your  option)  any
** later version.
** 
** ATS is distributed in the hope that it will be useful, but WITHOUT ANY
** WARRANTY; without  even  the  implied  warranty  of MERCHANTABILITY or
** FITNESS FOR A PARTICULAR PURPOSE.  See the  GNU General Public License
** for more details.
** 
** You  should  have  received  a  copy of the GNU General Public License
** along  with  ATS;  see the  file COPYING.  If not, please write to the
** Free Software Foundation,  51 Franklin Street, Fifth Floor, Boston, MA
** 02110-1301, USA.
*)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">// Author: Hongwei Xi (hwxi AT cs DOT bu DOT edu)
</span><span class="comment">// Time: October 2007
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="extern">%{^
#include "ats_counter.cats" /* only needed for [ATS/Geizella] */
#include "ats_intinf.cats"  /* only needed for [ATS/Geizella] */
%}</span> <span class="comment">// end [%{^]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">Err <span class="keyword">=</span> "ats_error.sats"</span>
<span class="keyword">staload</span> <span class="staexp">IntInf <span class="keyword">=</span> "ats_intinf.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Lab <span class="keyword">=</span> "ats_label.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Lst <span class="keyword">=</span> "ats_list.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Loc <span class="keyword">=</span> "ats_location.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Sym <span class="keyword">=</span> "ats_symbol.sats"</span>
<span class="keyword">staload</span> <span class="staexp">Syn <span class="keyword">=</span> "ats_syntax.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">staload</span> <span class="staexp">"ats_staexp2.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"ats_stadyncst2.sats"</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">#define</span> <span class="neuexp">nil list_nil</span>
<span class="keyword">#define</span> <span class="neuexp">:: list_cons</span>
<span class="keyword">#define</span> <span class="neuexp">cons list_cons</span>

<span class="comment">(* ****** ****** *)</span>

<span class="neuexp"><span class="keyword">overload</span> <span class="keyword">=</span> <span class="keyword">with</span> $Lab<span class="keyword">.</span>eq_label_label</span>
<span class="neuexp"><span class="keyword">overload</span> <span class="keyword">=</span> <span class="keyword">with</span> $Sym<span class="keyword">.</span>eq_symbol_symbol</span>
<span class="neuexp"><span class="keyword">overload</span> prerr <span class="keyword">with</span> $Loc<span class="keyword">.</span>prerr_location</span>
<span class="neuexp"><span class="keyword">overload</span> prerr <span class="keyword">with</span> $Sym<span class="keyword">.</span>prerr_symbol</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fn</span> prerr_loc_error2 <span class="keyword">(</span>loc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2034"><span class="stacstuse">loc_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#2738"><span class="dyncstuse">$Loc<span class="keyword">.</span>prerr_location</span></a> loc<span class="keyword">;</span> prerr ": error(2)"<span class="keyword">)</span>
<span class="comment">// end of [prerr_loc_error2]
</span>
<span class="keyword">fn</span> prerr_interror <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> prerr "INTERNAL ERROR (ats_staexp2_util1)"
<span class="keyword">fn</span> prerr_loc_interror <span class="keyword">(</span>loc<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2034"><span class="stacstuse">loc_t</span></a></span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flocation_2esats.html#2738"><span class="dyncstuse">$Loc<span class="keyword">.</span>prerr_location</span></a> loc<span class="keyword">;</span> prerr ": INTERNAL ERROR (ats_staexp2_util1)"
<span class="keyword">end</span> <span class="comment">// end of [prerr_loc_interror]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">extern</span>
<span class="keyword">fun</span> <a name="2644"><span class="dyncstdec">eq_s2rtbas_s2rtbas <span class="keyword">(</span>s2tb1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#3860"><span class="stacstuse">s2rtbas</span></a></span><span class="keyword">,</span> s2tb2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#3860"><span class="stacstuse">s2rtbas</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span></span></a>
<span class="neuexp"><span class="keyword">overload</span> <span class="keyword">=</span> <span class="keyword">with</span> eq_s2rtbas_s2rtbas</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#2644"><span class="dyncstimp">eq_s2rtbas_s2rtbas</span></a> <span class="keyword">(</span>s2tb1<span class="keyword">,</span> s2tb2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>s2tb1<span class="keyword">,</span> s2tb2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTBASpre id1<span class="keyword">,</span> S2RTBASpre id2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>id1 <span class="keyword">=</span> id2<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTBASimp <span class="keyword">(</span>id1<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span><span class="keyword">,</span> S2RTBASimp <span class="keyword">(</span>id2<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>id1 <span class="keyword">=</span> id2<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTBASdef s2td1<span class="keyword">,</span> S2RTBASdef s2td2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>s2td1 <span class="keyword">=</span> s2td2<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [eq_s2rtbas_s2rtbas]
</span>
<span class="keyword">extern</span>
<span class="keyword">fun</span> <a name="3063"><span class="dyncstdec">lte_s2rtbas_s2rtbas <span class="keyword">(</span>s2tb1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#3860"><span class="stacstuse">s2rtbas</span></a></span><span class="keyword">,</span> s2tb2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#3860"><span class="stacstuse">s2rtbas</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span></span></a>
<span class="neuexp"><span class="keyword">overload</span> &lt;= <span class="keyword">with</span> lte_s2rtbas_s2rtbas</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#3063"><span class="dyncstimp">lte_s2rtbas_s2rtbas</span></a> <span class="keyword">(</span>s2tb1<span class="keyword">,</span> s2tb2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>s2tb1<span class="keyword">,</span> s2tb2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTBASpre id1<span class="keyword">,</span> S2RTBASpre id2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>id1 <span class="keyword">=</span> id2<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTBASimp <span class="keyword">(</span>id1<span class="keyword">,</span> prf1<span class="keyword">,</span> lin1<span class="keyword">)</span><span class="keyword">,</span> S2RTBASimp <span class="keyword">(</span>id2<span class="keyword">,</span> prf2<span class="keyword">,</span> lin2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
    <span class="keyword">if</span> prf1 &lt;= prf2 <span class="keyword">then</span> lin1 &lt;= lin2 <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTBASdef s2td1<span class="keyword">,</span> S2RTBASdef s2td2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>s2td1 <span class="keyword">=</span> s2td2<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [lte_s2rtbas_s2rtbas]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#12341"><span class="dyncstimp">eq_s2rt_s2rt</span></a> <span class="keyword">(</span>s2t1<span class="keyword">,</span> s2t2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>s2t1<span class="keyword">,</span> s2t2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTbas s2tb1<span class="keyword">,</span> S2RTbas s2tb2<span class="keyword">)</span> <span class="keyword">=&gt;</span> s2tb1 <span class="keyword">=</span> s2tb2
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTfun <span class="keyword">(</span>s2ts1<span class="keyword">,</span> s2t1<span class="keyword">)</span><span class="keyword">,</span> S2RTfun <span class="keyword">(</span>s2ts2<span class="keyword">,</span> s2t2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
    <span class="keyword">if</span> s2ts2 <span class="keyword">=</span> s2ts1 <span class="keyword">then</span> s2t1 <span class="keyword">=</span> s2t2 <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTtup s2ts1<span class="keyword">,</span> S2RTtup s2ts2<span class="keyword">)</span> <span class="keyword">=&gt;</span> s2ts1 <span class="keyword">=</span> s2ts2
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [eq_s2rt_s2rt]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#12413"><span class="dyncstimp">eq_s2rtlst_s2rtlst</span></a> <span class="keyword">(</span>s2ts1<span class="keyword">,</span> s2ts2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>s2ts1<span class="keyword">,</span> s2ts2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>s2t1 :: s2ts1<span class="keyword">,</span> s2t2 :: s2ts2<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      <span class="keyword">if</span> s2t1 <span class="keyword">=</span> s2t2 <span class="keyword">then</span> s2ts1 <span class="keyword">=</span> s2ts2 <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>list_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> list_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [eq_s2rtlst_s2rtlst]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#12503"><span class="dyncstimp">lte_s2rt_s2rt</span></a> <span class="keyword">(</span>s2t1<span class="keyword">,</span> s2t2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>s2t1<span class="keyword">,</span> s2t2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTbas s2tb1<span class="keyword">,</span> S2RTbas s2tb2<span class="keyword">)</span> <span class="keyword">=&gt;</span> s2tb1 &lt;= s2tb2
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTfun <span class="keyword">(</span>s2ts1<span class="keyword">,</span> s2t1<span class="keyword">)</span><span class="keyword">,</span> S2RTfun <span class="keyword">(</span>s2ts2<span class="keyword">,</span> s2t2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span>
    <span class="keyword">if</span> s2ts2 &lt;= s2ts1 <span class="keyword">then</span> s2t1 &lt;= s2t2 <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>S2RTtup s2ts1<span class="keyword">,</span> S2RTtup s2ts2<span class="keyword">)</span> <span class="keyword">=&gt;</span> s2ts1 &lt;= s2ts2
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [lte_s2rt_s2rt]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#12578"><span class="dyncstimp">lte_s2rtlst_s2rtlst</span></a> <span class="keyword">(</span>s2ts1<span class="keyword">,</span> s2ts2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
 <span class="keyword">case+</span> <span class="keyword">(</span>s2ts1<span class="keyword">,</span> s2ts2<span class="keyword">)</span> <span class="keyword">of</span>
 <span class="keyword">|</span> <span class="keyword">(</span>s2t1 :: s2ts1<span class="keyword">,</span> s2t2 :: s2ts2<span class="keyword">)</span> <span class="keyword">=&gt;</span>
   <span class="keyword">if</span> s2t1 &lt;= s2t2 <span class="keyword">then</span> s2ts1 &lt;= s2ts2 <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
 <span class="keyword">|</span> <span class="keyword">(</span>list_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> list_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
 <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [lte_s2rtlst_s2rtlst]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10450"><span class="dyncstimp">s2rt_is_cls</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASpre id <span class="keyword">=&gt;</span> id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3323"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_CLS</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2rt_is_int]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10485"><span class="dyncstimp">s2rt_is_dat</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">case+</span> s2tb <span class="keyword">of</span> S2RTBASdef _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a><span class="keyword">)</span>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a> <span class="comment">// end of [S2RTbas]
</span><span class="keyword">end</span> <span class="comment">// end of [s2rt_is_dat]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10519"><span class="dyncstimp">s2rt_is_int</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASpre id <span class="keyword">=&gt;</span> id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3401"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_INT</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2rt_is_int]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10554"><span class="dyncstimp">s2rt_is_prop</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3460"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_PROP</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2rt_is_prop]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10589"><span class="dyncstimp">s2rt_is_type</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3487"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_TYPE</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2rt_is_type]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10624"><span class="dyncstimp">s2rt_is_t0ype</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3540"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_T0YPE</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2rt_is_t0ype]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10660"><span class="dyncstimp">s2rt_is_view</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3597"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_VIEW</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2rt_is_view]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10695"><span class="dyncstimp">s2rt_is_viewtype</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3624"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_VIEWTYPE</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2rt_is_viewtype]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10734"><span class="dyncstimp">s2rt_is_viewtype_fun</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTfun <span class="keyword">(</span>_<span class="keyword">,</span> s2t<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10734"><span class="dyncstuse">s2rt_is_viewtype_fun</span></a> s2t <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10695"><span class="dyncstuse">s2rt_is_viewtype</span></a> s2t
<span class="keyword">end</span> <span class="comment">// end of [s2rt_is_viewtype_fun]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10777"><span class="dyncstimp">s2rt_is_viewt0ype</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3685"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_VIEWT0YPE</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2rt_is_viewt0ype]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10817"><span class="dyncstimp">s2rt_is_types</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> id <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsymbol_2esats.html#3750"><span class="dyncstuse">$Sym<span class="keyword">.</span>symbol_TYPES</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [s2rt_is_types]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10875"><span class="dyncstimp">s2rt_is_linear</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> _<span class="keyword">,</span> lin<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>lin <span class="keyword">&gt;</span> 0<span class="keyword">)</span> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [s2rt_is_linear]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10912"><span class="dyncstimp">s2rt_is_linear_fun</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTfun <span class="keyword">(</span>_<span class="keyword">,</span> s2t<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10912"><span class="dyncstuse">s2rt_is_linear_fun</span></a> s2t <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10875"><span class="dyncstuse">s2rt_is_linear</span></a> s2t
<span class="comment">// end of [s2rt_is_linear]
</span>
<span class="keyword">#define</span> <span class="neuexp">PROOF_LEVEL 2</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10953"><span class="dyncstimp">s2rt_is_proof</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> prf<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> prf &gt;= PROOF_LEVEL <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [s2rt_is_proof]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10989"><span class="dyncstimp">s2rt_is_proof_fun</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTfun <span class="keyword">(</span>_<span class="keyword">,</span> s2t<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10989"><span class="dyncstuse">s2rt_is_proof_fun</span></a> s2t <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10953"><span class="dyncstuse">s2rt_is_proof</span></a> s2t
<span class="comment">// end of [s2rt_is_proof_fun]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11029"><span class="dyncstimp">s2rt_is_program</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> prf<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> prf <span class="keyword">&lt;</span> PROOF_LEVEL <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [s2rt_is_program]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11067"><span class="dyncstimp">s2rt_is_program_fun</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTfun <span class="keyword">(</span>_<span class="keyword">,</span> s2t<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11067"><span class="dyncstuse">s2rt_is_program_fun</span></a> s2t <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11029"><span class="dyncstuse">s2rt_is_program</span></a> s2t
<span class="comment">// end of [s2rt_is_program_fun]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11109"><span class="dyncstimp">s2rt_is_impredicative</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">case+</span> s2tb <span class="keyword">of</span> S2RTBASimp _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [s2rt_is_impredicative]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11153"><span class="dyncstimp">s2rt_is_impredicative_fun</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTfun <span class="keyword">(</span>_<span class="keyword">,</span> s2t<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11153"><span class="dyncstuse">s2rt_is_impredicative_fun</span></a> s2t
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11109"><span class="dyncstuse">s2rt_is_impredicative</span></a> s2t
<span class="comment">// end of [s2rt_is_impredicative_fun]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11201"><span class="dyncstimp">s2rt_is_boxed</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTbas s2tb <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2tb <span class="keyword">of</span>
    <span class="keyword">|</span> S2RTBASimp <span class="keyword">(</span>id<span class="keyword">,</span> prf<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>prf <span class="keyword">=</span> 0<span class="keyword">)</span> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2RTbas]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [s2rt_is_boxed]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11237"><span class="dyncstimp">s2rt_is_boxed_fun</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTfun <span class="keyword">(</span>_<span class="keyword">,</span> s2t<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11237"><span class="dyncstuse">s2rt_is_boxed_fun</span></a> s2t <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11201"><span class="dyncstuse">s2rt_is_boxed</span></a> s2t
<span class="comment">// end of [s2rt_is_boxed_fun]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11299"><span class="dyncstimp">s2rt_base_fun</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2t <span class="keyword">of</span>
  <span class="keyword">|</span> S2RTfun <span class="keyword">(</span>_<span class="keyword">,</span> s2t<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11299"><span class="dyncstuse">s2rt_base_fun</span></a> s2t <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> s2t
<span class="comment">// end of [s2rt_base_fun]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11335"><span class="dyncstimp">s2rt_datakind</span></a>
  <span class="keyword">(</span>datknd<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> datknd <span class="keyword">of</span>
  <span class="keyword">|</span> $Syn<span class="keyword">.</span>DATAKINDprop <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10270"><span class="dyncstuse">s2rt_prop</span></a>
  <span class="keyword">|</span> $Syn<span class="keyword">.</span>DATAKINDtype <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10291"><span class="dyncstuse">s2rt_type</span></a>
  <span class="keyword">|</span> $Syn<span class="keyword">.</span>DATAKINDview <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10334"><span class="dyncstuse">s2rt_view</span></a>
  <span class="keyword">|</span> $Syn<span class="keyword">.</span>DATAKINDviewtype <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10355"><span class="dyncstuse">s2rt_viewtype</span></a>
<span class="comment">// end of [s2rt_datakind]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11378"><span class="dyncstimp">s2rt_readize</span></a> <span class="keyword">(</span>s2t<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10953"><span class="dyncstuse">s2rt_is_proof</span></a> s2t <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10270"><span class="dyncstuse">s2rt_prop</span></a> <span class="keyword">else</span> <span class="keyword">begin</span>
    <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11201"><span class="dyncstuse">s2rt_is_boxed</span></a> s2t <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10291"><span class="dyncstuse">s2rt_type</span></a> <span class="keyword">else</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10312"><span class="dyncstuse">s2rt_t0ype</span></a>
  <span class="keyword">end</span>
<span class="comment">// end of [s2rt_readize]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">#define</span> <span class="neuexp">CLO 0</span><span class="keyword">;</span> <span class="keyword">#define</span> <span class="neuexp">CLOPTR 1</span><span class="keyword">;</span> <span class="keyword">#define</span> <span class="neuexp">CLOREF ~1</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11515"><span class="dyncstimp">s2rt_prf_lin_fc</span></a>
  <span class="keyword">(</span>loc0<span class="keyword">,</span> isprf<span class="keyword">,</span> islin<span class="keyword">,</span> fc<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">if</span> isprf <span class="keyword">then</span> <span class="keyword">begin</span>
    <span class="keyword">(</span><span class="keyword">if</span> islin <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10334"><span class="dyncstuse">s2rt_view</span></a> <span class="keyword">else</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10270"><span class="dyncstuse">s2rt_prop</span></a><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span> <span class="keyword">case+</span> islin <span class="keyword">of</span>
    <span class="keyword">|</span> _ <span class="keyword">when</span> islin <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> fc <span class="keyword">of</span>
      <span class="keyword">|</span> $Syn<span class="keyword">.</span>FUNCLOclo <span class="keyword">(</span>knd<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> knd <span class="keyword">of</span>
        <span class="keyword">|</span> CLO <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10380"><span class="dyncstuse">s2rt_viewt0ype</span></a>
        <span class="keyword">|</span> CLOPTR <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10355"><span class="dyncstuse">s2rt_viewtype</span></a>
        <span class="keyword">|</span> _ <span class="comment">(*CLOREF*)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
            prerr_loc_error2 loc0<span class="keyword">;</span>
            prerr ": a closure reference cannot be linear."<span class="keyword">;</span>
            <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
            <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4120"><span class="stacstuse">s2rt</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
          <span class="keyword">end</span> <span class="comment">// end of [_]
</span>        <span class="keyword">end</span> <span class="comment">(* end of [FUNCLOclo] *)</span>
      <span class="keyword">|</span> $Syn<span class="keyword">.</span>FUNCLOfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10355"><span class="dyncstuse">s2rt_viewtype</span></a>
      <span class="keyword">end</span> <span class="comment">// end of [_ when islin]
</span>    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> fc <span class="keyword">of</span>
      <span class="keyword">|</span> $Syn<span class="keyword">.</span>FUNCLOclo <span class="keyword">(</span>knd<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> knd <span class="keyword">of</span>
        <span class="keyword">|</span> CLO <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10312"><span class="dyncstuse">s2rt_t0ype</span></a>
        <span class="keyword">|</span> CLOPTR <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10355"><span class="dyncstuse">s2rt_viewtype</span></a> <span class="comment">(*ptr*)</span>
        <span class="keyword">|</span> _ <span class="comment">(*CLOREF*)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10291"><span class="dyncstuse">s2rt_type</span></a> <span class="comment">(*ref*)</span>
        <span class="keyword">end</span> <span class="comment">// end of [FUNCLOclo]
</span>      <span class="keyword">|</span> $Syn<span class="keyword">.</span>FUNCLOfun <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10291"><span class="dyncstuse">s2rt_type</span></a>
      <span class="keyword">end</span> <span class="comment">// end of [_]
</span>  <span class="keyword">end</span> <span class="comment">(* end of [if] *)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2rt_prf_lin_fc]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24689"><span class="dyncstimp">s2eff_union_eff</span></a> <span class="keyword">(</span>s2fe<span class="keyword">,</span> eff<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2fe <span class="keyword">of</span>
  <span class="keyword">|</span> S2EFFall <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> S2EFFall <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2EFFnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> S2EFFset
      <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5feffect_2esats.html#2914"><span class="dyncstuse">$Eff<span class="keyword">.</span>effset_add</span></a> <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5feffect_2esats.html#2669"><span class="dyncstuse">$Eff<span class="keyword">.</span>effset_nil</span></a><span class="keyword">,</span> eff<span class="keyword">)</span><span class="keyword">,</span> list_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="comment">// end of [S2EFFnil]
</span>  <span class="keyword">|</span> S2EFFset <span class="keyword">(</span>efs<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      S2EFFset <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5feffect_2esats.html#2914"><span class="dyncstuse">$Eff<span class="keyword">.</span>effset_add</span></a> <span class="keyword">(</span>efs<span class="keyword">,</span> eff<span class="keyword">)</span><span class="keyword">,</span> s2es<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2EFFset]
</span><span class="comment">// end of [s2eff_union_eff]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24745"><span class="dyncstimp">s2eff_union_s2eff</span></a> <span class="keyword">(</span>s2fe1<span class="keyword">,</span> s2fe2<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>s2fe1<span class="keyword">,</span> s2fe2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2EFFall <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> S2EFFall <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> S2EFFall <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> S2EFFall <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2EFFnil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> s2fe2
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> S2EFFnil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2fe1
  <span class="keyword">|</span> <span class="keyword">(</span>S2EFFset <span class="keyword">(</span>efs1<span class="keyword">,</span> s2es1<span class="keyword">)</span><span class="keyword">,</span> S2EFFset <span class="keyword">(</span>efs2<span class="keyword">,</span> s2es2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> efs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5feffect_2esats.html#3161"><span class="dyncstuse">$Eff<span class="keyword">.</span>effset_union</span></a> <span class="keyword">(</span>efs1<span class="keyword">,</span> efs2<span class="keyword">)</span>
      <span class="keyword">val</span> s2es <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#1736"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_append</span></a> <span class="keyword">(</span>s2es1<span class="keyword">,</span> s2es2<span class="keyword">)</span>
    <span class="keyword">in</span>
      S2EFFset <span class="keyword">(</span>efs<span class="keyword">,</span> s2es<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2EFFset, S2EFFset]
</span><span class="comment">// end of [s2eff_union_s2eff]
</span>
<span class="comment">// ------------------------------------------------
</span>
<span class="keyword">fun</span> s2exp_contain_eff
  <span class="keyword">(</span>s2e0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span><span class="keyword">,</span> eff<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11143"><span class="stacstuse">$Syn<span class="keyword">.</span>effect_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> s2e0 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#35358"><span class="dyncstuse">s2exp_whnf</span></a> s2e0
<span class="keyword">in</span>
  <span class="keyword">case+</span> s2e0<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Eeff s2fe <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24796"><span class="dyncstuse">s2eff_contain_eff</span></a> <span class="keyword">(</span>s2fe<span class="keyword">,</span> eff<span class="keyword">)</span>
  <span class="keyword">|</span> S2EVar s2V <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      prerr <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19041"><span class="dyncstuse">s2Var_loc_get</span></a> s2V<span class="keyword">)</span><span class="keyword">;</span>
      prerr ": INTERNAL WARNING (ats_staexp2_util1)"<span class="keyword">;</span>
      prerr ": s2exp_contain_eff: s2e0 = "<span class="keyword">;</span> prerr s2e0<span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2EVar]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2exp_contain_eff]
</span>
<span class="keyword">and</span> s2explst_contain_eff
  <span class="keyword">(</span>s2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span><span class="keyword">,</span> eff<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11143"><span class="stacstuse">$Syn<span class="keyword">.</span>effect_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2es <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> s2exp_contain_eff <span class="keyword">(</span>s2e<span class="keyword">,</span> eff<span class="keyword">)</span> <span class="keyword">then</span>
        <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> s2explst_contain_eff <span class="keyword">(</span>s2es<span class="keyword">,</span> eff<span class="keyword">)</span>
      <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2explst_contain_eff]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24796"><span class="dyncstimp">s2eff_contain_eff</span></a> <span class="keyword">(</span>s2fe<span class="keyword">,</span> eff<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">(*
  val () = begin
    print "s2eff_contain_eff: s2fe = "; print s2fe; print_newline ();
    print "s2eff_contain_eff: eff = "; print eff; print_newline ();
  end // end of [val]
*)</span>
<span class="keyword">in</span>
  <span class="keyword">case+</span> s2fe <span class="keyword">of</span>
  <span class="keyword">|</span> S2EFFall <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> S2EFFnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> S2EFFset <span class="keyword">(</span>efs<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5feffect_2esats.html#3076"><span class="dyncstuse">$Eff<span class="keyword">.</span>effset_contain</span></a> <span class="keyword">(</span>efs<span class="keyword">,</span> eff<span class="keyword">)</span> <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
      <span class="keyword">else</span> s2explst_contain_eff <span class="keyword">(</span>s2es<span class="keyword">,</span> eff<span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span> <span class="comment">// end of [s2eff_contain_eff]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24853"><span class="dyncstimp">s2eff_contain_effset</span></a> <span class="keyword">(</span>s2fe<span class="keyword">,</span> efs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#11186"><span class="stacstuse">$Syn<span class="keyword">.</span>effectlst</span></a></span><span class="keyword">)</span><span class="keyword">:&lt;</span><span class="staexp">cloptr1</span><span class="keyword">&gt;</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5feffect_2esats.html#3076"><span class="dyncstuse">$Eff<span class="keyword">.</span>effset_contain</span></a> <span class="keyword">(</span>efs<span class="keyword">,</span> x<span class="keyword">)</span> <span class="keyword">then</span>
          <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24796"><span class="dyncstuse">s2eff_contain_eff</span></a> <span class="keyword">(</span>s2fe<span class="keyword">,</span> x<span class="keyword">)</span> <span class="keyword">then</span> aux <span class="keyword">(</span>xs<span class="keyword">)</span> <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
        <span class="keyword">else</span> aux <span class="keyword">(</span>xs<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="comment">// end of [aux]
</span><span class="keyword">in</span>
  aux <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5feffect_2esats.html#1870"><span class="dyncstuse">$Eff<span class="keyword">.</span>effectlst_all</span></a><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2eff_contain_effset]
</span>
<span class="comment">// ------------------------------------------------
</span>
<span class="keyword">fun</span> s2exp_contain_effvar
  <span class="keyword">(</span>s2e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span><span class="keyword">,</span> s2v0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#35358"><span class="dyncstuse">s2exp_whnf</span></a> s2e
<span class="keyword">in</span>
  <span class="keyword">case+</span> s2e<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Eeff s2fe <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24913"><span class="dyncstuse">s2eff_contain_effvar</span></a> <span class="keyword">(</span>s2fe<span class="keyword">,</span> s2v0<span class="keyword">)</span>
  <span class="keyword">|</span> S2Evar s2v <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#17339"><span class="dyncstuse">eq_s2var_s2var</span></a> <span class="keyword">(</span>s2v0<span class="keyword">,</span> s2v<span class="keyword">)</span>
  <span class="keyword">|</span> S2EVar s2V <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      prerr <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19041"><span class="dyncstuse">s2Var_loc_get</span></a> s2V<span class="keyword">)</span><span class="keyword">;</span>
      prerr ": INTERNAL WARNING (ats_staexp2_util1)"<span class="keyword">;</span>
      prerr ": s2exp_contain_effvar: s2e = "<span class="keyword">;</span> prerr s2e<span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2EVar]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2exp_contain_effvar]
</span>
<span class="keyword">and</span> s2explst_contain_effvar <span class="keyword">(</span>s2es0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span><span class="keyword">,</span> s2v0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2es0 <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> s2exp_contain_effvar <span class="keyword">(</span>s2e<span class="keyword">,</span> s2v0<span class="keyword">)</span> <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
      <span class="keyword">else</span> s2explst_contain_effvar <span class="keyword">(</span>s2es<span class="keyword">,</span> s2v0<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a> <span class="comment">// end of [list_nil]
</span><span class="comment">// end of [s2explist_contain_effvar]
</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24913"><span class="dyncstimp">s2eff_contain_effvar</span></a> <span class="keyword">(</span>s2fe<span class="keyword">,</span> s2v<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2fe <span class="keyword">of</span>
  <span class="keyword">|</span> S2EFFall <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> S2EFFnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> S2EFFset <span class="keyword">(</span>efs<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> s2explst_contain_effvar <span class="keyword">(</span>s2es<span class="keyword">,</span> s2v<span class="keyword">)</span>
<span class="comment">// end of [s2eff_contain_effvar]
</span>
<span class="comment">// ------------------------------------------------
</span>
<span class="keyword">fun</span> s2eff_contain_s2exp
  <span class="keyword">(</span>s2fe1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5355"><span class="stacstuse">s2eff</span></a></span><span class="keyword">,</span> s2e2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> s2e2 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#35358"><span class="dyncstuse">s2exp_whnf</span></a> s2e2
<span class="keyword">in</span>
  <span class="keyword">case+</span> s2e2<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Eeff s2fe2 <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24967"><span class="dyncstuse">s2eff_contain_s2eff</span></a> <span class="keyword">(</span>s2fe1<span class="keyword">,</span> s2fe2<span class="keyword">)</span>
  <span class="keyword">|</span> S2Evar s2v2 <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24913"><span class="dyncstuse">s2eff_contain_effvar</span></a> <span class="keyword">(</span>s2fe1<span class="keyword">,</span> s2v2<span class="keyword">)</span>
  <span class="keyword">|</span> S2EVar s2V2 <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      prerr <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19041"><span class="dyncstuse">s2Var_loc_get</span></a> s2V2<span class="keyword">)</span><span class="keyword">;</span>
      prerr ": INTERNAL WARNING"<span class="keyword">;</span>
      prerr ": s2eff_contain_s2exp: s2e2 = "<span class="keyword">;</span> prerr s2e2<span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2EVar]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2eff_contain_s2exp]
</span>
<span class="keyword">and</span> s2eff_contain_s2explst <span class="keyword">(</span>s2fe<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5355"><span class="stacstuse">s2eff</span></a></span><span class="keyword">,</span> s2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2es <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> s2eff_contain_s2exp <span class="keyword">(</span>s2fe<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">then</span> s2eff_contain_s2explst <span class="keyword">(</span>s2fe<span class="keyword">,</span> s2es<span class="keyword">)</span>
      <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2eff_contain_s2explst]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24967"><span class="dyncstimp">s2eff_contain_s2eff</span></a> <span class="keyword">(</span>s2fe1<span class="keyword">,</span> s2fe2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2fe1 <span class="keyword">of</span>
  <span class="keyword">|</span> S2EFFall <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2fe2 <span class="keyword">of</span>
    <span class="keyword">|</span> S2EFFall <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24853"><span class="dyncstuse">s2eff_contain_effset</span></a> <span class="keyword">(</span>s2fe1<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5feffect_2esats.html#2644"><span class="dyncstuse">$Eff<span class="keyword">.</span>effset_all</span></a><span class="keyword">)</span>
    <span class="keyword">|</span> S2EFFnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
    <span class="keyword">|</span> S2EFFset <span class="keyword">(</span>efs<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#24853"><span class="dyncstuse">s2eff_contain_effset</span></a> <span class="keyword">(</span>s2fe1<span class="keyword">,</span> efs<span class="keyword">)</span> <span class="keyword">then</span>
          s2eff_contain_s2explst <span class="keyword">(</span>s2fe1<span class="keyword">,</span> s2es<span class="keyword">)</span>
        <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
      <span class="keyword">end</span> <span class="comment">// end of [S2EFFset]
</span>    <span class="keyword">end</span> <span class="comment">// end of [_]
</span><span class="comment">// end of [s2eff_contain_s2eff]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#25040"><span class="dyncstimp">s2lab_syneq</span></a> <span class="keyword">(</span>s2l1<span class="keyword">,</span> s2l2<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>s2l1<span class="keyword">,</span> s2l2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2LAB0lab l1<span class="keyword">,</span> S2LAB0lab l2<span class="keyword">)</span> <span class="keyword">=&gt;</span> l1 <span class="keyword">=</span> l2
  <span class="keyword">|</span> <span class="keyword">(</span>S2LAB1lab <span class="keyword">(</span>l1<span class="keyword">,</span> _<span class="keyword">)</span><span class="keyword">,</span> S2LAB1lab <span class="keyword">(</span>l2<span class="keyword">,</span> _<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> l1 <span class="keyword">=</span> l2
  <span class="keyword">|</span> <span class="keyword">(</span>S2LAB0ind s2ess1<span class="keyword">,</span> S2LAB0ind s2ess2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34759"><span class="dyncstuse">s2explstlst_syneq</span></a> <span class="keyword">(</span>s2ess1<span class="keyword">,</span> s2ess2<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2LAB1ind <span class="keyword">(</span>s2ess1<span class="keyword">,</span> _<span class="keyword">)</span><span class="keyword">,</span> S2LAB1ind <span class="keyword">(</span>s2ess2<span class="keyword">,</span> _<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34759"><span class="dyncstuse">s2explstlst_syneq</span></a> <span class="keyword">(</span>s2ess1<span class="keyword">,</span> s2ess2<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2LAB1ind, S2LAB1ind]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span>  _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2lab_syneq]
</span>
<span class="comment">//
</span><span class="comment">// the function is used in
</span><span class="comment">// [ats_trans3_assgn, ats_trans3_deref, ats_trans3_view]
</span><span class="comment">//
</span><span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#25083"><span class="dyncstimp">s2lablst_trim_s2lablst_s2lablst</span></a>
  <span class="keyword">(</span>s2ls0_ft<span class="keyword">,</span> s2ls_ft<span class="keyword">,</span> s2ls_bk<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">(*
  val () = begin
    print "s2lablst_trim_s2lablst_s2lablst: s2ls0_ft = "; print_s2lablst s2ls0_ft; print_newline ();
    print "s2lablst_trim_s2lablst_s2lablst: s2ls_ft = "; print_s2lablst s2ls_ft; print_newline ();
    print "s2lablst_trim_s2lablst_s2lablst: s2ls_bk = "; print_s2lablst s2ls_bk; print_newline ();
  end // end of [val]
*)</span>
  <span class="keyword">fun</span> aux <span class="keyword">(</span>
      s2ls1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9196"><span class="stacstuse">s2lablst</span></a></span><span class="keyword">,</span> s2ls2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9196"><span class="stacstuse">s2lablst</span></a></span>
    <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9196"><span class="stacstuse">s2lablst</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
    <span class="keyword">case+</span> s2ls1 <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>_<span class="keyword">,</span> s2ls1<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2ls2 <span class="keyword">of</span>
      <span class="keyword">|</span> list_cons <span class="keyword">(</span>_<span class="keyword">,</span> s2ls2<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>s2ls1<span class="keyword">,</span> s2ls2<span class="keyword">)</span>
      <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          prerr_interror <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span> prerr ": s2lablst_trim"<span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
          <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9196"><span class="stacstuse">s2lablst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [_]
</span>      <span class="keyword">end</span> <span class="comment">(* end of [list_cons] *)</span>
    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2ls2
  <span class="keyword">end</span> <span class="comment">// end of [aux]
</span><span class="keyword">in</span>
  <span class="keyword">case+</span> s2ls0_ft <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>_<span class="keyword">,</span> s2ls0_ft1<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2ls_ft <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>_<span class="keyword">,</span> s2ls_ft<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#25083"><span class="dyncstuse">s2lablst_trim_s2lablst_s2lablst</span></a> <span class="keyword">(</span>s2ls0_ft1<span class="keyword">,</span> s2ls_ft<span class="keyword">,</span> s2ls_bk<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [val]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> aux <span class="keyword">(</span>s2ls0_ft<span class="keyword">,</span> s2ls_bk<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#1736"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_append</span></a> <span class="keyword">(</span>s2ls_ft<span class="keyword">,</span> s2ls_bk<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2lablst_trim_s2lablst_s2lablst]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26640"><span class="dyncstimp">s2exp_is_proof</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10953"><span class="dyncstuse">s2rt_is_proof</span></a> <span class="keyword">(</span>s2e<span class="keyword">.</span>s2exp_srt<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26678"><span class="dyncstimp">s2exp_is_proof_fun</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10989"><span class="dyncstuse">s2rt_is_proof_fun</span></a> <span class="keyword">(</span>s2e<span class="keyword">.</span>s2exp_srt<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26720"><span class="dyncstimp">s2exp_is_linear</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10875"><span class="dyncstuse">s2rt_is_linear</span></a> <span class="keyword">(</span>s2e<span class="keyword">.</span>s2exp_srt<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26759"><span class="dyncstimp">s2exp_is_nonlin</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10875"><span class="dyncstuse">s2rt_is_linear</span></a> s2e<span class="keyword">.</span>s2exp_srt <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a> <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
<span class="comment">// end of [s2exp_is_nonlin]
</span><span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26798"><span class="dyncstimp">s2exp_is_impredicative</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11109"><span class="dyncstuse">s2rt_is_impredicative</span></a> <span class="keyword">(</span>s2e<span class="keyword">.</span>s2exp_srt<span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26844"><span class="dyncstimp">s2exp_is_types</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10817"><span class="dyncstuse">s2rt_is_types</span></a> <span class="keyword">(</span>s2e<span class="keyword">.</span>s2exp_srt<span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26883"><span class="dyncstimp">s2exp_is_abscon</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2e<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Ecst s2c <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#15747"><span class="dyncstuse">s2cst_is_abstract</span></a> s2c <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#14092"><span class="dyncstuse">s2cst_iscon_get</span></a> s2c
    <span class="keyword">end</span> <span class="comment">// end of [S2Ecst]
</span>  <span class="keyword">|</span> S2Eapp <span class="keyword">(</span>s2e<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26883"><span class="dyncstuse">s2exp_is_abscon</span></a> s2e
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end  of [s2exp_is_abscon]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26923"><span class="dyncstimp">s2exp_is_non_fun</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2e<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Efun _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> S2EVar _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> S2Eexi <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26923"><span class="dyncstuse">s2exp_is_non_fun</span></a> s2e
  <span class="keyword">|</span> S2Euni <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26923"><span class="dyncstuse">s2exp_is_non_fun</span></a> s2e
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
<span class="comment">// end of [s2exp_is_non_fun]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26963"><span class="dyncstimp">s2exp_is_non_tyrec</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2e<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Etyrec _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> S2EVar _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">|</span> S2Eexi <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26963"><span class="dyncstuse">s2exp_is_non_tyrec</span></a> s2e
  <span class="keyword">|</span> S2Euni <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26963"><span class="dyncstuse">s2exp_is_non_tyrec</span></a> s2e
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
<span class="comment">// end of [s2exp_is_non_tyrec]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#27006"><span class="dyncstimp">s2exp_is_wth</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> s2e<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Eexi <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#27006"><span class="dyncstuse">s2exp_is_wth</span></a> s2e <span class="keyword">|</span> S2Ewth _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [s2exp_is_wth]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32461"><span class="dyncstimp">s2exp_head_get</span></a> <span class="keyword">(</span>s2e0<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> loop <span class="keyword">(</span>s2e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> s2e<span class="keyword">.</span>s2exp_node <span class="keyword">of</span> S2Eapp <span class="keyword">(</span>s2e<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> loop s2e <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> s2e
  <span class="comment">// end of [loop]
</span><span class="keyword">in</span>
  loop <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#35358"><span class="dyncstuse">s2exp_whnf</span></a> s2e0<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2exp_head_get]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> lte_s2explst_s2rtlst
  <span class="keyword">(</span>s2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span><span class="keyword">,</span> s2ts<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8800"><span class="stacstuse">s2rtlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>s2es<span class="keyword">,</span> s2ts<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>s2e :: s2es<span class="keyword">,</span> s2t :: s2ts<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
<span class="comment">(*
      print "lte_s2explst_s2rtlst: srt = ";
      print s2t; print_newline ();
      print "lte_s2explst_s2rtlst: s2e.s2exp_srt = ";
      print s2e.s2exp_srt; print_newline ();
*)</span>
      <span class="keyword">if</span> s2e<span class="keyword">.</span>s2exp_srt &lt;= s2t <span class="keyword">then</span>
        lte_s2explst_s2rtlst <span class="keyword">(</span>s2es<span class="keyword">,</span> s2ts<span class="keyword">)</span>
      <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [::, ::]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="comment">// end of [lte_s2explst_s2rtlst]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32499"><span class="dyncstimp">s2cst_select_s2explstlst</span></a> <span class="keyword">(</span>s2cs<span class="keyword">,</span> s2ess<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> test <span class="keyword">(</span>s2t_fun<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4120"><span class="stacstuse">s2rt</span></a></span><span class="keyword">,</span> s2ess<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> s2ess <span class="keyword">of</span>
    <span class="keyword">|</span> s2es :: s2ess <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#12774"><span class="dyncstuse">un_s2rt_fun</span></a> s2t_fun <span class="keyword">of</span>
      <span class="keyword">|</span> <span class="keyword">~</span>Some_vt s2ts_s2t <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          <span class="keyword">if</span> lte_s2explst_s2rtlst <span class="keyword">(</span>s2es<span class="keyword">,</span> s2ts_s2t<span class="keyword">.</span>0<span class="keyword">)</span> <span class="keyword">then</span> test <span class="keyword">(</span>s2ts_s2t<span class="keyword">.</span>1<span class="keyword">,</span> s2ess<span class="keyword">)</span>
          <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
        <span class="keyword">end</span> <span class="comment">// end of [Some]
</span>      <span class="keyword">|</span> <span class="keyword">~</span>None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
      <span class="keyword">end</span>
    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">fun</span> filter <span class="keyword">(</span>s2cs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span><span class="keyword">,</span> s2ess<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> s2cs <span class="keyword">of</span>
    <span class="keyword">|</span> S2CSTLSTcons <span class="keyword">(</span>s2c<span class="keyword">,</span> s2cs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
<span class="comment">(*
        print "s2cst_select_s2explstlst: filter: s2c = ";
        print s2c;
        print_newline ();
        print "s2cst_select_s2explstlst: filter: s2c_s2t = ";
        print (s2cst_srt_get s2c);
        print_newline ();
*)</span>
        <span class="keyword">if</span> test <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#14003"><span class="dyncstuse">s2cst_srt_get</span></a> s2c<span class="keyword">,</span> s2ess<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">begin</span>
          S2CSTLSTcons <span class="keyword">(</span>s2c<span class="keyword">,</span> filter <span class="keyword">(</span>s2cs<span class="keyword">,</span> s2ess<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span>
          filter <span class="keyword">(</span>s2cs<span class="keyword">,</span> s2ess<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">(* end of [if] *)</span>
      <span class="keyword">end</span> <span class="comment">// end of [S2CSTLSTcons]
</span>    <span class="keyword">|</span> S2CSTLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> S2CSTLSTnil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">in</span>
  filter <span class="keyword">(</span>s2cs<span class="keyword">,</span> s2ess<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2cst_select_s2explstlst]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32569"><span class="dyncstimp">s2rt_lin_prg_boxed</span></a> <span class="keyword">(</span>lin<span class="keyword">,</span> prg<span class="keyword">,</span> boxed<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">if</span> lin <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <span class="keyword">begin</span>
    <span class="keyword">if</span> prg <span class="keyword">&gt;</span> 0 <span class="keyword">then</span>
      <span class="keyword">if</span> boxed <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10355"><span class="dyncstuse">s2rt_viewtype</span></a> <span class="keyword">else</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10380"><span class="dyncstuse">s2rt_viewt0ype</span></a>
    <span class="keyword">else</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10334"><span class="dyncstuse">s2rt_view</span></a>
  <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span>
    <span class="keyword">if</span> prg <span class="keyword">&gt;</span> 0 <span class="keyword">then</span>
      <span class="keyword">if</span> boxed <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10291"><span class="dyncstuse">s2rt_type</span></a> <span class="keyword">else</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10312"><span class="dyncstuse">s2rt_t0ype</span></a>
    <span class="keyword">else</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10270"><span class="dyncstuse">s2rt_prop</span></a>
  <span class="keyword">end</span> <span class="comment">(* end of [if] *)</span>
<span class="comment">// end of [s2rt_lin_prg_boxed]
</span>
<span class="keyword">fn</span> labs2explst_is_singleton
  <span class="keyword">(</span>npf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> ls2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#23028"><span class="stacstuse">Option_vt</span></a> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux0 <span class="keyword">(</span>npf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> ls2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#23028"><span class="stacstuse">Option_vt</span></a> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span> <span class="keyword">=</span>
    <span class="keyword">if</span> npf <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <span class="keyword">begin</span> <span class="keyword">case+</span> ls2es <span class="keyword">of</span>
      <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux0 <span class="keyword">(</span>npf - 1<span class="keyword">,</span> ls2es<span class="keyword">)</span>
      <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> None_vt <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span> <span class="keyword">case+</span> ls2es <span class="keyword">of</span>
      <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>_<span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26640"><span class="dyncstuse">s2exp_is_proof</span></a> s2e <span class="keyword">then</span> aux0 <span class="keyword">(</span>0<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">else</span> aux1 <span class="keyword">(</span>s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [LABS2EXPLSTcons]
</span>      <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> None_vt <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [if]
</span>  <span class="comment">// end of [aux0]
</span>  <span class="keyword">and</span> aux1 <span class="keyword">(</span>s2e0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span><span class="keyword">,</span> ls2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#23028"><span class="stacstuse">Option_vt</span></a> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> ls2es <span class="keyword">of</span>
    <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>_<span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26640"><span class="dyncstuse">s2exp_is_proof</span></a> s2e <span class="keyword">then</span> aux1 <span class="keyword">(</span>s2e0<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">else</span> None_vt <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// endof [LABS2EXPLSTcons]
</span>    <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> Some_vt s2e0
  <span class="comment">// end of [aux1]
</span><span class="keyword">in</span>
  aux0 <span class="keyword">(</span>npf<span class="keyword">,</span> ls2es<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">(* end of [labs2explst_is_singleton] *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32631"><span class="dyncstimp">s2rt_lin_prg_boxed_npf_labs2explst</span></a>
  <span class="keyword">(</span>lin<span class="keyword">,</span> prg<span class="keyword">,</span> boxed<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> s2t <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32569"><span class="dyncstuse">s2rt_lin_prg_boxed</span></a> <span class="keyword">(</span>lin<span class="keyword">,</span> prg<span class="keyword">,</span> boxed<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">if</span> prg <span class="keyword">&gt;</span> 0 <span class="keyword">then</span>
    <span class="keyword">if</span> boxed <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> s2t <span class="keyword">else</span> <span class="keyword">let</span>
      <span class="keyword">val</span> os2e <span class="keyword">=</span> labs2explst_is_singleton <span class="keyword">(</span>npf<span class="keyword">,</span> ls2es<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">case+</span> os2e <span class="keyword">of</span>
      <span class="keyword">|</span> <span class="keyword">~</span>Some_vt s2e <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> s2t <span class="keyword">=</span> s2e<span class="keyword">.</span>s2exp_srt
        <span class="keyword">in</span>
          <span class="keyword">if</span> lin <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#11413"><span class="dyncstuse">s2rt_linearize</span></a> s2t <span class="keyword">else</span> s2t
        <span class="keyword">end</span> <span class="comment">// end of [Some_vt]
</span>      <span class="keyword">|</span> <span class="keyword">~</span>None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2t <span class="comment">// end of [None_vt]
</span>    <span class="keyword">end</span> <span class="comment">// end of [if]
</span>  <span class="keyword">else</span> s2t <span class="comment">// end of [if]
</span><span class="keyword">end</span> <span class="comment">// end of [s2rt_lin_prg_boxed_npf_labs2explst]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31680"><span class="dyncstimp">s2exp_tyrec</span></a> <span class="keyword">(</span>recknd<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> tyrecknd<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#3563"><span class="stacstuse">tyreckind</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> recknd <span class="keyword">of</span>
    <span class="keyword">|</span> 0 <span class="keyword">=&gt;</span> TYRECKINDflt0 <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> TYRECKINDbox <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">var</span> lin<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0 <span class="keyword">and</span> prg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0
  <span class="keyword">fun</span> aux01
    <span class="keyword">(</span>i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> npf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> ls2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span><span class="keyword">,</span> lin<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> prg<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> ls2es <span class="keyword">of</span>
    <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>_<span class="comment">(*lab*)</span><span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> s2t <span class="keyword">=</span> s2e<span class="keyword">.</span>s2exp_srt
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10875"><span class="dyncstuse">s2rt_is_linear</span></a> s2t <span class="keyword">then</span> <span class="keyword">(</span>lin := lin+1<span class="keyword">)</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
          <span class="keyword">if</span> i &gt;= npf <span class="keyword">then</span> <span class="keyword">(</span><span class="keyword">if</span> <span class="keyword">~</span><span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10953"><span class="dyncstuse">s2rt_is_proof</span></a> s2t<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">(</span>prg := prg+1<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span>
      <span class="keyword">in</span>
        aux01 <span class="keyword">(</span>i+1<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">,</span> lin<span class="keyword">,</span> prg<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [LABS2EXPLSTcons]
</span>    <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux01]
</span>  <span class="keyword">val</span> s2t_rec <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> recknd <span class="keyword">of</span>
    <span class="keyword">|</span> 0 <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux01 <span class="keyword">(</span>0<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">,</span> lin<span class="keyword">,</span> prg<span class="keyword">)</span>
      <span class="keyword">in</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32631"><span class="dyncstuse">s2rt_lin_prg_boxed_npf_labs2explst</span></a> <span class="keyword">(</span>lin<span class="keyword">,</span> prg<span class="keyword">,</span> 0<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> 1 <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux01 <span class="keyword">(</span>0<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">,</span> lin<span class="keyword">,</span> prg<span class="keyword">)</span>
      <span class="keyword">in</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32569"><span class="dyncstuse">s2rt_lin_prg_boxed</span></a> <span class="keyword">(</span>lin<span class="keyword">,</span> prg<span class="keyword">,</span> 1<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> 2 <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10291"><span class="dyncstuse">s2rt_type</span></a> <span class="comment">// $rec_t/$tup_t
</span>    <span class="keyword">|</span> 3 <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10355"><span class="dyncstuse">s2rt_viewtype</span></a> <span class="comment">// $rec_vt/$tup_vt
</span>    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        prerr_interror <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
        prerr ": s2exp_tyrec: recknd = "<span class="keyword">;</span> prerr recknd<span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4120"><span class="stacstuse">s2rt</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [_]
</span>  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4120"><span class="stacstuse">s2rt</span></a></span>
<span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31747"><span class="dyncstuse">s2exp_tyrec_srt</span></a> <span class="keyword">(</span>s2t_rec<span class="keyword">,</span> tyrecknd<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2exp_tyrec]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31898"><span class="dyncstimp">s2exp_union</span></a> <span class="keyword">(</span>isbox<span class="keyword">,</span> stamp<span class="keyword">,</span> s2i<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux1 <span class="keyword">(</span>ls2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span><span class="keyword">,</span> lin<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> ls2es <span class="keyword">of</span>
    <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>_<span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10875"><span class="dyncstuse">s2rt_is_linear</span></a> <span class="keyword">(</span>s2e<span class="keyword">.</span>s2exp_srt<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">(</span>lin := 1 + lin<span class="keyword">)</span><span class="keyword">;</span>
        aux1 <span class="keyword">(</span>ls2es<span class="keyword">,</span> lin<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [LABS2EXPLSTcons]
</span>    <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux1]
</span>  <span class="keyword">fun</span> aux2 <span class="keyword">(</span>ls2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span><span class="keyword">,</span> i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9455"><span class="stacstuse">s2expopt_vt</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> ls2es <span class="keyword">of</span>
    <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>_<span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span>
        <span class="keyword">if</span> i <span class="keyword">=</span> 0 <span class="keyword">then</span> Some_vt <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">else</span> aux2 <span class="keyword">(</span>ls2es<span class="keyword">,</span> i-1<span class="keyword">)</span>
      <span class="comment">// end of [LABS2EXPLSTcons]
</span>    <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> None_vt <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux2]
</span>  <span class="keyword">var</span> lin<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0
  <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> s2i<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
    <span class="keyword">|</span> S2Eint i <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
       <span class="keyword">if</span> i &gt;= 0 <span class="keyword">then</span> <span class="keyword">begin</span> <span class="keyword">case+</span> aux2 <span class="keyword">(</span>ls2es<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">of</span>
          <span class="keyword">|</span> <span class="keyword">~</span>Some_vt s2e <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
              <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26720"><span class="dyncstuse">s2exp_is_linear</span></a> s2e <span class="keyword">then</span> lin := 1 <span class="keyword">else</span> lin := 0
            <span class="keyword">end</span>
          <span class="keyword">|</span> <span class="keyword">~</span>None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>lin := 0<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">(</span>lin := 0<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [S2Eint]
</span>    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> aux1 <span class="keyword">(</span>ls2es<span class="keyword">,</span> lin<span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span>
  <span class="keyword">val</span> s2t_union <span class="keyword">=</span> <span class="keyword">(</span>
    <span class="keyword">if</span> lin <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> isbox <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10355"><span class="dyncstuse">s2rt_viewtype</span></a> <span class="keyword">else</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10380"><span class="dyncstuse">s2rt_viewt0ype</span></a>
    <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> isbox <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10291"><span class="dyncstuse">s2rt_type</span></a> <span class="keyword">else</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10312"><span class="dyncstuse">s2rt_t0ype</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [if]
</span>  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4120"><span class="stacstuse">s2rt</span></a></span>
<span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31985"><span class="dyncstuse">s2exp_union_srt</span></a> <span class="keyword">(</span>s2t_union<span class="keyword">,</span> stamp<span class="keyword">,</span> s2i<span class="keyword">,</span> ls2es<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2exp_union]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32810"><span class="dyncstimp">s2kexp_make_s2exp</span></a> <span class="keyword">(</span>s2e0<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> aux_s2var
    <span class="keyword">(</span>s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2v0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4468"><span class="stacstuse">s2kexp</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> s2vss <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2vss<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">fun</span> test <span class="keyword">(</span>s2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span><span class="keyword">,</span> s2v0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span>
          <span class="keyword">case+</span> s2vs <span class="keyword">of</span>
          <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2v<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
              <span class="keyword">if</span> s2v <span class="keyword">=</span> s2v0 <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> test <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2v0<span class="keyword">)</span>
            <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>          <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
      <span class="keyword">in</span>
        <span class="keyword">if</span> test <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2v0<span class="keyword">)</span> <span class="keyword">then</span> S2KEany <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">else</span> aux_s2var <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2v0<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> S2KEvar s2v0
  <span class="comment">// end of [aux_s2var]
</span>
  <span class="keyword">fun</span> aux_s2exp
    <span class="keyword">(</span>pol<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2e0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4468"><span class="stacstuse">s2kexp</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
    <span class="keyword">val</span> s2e0 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#35358"><span class="dyncstuse">s2exp_whnf</span></a> s2e0 <span class="keyword">in</span> <span class="keyword">case+</span> s2e0<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
      <span class="keyword">|</span> S2Eapp <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> s2ke <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>0<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
          <span class="keyword">val</span> s2kes <span class="keyword">=</span> aux_s2explst_arg <span class="keyword">(</span>0<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2es<span class="keyword">)</span>
        <span class="keyword">in</span>
          <span class="keyword">case+</span> s2kes <span class="keyword">of</span>
          <span class="keyword">|</span> list_cons _ <span class="keyword">=&gt;</span> S2KEapp <span class="keyword">(</span>s2ke<span class="keyword">,</span> s2kes<span class="keyword">)</span> <span class="keyword">|</span> list_nil _ <span class="keyword">=&gt;</span> s2ke
        <span class="keyword">end</span> <span class="comment">// end of [S2Eapp]
</span>      <span class="keyword">|</span> S2Ecst s2c <span class="keyword">=&gt;</span> S2KEcst s2c
      <span class="keyword">|</span> S2Eexi <span class="keyword">(</span>s2vs<span class="keyword">,</span> _<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>pol<span class="keyword">,</span> s2vs :: s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">|</span> S2Efun <span class="keyword">(</span>fc<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> s2e_res<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> s2kes_arg <span class="keyword">=</span> aux_s2explst <span class="keyword">(</span>0<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2es_arg<span class="keyword">)</span>
          <span class="keyword">val</span> s2ke_res <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>0<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2e_res<span class="keyword">)</span>
        <span class="keyword">in</span>
          S2KEfun <span class="keyword">(</span>fc<span class="keyword">,</span> s2kes_arg<span class="keyword">,</span> s2ke_res<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [S2Efun]
</span><span class="comment">(*
// HX-2010-12-04: inadequate design
      | S2Enamed (_(*name*), s2e) =&gt; aux_s2exp (pol, s2vss, s2e)
*)</span>
      <span class="keyword">|</span> S2Eread <span class="keyword">(</span>_<span class="comment">(*view*)</span><span class="keyword">,</span> s2e_vt<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2e_vt<span class="keyword">)</span>
      <span class="keyword">|</span> S2Erefarg <span class="keyword">(</span>_<span class="comment">(*knd*)</span><span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">|</span> S2Etyarr _ <span class="keyword">=&gt;</span> S2KEtyarr <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">|</span> S2Etyrec <span class="keyword">(</span>knd<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> ls2kes <span class="keyword">=</span> aux_labs2explst <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> ls2es<span class="keyword">)</span>
        <span class="keyword">in</span>
          S2KEtyrec <span class="keyword">(</span>knd<span class="keyword">,</span> ls2kes<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [S2Etyrec]
</span>      <span class="keyword">|</span> S2Euni <span class="keyword">(</span>s2vs<span class="keyword">,</span> _<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>pol<span class="keyword">,</span> s2vs :: s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">|</span> S2Evar s2v <span class="keyword">=&gt;</span> aux_s2var <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2v<span class="keyword">)</span>
      <span class="keyword">|</span> S2EVar s2V <span class="keyword">=&gt;</span> aux_s2Var <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2V<span class="keyword">)</span>
      <span class="keyword">|</span> S2Ewth <span class="keyword">(</span>s2e<span class="keyword">,</span> _<span class="comment">(*wths2es*)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> S2KEany <span class="keyword">(</span><span class="keyword">)</span>
   <span class="keyword">end</span> <span class="comment">// end of [aux_s2exp]
</span>
  <span class="keyword">and</span> aux_s2explst <span class="keyword">(</span>pol<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9167"><span class="stacstuse">s2kexplst</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> s2es <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> list_cons
        <span class="keyword">(</span>aux_s2exp <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span><span class="keyword">,</span> aux_s2explst <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2es<span class="keyword">)</span><span class="keyword">)</span>
      <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux_s2explst]
</span>
  <span class="keyword">and</span> aux_s2Varboundlst
    <span class="keyword">(</span>pol<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2Vbs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2750"><span class="stacstuse">s2Varboundlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9167"><span class="stacstuse">s2kexplst</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> s2Vbs <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2Vb<span class="keyword">,</span> s2Vbs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> s2ke <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19815"><span class="dyncstuse">s2Varbound_val_get</span></a> s2Vb<span class="keyword">)</span>
      <span class="keyword">in</span>
        list_cons <span class="keyword">(</span>s2ke<span class="keyword">,</span> aux_s2Varboundlst <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2Vbs<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux_s2Varboundlst]
</span>
  <span class="keyword">and</span> aux_labs2explst
    <span class="keyword">(</span>pol<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> ls2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4735"><span class="stacstuse">labs2kexplst</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> ls2es <span class="keyword">of</span>
    <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> LABS2KEXPLSTcons
        <span class="keyword">(</span>l<span class="keyword">,</span> aux_s2exp <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span><span class="keyword">,</span> aux_labs2explst <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> ls2es<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> LABS2KEXPLSTnil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux_labs2explst]
</span>
  <span class="keyword">and</span> aux_s2explst_arg <span class="keyword">(</span>pol<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9167"><span class="stacstuse">s2kexplst</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> s2es <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#26798"><span class="dyncstuse">s2exp_is_impredicative</span></a> s2e <span class="keyword">then</span> list_cons
          <span class="keyword">(</span>aux_s2exp <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span><span class="keyword">,</span> aux_s2explst <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2es<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">else</span> aux_s2explst <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> s2es<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux_s2explst_arg]
</span>
  <span class="keyword">and</span> aux_s2Var
    <span class="keyword">(</span>pol<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span><span class="keyword">,</span> s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2V<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4468"><span class="stacstuse">s2kexp</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
    <span class="keyword">if</span> pol <span class="keyword">&gt;</span> 0 <span class="keyword">then</span>
      S2KEunion <span class="keyword">(</span>aux_s2Varboundlst <span class="keyword">(</span>pol<span class="keyword">,</span> s2vss<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19347"><span class="dyncstuse">s2Var_lbs_get</span></a> s2V<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">else</span> S2KEany <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [aux_s2Var]
</span><span class="keyword">in</span>
  aux_s2exp <span class="keyword">(</span>1<span class="keyword">,</span> list_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> s2e0<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2kexp_make]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> s2kexp_match_union_approx
  <span class="keyword">(</span>s2kes1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9167"><span class="stacstuse">s2kexplst</span></a></span><span class="keyword">,</span> s2ke2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4468"><span class="stacstuse">s2kexp</span></a></span><span class="keyword">,</span> approx<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2kes1 <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2ke1<span class="keyword">,</span> s2kes1<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32854"><span class="dyncstuse">s2kexp_match_approx</span></a> <span class="keyword">(</span>1<span class="keyword">,</span> s2ke1<span class="keyword">,</span> s2ke2<span class="keyword">,</span> approx<span class="keyword">)</span> <span class="keyword">then</span>
        s2kexp_match_union_approx <span class="keyword">(</span>s2kes1<span class="keyword">,</span> s2ke2<span class="keyword">,</span> approx<span class="keyword">)</span>
      <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">(* end of [list_cons] *)</span>
  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
<span class="keyword">end</span> <span class="comment">// end of [s2kexp_match_union]
</span>
<span class="keyword">fun</span> s2kexp_match_union
  <span class="keyword">(</span>s2kes1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9167"><span class="stacstuse">s2kexplst</span></a></span><span class="keyword">,</span> s2ke2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4468"><span class="stacstuse">s2kexp</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">var</span> approx<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0 <span class="keyword">in</span>
  s2kexp_match_union_approx <span class="keyword">(</span>s2kes1<span class="keyword">,</span> s2ke2<span class="keyword">,</span> approx<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2kexp_match_union]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32854"><span class="dyncstimp">s2kexp_match_approx</span></a> <span class="keyword">(</span>pol<span class="keyword">,</span> s2ke1<span class="keyword">,</span> s2ke2<span class="keyword">,</span> approx<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">(*
  val () = begin
    print "s2kexp_match_approx: s2ke1 = "; print s2ke1; print_newline ();
    print "s2kexp_match_approx: s2ke2 = "; print s2ke2; print_newline ();
  end // end of [val]
*)</span>
  <span class="keyword">val</span> ret <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> <span class="keyword">(</span>s2ke1<span class="keyword">,</span> s2ke2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2KEany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="comment">// no information
</span>  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> S2KEany <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="comment">// no information
</span>  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> S2KEunion _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="comment">// no information
</span>  <span class="keyword">|</span> <span class="keyword">(</span>S2KEapp <span class="keyword">(</span>s2ke11<span class="keyword">,</span> s2kes12<span class="keyword">)</span><span class="keyword">,</span> S2KEapp <span class="keyword">(</span>s2ke21<span class="keyword">,</span> s2kes22<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32854"><span class="dyncstuse">s2kexp_match_approx</span></a> <span class="keyword">(</span>0<span class="keyword">,</span> s2ke11<span class="keyword">,</span> s2ke21<span class="keyword">,</span> approx<span class="keyword">)</span>
        <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32934"><span class="dyncstuse">s2kexplst_match_approx</span></a> <span class="keyword">(</span>0<span class="keyword">,</span> s2kes12<span class="keyword">,</span> s2kes22<span class="keyword">,</span> approx<span class="keyword">)</span>
      <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2KEapp, S2KEapp]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>S2KEcst s2c1<span class="keyword">,</span> S2KEcst s2c2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> s2c1 <span class="keyword">=</span> s2c2 <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> <span class="keyword">begin</span>
        <span class="keyword">if</span> pol <span class="keyword">&gt;</span> 0 <span class="keyword">then</span>
          <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#15829"><span class="dyncstuse">s2cst_is_eqsup</span></a> <span class="keyword">(</span>s2c1<span class="keyword">,</span> s2c2<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">(</span>approx := approx + 1<span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a><span class="keyword">)</span>
          <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
        <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
      <span class="keyword">end</span> <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [S2KEcst, S2KEcst]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>S2KEfun <span class="keyword">(</span>fc1<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span><span class="keyword">,</span> S2KEfun <span class="keyword">(</span>fc2<span class="keyword">,</span> _<span class="keyword">,</span> _<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
       <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fsyntax_2esats.html#15718"><span class="dyncstuse">$Syn<span class="keyword">.</span>eq_funclo_funclo</span></a> <span class="keyword">(</span>fc1<span class="keyword">,</span> fc2<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2KEfun, S2KEfun]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>S2KEtyarr _<span class="keyword">,</span> S2KEtyarr _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>S2KEtyrec <span class="keyword">(</span>knd1<span class="keyword">,</span> ls2kes1<span class="keyword">)</span><span class="keyword">,</span> S2KEtyrec <span class="keyword">(</span>knd2<span class="keyword">,</span> ls2kes2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> knd1 <span class="keyword">=</span> knd2 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33058"><span class="dyncstuse">labs2kexplst_match_approx</span></a> <span class="keyword">(</span>pol<span class="keyword">,</span> ls2kes1<span class="keyword">,</span> ls2kes2<span class="keyword">,</span> approx<span class="keyword">)</span>
      <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [S2KEtyrec, S2KEtyrec]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>S2KEvar s2v1<span class="keyword">,</span> S2KEvar s2v2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#17339"><span class="dyncstuse">eq_s2var_s2var</span></a> <span class="keyword">(</span>s2v1<span class="keyword">,</span> s2v2<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>S2KEunion s2kes1<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> s2kexp_match_union <span class="keyword">(</span>s2kes1<span class="keyword">,</span> s2ke2<span class="keyword">)</span>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span>
<span class="comment">(*
  val () = begin
    print "s2kexp_match_approx: ret = "; print ret; print_newline ();
  end // end of [val]
*)</span>
<span class="keyword">in</span>
  ret <span class="comment">// return value
</span><span class="keyword">end</span> <span class="comment">// end of [s2kexp_match_approx]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32934"><span class="dyncstimp">s2kexplst_match_approx</span></a>
  <span class="keyword">(</span>pol<span class="keyword">,</span> s2kes1<span class="keyword">,</span> s2kes2<span class="keyword">,</span> approx<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> ret <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> <span class="keyword">(</span>s2kes1<span class="keyword">,</span> s2kes2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>s2ke1 :: s2kes1<span class="keyword">,</span> s2ke2 :: s2kes2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32854"><span class="dyncstuse">s2kexp_match_approx</span></a> <span class="keyword">(</span>pol<span class="keyword">,</span> s2ke1<span class="keyword">,</span> s2ke2<span class="keyword">,</span> approx<span class="keyword">)</span> <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32934"><span class="dyncstuse">s2kexplst_match_approx</span></a> <span class="keyword">(</span>pol<span class="keyword">,</span> s2kes1<span class="keyword">,</span> s2kes2<span class="keyword">,</span> approx<span class="keyword">)</span>
      <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [::, ::]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>nil _<span class="keyword">,</span> nil _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span>
<span class="keyword">in</span>
  ret <span class="comment">// return value
</span><span class="keyword">end</span> <span class="comment">// end of [s2kexplst_match_approx]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33058"><span class="dyncstimp">labs2kexplst_match_approx</span></a>
  <span class="keyword">(</span>pol<span class="keyword">,</span> ls2kes1<span class="keyword">,</span> ls2kes2<span class="keyword">,</span> approx<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <span class="keyword">(</span>ls2kes1<span class="keyword">,</span> ls2kes2<span class="keyword">)</span> <span class="keyword">of</span>
  <span class="keyword">|</span> <span class="keyword">(</span>LABS2KEXPLSTcons <span class="keyword">(</span>l1<span class="keyword">,</span> s2ke1<span class="keyword">,</span> ls2kes1<span class="keyword">)</span><span class="keyword">,</span>
     LABS2KEXPLSTcons <span class="keyword">(</span>l2<span class="keyword">,</span> s2ke2<span class="keyword">,</span> ls2kes2<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
       <span class="keyword">if</span> l1 <span class="keyword">=</span> l2 <span class="keyword">then</span>
         <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32854"><span class="dyncstuse">s2kexp_match_approx</span></a> <span class="keyword">(</span>pol<span class="keyword">,</span> s2ke1<span class="keyword">,</span> s2ke2<span class="keyword">,</span> approx<span class="keyword">)</span> <span class="keyword">then</span>
           <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33058"><span class="dyncstuse">labs2kexplst_match_approx</span></a> <span class="keyword">(</span>pol<span class="keyword">,</span> ls2kes1<span class="keyword">,</span> ls2kes2<span class="keyword">,</span> approx<span class="keyword">)</span>
         <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
       <span class="keyword">else</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
    <span class="keyword">end</span> <span class="comment">// end of [LABS2KEXPLSTcons, LABS2KEXPLSTcons]
</span>  <span class="keyword">|</span> <span class="keyword">(</span>LABS2KEXPLSTnil _<span class="keyword">,</span> LABS2KEXPLSTnil _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a>
  <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
<span class="keyword">end</span> <span class="comment">// end of [labs2kexplst_match_approx]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33194"><span class="dyncstimp">s2kexp_match_fun_arg</span></a>
  <span class="keyword">(</span>s2ke_fun<span class="keyword">,</span> s2kes_arg<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2ke_fun <span class="keyword">of</span>
  <span class="keyword">|</span> S2KEfun <span class="keyword">(</span>_<span class="comment">(*fc*)</span><span class="keyword">,</span> s2kes1_arg<span class="keyword">,</span> s2ke1_res<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">var</span> approx<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0
      <span class="keyword">val</span> ans <span class="keyword">=</span> <span class="keyword">begin</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32934"><span class="dyncstuse">s2kexplst_match_approx</span></a> <span class="keyword">(</span>1<span class="keyword">,</span> s2kes_arg<span class="keyword">,</span> s2kes1_arg<span class="keyword">,</span> approx<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> ans <span class="keyword">then</span> Some_vt <span class="keyword">@(</span>s2ke1_res<span class="keyword">,</span> approx<span class="keyword">)</span>
<span class="comment">(*
      else if $Lst.list_length_compare (s2kes_arg, s2kes1_arg) = 0 then
        Some_vt @(s2ke1_res, ~1) // [~1] means infinity: only arity match
*)</span>
      <span class="keyword">else</span> None_vt <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2KEfun]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// end of [_]
</span><span class="keyword">end</span> <span class="comment">// end of [s2kexp_match_fun_arg]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> s2cst_root_get
  <span class="keyword">(</span>s2c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2218"><span class="stacstuse">s2cst_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2218"><span class="stacstuse">s2cst_t</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#14818"><span class="dyncstuse">s2cst_sup_get</span></a> s2c <span class="keyword">of</span>
  <span class="keyword">|</span> S2CSTLSTcons <span class="keyword">(</span>s2c<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> s2cst_root_get s2c <span class="keyword">|</span> S2CSTLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2c
<span class="comment">// end of [s2cst_root_get]
</span>
<span class="keyword">fn</span> s2zexp_make_s2cst
  <span class="keyword">(</span>s2c<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2218"><span class="stacstuse">s2cst_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4854"><span class="stacstuse">s2zexp</span></a></span> <span class="keyword">=</span> S2ZEcst s2c
<span class="comment">// end of [s2zexp_make_s2cst]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34866"><span class="dyncstimp">s2zexp_make_s2exp</span></a> <span class="keyword">(</span>s2e0<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">//
</span>  <span class="keyword">fun</span> aux_s2exp <span class="keyword">(</span>
      s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2e0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span>
    <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4854"><span class="stacstuse">s2zexp</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
<span class="comment">(*
    val () = (print "s2zexp_make_s2exp: aux_s2exp: s2e0 = "; print s2e0; print_newline ())
*)</span>
    <span class="keyword">val</span> s2e0 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#35358"><span class="dyncstuse">s2exp_whnf</span></a> s2e0 <span class="keyword">in</span> <span class="keyword">case+</span> s2e0<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
      <span class="keyword">|</span> S2Eapp <span class="keyword">(</span>s2e_fun<span class="keyword">,</span> s2es_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span>
          aux_s2exp_app <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> s2e_fun<span class="keyword">,</span> s2es_arg<span class="keyword">)</span>
        <span class="comment">// end of [S2Eapp]
</span><span class="comment">//
</span>      <span class="keyword">|</span> S2Ecst s2c <span class="keyword">=&gt;</span> <span class="keyword">let</span>
          <span class="keyword">val</span> isabs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#14040"><span class="dyncstuse">s2cst_isabs_get</span></a> <span class="keyword">(</span>s2c<span class="keyword">)</span> <span class="keyword">in</span>
          <span class="keyword">case+</span> isabs <span class="keyword">of</span>
          <span class="keyword">|</span> Some <span class="keyword">(</span>Some s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> s2zexp_make_s2cst <span class="keyword">(</span>s2c<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [S2Ecst]
</span><span class="comment">//
</span>      <span class="keyword">|</span> S2Eclo <span class="keyword">(</span>knd<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">if</span> knd &lt;&gt; 0 <span class="keyword">then</span> S2ZEptr <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">else</span> S2ZEbot <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">|</span> S2Edatconptr <span class="keyword">(</span>d2c<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> s2zexp_make_s2cst <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#22300"><span class="dyncstuse">d2con_scst_get</span></a> d2c<span class="keyword">)</span>
      <span class="keyword">|</span> S2Edatcontyp <span class="keyword">(</span>d2c<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> s2zexp_make_s2cst <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#22300"><span class="dyncstuse">d2con_scst_get</span></a> d2c<span class="keyword">)</span>
      <span class="keyword">|</span> S2Eexi <span class="keyword">(</span>s2vs<span class="keyword">,</span> _<span class="comment">(*s2ps*)</span><span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2vs :: s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">|</span> S2Eextype <span class="keyword">(</span>name<span class="keyword">,</span> _<span class="comment">(*arglst*)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> S2ZEextype <span class="keyword">(</span>name<span class="keyword">)</span>
      <span class="keyword">|</span> S2Efun _ <span class="keyword">=&gt;</span> S2ZEptr <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">(*
      | S2Eout s2e =&gt; S2ZEout (s2zexp_make_s2exp s2e)
*)</span>
      <span class="keyword">|</span> S2Eread <span class="keyword">(</span>_<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34866"><span class="dyncstuse">s2zexp_make_s2exp</span></a> s2e
      <span class="keyword">|</span> S2Esize s2ze <span class="keyword">=&gt;</span> s2ze
      <span class="keyword">|</span> S2Esizeof s2e <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34866"><span class="dyncstuse">s2zexp_make_s2exp</span></a> s2e
      <span class="keyword">|</span> S2Etop <span class="keyword">(</span>_<span class="comment">(*knd*)</span><span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34866"><span class="dyncstuse">s2zexp_make_s2exp</span></a> s2e
      <span class="keyword">|</span> S2Etyarr <span class="keyword">(</span>s2e_elt<span class="keyword">,</span> s2ess_dim<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          S2ZEtyarr <span class="keyword">(</span>aux_s2exp <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2e_elt<span class="keyword">)</span><span class="keyword">,</span> s2ess_dim<span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [S2Etyarr]
</span>      <span class="keyword">|</span> S2Etyrec <span class="keyword">(</span>knd<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span> <span class="keyword">case+</span> knd <span class="keyword">of</span>
        <span class="keyword">|</span> TYRECKINDbox <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> S2ZEptr <span class="keyword">(</span><span class="keyword">)</span>
        <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> S2ZEtyrec <span class="keyword">(</span>knd<span class="keyword">,</span> aux_labs2explst <span class="keyword">(</span>s2vss<span class="keyword">,</span> ls2es<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [S2Etyrec]
</span>      <span class="keyword">|</span> S2Euni <span class="keyword">(</span>s2vs<span class="keyword">,</span> _<span class="comment">(*s2ps*)</span><span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2vs :: s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">|</span> S2Eunion <span class="keyword">(</span>stamp<span class="keyword">,</span> _<span class="comment">(*s2i*)</span><span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
          S2ZEunion <span class="keyword">(</span>stamp<span class="keyword">,</span> aux_labs2explst <span class="keyword">(</span>s2vss<span class="keyword">,</span> ls2es<span class="keyword">)</span><span class="keyword">)</span>
        <span class="keyword">end</span> <span class="comment">// end of [S2Eunion]
</span>      <span class="keyword">|</span> S2Evar s2v <span class="keyword">=&gt;</span> aux_s2var <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2v<span class="keyword">)</span>
      <span class="keyword">|</span> S2EVar s2V <span class="keyword">=&gt;</span> aux_s2Var <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2V<span class="keyword">)</span>
      <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> S2ZEbot <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [aux_s2exp]
</span><span class="comment">//
</span>  <span class="keyword">and</span> aux_s2exp_app <span class="keyword">(</span> <span class="comment">// [s2e_fun] is normalized
</span>      s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2t<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4120"><span class="stacstuse">s2rt</span></a></span><span class="keyword">,</span> s2e_fun<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span><span class="keyword">,</span> s2es_arg<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span>
    <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4854"><span class="stacstuse">s2zexp</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> s2e_fun<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
    <span class="keyword">|</span> S2Ecst s2c <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> isabs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#14040"><span class="dyncstuse">s2cst_isabs_get</span></a> <span class="keyword">(</span>s2c<span class="keyword">)</span> <span class="keyword">in</span>
        <span class="keyword">case+</span> isabs <span class="keyword">of</span>
        <span class="keyword">|</span> Some <span class="keyword">(</span>Some s2e_fun<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
            <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#29528"><span class="dyncstuse">s2exp_app_srt</span></a> <span class="keyword">(</span>s2t<span class="keyword">,</span> s2e_fun<span class="keyword">,</span> s2es_arg<span class="keyword">)</span> <span class="keyword">in</span> aux_s2exp <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
          <span class="keyword">end</span> <span class="comment">// end of [Some (Some _)]
</span>        <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> s2zexp_make_s2cst <span class="keyword">(</span>s2cst_root_get s2c<span class="keyword">)</span> <span class="comment">// incorrect for certain constructors
</span>      <span class="keyword">end</span> <span class="comment">(* end of [S2Ecst] *)</span>
    <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> S2ZEbot <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">(* HX: ??? *)</span>
  <span class="comment">// end of [aux_s2exp_app]
</span><span class="comment">//  
</span>  <span class="keyword">and</span> aux_s2explst
    <span class="keyword">(</span>s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9072"><span class="stacstuse">s2zexplst</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> s2es <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> s2ze <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">in</span> list_cons <span class="keyword">(</span>s2ze<span class="keyword">,</span> aux_s2explst <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2es<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [S2EXPLSTcons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux_s2explst]
</span><span class="comment">//
</span>  <span class="keyword">and</span> aux_labs2explst <span class="keyword">(</span>s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> ls2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5236"><span class="stacstuse">labs2zexplst</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> ls2es <span class="keyword">of</span>
    <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> s2ze <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">in</span>
        LABS2ZEXPLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> s2ze<span class="keyword">,</span> aux_labs2explst <span class="keyword">(</span>s2vss<span class="keyword">,</span> ls2es<span class="keyword">)</span><span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [LABS2EXPLSTcons]
</span>    <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> LABS2ZEXPLSTnil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="comment">// end of [aux_labs2explst]
</span><span class="comment">//
</span>  <span class="keyword">and</span> aux_s2var <span class="keyword">(</span>s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2v0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4854"><span class="stacstuse">s2zexp</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> s2vss <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2vss<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">fun</span> f <span class="keyword">(</span>s2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span><span class="keyword">,</span> s2v0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#14977"><span class="stacstuse">bool</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> s2vs <span class="keyword">of</span>
          <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2v<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=&gt;</span>
              <span class="keyword">if</span> s2v0 <span class="keyword">=</span> s2v <span class="keyword">then</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4327"><span class="dyncstuse">true</span></a> <span class="keyword">else</span> f <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2v0<span class="keyword">)</span>
          <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#4371"><span class="dyncstuse">false</span></a>
      <span class="keyword">in</span>
        <span class="keyword">if</span> f <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2v0<span class="keyword">)</span> <span class="keyword">then</span> S2ZEbot <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">else</span> aux_s2var <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2v0<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> S2ZEvar s2v0
  <span class="comment">// end of [aux_s2var]
</span><span class="comment">//
</span>  <span class="keyword">and</span> aux_s2Var
    <span class="keyword">(</span>s2vss<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2681"><span class="stacstuse">s2varlstlst</span></a></span><span class="keyword">,</span> s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4854"><span class="stacstuse">s2zexp</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
    <span class="keyword">val</span> lbs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19347"><span class="dyncstuse">s2Var_lbs_get</span></a> s2V0
  <span class="keyword">in</span>
    <span class="keyword">case+</span> lbs <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>lb<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19815"><span class="dyncstuse">s2Varbound_val_get</span></a> lb <span class="keyword">in</span> aux_s2exp <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> ubs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19450"><span class="dyncstuse">s2Var_ubs_get</span></a> s2V0 <span class="keyword">in</span>
        <span class="keyword">case+</span> ubs <span class="keyword">of</span>
        <span class="keyword">|</span> list_cons <span class="keyword">(</span>ub<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
            <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19815"><span class="dyncstuse">s2Varbound_val_get</span></a> ub <span class="keyword">in</span> aux_s2exp <span class="keyword">(</span>s2vss<span class="keyword">,</span> s2e<span class="keyword">)</span>
          <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>        <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> S2ZEbot <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// no information
</span>      <span class="keyword">end</span> <span class="comment">// end of [list_nil]
</span>  <span class="keyword">end</span> <span class="comment">// end of [aux_s2Var]
</span><span class="keyword">in</span>
  aux_s2exp <span class="keyword">(</span>list_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> s2e0<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2zexp_make_s2exp]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#3395"><span class="dyncstimp">s2cstlst_length</span></a> <span class="keyword">(</span>xs<span class="keyword">)</span> <span class="keyword">=</span> loop <span class="keyword">(</span>xs<span class="keyword">,</span> 0<span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">fun</span> loop <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span><span class="keyword">,</span> j<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16854"><span class="stacstuse">Nat</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16854"><span class="stacstuse">Nat</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> S2CSTLSTcons <span class="keyword">(</span>_<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> loop <span class="keyword">(</span>xs<span class="keyword">,</span> j+1<span class="keyword">)</span> <span class="keyword">|</span> S2CSTLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> j
<span class="keyword">}</span> <span class="comment">// end of [s2cstlst_length]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#3434"><span class="dyncstimp">s2cstlst_append</span></a> <span class="keyword">(</span>xs<span class="keyword">,</span> ys<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> xs <span class="keyword">of</span>
  <span class="keyword">|</span> S2CSTLSTcons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> S2CSTLSTcons <span class="keyword">(</span>x<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#3434"><span class="dyncstuse">s2cstlst_append</span></a> <span class="keyword">(</span>xs<span class="keyword">,</span> ys<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2CSTLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> ys
<span class="comment">// end of [s2cstlst_append]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#3491"><span class="dyncstimp">s2cstlst_reverse</span></a> <span class="keyword">(</span>xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> loop <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span><span class="keyword">,</span> ys<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span>
    <span class="keyword">|</span> S2CSTLSTcons <span class="keyword">(</span>x<span class="keyword">,</span> xs<span class="keyword">)</span> <span class="keyword">=&gt;</span> loop <span class="keyword">(</span>xs<span class="keyword">,</span> S2CSTLSTcons <span class="keyword">(</span>x<span class="keyword">,</span> ys<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">|</span> S2CSTLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> ys
  <span class="comment">// end of [loop]
</span><span class="keyword">in</span>
  loop <span class="keyword">(</span>xs<span class="keyword">,</span> S2CSTLSTnil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2cstlst_reverse]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#21490"><span class="dyncstimp">s2qualst_reverse</span></a> <span class="keyword">(</span>xs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> loop <span class="keyword">(</span>xs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse">s2qualst</span></a></span><span class="keyword">,</span> ys<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse">s2qualst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#10049"><span class="stacstuse">s2qualst</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> xs <span class="keyword">of</span> x :: xs <span class="keyword">=&gt;</span> loop <span class="keyword">(</span>xs<span class="keyword">,</span> x :: ys<span class="keyword">)</span> <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> ys
  <span class="comment">// end of [loop]
</span><span class="keyword">in</span>
  loop <span class="keyword">(</span>xs<span class="keyword">,</span> list_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2qualst_reverse]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">typedef</span> <span class="staexp"><a name="38633"><span class="stacstdec">stasub <span class="keyword">=</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#21893"><span class="stacstuse">List</span></a> <span class="keyword">@(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a><span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a><span class="keyword">)</span></span></a></span>
<span class="keyword">assume</span> <span class="staexp">stasub_t <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span>

<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33402"><span class="dyncstimp">stasub_nil</span></a> <span class="keyword">=</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">implement</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33428"><span class="dyncstimp">stasub_add</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2v<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">@(</span>s2v<span class="keyword">,</span> s2e<span class="keyword">)</span> :: sub
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33489"><span class="dyncstimp">stasub_addlst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2vs<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">fun</span> loop
    <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse">stasub_t</span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span><span class="keyword">,</span> s2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33374"><span class="stacstuse">stasub_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">(</span>list_cons <span class="keyword">(</span>s2v<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">,</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> sub <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33428"><span class="dyncstuse">stasub_add</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2v<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">in</span> loop <span class="keyword">(</span>sub<span class="keyword">,</span> s2vs<span class="keyword">,</span> s2es<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [list_cons, list_cons]
</span>    <span class="keyword">|</span> <span class="keyword">(</span>_<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> sub
  <span class="comment">// end of [loop]
</span><span class="keyword">in</span>
  loop <span class="keyword">(</span>sub<span class="keyword">,</span> s2vs<span class="keyword">,</span> s2es<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [stasub_addlst]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33558"><span class="dyncstimp">stasub_domain_get</span></a> <span class="keyword">(</span>sub<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> sub <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2vs2e<span class="keyword">,</span> sub<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      list_cons <span class="keyword">(</span>s2vs2e<span class="keyword">.</span>0<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33558"><span class="dyncstuse">stasub_domain_get</span></a> sub<span class="keyword">)</span>
  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of stasub_domain_get
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33604"><span class="dyncstimp">stasub_codomain_get_whnf</span></a> <span class="keyword">(</span>sub<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> sub <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2vs2e<span class="keyword">,</span> sub<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> s2e <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#35358"><span class="dyncstuse">s2exp_whnf</span></a> s2vs2e<span class="keyword">.</span>1 <span class="keyword">in</span>
      list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33604"><span class="dyncstuse">stasub_codomain_get_whnf</span></a> sub<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [stasub_codomain_get_whnf]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33658"><span class="dyncstimp">stasub_extend_svarlst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">typedef</span> <span class="staexp"><a name="39757"><span class="stacstdec">T <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span>
  <span class="keyword">fun</span> loop <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2vs1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#39757"><span class="stacstuse">T</span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#39757"><span class="stacstuse">T</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">@(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a><span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a><span class="keyword">)</span></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> s2vs <span class="keyword">of</span>
    <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2v<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> s2v1 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#16740"><span class="dyncstuse">s2var_copy</span></a> s2v
        <span class="keyword">val</span> s2e1 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32074"><span class="dyncstuse">s2exp_var</span></a> s2v1 <span class="keyword">in</span>
        loop <span class="keyword">(</span><span class="keyword">(</span>s2v<span class="keyword">,</span> s2e1<span class="keyword">)</span> :: sub<span class="keyword">,</span> s2v1 :: s2vs1<span class="keyword">,</span> s2vs<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>    <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>sub<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2934"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_reverse</span></a> s2vs1<span class="keyword">)</span>
  <span class="comment">// end of [loop]
</span><span class="keyword">in</span>
  loop <span class="keyword">(</span>sub<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> s2vs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [stasub_extend_svarlst]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33742"><span class="dyncstimp">stasub_extend_sarglst_svarlst</span></a>
  <span class="keyword">(</span>loc0<span class="keyword">,</span> sub<span class="keyword">,</span> s2as<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">typedef</span> <span class="staexp"><a name="40270"><span class="stacstdec">T1 <span class="keyword">=</span>  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9045"><span class="stacstuse">s2arglst</span></a></span></a></span> <span class="keyword">and</span> <span class="staexp"><a name="40289"><span class="stacstdec">T2 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span> 
  
  <span class="keyword">fn</span> err1 <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2034"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> s2t<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4120"><span class="stacstuse">s2rt</span></a></span><span class="keyword">,</span> s2a<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8952"><span class="stacstuse">s2arg</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4120"><span class="stacstuse">s2rt</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
    prerr_loc_error2 loc0<span class="keyword">;</span>
    prerr ": the static argument ["<span class="keyword">;</span>
    prerr s2a<span class="keyword">.</span>s2arg_sym<span class="keyword">;</span>
    prerr "] is expected to be of sort ["<span class="keyword">;</span> prerr s2t<span class="keyword">;</span> prerr "]."<span class="keyword">;</span>
    <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4120"><span class="stacstuse">s2rt</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [err1]
</span>
  <span class="keyword">fn</span> err2 <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2034"><span class="stacstuse">loc_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">@(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a><span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
    prerr_loc_error2 loc0<span class="keyword">;</span>
    prerr ": the static application is expected to have less arguments."<span class="keyword">;</span>
    <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [err2]
</span>
  <span class="keyword">fn</span> err3 <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2034"><span class="stacstuse">loc_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">@(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a><span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
    prerr_loc_error2 loc0<span class="keyword">;</span>
    prerr ": the static application is expected to have more arguments."<span class="keyword">;</span>
    <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
    <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">end</span> <span class="comment">// end of [err3]
</span>
  <span class="keyword">fun</span> aux
    <span class="keyword">(</span>loc0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2034"><span class="stacstuse">loc_t</span></a></span><span class="keyword">,</span> sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2vs1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#40289"><span class="stacstuse">T2</span></a></span><span class="keyword">,</span> s2as<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#40270"><span class="stacstuse">T1</span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#40289"><span class="stacstuse">T2</span></a></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><span class="keyword">@(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a><span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">case+</span> <span class="keyword">(</span>s2as<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">of</span>
    <span class="keyword">|</span> <span class="keyword">(</span>nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span>sub<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5flist_2esats.html#2934"><span class="dyncstuse">$Lst<span class="keyword">.</span>list_reverse</span></a> s2vs1<span class="keyword">)</span>
    <span class="keyword">|</span> <span class="keyword">(</span>s2a :: s2as<span class="keyword">,</span> s2v :: s2vs<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> s2t_s2v <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#16824"><span class="dyncstuse">s2var_srt_get</span></a> s2v
        <span class="keyword">val</span> s2t <span class="keyword">=</span> <span class="keyword">(</span><span class="keyword">case+</span> s2a<span class="keyword">.</span>s2arg_srt <span class="keyword">of</span>
          <span class="keyword">|</span> Some s2t <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
              <span class="keyword">if</span> s2t_s2v &lt;= s2t <span class="keyword">then</span> s2t <span class="keyword">else</span> err1 <span class="keyword">(</span>loc0<span class="keyword">,</span> s2t_s2v<span class="keyword">,</span> s2a<span class="keyword">)</span>
            <span class="keyword">end</span> <span class="comment">// end of [Some]
</span>          <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2t_s2v
        <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4120"><span class="stacstuse">s2rt</span></a></span>
        <span class="keyword">val</span> s2v1 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#16646"><span class="dyncstuse">s2var_make_id_srt</span></a> <span class="keyword">(</span>s2a<span class="keyword">.</span>s2arg_sym<span class="keyword">,</span> s2t<span class="keyword">)</span>
        <span class="keyword">val</span> sub <span class="keyword">=</span> list_cons <span class="keyword">(</span><span class="keyword">@(</span>s2v<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32074"><span class="dyncstuse">s2exp_var</span></a> s2v1<span class="keyword">)</span><span class="keyword">,</span> sub<span class="keyword">)</span>
      <span class="keyword">in</span>
        aux <span class="keyword">(</span>loc0<span class="keyword">,</span> sub<span class="keyword">,</span> list_cons <span class="keyword">(</span>s2v1<span class="keyword">,</span> s2vs1<span class="keyword">)</span><span class="keyword">,</span> s2as<span class="keyword">,</span> s2vs<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [::, ::]
</span>    <span class="keyword">|</span> <span class="keyword">(</span>list_cons _<span class="keyword">,</span> list_nil _<span class="keyword">)</span> <span class="keyword">=&gt;</span> err2 <span class="keyword">(</span>loc0<span class="keyword">)</span>
    <span class="keyword">|</span> <span class="keyword">(</span>list_nil _<span class="keyword">,</span> list_cons _<span class="keyword">)</span> <span class="keyword">=&gt;</span> err3 <span class="keyword">(</span>loc0<span class="keyword">)</span>
  <span class="comment">// end of [aux]
</span><span class="keyword">in</span>
  aux <span class="keyword">(</span>loc0<span class="keyword">,</span> sub<span class="keyword">,</span> nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> s2as<span class="keyword">,</span> s2vs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">(* end of [stasub_extend_sarg] *)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">fun</span> s2var_subst
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2v0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#23028"><span class="stacstuse">Option_vt</span></a> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> sub <span class="keyword">of</span>
  <span class="keyword">|</span> s2vs2e :: sub <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">if</span> s2v0 <span class="keyword">=</span> s2vs2e<span class="keyword">.</span>0 <span class="keyword">then</span> Some_vt s2vs2e<span class="keyword">.</span>1 <span class="keyword">else</span> s2var_subst <span class="keyword">(</span>sub<span class="keyword">,</span> s2v0<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [::]
</span>  <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> None_vt <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">(* end of [s2var_subst] *)</span>

<span class="keyword">fun</span> s2Var_subst <span class="staexp"><span class="keyword">.&lt;&gt;.</span></span>
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#23028"><span class="stacstuse">Option_vt</span></a> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19202"><span class="dyncstuse">s2Var_link_get</span></a> s2V0 <span class="keyword">of</span>
  <span class="keyword">|</span> Some s2e <span class="keyword">=&gt;</span> Some_vt <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33866"><span class="dyncstuse">s2exp_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">fun</span> aux <span class="keyword">(</span>s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span><span class="keyword">,</span> sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> sub <span class="keyword">of</span>
        <span class="keyword">|</span> s2vs2e :: sub <span class="keyword">=&gt;</span> <span class="keyword">let</span>
            <span class="keyword">val</span> s2v <span class="keyword">=</span> s2vs2e<span class="keyword">.</span>0<span class="keyword">;</span> <span class="keyword">val</span> sVs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#16956"><span class="dyncstuse">s2var_sVarset_get</span></a> s2v
            <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#17003"><span class="dyncstuse">s2var_sVarset_set</span></a> <span class="keyword">(</span>s2v<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#21092"><span class="dyncstuse">s2Varset_add</span></a> <span class="keyword">(</span>sVs<span class="keyword">,</span> s2V0<span class="keyword">)</span><span class="keyword">)</span>
          <span class="keyword">in</span>
            aux <span class="keyword">(</span>s2V0<span class="keyword">,</span> sub<span class="keyword">)</span>
          <span class="keyword">end</span> <span class="comment">// end of [::]
</span>        <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="comment">// end of [aux]
</span>      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux <span class="keyword">(</span>s2V0<span class="keyword">,</span> sub<span class="keyword">)</span>
    <span class="keyword">}</span> <span class="comment">// end of [None]
</span><span class="keyword">end</span> <span class="comment">(* end of [s2Var_subst] *)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="keyword">local</span>

<span class="keyword">fun</span> s2exp_subst_flag
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2e0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span><span class="keyword">,</span> flag<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2e0<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Eapp <span class="keyword">(</span>s2e_fun<span class="keyword">,</span> s2es_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e_fun <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e_fun<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2es_arg <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#29528"><span class="dyncstuse">s2exp_app_srt</span></a> <span class="keyword">(</span>s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> s2e_fun<span class="keyword">,</span> s2es_arg<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Eapp]
</span>  <span class="keyword">|</span> S2Echar _ <span class="keyword">=&gt;</span> s2e0
  <span class="keyword">|</span> S2Eclo <span class="keyword">(</span>knd<span class="keyword">,</span> s2e_fun<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e_fun <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e_fun<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#29704"><span class="dyncstuse">s2exp_clo_srt</span></a> <span class="keyword">(</span>s2e_fun<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> knd<span class="keyword">,</span> s2e_fun<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Eclo]
</span>  <span class="keyword">|</span> S2Ecrypt s2e <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#29826"><span class="dyncstuse">s2exp_crypt</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Ecrypt]
</span>  <span class="keyword">|</span> S2Ecst s2c  <span class="keyword">=&gt;</span> s2e0
  <span class="keyword">|</span> S2Edatconptr <span class="keyword">(</span>d2c<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2es <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#29953"><span class="dyncstuse">s2exp_datconptr</span></a> <span class="keyword">(</span>d2c<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Edatconptr]
</span>  <span class="keyword">|</span> S2Edatcontyp <span class="keyword">(</span>d2c<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2es <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30011"><span class="dyncstuse">s2exp_datcontyp</span></a> <span class="keyword">(</span>d2c<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Edatcontyp]
</span>  <span class="keyword">|</span> S2Eeff s2fe <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2fe <span class="keyword">=</span> s2eff_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2fe<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30069"><span class="dyncstuse">s2exp_eff</span></a> <span class="keyword">(</span>s2fe<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Eeff]
</span>  <span class="keyword">|</span> S2Eeqeq <span class="keyword">(</span>s2e1<span class="keyword">,</span> s2e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e1 <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e1<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2e2 <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e2<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30104"><span class="dyncstuse">s2exp_eqeq</span></a> <span class="keyword">(</span>s2e1<span class="keyword">,</span> s2e2<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Eeqeq]
</span>  <span class="keyword">|</span> S2Eexi <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2ps<span class="keyword">,</span> s2e_body<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> <span class="keyword">@(</span>sub<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33658"><span class="dyncstuse">stasub_extend_svarlst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2vs<span class="keyword">)</span>
      <span class="keyword">val</span> s2ps <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ps<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2e_body <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e_body<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30153"><span class="dyncstuse">s2exp_exi</span></a> <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2ps<span class="keyword">,</span> s2e_body<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Eexi]
</span>  <span class="keyword">|</span> S2Eextype <span class="keyword">(</span>name<span class="keyword">,</span> _arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> _arg <span class="keyword">=</span> s2explstlst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> _arg<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30220"><span class="dyncstuse">s2exp_extype_srt</span></a> <span class="keyword">(</span>s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> name<span class="keyword">,</span> _arg<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0 <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [S2Eextype]
</span>  <span class="keyword">|</span> S2Efun <span class="keyword">(</span>fc<span class="keyword">,</span> lin<span class="keyword">,</span> s2fe<span class="keyword">,</span> npf<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> s2e_res<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2fe <span class="keyword">=</span> s2eff_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2fe<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2es_arg <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2e_res <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e_res<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30327"><span class="dyncstuse">s2exp_fun_srt</span></a> <span class="keyword">(</span>s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> fc<span class="keyword">,</span> lin<span class="keyword">,</span> s2fe<span class="keyword">,</span> npf<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> s2e_res<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0 <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [S2Efun]
</span>  <span class="keyword">|</span> S2Eint _ <span class="keyword">=&gt;</span> s2e0
  <span class="keyword">|</span> S2Eintinf _ <span class="keyword">=&gt;</span> s2e0
  <span class="keyword">|</span> S2Elam <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2e_body<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> <span class="keyword">(</span>sub<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33658"><span class="dyncstuse">stasub_extend_svarlst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2vs<span class="keyword">)</span>
      <span class="keyword">val</span> s2e_body <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e_body<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30609"><span class="dyncstuse">s2exp_lam_srt</span></a> <span class="keyword">(</span>s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> s2vs<span class="keyword">,</span> s2e_body<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0 <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [S2Elam]
</span>  <span class="keyword">|</span> S2Emetfn <span class="keyword">(</span>d2v <span class="comment">(*stamp*)</span><span class="keyword">,</span> s2es_met<span class="keyword">,</span> s2e_fun<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2es_met <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es_met<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2e_fun <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e_fun<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30674"><span class="dyncstuse">s2exp_metfn</span></a> <span class="keyword">(</span>d2v<span class="keyword">,</span> s2es_met<span class="keyword">,</span> s2e_fun<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0 <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [S2Emetfn]
</span>  <span class="keyword">|</span> S2Emetlt <span class="keyword">(</span>s2es1<span class="keyword">,</span> s2es2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2es1 <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es1<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2es2 <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es2<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30755"><span class="dyncstuse">s2exp_metlt</span></a> <span class="keyword">(</span>s2es1<span class="keyword">,</span> s2es2<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Emetlt]
</span><span class="comment">(*
// HX-2010-12-04: inadequate design
  | S2Enamed _ =&gt; s2e0 // a named type must be closed!
*)</span>
  <span class="keyword">|</span> S2Eout s2e <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30927"><span class="dyncstuse">s2exp_out</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Eout]
</span>  <span class="keyword">|</span> S2Eproj <span class="keyword">(</span>s2e<span class="keyword">,</span> s2l<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2l <span class="keyword">=</span> s2lab_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2l<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#30961"><span class="dyncstuse">s2exp_proj</span></a> <span class="keyword">(</span>s2e<span class="keyword">,</span> s2l<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Eproj]
</span>  <span class="keyword">|</span> S2Eread <span class="keyword">(</span>_v<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> _v <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> _v<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31061"><span class="dyncstuse">s2exp_read_srt</span></a> <span class="keyword">(</span>s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> _v<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Eread]
</span>  <span class="keyword">|</span> S2Erefarg <span class="keyword">(</span>refval<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31187"><span class="dyncstuse">s2exp_refarg</span></a> <span class="keyword">(</span>refval<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Erefarg]
</span>  <span class="keyword">|</span> S2Esel <span class="keyword">(</span>s2e_tup<span class="keyword">,</span> i<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e_tup <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e_tup<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31282"><span class="dyncstuse">s2exp_sel_srt</span></a> <span class="keyword">(</span>s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> s2e_tup<span class="keyword">,</span> i<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0 <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [S2Esel]
</span>  <span class="keyword">|</span> S2Esize s2ze <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2ze <span class="keyword">=</span> s2zexp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ze<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31339"><span class="dyncstuse">s2exp_size</span></a> s2ze <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Esize]
</span>  <span class="keyword">|</span> S2Esizeof s2e <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31376"><span class="dyncstuse">s2exp_sizeof</span></a> s2e <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Esizeof]
</span>  <span class="keyword">|</span> S2Etop <span class="keyword">(</span>knd<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31414"><span class="dyncstuse">s2exp_top_srt</span></a> <span class="keyword">(</span>s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> knd<span class="keyword">,</span> s2e<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0 <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [S2Etop]
</span>  <span class="keyword">|</span> S2Etup s2es <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2es <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31473"><span class="dyncstuse">s2exp_tup_srt</span></a> <span class="keyword">(</span>s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> s2es<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0 <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [S2Etup]
</span>  <span class="keyword">|</span> S2Etyarr <span class="keyword">(</span>s2e_elt<span class="keyword">,</span> s2ess_dim<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e_elt <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e_elt<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2ess_dim <span class="keyword">=</span> s2explstlst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ess_dim<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31526"><span class="dyncstuse">s2exp_tyarr</span></a> <span class="keyword">(</span>s2e_elt<span class="keyword">,</span> s2ess_dim<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Etyarr]
</span>  <span class="keyword">|</span> S2Etyleq <span class="keyword">(</span>knd<span class="keyword">,</span> s2e1<span class="keyword">,</span> s2e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e1 <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e1<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2e2 <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e2<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31580"><span class="dyncstuse">s2exp_tyleq</span></a> <span class="keyword">(</span>knd<span class="keyword">,</span> s2e1<span class="keyword">,</span> s2e2<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Etyleq]
</span>  <span class="keyword">|</span> S2Etylst s2es <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2es <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31640"><span class="dyncstuse">s2exp_tylst</span></a> s2es <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Etylst]
</span>  <span class="keyword">|</span> S2Etyrec <span class="keyword">(</span>k<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> ls2es <span class="keyword">=</span> labs2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> ls2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31747"><span class="dyncstuse">s2exp_tyrec_srt</span></a> <span class="keyword">(</span>s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> k<span class="keyword">,</span> npf<span class="keyword">,</span> ls2es<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0 <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">// end of [S2Etyrec]
</span>  <span class="keyword">|</span> S2Euni <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2ps<span class="keyword">,</span> s2e_body<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> <span class="keyword">@(</span>sub<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33658"><span class="dyncstuse">stasub_extend_svarlst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2vs<span class="keyword">)</span>
      <span class="keyword">val</span> s2ps <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ps<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2e_body <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e_body<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31832"><span class="dyncstuse">s2exp_uni</span></a> <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2ps<span class="keyword">,</span> s2e_body<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Euni]
</span>  <span class="keyword">|</span> S2Eunion <span class="keyword">(</span>stamp<span class="keyword">,</span> s2e_ind<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e_ind <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e_ind<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> ls2es <span class="keyword">=</span> labs2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> ls2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>
        <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#31985"><span class="dyncstuse">s2exp_union_srt</span></a> <span class="keyword">(</span>s2e0<span class="keyword">.</span>s2exp_srt<span class="keyword">,</span> stamp<span class="keyword">,</span> s2e_ind<span class="keyword">,</span> ls2es<span class="keyword">)</span>
      <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Eunion]
</span>  <span class="keyword">|</span> S2Evar s2v <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">case+</span> s2var_subst <span class="keyword">(</span>sub<span class="keyword">,</span> s2v<span class="keyword">)</span> <span class="keyword">of</span>
      <span class="keyword">|</span> <span class="keyword">~</span>Some_vt s2e <span class="keyword">=&gt;</span> <span class="keyword">(</span>flag := flag + 1<span class="keyword">;</span> s2e<span class="keyword">)</span> <span class="keyword">|</span> <span class="keyword">~</span>None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Evar]
</span>  <span class="keyword">|</span> S2EVar s2V <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">case+</span> s2Var_subst <span class="keyword">(</span>sub<span class="keyword">,</span> s2V<span class="keyword">)</span> <span class="keyword">of</span>
      <span class="keyword">|</span> <span class="keyword">~</span>Some_vt s2e <span class="keyword">=&gt;</span> s2e <span class="keyword">|</span> <span class="keyword">~</span>None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2EVar]
</span>  <span class="keyword">|</span> S2Evararg s2e <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32110"><span class="dyncstuse">s2exp_vararg</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Evararg]
</span>  <span class="keyword">|</span> S2Ewth <span class="keyword">(</span>s2e<span class="keyword">,</span> wths2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> wths2es <span class="keyword">=</span> wths2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> wths2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32183"><span class="dyncstuse">s2exp_wth</span></a> <span class="keyword">(</span>s2e<span class="keyword">,</span> wths2es<span class="keyword">)</span> <span class="keyword">else</span> s2e0
    <span class="keyword">end</span> <span class="comment">// end of [S2Ewth]
</span><span class="keyword">end</span> <span class="comment">// end of [s2exp_subst_flag]
</span>
<span class="keyword">and</span> s2explst_subst_flag <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span>
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2es0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9354"><span class="stacstuse">s2explst</span></a> n</span><span class="keyword">,</span> flag<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9354"><span class="stacstuse">s2explst</span></a> n</span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2es0 <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2es <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">else</span> s2es0
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [s2explst_subst_flag]
</span>
<span class="keyword">and</span> s2explstlst_subst_flag
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2ess0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span><span class="keyword">,</span> flag<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2ess0 <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2es<span class="keyword">,</span> s2ess<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2es <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2ess <span class="keyword">=</span> s2explstlst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ess<span class="keyword">,</span> flag<span class="keyword">)</span> 
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> list_cons <span class="keyword">(</span>s2es<span class="keyword">,</span> s2ess<span class="keyword">)</span> <span class="keyword">else</span> s2ess0
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_nil <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [s2explstlst_subst_flag]
</span>
<span class="keyword">and</span> labs2explst_subst_flag
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> ls2es0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span><span class="keyword">,</span> flag<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> ls2es0 <span class="keyword">of</span>
  <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> ls2es <span class="keyword">=</span> labs2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> ls2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> LABS2EXPLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">else</span> ls2es0
    <span class="keyword">end</span> <span class="comment">// end of [LABS2EXPLSTcons]
</span>  <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [labs2explst_subst_flag]
</span>
<span class="keyword">and</span> wths2explst_subst_flag
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> wths2es0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8597"><span class="stacstuse">wths2explst</span></a></span><span class="keyword">,</span> flag<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8597"><span class="stacstuse">wths2explst</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> wths2es0 <span class="keyword">of</span>
  <span class="keyword">|</span> WTHS2EXPLSTcons_some <span class="keyword">(</span>refval<span class="keyword">,</span> s2e<span class="keyword">,</span> wths2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> wths2es <span class="keyword">=</span> wths2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> wths2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> WTHS2EXPLSTcons_some <span class="keyword">(</span>refval<span class="keyword">,</span> s2e<span class="keyword">,</span> wths2es<span class="keyword">)</span>
      <span class="keyword">else</span> wths2es0
    <span class="keyword">end</span> <span class="comment">// end of [WTHS2EXPLSTcons_some]
</span>  <span class="keyword">|</span> WTHS2EXPLSTcons_none <span class="keyword">(</span>wths2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> wths2es <span class="keyword">=</span> wths2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> wths2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> WTHS2EXPLSTcons_none wths2es <span class="keyword">else</span> wths2es0
    <span class="keyword">end</span>
  <span class="keyword">|</span> WTHS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> WTHS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [wths2explst_subst_flag]
</span>
<span class="keyword">and</span> s2eff_subst_flag
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2fe0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5355"><span class="stacstuse">s2eff</span></a></span><span class="keyword">,</span> flag<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5355"><span class="stacstuse">s2eff</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2fe0 <span class="keyword">of</span>
  <span class="keyword">|</span> S2EFFset <span class="keyword">(</span>efs<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2es <span class="keyword">=</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> S2EFFset <span class="keyword">(</span>efs<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">else</span> s2fe0
    <span class="keyword">end</span> <span class="comment">// end of [S2EFFset]
</span>  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> s2fe0 <span class="comment">// end of [_]
</span><span class="keyword">end</span> <span class="comment">// end of s2eff_subst_flag
</span>
<span class="keyword">and</span> s2lab_subst_flag
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2l0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5454"><span class="stacstuse">s2lab</span></a></span><span class="keyword">,</span> flag<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5454"><span class="stacstuse">s2lab</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2l0 <span class="keyword">of</span>
  <span class="keyword">|</span> S2LAB0lab _ <span class="keyword">=&gt;</span> s2l0
  <span class="keyword">|</span> S2LAB0ind <span class="keyword">(</span>s2ess<span class="comment">(*ind*)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2ess <span class="keyword">=</span> s2explstlst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ess<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> S2LAB0ind <span class="keyword">(</span>s2ess<span class="keyword">)</span> <span class="keyword">else</span> s2l0
    <span class="keyword">end</span> <span class="comment">// end of [S2LAB0ind]
</span>  <span class="keyword">|</span> S2LAB1lab <span class="keyword">(</span>l<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> S2LAB1lab <span class="keyword">(</span>l<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">else</span> s2l0
    <span class="keyword">end</span> <span class="comment">// end of [S2LAB1lab]
</span>  <span class="keyword">|</span> S2LAB1ind <span class="keyword">(</span>s2ess<span class="comment">(*ind*)</span><span class="keyword">,</span> s2e<span class="comment">(*elt*)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2ess <span class="keyword">=</span> s2explstlst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ess<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> S2LAB1ind <span class="keyword">(</span>s2ess<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">else</span> s2l0
    <span class="keyword">end</span> <span class="comment">// end of [S2LAB1ind]
</span><span class="keyword">end</span> <span class="comment">// end of [s2lab_subst_flag]
</span>
<span class="keyword">and</span> s2zexp_subst_flag
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2ze0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4854"><span class="stacstuse">s2zexp</span></a></span><span class="keyword">,</span> flag<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4854"><span class="stacstuse">s2zexp</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2ze0 <span class="keyword">of</span>
  <span class="keyword">|</span> S2ZEapp <span class="keyword">(</span>s2ze_fun<span class="keyword">,</span> s2zes_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2ze_fun <span class="keyword">=</span> s2zexp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ze_fun<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2zes_arg <span class="keyword">=</span> s2zexplst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2zes_arg<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> S2ZEapp <span class="keyword">(</span>s2ze_fun<span class="keyword">,</span> s2zes_arg<span class="keyword">)</span> <span class="keyword">else</span> s2ze0
    <span class="keyword">end</span>
  <span class="keyword">|</span> S2ZEbot _ <span class="keyword">=&gt;</span> s2ze0
  <span class="keyword">|</span> S2ZEcst _  <span class="keyword">=&gt;</span> s2ze0
  <span class="keyword">|</span> S2ZEextype _ <span class="keyword">=&gt;</span> s2ze0
  <span class="keyword">|</span> S2ZEptr <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2ze0
  <span class="keyword">|</span> S2ZEtyarr <span class="keyword">(</span>s2ze_elt<span class="keyword">,</span> s2ess_ind<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2ze_elt <span class="keyword">=</span> s2zexp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ze_elt<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2ess_ind <span class="keyword">=</span> s2explstlst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ess_ind<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span>  S2ZEtyarr <span class="keyword">(</span>s2ze_elt<span class="keyword">,</span> s2ess_ind<span class="keyword">)</span> <span class="keyword">else</span> s2ze0
    <span class="keyword">end</span> <span class="comment">// end of[S2ZEtyarr]
</span>  <span class="keyword">|</span> S2ZEtyrec <span class="keyword">(</span>knd<span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> ls2zes <span class="keyword">=</span> labs2zexplst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> ls2zes<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> S2ZEtyrec <span class="keyword">(</span>knd<span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">else</span> s2ze0
    <span class="keyword">end</span> <span class="comment">// end of [S2ZEtyrec]
</span>  <span class="keyword">|</span> S2ZEunion <span class="keyword">(</span>stamp<span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> ls2zes <span class="keyword">=</span> labs2zexplst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> ls2zes<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> S2ZEunion <span class="keyword">(</span>stamp<span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">else</span> s2ze0
    <span class="keyword">end</span> <span class="comment">// end of [S2ZEunion]
</span>  <span class="keyword">|</span> S2ZEvar s2v <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      <span class="keyword">case+</span> s2var_subst <span class="keyword">(</span>sub<span class="keyword">,</span> s2v<span class="keyword">)</span> <span class="keyword">of</span>
      <span class="keyword">|</span> <span class="keyword">~</span>Some_vt s2e <span class="keyword">=&gt;</span> <span class="keyword">(</span>flag := flag + 1<span class="keyword">;</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34866"><span class="dyncstuse">s2zexp_make_s2exp</span></a> s2e<span class="keyword">)</span>
      <span class="keyword">|</span> <span class="keyword">~</span>None_vt <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> s2ze0
    <span class="keyword">end</span> <span class="comment">// end of [S2ZEvar]
</span><span class="keyword">end</span> <span class="comment">// end of [s2zexp_subst_flag]
</span>
<span class="keyword">and</span> s2zexplst_subst_flag
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> s2zes0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9072"><span class="stacstuse">s2zexplst</span></a></span><span class="keyword">,</span> flag<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9072"><span class="stacstuse">s2zexplst</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2zes0 <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2ze<span class="keyword">,</span> s2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2ze <span class="keyword">=</span> s2zexp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ze<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> s2zes <span class="keyword">=</span> s2zexplst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2zes<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0  <span class="keyword">then</span> list_cons <span class="keyword">(</span>s2ze<span class="keyword">,</span> s2zes<span class="keyword">)</span> <span class="keyword">else</span> s2zes0
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="comment">// end of [list_nil]
</span><span class="comment">// end of [s2zexplst_subst_flag]
</span>
<span class="keyword">and</span> labs2zexplst_subst_flag
  <span class="keyword">(</span>sub<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_5futil1_2edats.html#38633"><span class="stacstuse">stasub</span></a></span><span class="keyword">,</span> ls2zes0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5236"><span class="stacstuse">labs2zexplst</span></a></span><span class="keyword">,</span> flag<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5236"><span class="stacstuse">labs2zexplst</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> ls2zes0 <span class="keyword">of</span>
  <span class="keyword">|</span> LABS2ZEXPLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> s2ze<span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> flag0 <span class="keyword">=</span> flag
      <span class="keyword">val</span> s2ze <span class="keyword">=</span> s2zexp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ze<span class="keyword">,</span> flag<span class="keyword">)</span>
      <span class="keyword">val</span> ls2zes <span class="keyword">=</span> labs2zexplst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> ls2zes<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> flag0 <span class="keyword">then</span> LABS2ZEXPLSTcons <span class="keyword">(</span>l<span class="keyword">,</span> s2ze<span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">else</span> ls2zes0
    <span class="keyword">end</span> <span class="comment">// end of [LABS2ZEXPLSTcons]
</span>  <span class="keyword">|</span> LABS2ZEXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> LABS2ZEXPLSTnil <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [labs2zexplst_subst_flag]
</span>
<span class="keyword">in</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33917"><span class="dyncstimp">s2explst_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2es0<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">var</span> flag<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0 <span class="keyword">in</span> s2explst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2es0<span class="keyword">,</span> flag<span class="keyword">)</span> <span class="keyword">end</span>
<span class="comment">// end of [s2explst_subst]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34052"><span class="dyncstimp">s2explstlst_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2ess0<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">var</span> flag<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0 <span class="keyword">in</span> s2explstlst_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2ess0<span class="keyword">,</span> flag<span class="keyword">)</span> <span class="keyword">end</span>
<span class="comment">// end of [s2explstlst_subst]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33990"><span class="dyncstimp">s2expopt_subst</span></a>
  <span class="keyword">(</span>sub<span class="keyword">,</span> os2e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">case+</span> os2e <span class="keyword">of</span>
  <span class="keyword">|</span> Some <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">var</span> flag<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0
      <span class="keyword">val</span> s2e <span class="keyword">=</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">,</span> flag<span class="keyword">)</span>
    <span class="keyword">in</span>
      <span class="keyword">if</span> flag <span class="keyword">&gt;</span> 0 <span class="keyword">then</span> Some s2e <span class="keyword">else</span> os2e
    <span class="keyword">end</span> <span class="comment">// end of [Some]
</span>  <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> None <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [s2expopt_subst]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33866"><span class="dyncstimp">s2exp_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2e0<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">var</span> flag<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0 <span class="keyword">in</span> s2exp_subst_flag <span class="keyword">(</span>sub<span class="keyword">,</span> s2e0<span class="keyword">,</span> flag<span class="keyword">)</span> <span class="keyword">end</span>
<span class="comment">// end of [s2exp_subst]
</span>
<span class="keyword">end</span> <span class="comment">// end of [local]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34139"><span class="dyncstimp">s2exp_alpha</span></a> <span class="keyword">(</span>s1v<span class="keyword">,</span> s1v1<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> sub <span class="keyword">=</span> list_cons <span class="keyword">(</span><span class="keyword">(</span>s1v<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32074"><span class="dyncstuse">s2exp_var</span></a> s1v1<span class="keyword">)</span><span class="keyword">,</span> list_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33866"><span class="dyncstuse">s2exp_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2e<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2exp_alpha]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34232"><span class="dyncstimp">s2explst_alpha</span></a> <span class="keyword">(</span>s1v<span class="keyword">,</span> s1v1<span class="keyword">,</span> s2elst<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> sub <span class="keyword">=</span> list_cons <span class="keyword">(</span><span class="keyword">(</span>s1v<span class="keyword">,</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#32074"><span class="dyncstuse">s2exp_var</span></a> s1v1<span class="keyword">)</span><span class="keyword">,</span> list_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">in</span>
  <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#33917"><span class="dyncstuse">s2explst_subst</span></a> <span class="keyword">(</span>sub<span class="keyword">,</span> s2elst<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [s2explst_alpha]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">local</span>

<span class="keyword">fun</span> aux_s2exp <span class="keyword">(</span>
  s2e0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span>
<span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2e0<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Eapp <span class="keyword">(</span>s2e_fun<span class="keyword">,</span> s2es_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2e_fun<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2explst <span class="keyword">(</span>s2es_arg<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S2Echar _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2Eclo <span class="keyword">(</span>_<span class="keyword">,</span> _fun<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>_fun<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Ecrypt <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Ecst _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2Edatconptr <span class="keyword">(</span>d2c<span class="keyword">,</span> _arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2explst <span class="keyword">(</span>_arg<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Edatcontyp <span class="keyword">(</span>d2c<span class="keyword">,</span> _arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2explst <span class="keyword">(</span>_arg<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Eeff s2fe <span class="keyword">=&gt;</span> aux_s2eff <span class="keyword">(</span>s2fe<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Eeqeq <span class="keyword">(</span>s2e1<span class="keyword">,</span> s2e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2e1<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2exp <span class="keyword">(</span>s2e2<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Eeqeq]
</span>  <span class="keyword">|</span> S2Eexi <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2ps<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">var</span> fvs1 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18316"><span class="dyncstuse">s2varset_nil</span></a>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2explst <span class="keyword">(</span>s2ps<span class="keyword">,</span> fvs1<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs1<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fvs1 := <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18668"><span class="dyncstuse">s2varset_dels</span></a> <span class="keyword">(</span>fvs1<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">in</span>
      fvs := <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18732"><span class="dyncstuse">s2varset_union</span></a> <span class="keyword">(</span>fvs<span class="keyword">,</span> fvs1<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Eexi]
</span>  <span class="keyword">|</span> S2Eextype <span class="keyword">(</span>_<span class="comment">(*name*)</span><span class="keyword">,</span> _arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2explstlst <span class="keyword">(</span>_arg<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Efun <span class="keyword">(</span>
      _<span class="comment">(*funclo*)</span><span class="keyword">,</span> _<span class="comment">(*lin*)</span><span class="keyword">,</span> s2fe<span class="keyword">,</span> _<span class="comment">(*npf*)</span><span class="keyword">,</span> _arg<span class="keyword">,</span> _res
    <span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2eff <span class="keyword">(</span>s2fe<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2explst <span class="keyword">(</span>_arg<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2exp <span class="keyword">(</span>_res<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Efun]
</span>  <span class="keyword">|</span> S2Eint _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2Eintinf _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2Elam <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">var</span> fvs1 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18316"><span class="dyncstuse">s2varset_nil</span></a>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs1<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fvs1 := <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18668"><span class="dyncstuse">s2varset_dels</span></a> <span class="keyword">(</span>fvs1<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">in</span>
      fvs := <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18732"><span class="dyncstuse">s2varset_union</span></a> <span class="keyword">(</span>fvs<span class="keyword">,</span> fvs1<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Elam]
</span>  <span class="keyword">|</span> S2Emetfn <span class="keyword">(</span>_<span class="comment">(*d2vopt*)</span><span class="keyword">,</span> s2es<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explst <span class="keyword">(</span>s2es<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S2Emetlt <span class="keyword">(</span>s2es1<span class="keyword">,</span> s2es2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explst <span class="keyword">(</span>s2es1<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2explst <span class="keyword">(</span>s2es2<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [metlt]
</span><span class="comment">(*
// HX-2010-12-04: inadequate design
  | S2Enamed _ =&gt; () // a named type must be closed
*)</span>
  <span class="keyword">|</span> S2Eout s2e <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Eproj <span class="keyword">(</span>s2e<span class="comment">(*ptr*)</span><span class="keyword">,</span> s2l<span class="comment">(*lab*)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2lab <span class="keyword">(</span>s2l<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S2Eread <span class="keyword">(</span>_v<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>_v<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Eread]
</span>  <span class="keyword">|</span> S2Erefarg <span class="keyword">(</span>_<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Esel <span class="keyword">(</span>s2e<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Esize s2ze <span class="keyword">=&gt;</span> aux_s2zexp <span class="keyword">(</span>s2ze<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Esizeof s2e <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Etop <span class="keyword">(</span>_<span class="comment">(*knd*)</span><span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Etup s2es <span class="keyword">=&gt;</span> aux_s2explst <span class="keyword">(</span>s2es<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Etyarr <span class="keyword">(</span>s2e_elt<span class="keyword">,</span> s2ess_dim<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2e_elt<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2explstlst <span class="keyword">(</span>s2ess_dim<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Etyarr]
</span>  <span class="keyword">|</span> S2Etyleq <span class="keyword">(</span>_<span class="comment">(*knd*)</span><span class="keyword">,</span> s2e1<span class="keyword">,</span> s2e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2e1<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2exp <span class="keyword">(</span>s2e2<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Etyleq]
</span>  <span class="keyword">|</span> S2Etylst s2es <span class="keyword">=&gt;</span> aux_s2explst <span class="keyword">(</span>s2es<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Etyrec <span class="keyword">(</span>_<span class="comment">(*knd*)</span><span class="keyword">,</span> _<span class="comment">(*npf*)</span><span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_labs2explst <span class="keyword">(</span>ls2es<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Euni <span class="keyword">(</span>s2vs<span class="keyword">,</span> s2ps<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">var</span> fvs1 <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18316"><span class="dyncstuse">s2varset_nil</span></a>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2explst <span class="keyword">(</span>s2ps<span class="keyword">,</span> fvs1<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs1<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> fvs1 := <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18668"><span class="dyncstuse">s2varset_dels</span></a> <span class="keyword">(</span>fvs1<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">in</span>
      fvs := <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18732"><span class="dyncstuse">s2varset_union</span></a> <span class="keyword">(</span>fvs<span class="keyword">,</span> fvs1<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Euni]
</span>  <span class="keyword">|</span> S2Eunion <span class="keyword">(</span>_<span class="comment">(*stamp*)</span><span class="keyword">,</span> s2e_ind<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2e_ind<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_labs2explst <span class="keyword">(</span>ls2es<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S2Evar s2v <span class="keyword">=&gt;</span> <span class="keyword">(</span>fvs := <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18486"><span class="dyncstuse">s2varset_add</span></a> <span class="keyword">(</span>fvs<span class="keyword">,</span> s2v<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2EVar s2V <span class="keyword">=&gt;</span> aux_s2Var <span class="keyword">(</span>s2V<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Evararg s2e <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Ewth <span class="keyword">(</span>s2e<span class="keyword">,</span> wths2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_wths2explst <span class="keyword">(</span>wths2es<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Ewth]
</span><span class="comment">// end of [aux_s2exp]
</span>
<span class="keyword">and</span> aux_s2explst <span class="keyword">(</span>
  s2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span>
<span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2es <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2explst <span class="keyword">(</span>s2es<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [aux_s2explst]
</span>
<span class="keyword">and</span> aux_s2explstlst <span class="keyword">(</span>
  s2ess<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span>
<span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2ess <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2es<span class="keyword">,</span> s2ess<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explst <span class="keyword">(</span>s2es<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2explstlst <span class="keyword">(</span>s2ess<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [aux_s2explstlst]
</span>
<span class="keyword">and</span> aux_labs2explst <span class="keyword">(</span>
  ls2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span>
<span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> ls2es <span class="keyword">of</span>
  <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>_<span class="comment">(*lab*)</span><span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_labs2explst <span class="keyword">(</span>ls2es<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [LABS2EXPLSTcons]
</span>  <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [aux_labs2explst]
</span>
<span class="keyword">and</span> aux_wths2explst <span class="keyword">(</span>
  wths2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8597"><span class="stacstuse">wths2explst</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span>
<span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> wths2es <span class="keyword">of</span>
  <span class="keyword">|</span> WTHS2EXPLSTcons_some <span class="keyword">(</span>_<span class="comment">(*refval*)</span><span class="keyword">,</span> s2e<span class="keyword">,</span> wths2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_wths2explst <span class="keyword">(</span>wths2es<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [WTHS2EXPLSTcons_some]
</span>  <span class="keyword">|</span> WTHS2EXPLSTcons_none <span class="keyword">(</span>wths2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_wths2explst <span class="keyword">(</span>wths2es<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> WTHS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [aux_wths2explst]
</span>
<span class="keyword">and</span> aux_s2eff <span class="keyword">(</span>
  s2fe<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5355"><span class="stacstuse">s2eff</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span>
<span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> s2fe <span class="keyword">of</span>
  <span class="keyword">|</span> S2EFFall _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2EFFnil _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2EFFset <span class="keyword">(</span>_<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2explst <span class="keyword">(</span>s2es<span class="keyword">,</span> fvs<span class="keyword">)</span>
<span class="comment">// end of [aux_s2eff]
</span>
<span class="keyword">and</span> aux_s2lab <span class="keyword">(</span>
  s2l<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5454"><span class="stacstuse">s2lab</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span>
<span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">case+</span> s2l <span class="keyword">of</span>
  <span class="keyword">|</span> S2LAB0lab _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2LAB0ind s2ess_ind <span class="keyword">=&gt;</span> aux_s2explstlst <span class="keyword">(</span>s2ess_ind<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2LAB1lab <span class="keyword">(</span>_<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2LAB1ind <span class="keyword">(</span>s2ess_ind<span class="keyword">,</span> s2e_elt<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explstlst <span class="keyword">(</span>s2ess_ind<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2exp <span class="keyword">(</span>s2e_elt<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2LAB1ind]
</span><span class="comment">// end of [aux_s2lab]
</span>
<span class="keyword">and</span> aux_s2Var
  <span class="keyword">(</span>s2V<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19202"><span class="dyncstuse">s2Var_link_get</span></a> s2V <span class="keyword">of</span>
  <span class="keyword">|</span> Some s2e <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span> <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      prerr_loc_interror <span class="keyword">(</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19041"><span class="dyncstuse">s2Var_loc_get</span></a> s2V<span class="keyword">)</span><span class="keyword">;</span>
      prerr ": s2exp_freevars: s2V = "<span class="keyword">;</span> prerr s2V<span class="keyword">;</span> <a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fdyn_2esats.html#12890"><span class="dyncstuse">prerr_newline</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span>
      <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5ferror_2esats.html#1817"><span class="dyncstuse">$Err<span class="keyword">.</span>abort</span></a> <span class="staexp"><span class="keyword">{</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a><span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [None]
</span><span class="comment">// end of [aux_s2Var]
</span>
<span class="keyword">and</span> aux_s2zexp
  <span class="keyword">(</span>s2ze<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4854"><span class="stacstuse">s2zexp</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2ze <span class="keyword">of</span>
  <span class="keyword">|</span> S2ZEapp <span class="keyword">(</span>s2ze<span class="keyword">,</span> s2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2zexp <span class="keyword">(</span>s2ze<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2zexplst <span class="keyword">(</span>s2zes<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2ZEapp]
</span>  <span class="keyword">|</span> S2ZEbot <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2ZEcst _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2ZEextype _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2ZEptr <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2ZEtyarr <span class="keyword">(</span>s2ze_elt<span class="keyword">,</span> s2ess_dim<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2zexp <span class="keyword">(</span>s2ze_elt<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2explstlst <span class="keyword">(</span>s2ess_dim<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2ZEtyarr]
</span>  <span class="keyword">|</span> S2ZEtyrec <span class="keyword">(</span>_<span class="comment">(*knd*)</span><span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_labs2zexplst <span class="keyword">(</span>ls2zes<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2ZEunion <span class="keyword">(</span>_<span class="comment">(*stamp*)</span><span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_labs2zexplst <span class="keyword">(</span>ls2zes<span class="keyword">,</span> fvs<span class="keyword">)</span>
  <span class="keyword">|</span> S2ZEvar s2v <span class="keyword">=&gt;</span> <span class="keyword">(</span>fvs := <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18486"><span class="dyncstuse">s2varset_add</span></a> <span class="keyword">(</span>fvs<span class="keyword">,</span> s2v<span class="keyword">)</span><span class="keyword">)</span>
<span class="comment">// end of [aux_s2zexp]
</span>
<span class="keyword">and</span> aux_s2zexplst
  <span class="keyword">(</span>s2zes<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9072"><span class="stacstuse">s2zexplst</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2zes <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2ze<span class="keyword">,</span> s2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2zexp <span class="keyword">(</span>s2ze<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_s2zexplst <span class="keyword">(</span>s2zes<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [aux_s2zexplst]
</span>
<span class="keyword">and</span> aux_labs2zexplst
  <span class="keyword">(</span>ls2zes<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5236"><span class="stacstuse">labs2zexplst</span></a></span><span class="keyword">,</span> fvs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> ls2zes <span class="keyword">of</span>
  <span class="keyword">|</span> LABS2ZEXPLSTcons <span class="keyword">(</span>_<span class="comment">(*lab*)</span><span class="keyword">,</span> s2ze<span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2zexp <span class="keyword">(</span>s2ze<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> aux_labs2zexplst <span class="keyword">(</span>ls2zes<span class="keyword">,</span> fvs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [LABS2ZEXPLSTcons]
</span>  <span class="keyword">|</span> LABS2ZEXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [aux_labs2zexplst]
</span>
<span class="keyword">in</span>

<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34357"><span class="dyncstimp">s2exp_freevars</span></a> <span class="keyword">(</span>s2e<span class="keyword">)</span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">var</span> fvs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2327"><span class="stacstuse">s2varset_t</span></a></span> <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#18316"><span class="dyncstuse">s2varset_nil</span></a> <span class="keyword">in</span> aux_s2exp <span class="keyword">(</span>s2e<span class="keyword">,</span> fvs<span class="keyword">)</span><span class="keyword">;</span> fvs <span class="keyword">end</span>
<span class="comment">// end of [s2exp_freevars]
</span>
<span class="keyword">end</span> <span class="comment">// end of [local]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="keyword">local</span>

<span class="keyword">fun</span> aux_s2exp
  <span class="keyword">(</span>s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span><span class="keyword">,</span> s2e<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9276"><span class="stacstuse">s2exp</span></a></span><span class="keyword">,</span>
   ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2e<span class="keyword">.</span>s2exp_node <span class="keyword">of</span>
  <span class="keyword">|</span> S2Eapp <span class="keyword">(</span>s2e_fun<span class="keyword">,</span> s2es_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e_fun<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Eapp]
</span>  <span class="keyword">|</span> S2Echar _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2Eclo <span class="keyword">(</span>_<span class="comment">(*knd*)</span><span class="keyword">,</span> s2e_fun<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e_fun<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Ecrypt s2e <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Ecst s2c <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> sVs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#15015"><span class="dyncstuse">s2cst_sVarset_get</span></a> s2c <span class="keyword">in</span>
      <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#21411"><span class="dyncstuse">s2Varset_ismem</span></a> <span class="keyword">(</span>sVs<span class="keyword">,</span> s2V0<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">(</span>s2cs := S2CSTLSTcons <span class="keyword">(</span>s2c<span class="keyword">,</span> s2cs<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Ecst]
</span>  <span class="keyword">|</span> S2Edatconptr <span class="keyword">(</span>d2c<span class="keyword">,</span> s2es_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S2Edatcontyp <span class="keyword">(</span>d2c<span class="keyword">,</span> s2es_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es_arg<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Edatcontyp]
</span>  <span class="keyword">|</span> S2Eeff s2fe <span class="keyword">=&gt;</span> aux_s2eff <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2fe<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Eeqeq <span class="keyword">(</span>s2e1<span class="keyword">,</span> s2e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e1<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e2<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">}</span> <span class="comment">// end of [S2Eeqeq]
</span>  <span class="keyword">|</span> S2Eexi <span class="keyword">(</span>_<span class="keyword">,</span> s2ps<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ps<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">}</span> <span class="comment">// end of [S2Eexi]
</span>  <span class="keyword">|</span> S2Eextype <span class="keyword">(</span>_<span class="comment">(*name*)</span><span class="keyword">,</span> _arg<span class="keyword">)</span> <span class="keyword">=&gt;</span>
      aux_s2explstlst <span class="keyword">(</span>s2V0<span class="keyword">,</span> _arg<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="comment">// end of [S2Eextype]
</span>  <span class="keyword">|</span> S2Efun <span class="keyword">(</span>
      _<span class="comment">(*funclo*)</span><span class="keyword">,</span> _<span class="comment">(*lin*)</span><span class="keyword">,</span> s2fe<span class="keyword">,</span> _<span class="comment">(*npf*)</span><span class="keyword">,</span> _arg<span class="keyword">,</span> _res
    <span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2eff <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2fe<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> _arg<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> _res<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">}</span> <span class="comment">// end of [S2Efun]
</span>  <span class="keyword">|</span> S2Eint _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2Eintinf _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2Elam <span class="keyword">(</span>_<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Emetfn <span class="keyword">(</span>
      _<span class="comment">(*d2vopt*)</span><span class="keyword">,</span> s2es<span class="keyword">,</span> s2e
    <span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">where</span> <span class="keyword">{</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
      <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">}</span> <span class="comment">// end of [S2Emetfn]
</span>  <span class="keyword">|</span> S2Emetlt <span class="keyword">(</span>s2es1<span class="keyword">,</span> s2es2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es1<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es2<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Emetlt]
</span><span class="comment">(*
// HX-2010-12-04: inadequate design
  | S2Enamed _ =&gt; () // a named type should be closed
*)</span>
  <span class="keyword">|</span> S2Eout s2e <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Eproj <span class="keyword">(</span>s2e<span class="keyword">,</span> s2l<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2lab <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2l<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Eproj]
</span>  <span class="keyword">|</span> S2Eread <span class="keyword">(</span>_v<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> _v<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Eread]
</span>  <span class="keyword">|</span> S2Erefarg <span class="keyword">(</span>_<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Erefarg]
</span>  <span class="keyword">|</span> S2Esel <span class="keyword">(</span>s2e<span class="keyword">,</span> _<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Esize s2ze <span class="keyword">=&gt;</span> aux_s2zexp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ze<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Esizeof s2e <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Etop <span class="keyword">(</span>_knd<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Etup s2es <span class="keyword">=&gt;</span> aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Etyarr <span class="keyword">(</span>s2e_elt<span class="keyword">,</span> s2ess_dim<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e_elt<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2explstlst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ess_dim<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Etyarr]
</span>  <span class="keyword">|</span> S2Etyleq <span class="keyword">(</span>_knd<span class="keyword">,</span> s2e1<span class="keyword">,</span> s2e2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e1<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e2<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Etyleq]
</span>  <span class="keyword">|</span> S2Etylst s2es <span class="keyword">=&gt;</span> aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Etyrec <span class="keyword">(</span>_knd<span class="keyword">,</span> _npf<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_labs2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> ls2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Etyrec]
</span>  <span class="keyword">|</span> S2Euni <span class="keyword">(</span>_<span class="keyword">,</span> s2ps<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ps<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Euni]
</span>  <span class="keyword">|</span> S2Eunion <span class="keyword">(</span>_stamp<span class="keyword">,</span> s2e_ind<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e_ind<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_labs2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> ls2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Eunion]
</span>  <span class="keyword">|</span> S2Evar s2v <span class="keyword">=&gt;</span> aux_s2var <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2v<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2EVar s2V <span class="keyword">=&gt;</span> aux_s2Var <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2V<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Evararg s2e <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2Ewth <span class="keyword">(</span>s2e<span class="keyword">,</span> wths2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_wths2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> wths2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2Ewth]
</span><span class="comment">// end of [aux_s2exp]
</span>
<span class="keyword">and</span> aux_s2explst <span class="keyword">(</span>
    s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span>
  <span class="keyword">,</span> s2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9393"><span class="stacstuse">s2explst</span></a></span>
  <span class="keyword">,</span> ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2es <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2e<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">(* end of [list_cons] *)</span>
  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [aux_s2explst]
</span>
<span class="keyword">and</span> aux_s2explstlst <span class="keyword">(</span>
    s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span>
  <span class="keyword">,</span> s2ess<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9489"><span class="stacstuse">s2explstlst</span></a></span>
  <span class="keyword">,</span> ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2ess <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2es<span class="keyword">,</span> s2ess<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2explstlst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ess<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [aux_s2explstlst]
</span>
<span class="keyword">and</span> aux_labs2explst <span class="keyword">(</span>
    s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span>
  <span class="keyword">,</span> ls2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8353"><span class="stacstuse">labs2explst</span></a></span>
  <span class="keyword">,</span> ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> ls2es <span class="keyword">of</span>
  <span class="keyword">|</span> LABS2EXPLSTcons <span class="keyword">(</span>_<span class="comment">(*lab*)</span><span class="keyword">,</span> s2e<span class="keyword">,</span> ls2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_labs2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> ls2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [LABS2EXPLSTcons]
</span>  <span class="keyword">|</span> LABS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [aux_labs2explst]
</span>
<span class="keyword">and</span> aux_wths2explst
  <span class="keyword">(</span>s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span><span class="keyword">,</span> wths2es<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#8597"><span class="stacstuse">wths2explst</span></a></span><span class="keyword">,</span>
   ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> wths2es <span class="keyword">of</span>
  <span class="keyword">|</span> WTHS2EXPLSTcons_some <span class="keyword">(</span>_<span class="comment">(*refval*)</span><span class="keyword">,</span> s2e<span class="keyword">,</span> wths2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_wths2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> wths2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> WTHS2EXPLSTcons_none wths2es <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_wths2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> wths2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> WTHS2EXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [aux_wths2explst]
</span>
<span class="keyword">and</span> aux_s2eff <span class="keyword">(</span>
    s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span>
  <span class="keyword">,</span> s2fe<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5355"><span class="stacstuse">s2eff</span></a></span>
  <span class="keyword">,</span> ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2fe <span class="keyword">of</span>
  <span class="keyword">|</span> S2EFFall _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2EFFnil _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2EFFset <span class="keyword">(</span>_<span class="keyword">,</span> s2es<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2explst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2es<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of[aux_s2eff]
</span>
<span class="keyword">and</span> aux_s2lab <span class="keyword">(</span>
    s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span>
  <span class="keyword">,</span> s2l<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5454"><span class="stacstuse">s2lab</span></a></span>
  <span class="keyword">,</span> ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> s2l <span class="keyword">of</span>
  <span class="keyword">|</span> S2LAB0lab _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2LAB0ind <span class="keyword">(</span>s2ess<span class="comment">(*ind*)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explstlst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ess<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [S2LAB0ind]
</span>  <span class="keyword">|</span> S2LAB1lab <span class="keyword">(</span>_<span class="keyword">,</span> s2e<span class="keyword">)</span> <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> S2LAB1ind <span class="keyword">(</span>s2ess<span class="comment">(*ind*)</span><span class="keyword">,</span> s2e<span class="comment">(*elt*)</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2explstlst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ess<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">(* end of [S2LAB1ind] *)</span>
<span class="keyword">end</span> <span class="comment">// end of [aux_s2lab]
</span>
<span class="keyword">and</span> aux_s2var <span class="keyword">(</span>
    s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span>
  <span class="keyword">,</span> s2v<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2272"><span class="stacstuse">s2var_t</span></a></span>
  <span class="keyword">,</span> ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> sVs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#16956"><span class="dyncstuse">s2var_sVarset_get</span></a> s2v <span class="keyword">in</span>
  <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#21411"><span class="dyncstuse">s2Varset_ismem</span></a> <span class="keyword">(</span>sVs<span class="keyword">,</span> s2V0<span class="keyword">)</span>
    <span class="keyword">then</span> <span class="keyword">(</span>s2vs := list_cons <span class="keyword">(</span>s2v<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">)</span>
  <span class="comment">// end of [if]
</span><span class="keyword">end</span> <span class="comment">// end of [aux_s2var]
</span>
<span class="keyword">and</span> aux_s2Var <span class="keyword">(</span>
    s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span>
  <span class="keyword">,</span> s2V<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span>
  <span class="keyword">,</span> ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span>
  <span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span>
  <span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19202"><span class="dyncstuse">s2Var_link_get</span></a> s2V <span class="keyword">of</span>
  <span class="keyword">|</span> Some s2e <span class="keyword">=&gt;</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
  <span class="keyword">|</span> None <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">val</span> tst <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#20038"><span class="dyncstuse">eq_s2Var_s2Var</span></a> <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2V<span class="keyword">)</span> <span class="keyword">in</span>
      <span class="keyword">if</span> tst <span class="keyword">then</span>
        <span class="keyword">(</span>ans := ans + 1<span class="keyword">)</span>
      <span class="keyword">else</span> <span class="keyword">let</span>
        <span class="keyword">val</span> sVs <span class="keyword">=</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#19553"><span class="dyncstuse">s2Var_sVarset_get</span></a> s2V <span class="keyword">in</span>
        <span class="keyword">if</span> <a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#21411"><span class="dyncstuse">s2Varset_ismem</span></a> <span class="keyword">(</span>sVs<span class="keyword">,</span> s2V0<span class="keyword">)</span> <span class="keyword">then</span> <span class="keyword">(</span>ans := ans + 1<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [if]
</span>    <span class="keyword">end</span> <span class="comment">(* end of [None] *)</span>
<span class="keyword">end</span> <span class="comment">// end of [aux_s2Var]
</span>
<span class="keyword">and</span> aux_s2zexp <span class="keyword">(</span>
    s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span>
  <span class="keyword">,</span> s2ze<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#4854"><span class="stacstuse">s2zexp</span></a></span>
  <span class="keyword">,</span> ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> s2ze <span class="keyword">of</span>
  <span class="keyword">|</span> S2ZEapp <span class="keyword">(</span>s2ze_fun<span class="keyword">,</span> s2zes_arg<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2zexp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ze_fun<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2zexplst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2zes_arg<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S2ZEbot <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2ZEcst _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2ZEextype _ <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2ZEptr <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">|</span> S2ZEtyarr <span class="keyword">(</span>s2ze_elt<span class="keyword">,</span> s2ess_dim<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2zexp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ze_elt<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2explstlst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ess_dim<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S2ZEtyrec <span class="keyword">(</span>_<span class="comment">(*knd*)</span><span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_labs2zexplst <span class="keyword">(</span>s2V0<span class="keyword">,</span> ls2zes<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S2ZEunion <span class="keyword">(</span>_<span class="comment">(*stamp*)</span><span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_labs2zexplst <span class="keyword">(</span>s2V0<span class="keyword">,</span> ls2zes<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> S2ZEvar s2v <span class="keyword">=&gt;</span> aux_s2var <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2v<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [aux_s2zexp]
</span>
<span class="keyword">and</span> aux_s2zexplst
  <span class="keyword">(</span>s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span><span class="keyword">,</span> s2zes<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#9072"><span class="stacstuse">s2zexplst</span></a></span><span class="keyword">,</span>
   ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> s2zes <span class="keyword">of</span>
  <span class="keyword">|</span> list_cons <span class="keyword">(</span>s2ze<span class="keyword">,</span> s2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2zexp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ze<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_s2zexplst <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2zes<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">// end of [list_cons]
</span>  <span class="keyword">|</span> list_nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [aux_s2zexplst]
</span>
<span class="keyword">and</span> aux_labs2zexplst
  <span class="keyword">(</span>s2V0<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2386"><span class="stacstuse">s2Var_t</span></a></span><span class="keyword">,</span> ls2zes<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#5236"><span class="stacstuse">labs2zexplst</span></a></span><span class="keyword">,</span>
   ans<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span></a></span><span class="keyword">,</span> s2cs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2880"><span class="stacstuse">s2cstlst</span></a></span></a></span><span class="keyword">,</span> s2vs<span class="keyword">:</span> <span class="staexp"><span class="keyword">&amp;</span><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse"><a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#2615"><span class="stacstuse">s2varlst</span></a></span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#16293"><span class="stacstuse">void</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> ls2zes <span class="keyword">of</span>
  <span class="keyword">|</span> LABS2ZEXPLSTcons <span class="keyword">(</span>_<span class="comment">(*lab*)</span><span class="keyword">,</span> s2ze<span class="keyword">,</span> ls2zes<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      aux_s2zexp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2ze<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span><span class="keyword">;</span>
      aux_labs2zexplst <span class="keyword">(</span>s2V0<span class="keyword">,</span> ls2zes<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
    <span class="keyword">end</span> <span class="comment">(* end of [LABS2ZEXPLSTcons] *)</span>
  <span class="keyword">|</span> LABS2ZEXPLSTnil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
<span class="comment">// end of [aux_labs2zexplst]
</span>
<span class="keyword">in</span> <span class="comment">// in of [local]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fscratch_2ftmp_2fATS_2d0_2e2_2e3_2fsrc_2fats_5fstaexp2_2esats.html#34399"><span class="dyncstimp">s2Var_s2exp_occurs</span></a>
  <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span> <span class="keyword">=</span> ans <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">var</span> ans<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2ftmp_2fATS_2d0_2e2_2e3_2fprelude_2fbasics_5fsta_2esats.html#15410"><span class="stacstuse">int</span></a></span> <span class="keyword">=</span> 0<span class="keyword">;</span> <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> aux_s2exp <span class="keyword">(</span>s2V0<span class="keyword">,</span> s2e<span class="keyword">,</span> ans<span class="keyword">,</span> s2cs<span class="keyword">,</span> s2vs<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [s2Var_s2exp_occurs]
</span>
<span class="keyword">end</span> <span class="comment">// end of [local]
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [ats_staexp2_util1.dats] *)</span>
</pre>
</body>
</html>
