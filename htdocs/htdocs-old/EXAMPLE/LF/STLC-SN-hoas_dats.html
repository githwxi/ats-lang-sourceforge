<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    span.comment {color:#787878;font-style:italic}
    span.extern  {color:#A52A2A}
    span.keyword {color:#000000;font-weight:bold}
    span.neuexp  {color:#800080}
    span.staexp  {color:#0000FF}
    span.dynexp  {color:#E80000}
    span.prfexp  {color:#009000}
    span.stacstdec  {text-decoration:none}
    span.stacstuse  {color:#0000CF;text-decoration:underline}
    span.dyncstdec  {text-decoration:none}
    span.dyncstimp  {color:#B80000;text-decoration:underline}
    span.dyncstuse  {color:#B80000;text-decoration:underline}
    body          {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre>
<span class="comment">//
</span><span class="comment">//
</span><span class="comment">// simply typed lambda calculus is strongly-normalizing
</span><span class="comment">// This formalization uses higher-order abstract syntax for lambda-terms.
</span><span class="comment">//
</span><span class="comment">//
</span>
<span class="comment">// April 2006:
</span><span class="comment">// It is completed by Kevin Donnelly and Hongwei Xi
</span>
<span class="comment">// January 2007:
</span><span class="comment">// It is ported to ATS/Geizella by Hongwei Xi
</span>
<span class="comment">// March 3rd, 2008
</span><span class="comment">// It is ported to ATS/Anairiats by Hongwei Xi
</span>
<span class="comment">(* ****** ****** *)</span>

<span class="comment">// This is a proof based on Tait's method of reducibility predicates
</span>
<span class="comment">(* Syntax *)</span>
<span class="comment">// definition of sort 'tm' of HOAS terms
</span><span class="keyword">dataparasort</span> <span class="staexp">tm <span class="keyword">=</span>
  TMcst <span class="keyword">of</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">|</span> TMlam <span class="keyword">of</span> <span class="keyword">(</span>tm <span class="keyword">-&gt;</span> tm<span class="keyword">)</span> <span class="keyword">|</span> TMapp <span class="keyword">of</span> <span class="keyword">(</span>tm<span class="keyword">,</span> tm<span class="keyword">)</span></span>

<span class="comment">// definition of sort 'tp' for simple types with a base type
</span><span class="keyword">datasort</span> <span class="staexp">tp <span class="keyword">=</span> TPbas <span class="keyword">|</span> TPfun <span class="keyword">of</span> <span class="keyword">(</span>tp<span class="keyword">,</span> tp<span class="keyword">)</span></span> 

<span class="comment">// sort for typing contexts (really, typed substitutions)
</span><span class="keyword">datasort</span> <span class="staexp">ctx <span class="keyword">=</span> CTXnil <span class="keyword">|</span> CTXcons <span class="keyword">of</span> <span class="keyword">(</span>tm<span class="keyword">,</span> tp<span class="keyword">,</span> ctx<span class="keyword">)</span></span>

<span class="comment">(* Reduction *)</span>
<span class="comment">// small-step reduction
</span><span class="comment">// RED(t, t', n) represents n length derivations of t --&gt; t'
</span><span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="883"><span class="stacstdec">RED <span class="keyword">(</span>tm<span class="keyword">,</span> tm<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">f<span class="keyword">,</span>f'<span class="keyword">:</span>tm<span class="keyword">-&gt;</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      REDlam <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f'<span class="keyword">,</span> s<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">{</span>x<span class="keyword">:</span>tm<span class="keyword">}</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#883"><span class="stacstuse">RED</span></a> <span class="keyword">(</span>f x<span class="keyword">,</span> f' x<span class="keyword">,</span> s<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">,</span>t1'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      REDapp1 <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a> <span class="keyword">(</span>t1'<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> s<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#883"><span class="stacstuse">RED</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t1'<span class="keyword">,</span> s<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">,</span>t2'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">s<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      REDapp2 <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2'<span class="keyword">)</span><span class="keyword">,</span> s<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#883"><span class="stacstuse">RED</span></a> <span class="keyword">(</span>t2<span class="keyword">,</span> t2'<span class="keyword">,</span> s<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">f<span class="keyword">:</span>tm<span class="keyword">-&gt;</span>tm</span><span class="keyword">;</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> REDapp3 <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> f t<span class="keyword">,</span> 0<span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="1265"><span class="stacstdec">RED0 <span class="keyword">(</span>t<span class="keyword">:</span>tm<span class="keyword">,</span> t'<span class="keyword">:</span>tm<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>s<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#883"><span class="stacstuse">RED</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">,</span> s<span class="keyword">)</span></span></a></span>

<span class="comment">(* Type Assignment *)</span>
<span class="comment">// dynamic type representation (and index for structural induction on types)
</span><span class="comment">// TP (t) represents derivations of the judgment 't type'
</span><span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1476"><span class="stacstdec">TP <span class="keyword">(</span>tp<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> TPbas <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#637"><span class="stacstuse">TPbas</span></a><span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp</span><span class="keyword">}</span> TPfun <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#645"><span class="stacstuse">TPfun</span></a> <span class="keyword">(</span>T1<span class="keyword">,</span>T2<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T1<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T2<span class="keyword">)</span></span></span>

<span class="comment">// Context lookup, INCTX(t, T, G) represents (t: T) \in G
</span><span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1627"><span class="stacstdec">INCTX <span class="keyword">(</span>tm<span class="keyword">,</span>tp<span class="keyword">,</span>ctx<span class="keyword">)</span></span></a></span> <span class="keyword">=</span> 
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>ctx</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span> INCTXone<span class="staexp"><span class="keyword">(</span>t<span class="keyword">,</span>T<span class="keyword">,</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#747"><span class="stacstuse">CTXcons</span></a><span class="keyword">(</span>t<span class="keyword">,</span>T<span class="keyword">,</span>G<span class="keyword">)</span><span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>ctx</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">,</span>t'<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">,</span>T'<span class="keyword">:</span>tp</span><span class="keyword">}</span>
      INCTXshi<span class="staexp"><span class="keyword">(</span>t<span class="keyword">,</span>T<span class="keyword">,</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#747"><span class="stacstuse">CTXcons</span></a><span class="keyword">(</span>t'<span class="keyword">,</span>T'<span class="keyword">,</span>G<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1627"><span class="stacstuse">INCTX</span></a><span class="keyword">(</span>t<span class="keyword">,</span>T<span class="keyword">,</span>G<span class="keyword">)</span></span></span>

<span class="comment">// typing derivations in first-order representation
</span><span class="comment">// DER(G, t, T, n) represents n length derivations of G |- t: T
</span><span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="1914"><span class="stacstdec">DER <span class="keyword">(</span>ctx<span class="keyword">,</span>tm<span class="keyword">,</span>tp<span class="keyword">,</span>int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>ctx</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span>
      DERvar<span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span>t<span class="keyword">,</span>T<span class="keyword">,</span>0<span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1627"><span class="stacstuse">INCTX</span></a> <span class="keyword">(</span>t<span class="keyword">,</span>T<span class="keyword">,</span>G<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T<span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>ctx</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">f<span class="keyword">:</span>tm<span class="keyword">-&gt;</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span>
      DERlam <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#645"><span class="stacstuse">TPfun</span></a><span class="keyword">(</span>T1<span class="keyword">,</span>T2<span class="keyword">)</span><span class="keyword">,</span> n<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T1<span class="keyword">,</span> <span class="keyword">{</span>x<span class="keyword">:</span>tm<span class="keyword">}</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1914"><span class="stacstuse">DER</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#747"><span class="stacstuse">CTXcons</span></a> <span class="keyword">(</span>x<span class="keyword">,</span>T1<span class="keyword">,</span>G<span class="keyword">)</span><span class="keyword">,</span> f x<span class="keyword">,</span> T2<span class="keyword">,</span> n<span class="keyword">)</span><span class="keyword">)</span></span>

  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>ctx</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat</span><span class="keyword">}</span> 
      DERapp <span class="staexp"><span class="keyword">(</span>G<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a><span class="keyword">(</span>t1<span class="keyword">,</span>t2<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">,</span> n1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n2<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>1<span class="keyword">)</span></span> <span class="keyword">of</span>
        <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1914"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> t1<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#645"><span class="stacstuse">TPfun</span></a><span class="keyword">(</span>T1<span class="keyword">,</span>T2<span class="keyword">)</span><span class="keyword">,</span> n1<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1914"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> t2<span class="keyword">,</span> T1<span class="keyword">,</span> n2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="2323"><span class="stacstdec">DER0 <span class="keyword">(</span>G<span class="keyword">:</span>ctx<span class="keyword">,</span>t<span class="keyword">:</span>tm<span class="keyword">,</span>T<span class="keyword">:</span>tp<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1914"><span class="stacstuse">DER</span></a> <span class="keyword">(</span>G<span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="comment">(* Strong Normalization *)</span>
<span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="2410"><span class="stacstdec">SN <span class="keyword">(</span>tm<span class="keyword">,</span> int<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">n<span class="keyword">:</span>nat</span><span class="keyword">}</span> SN <span class="staexp"><span class="keyword">(</span>t<span class="keyword">,</span>n<span class="keyword">)</span></span> <span class="keyword">of</span> 
      <span class="staexp"><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a><span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> <span class="keyword">[</span>n'<span class="keyword">:</span>nat <span class="keyword">|</span> n' <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> n<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a><span class="keyword">(</span>t'<span class="keyword">,</span>n'<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">propdef</span> <span class="staexp"><a name="2529"><span class="stacstdec">SN0<span class="keyword">(</span>t<span class="keyword">:</span>tm<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">[</span>n<span class="keyword">:</span>nat<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a><span class="keyword">(</span>t<span class="keyword">,</span> n<span class="keyword">)</span></span></a></span>

<span class="comment">//
</span>
<span class="comment">// If everything t reduces to is SN then t is SN.  We leave this as an
</span><span class="comment">// unproven lemma because it is obvious, but has a complicated formal proof.
</span><span class="keyword">extern</span> <span class="keyword">prval</span> <a name="2724"><span class="dyncstdec"><span class="prfexp">backwardSN <span class="keyword">:</span>
  <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span> <span class="keyword">(</span><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2529"><span class="stacstuse">SN0</span></a> t'<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2529"><span class="stacstuse">SN0</span></a> t</span></span></span></a>

<span class="comment">// SN is closed under reduction
</span><span class="keyword">prfn</span> <span class="prfexp">forwardSN <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span>
  <span class="keyword">(</span>sn <span class="keyword">:</span><span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a><span class="keyword">(</span>t<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">,</span> red <span class="keyword">:</span><span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a><span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><span class="keyword">[</span>n'<span class="keyword">:</span>nat <span class="keyword">|</span> n' <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> n<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a><span class="keyword">(</span>t'<span class="keyword">,</span> n'<span class="keyword">)</span></span> <span class="keyword">=</span>
  <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">SN fsn <span class="keyword">=</span> sn</span> <span class="keyword">in</span> fsn red <span class="keyword">end</span></span>

<span class="comment">(* Reducibility *)</span>
<span class="comment">// reducibility
</span><span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="3013"><span class="stacstdec">R<span class="keyword">(</span>tm<span class="keyword">,</span> tp<span class="keyword">)</span></span></a></span> <span class="keyword">=</span> 
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> Rbas<span class="staexp"><span class="keyword">(</span>t<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#637"><span class="stacstuse">TPbas</span></a><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2529"><span class="stacstuse">SN0</span></a><span class="keyword">(</span>t<span class="keyword">)</span></span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp</span><span class="keyword">}</span>
      Rfun <span class="staexp"><span class="keyword">(</span>t<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#645"><span class="stacstuse">TPfun</span></a><span class="keyword">(</span>T1<span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">:</span>tm<span class="keyword">}</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t1<span class="keyword">,</span> T1<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a><span class="keyword">(</span>t<span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span></span>

<span class="comment">// sequence of redubility predicates for a substitution
</span><span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="3228"><span class="stacstdec">RS <span class="keyword">(</span>ctx<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">G<span class="keyword">:</span>ctx</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">t<span class="keyword">:</span>tm</span><span class="keyword">}</span> <span class="keyword">{</span><span class="staexp">T<span class="keyword">:</span>tp</span><span class="keyword">}</span> RScons<span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#747"><span class="stacstuse">CTXcons</span></a><span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">,</span> G<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">of</span> <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3228"><span class="stacstuse">RS</span></a> G<span class="keyword">)</span></span>
  <span class="keyword">|</span> RSnil <span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#738"><span class="stacstuse">CTXnil</span></a><span class="keyword">)</span></span></span>

<span class="comment">// definition of neutral terms
</span><span class="keyword">dataprop</span> <span class="prfexp"><span class="staexp"><a name="3369"><span class="stacstdec">NEU <span class="keyword">(</span>tm<span class="keyword">)</span></span></a></span> <span class="keyword">=</span>
  <span class="keyword">|</span> NEUcst<span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#507"><span class="stacstuse">TMcst</span></a><span class="keyword">)</span></span> <span class="keyword">|</span> <span class="keyword">{</span><span class="staexp">t1<span class="keyword">,</span>t2<span class="keyword">:</span>tm</span><span class="keyword">}</span> NEUapp<span class="staexp"><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a><span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">)</span></span></span>

<span class="keyword">prfun</span> <span class="prfexp">lamSN <span class="staexp"><span class="keyword">{</span>f<span class="keyword">:</span>tm<span class="keyword">-&gt;</span>tm<span class="keyword">;</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>sn<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a> <span class="keyword">(</span>f t<span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> n<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prval</span> <span class="prfexp">SN fsn <span class="keyword">=</span> sn</span>
  <span class="keyword">prfn</span> <span class="prfexp">fsn' <span class="staexp"><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span>
    <span class="keyword">(</span>rd<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:&lt;&gt;</span> <span class="staexp"><span class="keyword">[</span>n'<span class="keyword">:</span>nat <span class="keyword">|</span> n' <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#7294"><span class="stacstuse"><span class="keyword">&lt;</span></span></a> n<span class="keyword">]</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a> <span class="keyword">(</span>t'<span class="keyword">,</span> n'<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
    <span class="keyword">prval</span> <span class="prfexp">REDlam <span class="staexp"><span class="keyword">{</span>f<span class="keyword">,</span>f'<span class="keyword">}</span></span> frd <span class="keyword">=</span> rd</span>
  <span class="keyword">in</span>
    lamSN <span class="staexp"><span class="keyword">{</span>f'<span class="keyword">,</span>t<span class="keyword">}</span></span> <span class="keyword">(</span>fsn <span class="keyword">(</span>frd <span class="staexp"><span class="keyword">{</span>t<span class="keyword">}</span></span><span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">end</span></span> <span class="comment">// end of [fsn']
</span><span class="keyword">in</span>
  SN <span class="keyword">(</span>fsn'<span class="keyword">)</span>     
<span class="keyword">end</span></span> <span class="comment">// end of [lamSN]
</span>
<span class="comment">//
</span>
<span class="keyword">prfun</span> <span class="prfexp">appSN1 <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">,</span>t2<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>sn<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t2<span class="keyword">)</span><span class="keyword">,</span> n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2529"><span class="stacstuse">SN0</span></a> t1</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prval</span> <span class="prfexp">SN fsn <span class="keyword">=</span> sn</span>
  <span class="keyword">prfn</span> <span class="prfexp">fsn1 <span class="staexp"><span class="keyword">{</span>t1'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>red<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> t1'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2529"><span class="stacstuse">SN0</span></a> <span class="keyword">(</span>t1'<span class="keyword">)</span></span> <span class="keyword">=</span>
    appSN1 <span class="keyword">(</span>fsn <span class="keyword">(</span>REDapp1 <span class="keyword">(</span>red<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>
<span class="keyword">in</span>
  <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2724"><span class="dyncstuse">backwardSN</span></a> <span class="keyword">(</span>fsn1<span class="keyword">)</span>
<span class="keyword">end</span></span> <span class="comment">// end of [appSN1]
</span>
<span class="comment">//
</span>
<span class="comment">(* CR 2 *)</span>
<span class="comment">// R is preserved by forward reduction
</span><span class="keyword">prfun</span> <span class="prfexp">cr2 <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>T<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>r<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span></span><span class="keyword">,</span> rd<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a><span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t'<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> r <span class="keyword">of</span>
  <span class="keyword">|</span> Rbas sn <span class="keyword">=&gt;</span> Rbas <span class="keyword">(</span>forwardSN <span class="keyword">(</span>sn<span class="keyword">,</span> rd<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">|</span> Rfun <span class="staexp"><span class="keyword">{</span>t<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">}</span></span> <span class="keyword">(</span>fr<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
      Rfun <span class="keyword">(</span><span class="keyword">lam</span> <span class="keyword">(</span>r<span class="keyword">)</span> <span class="keyword">=&lt;&gt;</span> cr2 <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T2<span class="keyword">}</span></span> <span class="keyword">(</span>fr r<span class="keyword">,</span> REDapp1 rd<span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span></span> <span class="comment">// end of [cr2]
</span>
<span class="comment">(* CR 1 *)</span>
<span class="comment">// R implies strongly normalizing
</span><span class="keyword">prfun</span> <span class="prfexp">cr1 <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>T<span class="keyword">,</span>0<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>tp<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T</span><span class="keyword">,</span> pf<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2529"><span class="stacstuse">SN0</span></a><span class="keyword">(</span>t<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> pf <span class="keyword">of</span>
  <span class="keyword">|</span> Rbas sn <span class="keyword">=&gt;</span> sn
  <span class="keyword">|</span> Rfun fr <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">TPfun <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">)</span> <span class="keyword">=</span> tp</span>
    <span class="keyword">in</span>
      appSN1 <span class="keyword">(</span>cr1 <span class="keyword">(</span>tp2<span class="keyword">,</span> fr <span class="keyword">(</span>cr4 tp1<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span> <span class="comment">// end of [cr1]
</span>
<span class="comment">(* CR4 *)</span>
<span class="keyword">and</span> cr4 <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>T<span class="keyword">,</span>2<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>tp<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#507"><span class="stacstuse">TMcst</span></a><span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prfn</span> <span class="prfexp">fr <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>red<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#507"><span class="stacstuse">TMcst</span></a><span class="keyword">,</span> t<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> red <span class="keyword">of</span> REDlam _ <span class="keyword">=/=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span></span>
<span class="keyword">in</span>
  cr3 <span class="keyword">(</span>NEUcst <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> tp<span class="keyword">,</span> fr<span class="keyword">)</span>
<span class="keyword">end</span> <span class="comment">// end of [cr4]
</span>
<span class="comment">(* CR 3*)</span>
<span class="comment">// (NEU t and for all t' such that t --&gt; t' we have R(t',T)) implies R(t,T)
</span><span class="keyword">and</span> cr3 <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>T<span class="keyword">,</span>1<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>
    neu<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3369"><span class="stacstuse">NEU</span></a><span class="keyword">(</span>t<span class="keyword">)</span></span>
  <span class="keyword">,</span> tp<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T</span>
  <span class="keyword">,</span> fr<span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a><span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t'<span class="keyword">,</span> T<span class="keyword">)</span></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prval</span> <span class="prfexp">fsn <span class="keyword">=</span> <span class="keyword">lam</span> <span class="staexp"><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">=&gt;</span> <span class="keyword">lam</span> <span class="keyword">(</span>red<span class="keyword">:</span><span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a><span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span> <span class="keyword">=&lt;&gt;</span> cr1 <span class="keyword">(</span>tp<span class="keyword">,</span> fr red<span class="keyword">)</span></span>
  <span class="keyword">prval</span> <span class="prfexp">sn <span class="keyword">=</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2724"><span class="dyncstuse">backwardSN</span></a> fsn</span>
<span class="keyword">in</span>
  <span class="keyword">case+</span> tp <span class="keyword">of</span>
  <span class="keyword">|</span> TPbas<span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> Rbas sn
  <span class="keyword">|</span> TPfun <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">}</span></span> <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prfn</span> <span class="prfexp">fr <span class="staexp"><span class="keyword">{</span>t1<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>r1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> T1<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span>
        cr3a <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">,</span> neu<span class="keyword">,</span> r1<span class="keyword">,</span> cr1 <span class="keyword">(</span>tp1<span class="keyword">,</span> r1<span class="keyword">)</span><span class="keyword">,</span> fr<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      Rfun fr
    <span class="keyword">end</span>
<span class="keyword">end</span> <span class="comment">// end of [cr3]
</span>
<span class="keyword">and</span> cr3a <span class="staexp"><span class="keyword">{</span>t<span class="keyword">,</span>t1<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>m<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>T2<span class="keyword">,</span> m<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>2<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>
    tp1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T1</span>
  <span class="keyword">,</span> tp2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T2</span>
  <span class="keyword">,</span> neu<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3369"><span class="stacstuse">NEU</span></a> t</span>
  <span class="keyword">,</span> r1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> T1<span class="keyword">)</span></span>
  <span class="keyword">,</span> sn1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a> <span class="keyword">(</span>t1<span class="keyword">,</span> m<span class="keyword">)</span></span>
  <span class="keyword">,</span> f<span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t'<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a> <span class="keyword">(</span>t'<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#645"><span class="stacstuse">TPfun</span></a> <span class="keyword">(</span>T1<span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">)</span></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prfn</span> <span class="prfexp">ff <span class="staexp"><span class="keyword">{</span>tt<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>rd<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> t1<span class="keyword">)</span><span class="keyword">,</span> tt<span class="keyword">)</span></span><span class="keyword">)</span>
    <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a> <span class="keyword">(</span>tt<span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> rd <span class="keyword">of</span>
    <span class="keyword">|</span> REDapp1 rd <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">let</span> <span class="keyword">prval</span> <span class="prfexp">Rfun fr <span class="keyword">=</span> f rd</span> <span class="keyword">in</span> fr <span class="keyword">(</span>r1<span class="keyword">)</span> <span class="keyword">end</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> REDapp2 rd <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp">SN fsn1 <span class="keyword">=</span> sn1</span>
      <span class="keyword">in</span>
        cr3a <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">,</span> neu<span class="keyword">,</span> cr2 <span class="keyword">(</span>r1<span class="keyword">,</span> rd<span class="keyword">)</span><span class="keyword">,</span> fsn1 rd<span class="keyword">,</span> f<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> REDapp3 _ <span class="keyword">=/=&gt;</span> <span class="keyword">begin</span>
        <span class="keyword">case+</span> neu <span class="keyword">of</span> NEUcst<span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">|</span> NEUapp<span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">)</span>
      <span class="keyword">end</span>
  <span class="keyword">end</span></span> <span class="comment">// end of [ff]
</span><span class="keyword">in</span>
  cr3  <span class="keyword">(</span>NEUapp<span class="keyword">,</span> tp2<span class="keyword">,</span> ff<span class="keyword">)</span>
<span class="keyword">end</span></span> <span class="comment">// end of [cr3a]
</span>
<span class="comment">// application reducibility lemma
</span>
<span class="keyword">prfun</span> <span class="prfexp">reduceFun <span class="staexp"><span class="keyword">{</span>f<span class="keyword">:</span>tm<span class="keyword">-&gt;</span>tm<span class="keyword">;</span> t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n1<span class="keyword">,</span>n2<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n1<a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fprelude_2fbasics_5fsta_2esats.html#4604"><span class="stacstuse">+</span></a>n2<span class="keyword">&gt;.</span></span> <span class="keyword">(</span>
    tp1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T1</span>
  <span class="keyword">,</span> tp2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T2</span>
  <span class="keyword">,</span> sn1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> n1<span class="keyword">)</span></span>
  <span class="keyword">,</span> sn2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2410"><span class="stacstuse">SN</span></a><span class="keyword">(</span>t<span class="keyword">,</span> n2<span class="keyword">)</span></span>
  <span class="keyword">,</span> r1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span> T1<span class="keyword">)</span></span>
  <span class="keyword">,</span> fr2<span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span> T1<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>f t<span class="keyword">,</span> T2<span class="keyword">)</span></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prfn</span> <span class="prfexp">fr <span class="staexp"><span class="keyword">{</span>t'<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>red<span class="keyword">:</span><span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1265"><span class="stacstuse">RED0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> t'<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t'<span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> red <span class="keyword">of</span>
    <span class="keyword">|</span> REDapp1<span class="keyword">(</span>red'<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp">REDlam <span class="staexp"><span class="keyword">{</span>f<span class="keyword">,</span>f'<span class="keyword">}</span></span> fred' <span class="keyword">=</span> red'</span>
        <span class="keyword">prfn</span> <span class="prfexp">fr2' <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>r<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span> T1<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>f' t<span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span>
          cr2<span class="keyword">(</span>fr2 r<span class="keyword">,</span> fred'<span class="staexp"><span class="keyword">{</span>t<span class="keyword">}</span></span><span class="keyword">)</span></span>
      <span class="keyword">in</span>
        reduceFun<span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">,</span> forwardSN<span class="keyword">(</span>sn1<span class="keyword">,</span> red'<span class="keyword">)</span><span class="keyword">,</span> sn2<span class="keyword">,</span> r1<span class="keyword">,</span> fr2'<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> REDapp2<span class="keyword">(</span>red'<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">begin</span>
        reduceFun<span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">,</span> sn1<span class="keyword">,</span> forwardSN<span class="keyword">(</span>sn2<span class="keyword">,</span> red'<span class="keyword">)</span><span class="keyword">,</span> cr2<span class="keyword">(</span>r1<span class="keyword">,</span> red'<span class="keyword">)</span><span class="keyword">,</span> fr2<span class="keyword">)</span>
      <span class="keyword">end</span>
    <span class="keyword">|</span> REDapp3 <span class="staexp"><span class="keyword">{</span>f<span class="keyword">,</span> t<span class="keyword">}</span></span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> fr2 <span class="staexp"><span class="keyword">{</span>t<span class="keyword">}</span></span> <span class="keyword">(</span>r1<span class="keyword">)</span></span>
<span class="keyword">in</span>
  cr3<span class="keyword">(</span>NEUapp<span class="keyword">,</span> tp2<span class="keyword">,</span> fr<span class="keyword">)</span>
<span class="keyword">end</span></span> <span class="comment">// end of [reduceFun]
</span>
<span class="comment">// the abstraction rule is sound with respect to reducible terms
</span><span class="keyword">prfn</span> <span class="prfexp">absSound <span class="staexp"><span class="keyword">{</span>f<span class="keyword">:</span>tm<span class="keyword">-&gt;</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="keyword">(</span>
    tp1<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T1</span>
  <span class="keyword">,</span> tp2<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T2</span>
  <span class="keyword">,</span> frr<span class="keyword">:</span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span> T1<span class="keyword">)</span> <span class="keyword">-&lt;</span><span class="keyword">fun</span><span class="keyword">&gt;</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>f t<span class="keyword">,</span> T2<span class="keyword">)</span></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> <a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#645"><span class="stacstuse">TPfun</span></a><span class="keyword">(</span>T1<span class="keyword">,</span> T2<span class="keyword">)</span><span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">prfn</span> <span class="prfexp">fr <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>rt<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span> T1<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span>
    <span class="keyword">let</span> 
      <span class="keyword">prval</span> <span class="prfexp">snt <span class="keyword">=</span> cr1<span class="keyword">(</span>tp1<span class="keyword">,</span> rt<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">snf <span class="keyword">=</span> lamSN <span class="staexp"><span class="keyword">{</span>f<span class="keyword">,</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#507"><span class="stacstuse">TMcst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span>cr1 <span class="keyword">(</span>tp2<span class="keyword">,</span> frr <span class="staexp"><span class="keyword">{</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#507"><span class="stacstuse">TMcst</span></a><span class="keyword">}</span></span> <span class="keyword">(</span>cr4 tp1<span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></span>
    <span class="keyword">in</span>
      reduceFun <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">,</span> snf<span class="keyword">,</span> snt<span class="keyword">,</span> rt<span class="keyword">,</span> frr<span class="keyword">)</span>
    <span class="keyword">end</span></span>
<span class="keyword">in</span>
  Rfun<span class="keyword">(</span>fr<span class="keyword">)</span>
<span class="keyword">end</span></span> <span class="comment">// end of [absSound]
</span>
<span class="comment">// pick specified reducibility predicate from the sequence
</span><span class="keyword">prfun</span> <span class="prfexp">rGet <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>ctx<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>G<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>i<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1627"><span class="stacstuse">INCTX</span></a> <span class="keyword">(</span>t<span class="keyword">,</span>T<span class="keyword">,</span>G<span class="keyword">)</span></span><span class="keyword">,</span> rs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3228"><span class="stacstuse">RS</span></a> G</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span>T<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">case+</span> i <span class="keyword">of</span>
  <span class="keyword">|</span> INCTXone<span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">case+</span> rs <span class="keyword">of</span> RScons<span class="keyword">(</span>r<span class="keyword">,</span>_<span class="keyword">)</span> <span class="keyword">=&gt;</span> r<span class="keyword">)</span>
  <span class="keyword">|</span> INCTXshi i <span class="keyword">=&gt;</span> <span class="keyword">(</span><span class="keyword">case+</span> rs <span class="keyword">of</span> RScons<span class="keyword">(</span>_<span class="keyword">,</span>rs<span class="keyword">)</span> <span class="keyword">=&gt;</span> rGet<span class="keyword">(</span>i<span class="keyword">,</span> rs<span class="keyword">)</span><span class="keyword">)</span></span>

<span class="comment">// The assigned type can be extracted from a derivation
</span><span class="keyword">prfun</span> <span class="prfexp">der2tp <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>ctx<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>der<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1914"><span class="stacstuse">DER</span></a><span class="keyword">(</span>G<span class="keyword">,</span>t<span class="keyword">,</span>T<span class="keyword">,</span>n<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1476"><span class="stacstuse">TP</span></a> T</span> <span class="keyword">=</span> <span class="keyword">begin</span>
  <span class="keyword">case+</span> der <span class="keyword">of</span>
  <span class="keyword">|</span> DERvar <span class="keyword">(</span>_<span class="keyword">,</span> tp<span class="keyword">)</span> <span class="keyword">=&gt;</span> tp
  <span class="keyword">|</span> DERlam <span class="keyword">(</span>tp1<span class="keyword">,</span> derf<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">tp2 <span class="keyword">=</span> der2tp <span class="keyword">(</span>derf <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span><span class="keyword">)</span></span>
    <span class="keyword">in</span>
      TPfun <span class="keyword">(</span>tp1<span class="keyword">,</span>tp2<span class="keyword">)</span>
    <span class="keyword">end</span>
  <span class="keyword">|</span> DERapp <span class="keyword">(</span>der1<span class="keyword">,</span> der2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">TPfun <span class="keyword">(</span>_<span class="keyword">,</span> tp2<span class="keyword">)</span> <span class="keyword">=</span> der2tp der1</span>
    <span class="keyword">in</span>
      tp2
    <span class="keyword">end</span>
<span class="keyword">end</span></span> <span class="comment">// end of [der2tp]
</span>
<span class="comment">// main lemma
</span><span class="keyword">prfun</span> <span class="prfexp">reduceLemma <span class="staexp"><span class="keyword">{</span>G<span class="keyword">:</span>ctx<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>n<span class="keyword">:</span>nat<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">.&lt;</span>n<span class="keyword">&gt;.</span></span>
  <span class="keyword">(</span>der<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#1914"><span class="stacstuse">DER</span></a><span class="keyword">(</span>G<span class="keyword">,</span>t<span class="keyword">,</span>T<span class="keyword">,</span>n<span class="keyword">)</span></span><span class="keyword">,</span> rs<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3228"><span class="stacstuse">RS</span></a> G</span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a> <span class="keyword">(</span>t<span class="keyword">,</span> T<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">begin</span> <span class="keyword">case+</span> der <span class="keyword">of</span>
  <span class="keyword">|</span> DERvar <span class="keyword">(</span>i<span class="keyword">,</span>_<span class="keyword">)</span> <span class="keyword">=&gt;</span> rGet <span class="keyword">(</span>i<span class="keyword">,</span> rs<span class="keyword">)</span>
  <span class="keyword">|</span> DERlam <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>f<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span><span class="keyword">..</span><span class="keyword">}</span></span> <span class="keyword">(</span>_<span class="keyword">,</span> derf<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span> 
      <span class="keyword">prval</span> <span class="prfexp">TPfun <span class="staexp"><span class="keyword">{</span>T1<span class="keyword">,</span>T2<span class="keyword">}</span></span> <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">)</span> <span class="keyword">=</span> der2tp der</span>
      <span class="keyword">prfn</span> <span class="prfexp">gr <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>r<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span>T1<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>f t<span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>
        <span class="keyword">prval</span> <span class="prfexp">rs' <span class="keyword">=</span> RScons <span class="keyword">(</span>r<span class="keyword">,</span> rs<span class="keyword">)</span></span>       
        <span class="keyword">prval</span> <span class="prfexp">r' <span class="keyword">=</span> reduceLemma <span class="keyword">(</span>derf<span class="staexp"><span class="keyword">{</span>t<span class="keyword">}</span></span><span class="keyword">,</span> rs'<span class="keyword">)</span></span>
      <span class="keyword">in</span>
        r'
      <span class="keyword">end</span></span>
      <span class="keyword">prfn</span> <span class="prfexp">fr <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="keyword">(</span>r<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span>t<span class="keyword">,</span>T1<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#543"><span class="stacstuse">TMapp</span></a><span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#521"><span class="stacstuse">TMlam</span></a> f<span class="keyword">,</span> t<span class="keyword">)</span><span class="keyword">,</span> T2<span class="keyword">)</span></span> <span class="keyword">=</span> <span class="keyword">let</span>    
        <span class="keyword">prval</span> <span class="prfexp">lamf_red <span class="keyword">=</span> absSound <span class="staexp"><span class="keyword">{</span>f<span class="keyword">}</span></span> <span class="keyword">(</span>tp1<span class="keyword">,</span> tp2<span class="keyword">,</span> gr<span class="keyword">)</span></span>
        <span class="keyword">prval</span> <span class="prfexp">Rfun<span class="keyword">(</span>red_imp<span class="keyword">)</span> <span class="keyword">=</span> lamf_red</span>
      <span class="keyword">in</span>
        red_imp r
      <span class="keyword">end</span></span>
    <span class="keyword">in</span>
      Rfun fr
    <span class="keyword">end</span>
  <span class="keyword">|</span> DERapp <span class="keyword">(</span>der1<span class="keyword">,</span> der2<span class="keyword">)</span> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
      <span class="keyword">prval</span> <span class="prfexp">r1 <span class="keyword">=</span> reduceLemma<span class="keyword">(</span>der1<span class="keyword">,</span> rs<span class="keyword">)</span></span>
      <span class="keyword">prval</span> <span class="prfexp">Rfun fr <span class="keyword">=</span> r1</span>
      <span class="keyword">prval</span> <span class="prfexp">r2 <span class="keyword">=</span> reduceLemma<span class="keyword">(</span>der2<span class="keyword">,</span> rs<span class="keyword">)</span></span>
    <span class="keyword">in</span>
      fr r2
    <span class="keyword">end</span>
<span class="keyword">end</span></span> <span class="comment">// end of [reduceLemma]
</span>
<span class="comment">// all typable terms are reducible
</span><span class="keyword">prfn</span> <span class="prfexp">reduce <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="keyword">(</span>der<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2323"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#738"><span class="stacstuse">CTXnil</span></a><span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#3013"><span class="stacstuse">R</span></a> <span class="keyword">(</span>t<span class="keyword">,</span>T<span class="keyword">)</span></span> <span class="keyword">=</span>
  reduceLemma<span class="keyword">(</span>der<span class="keyword">,</span> RSnil<span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span></span>

<span class="comment">// the final payoff
</span><span class="keyword">prfn</span> <span class="prfexp">normalize <span class="staexp"><span class="keyword">{</span>t<span class="keyword">:</span>tm<span class="keyword">}</span></span> <span class="staexp"><span class="keyword">{</span>T<span class="keyword">:</span>tp<span class="keyword">}</span></span> <span class="keyword">(</span>der<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2323"><span class="stacstuse">DER0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#738"><span class="stacstuse">CTXnil</span></a><span class="keyword">,</span> t<span class="keyword">,</span> T<span class="keyword">)</span></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2ffac2_2fhwxi_2fresearch_2fATS_2fIMPLEMENT_2fGeizella_2fAnairiats_2fsvn_2fats_2dlang_2fdoc_2fEXAMPLE_2fLF_2fSTLC_2dSN_2dhoas_2edats.html#2529"><span class="stacstuse">SN0</span></a> t</span> <span class="keyword">=</span>
  cr1<span class="keyword">(</span>der2tp der<span class="keyword">,</span> reduce der<span class="keyword">)</span></span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* end of [STLC-SN-hoas.dats] *)</span>
</pre>
</body>
</html>
